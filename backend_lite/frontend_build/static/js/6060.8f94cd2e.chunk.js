"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6060],{6060:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var l=t(9379),a=t(5043),n=t(7819),r=t(2024),i=t(7104),o=t(1680),c=t(1360),d=t(9855),x=t(797),m=t(614),u=t(6328),h=t(9688),p=t(8018),b=t(8211),f=t(579);const g=[{value:"claim",label:"\ud83d\udcdc \u05db\u05ea\u05d1 \u05ea\u05d1\u05d9\u05e2\u05d4 / \u05d1\u05e7\u05e9\u05d4",isFoundational:!0},{value:"defense",label:"\ud83d\udee1\ufe0f \u05db\u05ea\u05d1 \u05d4\u05d2\u05e0\u05d4 / \u05ea\u05e9\u05d5\u05d1\u05d4",isFoundational:!0},{value:"reply",label:"\u21a9\ufe0f \u05db\u05ea\u05d1 \u05ea\u05e9\u05d5\u05d1\u05d4 \u05dc\u05db\u05ea\u05d1 \u05d4\u05d2\u05e0\u05d4",isFoundational:!0},{value:"summaries",label:"\ud83d\udcd1 \u05e1\u05d9\u05db\u05d5\u05de\u05d9\u05dd",isFoundational:!0},{value:"protocol",label:"\ud83d\udccb \u05e4\u05e8\u05d5\u05d8\u05d5\u05e7\u05d5\u05dc \u05d3\u05d9\u05d5\u05df",isFoundational:!1},{value:"affidavit",label:"\u270d\ufe0f \u05ea\u05e6\u05d4\u05d9\u05e8",isFoundational:!1},{value:"witness_statement",label:"\ud83d\udc64 \u05e2\u05d3\u05d5\u05ea / \u05ea\u05e2\u05ea\u05d9\u05e7 \u05e2\u05d3\u05d5\u05ea",isFoundational:!1},{value:"expert_opinion",label:"\ud83d\udd2c \u05d7\u05d5\u05d5\u05ea \u05d3\u05e2\u05ea \u05de\u05d5\u05de\u05d7\u05d4",isFoundational:!1},{value:"evidence",label:"\ud83d\udcce \u05e8\u05d0\u05d9\u05d4 / \u05e0\u05e1\u05e4\u05d7",isFoundational:!1},{value:"contract",label:"\ud83d\udcc4 \u05d7\u05d5\u05d6\u05d4 / \u05d4\u05e1\u05db\u05dd",isFoundational:!1},{value:"correspondence",label:"\u2709\ufe0f \u05d4\u05ea\u05db\u05ea\u05d1\u05d5\u05ea / \u05de\u05db\u05ea\u05d1\u05d9\u05dd",isFoundational:!1},{value:"court_decision",label:"\u2696\ufe0f \u05d4\u05d7\u05dc\u05d8\u05d4 / \u05e4\u05e1\u05e7 \u05d3\u05d9\u05df",isFoundational:!1},{value:"motion",label:"\ud83d\udcdd \u05d1\u05e7\u05e9\u05d4 \u05d1\u05d9\u05e0\u05d9\u05d9\u05dd",isFoundational:!1},{value:"other",label:"\ud83d\udcc1 \u05d0\u05d7\u05e8",isFoundational:!1}],v="yitro_recent_inputs",j=e=>{try{const s=localStorage.getItem(v);if(!s)return[];return(JSON.parse(s)[e]||[]).slice(0,3)}catch(s){return[]}},N=e=>{var s;let{caseId:t,caseName:N,files:w=[],onFilesUpdate:y,autoOpenUpload:k=!1}=e;const[_,A]=(0,a.useState)(k),[C,z]=(0,a.useState)(null),[R,F]=(0,a.useState)([]),[S,U]=(0,a.useState)(!1),[I,T]=(0,a.useState)(null),[D,E]=(0,a.useState)(null),[L,M]=(0,a.useState)("skip"),[O,J]=(0,a.useState)(null),[P,q]=(0,a.useState)(null),[$,B]=(0,a.useState)(null),[G,X]=(0,a.useState)(""),[H,K]=(0,a.useState)(()=>j("lawyer_name")),Q=(0,a.useRef)(y),V=(0,a.useRef)(null);(0,a.useEffect)(()=>{Q.current=y},[y]),(0,a.useEffect)(()=>{t&&(async()=>{try{const e=await(0,h.v$)("/api/cases/".concat(t,"/context"));if(e.ok){const s=await e.json();s.has_context&&s.context&&(J(s.context),p.v.log("\u2705 FileManager: Case context loaded for pre-fill"))}}catch(e){p.v.warn("FileManager: Could not fetch case context:",e)}})()},[t]);const W=async function(e,s){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("opponent"===s&&!l){const t=w.find(s=>s.id===e||s.filename===e),l=(null===t||void 0===t?void 0:t.opponent_lawyer_name)||(null===O||void 0===O?void 0:O.opposing_lawyer_name)||"";return X(l),void B({fileId:e,newSource:s})}try{q(e);let a="/api/cases/".concat(encodeURIComponent(t),"/files/").concat(encodeURIComponent(e),"?source=").concat(s);l&&(a+="&opponent_lawyer_name=".concat(encodeURIComponent(l)));const n=await(0,h.v$)(a,{method:"PATCH"});if(!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.detail||"Update failed")}u.oR.success('\u2705 \u05de\u05e7\u05d5\u05e8 \u05d4\u05de\u05e1\u05de\u05da \u05e2\u05d5\u05d3\u05db\u05df \u05dc"'.concat("self"===s?"\u05e9\u05dc\u05d9":"opponent"===s?"\u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9":"court"===s?"\u05d1\u05d9\u05ea \u05d4\u05de\u05e9\u05e4\u05d8":"\u05e6\u05d3 \u05e9\u05dc\u05d9\u05e9\u05d9",'"')),Q.current&&await Q.current()}catch(a){p.v.error("Update file source error:",a),u.oR.error("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05e2\u05d3\u05db\u05d5\u05df \u05de\u05e7\u05d5\u05e8 \u05d4\u05de\u05e1\u05de\u05da: "+a.message)}finally{q(null)}},Y=async()=>{if(!$)return;const{fileId:e,newSource:s}=$,t=G.trim();!t||t.length<2?u.oR.error("\u05e0\u05d0 \u05dc\u05d4\u05d6\u05d9\u05df \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d3\u05d9\u05df (\u05dc\u05e4\u05d7\u05d5\u05ea 2 \u05ea\u05d5\u05d5\u05d9\u05dd)"):(B(null),X(""),await W(e,s,t))},Z=(e,s)=>{const t=e.reduce((e,s)=>{var t;return e+((null===(t=s.file)||void 0===t?void 0:t.size)||0)/1048576},0),l=e.length,a=Math.ceil(5*t);if("skip"===s){const e=Math.floor(a/60),s=a%60;return e>0?"".concat(e,":").concat(s.toString().padStart(2,"0")," \u05d3\u05e7\u05d5\u05ea"):"".concat(s," \u05e9\u05e0\u05d9\u05d5\u05ea")}const n=a+("new"===s?45*l:45*(w.length+l)),r=Math.floor(n/60),i=n%60;return r>0?"".concat(r,":").concat(i.toString().padStart(2,"0")," \u05d3\u05e7\u05d5\u05ea"):"".concat(i," \u05e9\u05e0\u05d9\u05d5\u05ea")},ee=(w||[]).filter(e=>"self"===e.source||!e.source),se=(w||[]).filter(e=>"opponent"===e.source),te=ee.length>0,le=se.length>0,ae=te&&le;return(0,f.jsxs)(f.Fragment,{children:[I&&(0,f.jsxs)("div",{className:"fixed bottom-24 left-4 z-[9998] bg-slate-900/95 backdrop-blur-xl border border-blue-500/50 rounded-xl p-4 shadow-2xl max-w-sm",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(r.A,{className:"animate-spin text-blue-400",size:24}),(0,f.jsx)(x.A,{className:"absolute inset-0 m-auto text-blue-400/30",size:12})]}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-white font-semibold text-sm",children:I.message}),(0,f.jsxs)("p",{className:"text-blue-300 text-xs mt-1",children:["\u23f1\ufe0f \u05d6\u05de\u05df \u05de\u05e9\u05d5\u05e2\u05e8: ",I.estimatedTime]}),(0,f.jsx)("p",{className:"text-blue-400/70 text-xs mt-0.5",children:"\u05e0\u05d9\u05ea\u05df \u05dc\u05d4\u05de\u05e9\u05d9\u05da \u05dc\u05e2\u05d1\u05d5\u05d3 \u05d1\u05d9\u05e0\u05ea\u05d9\u05d9\u05dd!"})]}),I.canCancel&&(0,f.jsx)("button",{onClick:()=>{V.current&&(V.current.abort(),p.v.log("\ud83d\udeab Upload canceled by user"))},className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-lg transition-colors",title:"\u05d1\u05d8\u05dc \u05d4\u05e2\u05dc\u05d0\u05d4",children:(0,f.jsx)(m.A,{size:20})})]}),(0,f.jsx)("div",{className:"mt-3 h-1.5 bg-white/10 rounded-full overflow-hidden",children:(0,f.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all duration-500 ".concat(void 0===I.progress?"animate-pulse":""),style:{width:"".concat(null!==(s=I.progress)&&void 0!==s?s:60,"%")}})}),void 0!==I.progress&&(0,f.jsxs)("p",{className:"text-blue-300 text-xs mt-1 text-center",children:[I.progress,"%"]})]}),(0,f.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-6 border border-white/20",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)(o.A,{className:"text-blue-400",size:24}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-xl font-bold text-white",children:"\u05e7\u05d1\u05e6\u05d9\u05dd \u05d1\u05ea\u05d9\u05e7"}),(0,f.jsxs)("p",{className:"text-blue-300 text-sm",children:[(null===w||void 0===w?void 0:w.length)||0," ",1===((null===w||void 0===w?void 0:w.length)||0)?"\u05e7\u05d5\u05d1\u05e5":"\u05e7\u05d1\u05e6\u05d9\u05dd",I&&(0,f.jsx)("span",{className:"text-blue-400 mr-2",children:"\u2022 \u05de\u05e2\u05dc\u05d4..."})]})]})]}),(0,f.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:[(0,f.jsx)(c.A,{size:20}),I?"\u05d4\u05d5\u05e1\u05e3 \u05e2\u05d5\u05d3 \u05e7\u05d1\u05e6\u05d9\u05dd":"\u05d4\u05d5\u05e1\u05e3 \u05e7\u05d1\u05e6\u05d9\u05dd"]})]}),((null===w||void 0===w?void 0:w.length)||0)>0&&!ae&&(0,f.jsx)("div",{className:"mb-6 bg-amber-500/20 border border-amber-500/50 rounded-xl p-4",children:(0,f.jsxs)("div",{className:"flex items-start gap-3",children:[(0,f.jsx)(n.A,{className:"text-amber-300 mt-0.5 flex-shrink-0",size:24}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-amber-200 font-semibold mb-2",children:"\ud83d\udca1 \u05dc\u05de\u05d4 \u05d7\u05e9\u05d5\u05d1 \u05dc\u05d4\u05e2\u05dc\u05d5\u05ea \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05de\u05e9\u05e0\u05d9 \u05d4\u05e6\u05d3\u05d3\u05d9\u05dd?"}),(0,f.jsx)("p",{className:"text-amber-100 text-sm mb-2",children:"\u05d9\u05ea\u05e8\u05d5 \u05de\u05d1\u05e6\u05e2 \u05e9\u05dc\u05d5\u05e9\u05d4 \u05e1\u05d5\u05d2\u05d9 \u05e0\u05d9\u05ea\u05d5\u05d7\u05d9\u05dd \u05e2\u05dc \u05d1\u05e1\u05d9\u05e1 \u05d4\u05de\u05e1\u05de\u05db\u05d9\u05dd:"}),(0,f.jsxs)("ul",{className:"text-amber-100 text-sm space-y-1 mb-3 mr-2",children:[(0,f.jsxs)("li",{children:["\u2022 ",(0,f.jsx)("strong",{children:"\u05e1\u05ea\u05d9\u05e8\u05d5\u05ea:"})," \u05e1\u05ea\u05d9\u05e8\u05d5\u05ea \u05e4\u05e0\u05d9\u05de\u05d9\u05d5\u05ea \u05d1\u05ea\u05d5\u05da \u05de\u05e1\u05de\u05db\u05d9 \u05e6\u05d3 \u05d0\u05d7\u05d3 (\u05dc\u05d7\u05e7\u05d9\u05e8\u05d4 \u05e0\u05d2\u05d3\u05d9\u05ea)"]}),(0,f.jsxs)("li",{children:["\u2022 ",(0,f.jsx)("strong",{children:"\u05e4\u05dc\u05d5\u05d2\u05ea\u05d0\u05d5\u05ea:"})," \u05de\u05d7\u05dc\u05d5\u05e7\u05d5\u05ea \u05d1\u05d9\u05df \u05e9\u05e0\u05d9 \u05d4\u05e6\u05d3\u05d3\u05d9\u05dd (\u05e9\u05d0\u05dc\u05d5\u05ea \u05e9\u05d1\u05d9\u05ea \u05d4\u05de\u05e9\u05e4\u05d8 \u05d9\u05db\u05e8\u05d9\u05e2)"]}),(0,f.jsxs)("li",{children:["\u2022 ",(0,f.jsx)("strong",{children:"\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea:"})," \u05e2\u05d5\u05d1\u05d3\u05d5\u05ea \u05e9\u05e9\u05e0\u05d9 \u05d4\u05e6\u05d3\u05d3\u05d9\u05dd \u05de\u05e1\u05db\u05d9\u05de\u05d9\u05dd \u05e2\u05dc\u05d9\u05d4\u05df (\u05d0\u05d9\u05df \u05e6\u05d5\u05e8\u05da \u05dc\u05d4\u05d5\u05db\u05d9\u05d7)"]})]}),(0,f.jsx)("p",{className:"text-amber-200 text-sm font-semibold mb-3",children:"\u26a0\ufe0f \u05dc\u05d6\u05d9\u05d4\u05d5\u05d9 \u05e4\u05dc\u05d5\u05d2\u05ea\u05d0\u05d5\u05ea \u05d5\u05de\u05d5\u05e1\u05db\u05de\u05d5\u05ea - \u05d7\u05d5\u05d1\u05d4 \u05dc\u05d4\u05e2\u05dc\u05d5\u05ea \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05e9\u05dc \u05e9\u05e0\u05d9 \u05d4\u05e6\u05d3\u05d3\u05d9\u05dd!"}),(0,f.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg ".concat(te?"bg-emerald-500/20 text-emerald-300":"bg-white/10 text-white/60"),children:[te?"\u2705":"\ud83d\udcc4"," \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05e9\u05dc\u05e0\u05d5 ",te?"(".concat(ee.length,")"):"(\u05d7\u05e1\u05e8)"]}),(0,f.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg ".concat(le?"bg-emerald-500/20 text-emerald-300":"bg-white/10 text-white/60"),children:[le?"\u2705":"\ud83d\udcc4"," \u05de\u05e1\u05de\u05db\u05d9 \u05d4\u05d9\u05e8\u05d9\u05d1 ",le?"(".concat(se.length,")"):"(\u05d7\u05e1\u05e8)"]})]}),!te&&(0,f.jsx)("p",{className:"text-amber-100/70 text-xs mt-2",children:"\u2192 \u05d4\u05e2\u05dc\u05d4 \u05db\u05ea\u05d1 \u05ea\u05d1\u05d9\u05e2\u05d4/\u05d4\u05d2\u05e0\u05d4/\u05ea\u05e6\u05d4\u05d9\u05e8 \u05e9\u05dc\u05da"}),!le&&(0,f.jsx)("p",{className:"text-amber-100/70 text-xs mt-2",children:"\u2192 \u05d4\u05e2\u05dc\u05d4 \u05db\u05ea\u05d1 \u05ea\u05d1\u05d9\u05e2\u05d4/\u05d4\u05d2\u05e0\u05d4/\u05ea\u05e6\u05d4\u05d9\u05e8 \u05e9\u05dc \u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9"})]})]})}),0===((null===w||void 0===w?void 0:w.length)||0)?(0,f.jsxs)("div",{className:"text-center py-12 text-blue-300",children:[(0,f.jsx)(o.A,{className:"mx-auto mb-4 opacity-50",size:64}),(0,f.jsx)("p",{children:"\u05d0\u05d9\u05df \u05e7\u05d1\u05e6\u05d9\u05dd \u05d1\u05ea\u05d9\u05e7"})]}):(0,f.jsx)("div",{className:"space-y-3",children:w.map(e=>{var s;const l=(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.filename);let a=null===e||void 0===e?void 0:e.status;a||(a=null!==e&&void 0!==e&&e.uploaded_at?"ready":"processing");const c="processing"===a,x="missing"===a,m="ready"===a,b=(()=>{if(null===e||void 0===e||!e.uploaded_at)return"\u2014";const s=new Date(e.uploaded_at);return isNaN(s)?"\u2014":s.toLocaleDateString("he-IL")})();return(0,f.jsx)("div",{className:"bg-white/5 rounded-xl p-4 border transition-all ".concat(x?"border-red-500/50":c?"border-yellow-500/50 animate-pulse":"border-white/10 hover:border-blue-500/50"),children:(0,f.jsxs)("div",{className:"flex items-start justify-between",children:[(0,f.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[(0,f.jsx)("div",{className:"mt-1",children:(0,f.jsx)(o.A,{className:"text-blue-400",size:32})}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,f.jsx)("h4",{className:"text-white font-semibold",children:(null===e||void 0===e?void 0:e.filename)||"\u2014"}),a&&(0,f.jsx)("span",{className:"ready"===a?"text-xs bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded-full":"processing"===a?"text-xs bg-yellow-500/20 text-yellow-300 px-2 py-1 rounded-full flex items-center gap-1":"text-xs bg-red-500/20 text-red-300 px-2 py-1 rounded-full",children:"ready"===a?"\u05de\u05d5\u05db\u05df":"processing"===a?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(r.A,{className:"animate-spin",size:12}),"\u05de\u05e0\u05ea\u05d7..."]}):"\u05d7\u05e1\u05e8 \u05d1\u05d3\u05d9\u05e1\u05e7"})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-blue-300",children:"\ud83d\udcc4 \u05e2\u05de\u05d5\u05d3\u05d9\u05dd:"}),(0,f.jsx)("span",{className:"text-white font-semibold mr-2",children:c?"...":x?"?":null!==(s=null===e||void 0===e?void 0:e.pages)&&void 0!==s?s:"\u2014"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-blue-300",children:"\ud83d\udcbe \u05d2\u05d5\u05d3\u05dc:"}),(0,f.jsx)("span",{className:"text-white font-semibold mr-2",children:(e=>{const s=Number(e);return Number.isFinite(s)?(s/1024/1024).toFixed(2)+" MB":"\u2014"})(null===e||void 0===e?void 0:e.size)})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-blue-300",children:"\ud83d\udcdd \u05d8\u05e2\u05e0\u05d5\u05ea:"}),(0,f.jsx)("span",{className:"text-white font-semibold mr-2",children:c?"...":x?"?":(null===e||void 0===e?void 0:e.claims_count)||0})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-blue-300",children:"\ud83d\udc65 \u05d9\u05e9\u05d5\u05d9\u05d5\u05ea:"}),(0,f.jsx)("span",{className:"text-white font-semibold mr-2",children:c?"...":x?"?":(null===e||void 0===e?void 0:e.entities_count)||0})]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[(0,f.jsx)("span",{className:"text-blue-300 text-sm",children:"\ud83d\udcc1 \u05de\u05e7\u05d5\u05e8:"}),(0,f.jsxs)("select",{value:(null===e||void 0===e?void 0:e.source)||"self",onChange:e=>W(l,e.target.value),disabled:P===l,className:"px-2 py-1 text-xs border border-white/20 rounded bg-slate-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,f.jsx)("option",{value:"self",children:"\ud83d\udee1\ufe0f \u05e9\u05dc\u05d9"}),(0,f.jsx)("option",{value:"opponent",children:"\u2694\ufe0f \u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9"}),(0,f.jsx)("option",{value:"court",children:"\u2696\ufe0f \u05d1\u05d9\u05ea \u05d4\u05de\u05e9\u05e4\u05d8"}),(0,f.jsx)("option",{value:"third_party",children:"\ud83d\udc65 \u05e6\u05d3 \u05e9\u05dc\u05d9\u05e9\u05d9"})]}),P===l&&(0,f.jsx)(r.A,{className:"animate-spin text-blue-400",size:14})]}),(0,f.jsxs)("p",{className:"text-blue-300 text-xs mt-2",children:["\u05d4\u05d5\u05e2\u05dc\u05d4 \u05d1-",b]}),(()=>{const s=null===e||void 0===e?void 0:e.analysis_status,t=null===e||void 0===e?void 0:e.analysis_error;return c||"analyzing"===s?(0,f.jsxs)("p",{className:"text-yellow-300 text-xs mt-1 flex items-center gap-1",children:[(0,f.jsx)(n.A,{size:12}),"\u05d4\u05e7\u05d5\u05d1\u05e5 \u05d1\u05ea\u05d4\u05dc\u05d9\u05da \u05e0\u05d9\u05ea\u05d5\u05d7 - \u05d6\u05d4 \u05d9\u05db\u05d5\u05dc \u05dc\u05e7\u05d7\u05ea \u05de\u05e1\u05e4\u05e8 \u05d3\u05e7\u05d5\u05ea"]}):"error"===s?(0,f.jsxs)("p",{className:"text-red-400 text-xs mt-1 flex items-center gap-1",children:[(0,f.jsx)(n.A,{size:12}),"\u274c \u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05e0\u05d9\u05ea\u05d5\u05d7: ",t||"\u05e9\u05d2\u05d9\u05d0\u05d4 \u05dc\u05d0 \u05d9\u05d3\u05d5\u05e2\u05d4"]}):"no_text"===s?(0,f.jsxs)("p",{className:"text-orange-400 text-xs mt-1 flex items-center gap-1",children:[(0,f.jsx)(n.A,{size:12}),"\u26a0\ufe0f \u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05d8\u05e7\u05e1\u05d8 \u05dc\u05e0\u05d9\u05ea\u05d5\u05d7 \u05d1\u05de\u05e1\u05de\u05da \u05d6\u05d4 (\u05d9\u05d9\u05ea\u05db\u05df \u05e9\u05de\u05d3\u05d5\u05d1\u05e8 \u05d1\u05e1\u05e8\u05d9\u05e7\u05d4/\u05ea\u05de\u05d5\u05e0\u05d4 \u05dc\u05dc\u05d0 OCR)"]}):"pending"===s||!s&&0===(null===e||void 0===e?void 0:e.claims_count)&&0===(null===e||void 0===e?void 0:e.entities_count)?(0,f.jsxs)("p",{className:"text-gray-400 text-xs mt-1 flex items-center gap-1",children:[(0,f.jsx)(n.A,{size:12}),"\u23f3 \u05de\u05de\u05ea\u05d9\u05df \u05dc\u05e0\u05d9\u05ea\u05d5\u05d7 - \u05d4\u05e2\u05dc\u05d4 \u05e7\u05d1\u05e6\u05d9\u05dd \u05e0\u05d5\u05e1\u05e4\u05d9\u05dd \u05d5\u05d4\u05e4\u05e2\u05dc \u05e0\u05d9\u05ea\u05d5\u05d7"]}):"completed"===s?(0,f.jsxs)("p",{className:"text-green-400 text-xs mt-1",children:["\u2705 \u05e0\u05d5\u05ea\u05d7 \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4",(null===e||void 0===e?void 0:e.analyzed_at)&&" (".concat(new Date(e.analyzed_at).toLocaleDateString("he-IL"),")")]}):null})(),x&&(0,f.jsx)("p",{className:"text-red-300 text-xs mt-1",children:"\u05d4\u05e7\u05d5\u05d1\u05e5 \u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05d1\u05d3\u05d9\u05e1\u05e7. \u05d9\u05d9\u05ea\u05db\u05df \u05e9\u05e0\u05de\u05d7\u05e7 \u05d9\u05d3\u05e0\u05d9\u05ea. \u05e0\u05e1\u05d4 \u05dc\u05d4\u05e2\u05dc\u05d5\u05ea \u05de\u05d7\u05d3\u05e9."})]})]}),(0,f.jsxs)("div",{className:"flex gap-2",children:[(0,f.jsx)("button",{onClick:()=>(async(e,s)=>{if(e)try{const l=await(0,h.v$)("/api/cases/".concat(encodeURIComponent(t),"/files/").concat(encodeURIComponent(e),"/download"));if(!l.ok)throw new Error("Download failed");const a=await l.blob(),n=window.URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download=s||"download",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),document.body.removeChild(r)}catch(l){p.v.error("Download error:",l),u.oR.error("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d4\u05d5\u05e8\u05d3\u05ea \u05e7\u05d5\u05d1\u05e5",{description:l.message})}else u.oR.error("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d4\u05d5\u05e8\u05d9\u05d3 \u05e7\u05d5\u05d1\u05e5 \u05dc\u05dc\u05d0 \u05de\u05d6\u05d4\u05d4")})(l,null===e||void 0===e?void 0:e.filename),disabled:!m||!l,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:m?l?"\u05d4\u05d5\u05e8\u05d3":"\u05d0\u05d9\u05df \u05de\u05d6\u05d4\u05d4/\u05e9\u05dd \u05e7\u05d5\u05d1\u05e5 \u05d7\u05d5\u05e7\u05d9":"\u05d6\u05de\u05d9\u05df \u05dc\u05d4\u05d5\u05e8\u05d3\u05d4 \u05e8\u05e7 \u05db\u05e9\u05de\u05d5\u05db\u05df",children:(0,f.jsx)(i.A,{size:16})}),(0,f.jsx)("button",{onClick:()=>z(e),disabled:D===l,className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",title:"\u05de\u05d7\u05e7",children:D===l?(0,f.jsx)(r.A,{className:"animate-spin",size:16}):(0,f.jsx)(d.A,{size:16})})]})]})},l)})}),_&&(0,f.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,f.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-8 max-w-2xl w-full border border-white/20 max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,f.jsx)("h3",{className:"text-2xl font-bold text-white",children:"\u05d4\u05d5\u05e1\u05e3 \u05e7\u05d1\u05e6\u05d9\u05dd \u05dc\u05ea\u05d9\u05e7"}),(0,f.jsx)("button",{onClick:()=>{A(!1),F([])},className:"text-blue-300 hover:text-white transition-colors",children:(0,f.jsx)(m.A,{size:24})})]}),I&&(0,f.jsx)("div",{className:"mb-6 bg-blue-500/20 border border-blue-500 rounded-lg p-4",children:(0,f.jsxs)("div",{className:"flex items-start gap-3",children:[(0,f.jsx)(r.A,{className:"text-blue-300 mt-0.5 flex-shrink-0 animate-spin",size:20}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-blue-200 font-semibold mb-1",children:"\ud83d\udce4 \u05d4\u05e2\u05dc\u05d0\u05d4 \u05d1\u05ea\u05d4\u05dc\u05d9\u05da"}),(0,f.jsx)("p",{className:"text-blue-100 text-sm",children:"\u05e7\u05d1\u05e6\u05d9\u05dd \u05e0\u05d5\u05e1\u05e4\u05d9\u05dd \u05d9\u05ea\u05d5\u05d5\u05e1\u05e4\u05d5 \u05dc\u05ea\u05d5\u05e8 \u05d5\u05d9\u05e2\u05dc\u05d5 \u05d0\u05d5\u05d8\u05d5\u05de\u05d8\u05d9\u05ea \u05dc\u05d0\u05d7\u05e8 \u05e1\u05d9\u05d5\u05dd \u05d4\u05d4\u05e2\u05dc\u05d0\u05d4 \u05d4\u05e0\u05d5\u05db\u05d7\u05d9\u05ea."})]})]})}),(0,f.jsx)("div",{className:"mb-6 bg-yellow-500/20 border border-yellow-500 rounded-lg p-4",children:(0,f.jsxs)("div",{className:"flex items-start gap-3",children:[(0,f.jsx)(n.A,{className:"text-yellow-300 mt-0.5 flex-shrink-0",size:20}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-yellow-200 font-semibold mb-1",children:"\u26a0\ufe0f \u05e9\u05d9\u05dd \u05dc\u05d1"}),(0,f.jsx)("p",{className:"text-yellow-100 text-sm",children:"\u05db\u05d1\u05e8\u05d9\u05e8\u05ea \u05de\u05d7\u05d3\u05dc \u05d4\u05e2\u05dc\u05d0\u05d4 \u05dc\u05d0 \u05de\u05e8\u05d9\u05e6\u05d4 \u05e0\u05d9\u05ea\u05d5\u05d7. \u05e0\u05d9\u05ea\u05d5\u05d7/\u200fRAG \u05d9\u05d5\u05e4\u05e2\u05dc\u05d5 \u05e8\u05e7 \u05dc\u05e4\u05d9 \u05d3\u05e8\u05d9\u05e9\u05ea \u05d4\u05de\u05e9\u05ea\u05de\u05e9."})]})]})}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("label",{className:"block text-white font-semibold mb-3",children:"\u05e1\u05d5\u05d2 \u05d4\u05e0\u05d9\u05ea\u05d5\u05d7"}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-white/5 rounded-lg border border-white/10 hover:border-blue-500 cursor-pointer transition-all",children:[(0,f.jsx)("input",{type:"radio",name:"reanalyze",value:"skip",checked:"skip"===L,onChange:e=>M(e.target.value),className:"mt-1 flex-shrink-0"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-white font-semibold mb-1",children:"\u23f8\ufe0f \u05dc\u05d0 \u05dc\u05d1\u05e6\u05e2 \u05e0\u05d9\u05ea\u05d5\u05d7 \u05db\u05e8\u05d2\u05e2 (\u05e2\u05dc \u05e4\u05d9 \u05d3\u05e8\u05d9\u05e9\u05d4)"}),(0,f.jsx)("p",{className:"text-blue-300 text-sm",children:"\u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d9\u05d9\u05e9\u05de\u05e8\u05d5 \u05d1\u05ea\u05d9\u05e7. \u05ea\u05d5\u05db\u05dc \u05dc\u05d4\u05e4\u05e2\u05d9\u05dc \u05e0\u05d9\u05ea\u05d5\u05d7/\u200fRAG \u05de\u05d0\u05d5\u05d7\u05e8 \u05d9\u05d5\u05ea\u05e8 \u05db\u05e9\u05e6\u05e8\u05d9\u05da."}),(0,f.jsxs)("p",{className:"text-yellow-300 text-xs mt-1",children:["\u23f1\ufe0f \u05d6\u05de\u05df \u05de\u05e9\u05d5\u05e2\u05e8: ",R.length>0?Z(R,"skip"):"\u2014"]})]})]}),(0,f.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-white/5 rounded-lg border border-white/10 hover:border-blue-500 cursor-pointer transition-all",children:[(0,f.jsx)("input",{type:"radio",name:"reanalyze",value:"full",checked:"full"===L,onChange:e=>M(e.target.value),className:"mt-1 flex-shrink-0"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-white font-semibold mb-1",children:"\ud83d\udd04 \u05e0\u05d9\u05ea\u05d5\u05d7 \u05de\u05dc\u05d0 \u05de\u05d7\u05d3\u05e9 (\u05de\u05d5\u05de\u05dc\u05e5)"}),(0,f.jsx)("p",{className:"text-blue-300 text-sm",children:"\u05e0\u05d9\u05ea\u05d7 \u05de\u05d7\u05d3\u05e9 \u05d0\u05ea \u05db\u05dc \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd (\u05d9\u05e9\u05e0\u05d9\u05dd + \u05d7\u05d3\u05e9\u05d9\u05dd). \u05de\u05d5\u05de\u05dc\u05e5 \u05dc\u05de\u05e6\u05d9\u05d0\u05ea \u05e1\u05ea\u05d9\u05e8\u05d5\u05ea \u05d1\u05d9\u05df \u05e7\u05d1\u05e6\u05d9\u05dd."}),(0,f.jsxs)("p",{className:"text-yellow-300 text-xs mt-1",children:["\u23f1\ufe0f \u05d6\u05de\u05df \u05de\u05e9\u05d5\u05e2\u05e8: ",R.length>0?Z(R,"full"):"\u2014"]})]})]}),(0,f.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-white/5 rounded-lg border border-white/10 hover:border-blue-500 cursor-pointer transition-all",children:[(0,f.jsx)("input",{type:"radio",name:"reanalyze",value:"new",checked:"new"===L,onChange:e=>M(e.target.value),className:"mt-1 flex-shrink-0"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-white font-semibold mb-1",children:"\u26a1 \u05e0\u05ea\u05d7 \u05e8\u05e7 \u05e7\u05d1\u05e6\u05d9\u05dd \u05d7\u05d3\u05e9\u05d9\u05dd (\u05de\u05d4\u05d9\u05e8)"}),(0,f.jsx)("p",{className:"text-blue-300 text-sm",children:"\u05e0\u05ea\u05d7 \u05e8\u05e7 \u05d0\u05ea \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d4\u05d7\u05d3\u05e9\u05d9\u05dd, \u05dc\u05dc\u05d0 \u05e9\u05d9\u05e0\u05d5\u05d9 \u05d1\u05e7\u05d1\u05e6\u05d9\u05dd \u05d4\u05e7\u05d9\u05d9\u05de\u05d9\u05dd."}),(0,f.jsxs)("p",{className:"text-yellow-300 text-xs mt-1",children:["\u23f1\ufe0f \u05d6\u05de\u05df \u05de\u05e9\u05d5\u05e2\u05e8: ",R.length>0?Z(R,"new"):"\u2014"]})]})]}),(0,f.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-white/5 rounded-lg border border-white/10 hover:border-blue-500 cursor-pointer transition-all",children:[(0,f.jsx)("input",{type:"radio",name:"reanalyze",value:"diff",checked:"diff"===L,onChange:e=>M(e.target.value),className:"mt-1 flex-shrink-0"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-white font-semibold mb-1",children:"\ud83d\udd0d \u05de\u05e6\u05d1 \u05d4\u05e9\u05d5\u05d5\u05d0\u05d4 (Diff)"}),(0,f.jsx)("p",{className:"text-blue-300 text-sm",children:"\u05d4\u05e9\u05d5\u05d5\u05d4 \u05d1\u05d9\u05df \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d4\u05d9\u05e9\u05e0\u05d9\u05dd \u05dc\u05d7\u05d3\u05e9\u05d9\u05dd \u05d5\u05d6\u05d4\u05d4 \u05e9\u05d9\u05e0\u05d5\u05d9\u05d9\u05dd \u05d5\u05e1\u05ea\u05d9\u05e8\u05d5\u05ea \u05d7\u05d3\u05e9\u05d5\u05ea."}),(0,f.jsxs)("p",{className:"text-yellow-300 text-xs mt-1",children:["\u23f1\ufe0f \u05d6\u05de\u05df \u05de\u05e9\u05d5\u05e2\u05e8: ",R.length>0?Z(R,"diff"):"\u2014"]})]})]})]})]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("label",{className:"block text-white font-semibold mb-3",children:"\u05d1\u05d7\u05e8 \u05e7\u05d1\u05e6\u05d9\u05dd"}),(0,f.jsxs)("div",{className:"border-2 border-dashed border-white/20 rounded-lg p-8 text-center hover:border-blue-500 transition-colors",children:[(0,f.jsx)(x.A,{className:"mx-auto text-blue-300 mb-4",size:48}),(0,f.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.txt",onChange:e=>{const s=Array.from(e.target.files||[]).map(e=>({id:Date.now()+Math.random(),name:e.name,size:(e.size/1024/1024).toFixed(2)+" MB",file:e,source:"self",documentType:"",opponent_lawyer_name:""}));F(e=>[...e,...s])},className:"hidden",id:"file-upload-new"}),(0,f.jsx)("label",{htmlFor:"file-upload-new",className:"cursor-pointer text-blue-300 hover:text-white font-semibold",children:"\u05dc\u05d7\u05e5 \u05dc\u05d1\u05d7\u05d9\u05e8\u05ea \u05e7\u05d1\u05e6\u05d9\u05dd"}),(0,f.jsx)("p",{className:"text-blue-200 text-sm mt-2",children:"PDF, PNG, JPG, TXT"})]}),R.length>0&&(0,f.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,f.jsxs)("p",{className:"text-white font-semibold",children:["\u05e7\u05d1\u05e6\u05d9\u05dd \u05e0\u05d1\u05d7\u05e8\u05d9\u05dd (",R.length,")"]}),(0,f.jsxs)("div",{className:"flex gap-2 text-xs",children:[R.filter(e=>"self"===e.source).length>0&&(0,f.jsxs)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 rounded",children:["\ud83d\udee1\ufe0f \u05e9\u05dc\u05d9: ",R.filter(e=>"self"===e.source).length]}),R.filter(e=>"opponent"===e.source).length>0&&(0,f.jsxs)("span",{className:"px-2 py-1 bg-red-500/20 text-red-300 rounded",children:["\u2694\ufe0f \u05d9\u05e8\u05d9\u05d1: ",R.filter(e=>"opponent"===e.source).length]}),R.filter(e=>"court"===e.source).length>0&&(0,f.jsxs)("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-300 rounded",children:['\u2696\ufe0f \u05d1\u05d9"\u05de: ',R.filter(e=>"court"===e.source).length]}),R.filter(e=>"third_party"===e.source).length>0&&(0,f.jsxs)("span",{className:"px-2 py-1 bg-green-500/20 text-green-300 rounded",children:["\ud83d\udc65 \u05e6\u05d3 \u05d2': ",R.filter(e=>"third_party"===e.source).length]}),R.filter(e=>!e.source).length>0&&(0,f.jsxs)("span",{className:"px-2 py-1 bg-red-500/30 text-red-400 rounded animate-pulse",children:["\u26a0\ufe0f \u05dc\u05dc\u05d0 \u05de\u05e7\u05d5\u05e8: ",R.filter(e=>!e.source).length]})]})]}),R.map(e=>(0,f.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg border border-white/20 space-y-3",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,f.jsx)(o.A,{className:"text-blue-300 flex-shrink-0",size:20}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"text-white text-sm font-semibold truncate",children:e.name}),(0,f.jsx)("p",{className:"text-blue-300 text-xs",children:e.size})]})]}),(0,f.jsx)("button",{onClick:()=>{return s=e.id,void F(e=>e.filter(e=>e.id!==s));var s},className:"text-red-400 hover:text-red-300 transition-colors flex-shrink-0 ml-2",children:(0,f.jsx)(m.A,{size:20})})]}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("label",{className:"text-sm font-semibold text-white flex-shrink-0",children:["\u05e1\u05d5\u05d2 \u05d4\u05de\u05e1\u05de\u05da: ",(0,f.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,f.jsxs)("select",{value:e.documentType||"",onChange:s=>{return t=e.id,a=s.target.value,void F(e=>e.map(e=>e.id===t?(0,l.A)((0,l.A)({},e),{},{documentType:a}):e));var t,a},className:"flex-1 px-3 py-2 border rounded-lg text-sm bg-slate-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(e.documentType?"border-white/20":"border-red-500 bg-red-900/20"),required:!0,children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"\u26a0\ufe0f \u05d1\u05d7\u05e8 \u05e1\u05d5\u05d2 \u05de\u05e1\u05de\u05da (\u05d7\u05d5\u05d1\u05d4)"}),(0,f.jsx)("optgroup",{label:"\ud83d\udccb \u05de\u05e1\u05de\u05db\u05d9 \u05d9\u05e1\u05d5\u05d3",children:g.filter(e=>e.isFoundational).map(e=>(0,f.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,f.jsx)("optgroup",{label:"\ud83d\udcce \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05e0\u05d5\u05e1\u05e4\u05d9\u05dd",children:g.filter(e=>!e.isFoundational).map(e=>(0,f.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),!e.documentType&&(0,f.jsx)("p",{className:"text-red-400 text-xs",children:"\u26a0\ufe0f \u05d7\u05d5\u05d1\u05d4 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05e1\u05d5\u05d2 \u05de\u05e1\u05de\u05da - \u05e7\u05e8\u05d9\u05d8\u05d9 \u05dc\u05d4\u05d1\u05e0\u05ea \u05d4\u05ea\u05d9\u05e7!"}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("label",{className:"text-sm font-semibold text-white flex-shrink-0",children:["\u05de\u05e7\u05d5\u05e8 \u05d4\u05de\u05e1\u05de\u05da: ",(0,f.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,f.jsxs)("select",{value:e.source||"",onChange:s=>{return t=e.id,a=s.target.value,void F(e=>e.map(e=>{if(e.id!==t)return e;let s="";return"opponent"===a&&(s=e.opponent_lawyer_name||(null===O||void 0===O?void 0:O.opposing_lawyer_name)||""),(0,l.A)((0,l.A)({},e),{},{source:a,opponent_lawyer_name:s})}));var t,a},className:"flex-1 px-3 py-2 border rounded-lg text-sm bg-slate-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(e.source?"border-white/20":"border-red-500 bg-red-900/20"),required:!0,children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"\u26a0\ufe0f \u05d1\u05d7\u05e8 \u05de\u05e7\u05d5\u05e8 (\u05d7\u05d5\u05d1\u05d4)"}),(0,f.jsx)("option",{value:"self",children:"\ud83d\udee1\ufe0f \u05e9\u05dc\u05d9 (\u05d4\u05dc\u05e7\u05d5\u05d7 \u05e9\u05dc\u05d9)"}),(0,f.jsx)("option",{value:"opponent",children:"\u2694\ufe0f \u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9 (\u05d4\u05d9\u05e8\u05d9\u05d1)"}),(0,f.jsx)("option",{value:"court",children:"\u2696\ufe0f \u05d1\u05d9\u05ea \u05d4\u05de\u05e9\u05e4\u05d8"}),(0,f.jsx)("option",{value:"third_party",children:"\ud83d\udc65 \u05e6\u05d3 \u05e9\u05dc\u05d9\u05e9\u05d9 (\u05e2\u05d3/\u05de\u05d5\u05de\u05d7\u05d4)"})]})]}),!e.source&&(0,f.jsx)("p",{className:"text-red-400 text-xs",children:"\u26a0\ufe0f \u05d7\u05d5\u05d1\u05d4 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05d0\u05ea \u05de\u05e7\u05d5\u05e8 \u05d4\u05de\u05e1\u05de\u05da \u05dc\u05e4\u05e0\u05d9 \u05d4\u05e2\u05dc\u05d0\u05d4"}),"opponent"===e.source&&(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("label",{className:"text-sm font-semibold text-white flex-shrink-0",children:["\u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d4\u05d3\u05d9\u05df: ",(0,f.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,f.jsx)("input",{type:"text",list:"recent-lawyer-names",value:e.opponent_lawyer_name||"",onChange:s=>{return t=e.id,a=s.target.value,void F(e=>e.map(e=>e.id===t?(0,l.A)((0,l.A)({},e),{},{opponent_lawyer_name:a}):e));var t,a},onBlur:e=>{var s;(null===(s=e.target.value)||void 0===s?void 0:s.trim().length)>=2&&(((s,t)=>{if(t&&!(t.trim().length<2))try{const e=localStorage.getItem(v),l=e?JSON.parse(e):{},a=(l[s]||[]).filter(e=>e.toLowerCase()!==t.trim().toLowerCase());l[s]=[t.trim(),...a].slice(0,3),localStorage.setItem(v,JSON.stringify(l))}catch(e){p.v.warn("Failed to save recent input:",e)}})("lawyer_name",e.target.value),K(j("lawyer_name")))},placeholder:"\u05d4\u05d6\u05df \u05d0\u05ea \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d4\u05d3\u05d9\u05df \u05d4\u05d9\u05e8\u05d9\u05d1",className:"flex-1 px-3 py-2 border border-white/20 rounded-lg text-sm bg-slate-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-500",required:!0}),(0,f.jsx)("datalist",{id:"recent-lawyer-names",children:H.map((e,s)=>(0,f.jsx)("option",{value:e},s))})]})]})]},e.id))]})]}),(0,f.jsxs)("div",{className:"flex gap-4",children:[(0,f.jsx)("button",{onClick:()=>{A(!1),F([])},className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors font-semibold",children:"\u05d1\u05d9\u05d8\u05d5\u05dc"}),(0,f.jsx)("button",{onClick:async()=>{if(0===R.length)return void u.oR.error("\u05e0\u05d0 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05e7\u05d1\u05e6\u05d9\u05dd \u05dc\u05d4\u05e2\u05dc\u05d0\u05d4");const e=R.filter(e=>!e.documentType);if(e.length>0)return void u.oR.error("\u05d7\u05d5\u05d1\u05d4 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05e1\u05d5\u05d2 \u05de\u05e1\u05de\u05da \u05dc\u05db\u05dc \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd!",{description:"\u05dc\u05d0 \u05e0\u05d1\u05d7\u05e8 \u05e1\u05d5\u05d2 \u05de\u05e1\u05de\u05da \u05e2\u05d1\u05d5\u05e8 ".concat(e.length," ").concat(1===e.length?"\u05e7\u05d5\u05d1\u05e5":"\u05e7\u05d1\u05e6\u05d9\u05dd")});const s=R.filter(e=>!e.source);if(s.length>0)return void u.oR.error("\u05d7\u05d5\u05d1\u05d4 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05de\u05e7\u05d5\u05e8 \u05dc\u05db\u05dc \u05d4\u05de\u05e1\u05de\u05db\u05d9\u05dd!",{description:"\u05dc\u05d0 \u05e0\u05d1\u05d7\u05e8 \u05de\u05e7\u05d5\u05e8 \u05e2\u05d1\u05d5\u05e8 ".concat(s.length," ").concat(1===s.length?"\u05e7\u05d5\u05d1\u05e5":"\u05e7\u05d1\u05e6\u05d9\u05dd")});const a=R.filter(e=>"opponent"===e.source).filter(e=>!e.opponent_lawyer_name||""===e.opponent_lawyer_name.trim());if(a.length>0)return void u.oR.error("\u05e0\u05d0 \u05dc\u05d4\u05d6\u05d9\u05df \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d3\u05d9\u05df",{description:"\u05d7\u05e1\u05e8 \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d3\u05d9\u05df \u05e2\u05d1\u05d5\u05e8 ".concat(a.length," ").concat(1===a.length?"\u05e7\u05d5\u05d1\u05e5":"\u05e7\u05d1\u05e6\u05d9\u05dd"," \u05e9\u05dc \u05d4\u05d9\u05e8\u05d9\u05d1")});const n=R.length,r=Z(R,L),i=[...R],o="case-".concat(t);A(!1),F([]),V.current=new AbortController;try{(0,b.Pr)({id:o,type:"case",name:N||"\u05ea\u05d9\u05e7",totalFiles:n,documents:i.map(e=>({filename:e.name,status:"pending",canRetry:!0}))})}catch(g){}T({filesCount:n,estimatedTime:r,startTime:Date.now(),status:"uploading",message:"\u05de\u05e2\u05dc\u05d4 ".concat(n," \u05e7\u05d1\u05e6\u05d9\u05dd..."),canCancel:!0});try{var c,d;const e=i.some(e=>e.file.size>10485760),s=i.reduce((e,s)=>e+s.file.size,0);let a;if(p.v.log("\ud83d\udce4 Uploading ".concat(n," files (total: ").concat((s/1024/1024).toFixed(1),"MB, chunked: ").concat(e,")")),e||s>52428800){p.v.log("\ud83e\udde9 Using chunked upload for ".concat(n," files"));const e=[];let s=0;for(const a of i){var x,m;if(null!==(x=V.current)&&void 0!==x&&null!==(m=x.signal)&&void 0!==m&&m.aborted)throw new Error("\u05d4\u05d4\u05e2\u05dc\u05d0\u05d4 \u05d1\u05d5\u05d8\u05dc\u05d4");T(e=>e?(0,l.A)((0,l.A)({},e),{},{status:"uploading",message:"\u05de\u05e2\u05dc\u05d4 ".concat(a.name," (").concat(s+1,"/").concat(n,")..."),progress:s/n*100,canCancel:!0}):null);try{var f;const r=await(0,h.oI)(t,a.file,{source:a.source||"self",documentType:a.documentType||"other",opponentLawyerName:a.opponent_lawyer_name||"",abortSignal:null===(f=V.current)||void 0===f?void 0:f.signal,onProgress:(e,t)=>{const r=(s+e/100)/n*100;T(s=>s?(0,l.A)((0,l.A)({},s),{},{progress:r,message:"uploading"===t?"\u05de\u05e2\u05dc\u05d4 ".concat(a.name," (").concat(Math.round(e),"%)..."):"\u05de\u05e2\u05d1\u05d3 ".concat(a.name,"...")}):null)}});e.push(r),s++}catch(v){p.v.error("Failed to upload ".concat(a.name,":"),v),u.oR.error("\u05e0\u05db\u05e9\u05dc \u05dc\u05d4\u05e2\u05dc\u05d5\u05ea: ".concat(a.name))}}a={uploaded_files:e,status:e.length>0?"success":"failed"}}else{const e=new FormData;e.append("reanalyze_mode","skip");const s=i.map(e=>e.documentType||"other");e.append("document_types",JSON.stringify(s));const r=i.map(e=>e.source||"self");e.append("file_sources",JSON.stringify(r));const o=i.map(e=>e.opponent_lawyer_name||"");e.append("opponent_lawyer_names",JSON.stringify(o)),i.forEach(s=>{e.append("files",s.file)}),T(e=>e?(0,l.A)((0,l.A)({},e),{},{status:"processing",message:"\u05de\u05e2\u05d1\u05d3 ".concat(1===n?"\u05e7\u05d5\u05d1\u05e5":n+" \u05e7\u05d1\u05e6\u05d9\u05dd","..."),canCancel:!0}):null),a=await(0,h.yX)("/api/cases/".concat(encodeURIComponent(t),"/files"),e,{showErrorToast:!1,abortSignal:V.current.signal,timeoutMs:6e5})}const r=(null===(c=a)||void 0===c||null===(d=c.uploaded_files)||void 0===d?void 0:d.length)||0;r!==n?(p.v.warn("\u26a0\ufe0f Upload mismatch: tried ".concat(n,", uploaded ").concat(r)),u.oR.warning("\u05d4\u05d5\u05e2\u05dc\u05d5 ".concat(r," \u05e7\u05d1\u05e6\u05d9\u05dd \u05de\u05ea\u05d5\u05da ").concat(n," \u05e9\u05e0\u05d1\u05d7\u05e8\u05d5"))):p.v.log("\u2705 Successfully uploaded ".concat(r," files")),Q.current&&await Q.current(a);try{T(e=>e?(0,l.A)((0,l.A)({},e),{},{status:"processing",message:"\ud83d\udd04 \u05de\u05ea\u05d7\u05d9\u05dc \u05e0\u05d9\u05ea\u05d5\u05d7 \u05de\u05e1\u05de\u05db\u05d9\u05dd...",canCancel:!1,progress:80}):null),await(0,h.$P)("/api/cases/".concat(encodeURIComponent(t),"/reanalyze"),{mode:"full",quality:"balanced"}),p.v.log("\u2705 Analysis triggered successfully"),T(e=>e?(0,l.A)((0,l.A)({},e),{},{status:"ready",message:"\u2705 \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d4\u05d5\u05e2\u05dc\u05d5 \u05d5\u05d4\u05e0\u05d9\u05ea\u05d5\u05d7 \u05d4\u05d7\u05dc! \u05d4\u05ea\u05d5\u05e6\u05d0\u05d5\u05ea \u05d9\u05d5\u05e4\u05d9\u05e2\u05d5 \u05d1\u05e7\u05e8\u05d5\u05d1.",canCancel:!1,progress:100}):null)}catch(j){p.v.warn("\u26a0\ufe0f Failed to trigger analysis:",j),T(e=>e?(0,l.A)((0,l.A)({},e),{},{status:"ready",message:"\u2705 \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d4\u05d5\u05e2\u05dc\u05d5 \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4! \u05d4\u05e0\u05d9\u05ea\u05d5\u05d7 \u05d9\u05ea\u05d1\u05e6\u05e2 \u05d1\u05e7\u05e8\u05d5\u05d1.",canCancel:!1,progress:100}):null)}return setTimeout(()=>T(null),3e3),U(!1),void(V.current=null)}catch(w){p.v.error("Upload error:",w);const e=(null===w||void 0===w?void 0:w.message)||String(w);e.includes("\u05d1\u05d5\u05d8\u05dc\u05d4")||e.includes("abort")?u.oR.info("\u05d4\u05d4\u05e2\u05dc\u05d0\u05d4 \u05d1\u05d5\u05d8\u05dc\u05d4"):e.includes("timeout")?u.oR.error("\u26a0\ufe0f \u05d4\u05d4\u05e2\u05dc\u05d0\u05d4 \u05e0\u05db\u05e9\u05dc\u05d4 - timeout. \u05e0\u05e1\u05d4 \u05e7\u05d1\u05e6\u05d9\u05dd \u05e7\u05d8\u05e0\u05d9\u05dd \u05d9\u05d5\u05ea\u05e8 \u05d0\u05d5 \u05d1\u05d3\u05d5\u05e7 \u05d0\u05ea \u05d4\u05d7\u05d9\u05d1\u05d5\u05e8."):e.includes("lawyer")||e.includes("\u05e2\u05d5\u05e8\u05da")?u.oR.error("\u26a0\ufe0f \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d4\u05d3\u05d9\u05df \u05e0\u05d3\u05e8\u05e9 \u05e2\u05d1\u05d5\u05e8 \u05de\u05e1\u05de\u05db\u05d9 \u05d4\u05d9\u05e8\u05d9\u05d1"):e.includes("size")||e.includes("\u05d2\u05d5\u05d3\u05dc")?u.oR.error("\u26a0\ufe0f \u05d0\u05d7\u05d3 \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd \u05d2\u05d3\u05d5\u05dc \u05de\u05d3\u05d9"):u.oR.error("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d4\u05e2\u05dc\u05d0\u05ea \u05e7\u05d1\u05e6\u05d9\u05dd: "+e);try{(0,b.vq)(o,e||"\u05d4\u05e2\u05dc\u05d0\u05d4 \u05e0\u05db\u05e9\u05dc\u05d4",!0)}catch(g){}U(!1),T(null),V.current=null}},disabled:S||0===R.length||R.some(e=>!e.source),className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-semibold hover:from-green-600 hover:to-emerald-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:S?(0,f.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,f.jsx)(r.A,{className:"animate-spin",size:20}),"\u05de\u05e2\u05dc\u05d4..."]}):R.some(e=>!e.source)?"\u26a0\ufe0f \u05d1\u05d7\u05e8 \u05de\u05e7\u05d5\u05e8 \u05dc\u05db\u05dc \u05d4\u05e7\u05d1\u05e6\u05d9\u05dd":"\ud83d\udce4 \u05d4\u05e2\u05dc\u05d4 \u05d5\u05e0\u05d9\u05ea\u05d7"})]})]})}),C&&(0,f.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,f.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-8 max-w-md w-full border border-red-500/50 shadow-2xl",children:[(0,f.jsxs)("div",{className:"text-center mb-6",children:[(0,f.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-500/20 rounded-full mb-4",children:(0,f.jsx)(n.A,{className:"text-red-400",size:32})}),(0,f.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"\u26a0\ufe0f \u05de\u05d7\u05d9\u05e7\u05ea \u05e7\u05d5\u05d1\u05e5"}),(0,f.jsxs)("p",{className:"text-blue-200",children:["\u05d4\u05d0\u05dd \u05dc\u05de\u05d7\u05d5\u05e7 \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5"," ",(0,f.jsxs)("span",{className:"font-bold text-white",children:['"',C.filename,'"']}),"?"]})]}),(0,f.jsxs)("div",{className:"bg-red-500/10 border border-red-500 rounded-lg p-4 mb-6",children:[(0,f.jsx)("p",{className:"text-red-200 text-sm mb-3 font-semibold",children:"\u05e4\u05e2\u05d5\u05dc\u05d4 \u05d6\u05d5 \u05ea\u05d2\u05e8\u05d5\u05dd \u05dc:"}),(0,f.jsxs)("ul",{className:"text-red-100 text-sm space-y-1",children:[(0,f.jsxs)("li",{children:["\u2022 \u05de\u05d7\u05d9\u05e7\u05ea ",C.claims_count||0," \u05d8\u05e2\u05e0\u05d5\u05ea \u05d4\u05e7\u05e9\u05d5\u05e8\u05d5\u05ea \u05dc\u05e7\u05d5\u05d1\u05e5"]}),(0,f.jsx)("li",{children:"\u2022 \u05de\u05d7\u05d9\u05e7\u05ea \u05e1\u05ea\u05d9\u05e8\u05d5\u05ea \u05e9\u05e7\u05e9\u05d5\u05e8\u05d5\u05ea \u05dc\u05d8\u05e2\u05e0\u05d5\u05ea \u05d0\u05dc\u05d5"}),(0,f.jsx)("li",{children:"\u2022 \u05e9\u05d9\u05e0\u05d5\u05d9 \u05d1\u05d2\u05e8\u05e3 \u05d4\u05d9\u05e9\u05d5\u05d9\u05d5\u05ea"}),(0,f.jsxs)("li",{children:["\u2022 ",(0,f.jsx)("span",{className:"font-bold",children:"\u05d4\u05de\u05d7\u05d9\u05e7\u05d4 \u05d4\u05d9\u05d0 \u05dc\u05e6\u05de\u05d9\u05ea\u05d5\u05ea \u05d5\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05e9\u05d7\u05d6\u05e8!"})]})]})]}),(0,f.jsxs)("div",{className:"flex gap-4",children:[(0,f.jsx)("button",{onClick:()=>z(null),className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors font-semibold",children:"\u05d1\u05d9\u05d8\u05d5\u05dc"}),(0,f.jsx)("button",{onClick:()=>(async(e,s)=>{try{E(e);const l=await(0,h.v$)("/api/cases/".concat(encodeURIComponent(t),"/files/").concat(encodeURIComponent(e)),{method:"DELETE"});if(!l.ok){const e=await l.json().catch(()=>({}));throw new Error(e.detail||"Delete failed")}u.oR.success('\u05d4\u05e7\u05d5\u05d1\u05e5 "'.concat(s,'" \u05e0\u05de\u05d7\u05e7 \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4')),z(null),Q.current&&await Q.current()}catch(l){p.v.error("Delete error:",l),u.oR.error("\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05de\u05d7\u05d9\u05e7\u05ea \u05e7\u05d5\u05d1\u05e5",{description:l.message})}finally{E(null)}})(C.id||C.filename,C.filename),disabled:!!D,className:"flex-1 px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:D?(0,f.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,f.jsx)(r.A,{className:"animate-spin",size:20}),"\u05de\u05d5\u05d7\u05e7..."]}):"\ud83d\uddd1\ufe0f \u05de\u05d7\u05e7 \u05dc\u05e6\u05de\u05d9\u05ea\u05d5\u05ea"})]})]})}),$&&(0,f.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,f.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-8 max-w-md w-full border border-blue-500/50 shadow-2xl",children:[(0,f.jsxs)("div",{className:"text-center mb-6",children:[(0,f.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-500/20 rounded-full mb-4",children:(0,f.jsx)(o.A,{className:"text-blue-400",size:32})}),(0,f.jsx)("h3",{className:"text-2xl font-bold text-white mb-2",children:"\u2694\ufe0f \u05de\u05e1\u05de\u05da \u05e9\u05dc \u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9"}),(0,f.jsx)("p",{className:"text-blue-200",children:"\u05e0\u05d0 \u05dc\u05d4\u05d6\u05d9\u05df \u05d0\u05ea \u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d4\u05d3\u05d9\u05df \u05e9\u05dc \u05d4\u05e6\u05d3 \u05d4\u05e9\u05e0\u05d9"})]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsxs)("label",{className:"block text-white font-semibold mb-2",children:["\u05e9\u05dd \u05e2\u05d5\u05e8\u05da \u05d4\u05d3\u05d9\u05df: ",(0,f.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,f.jsx)("input",{type:"text",value:G,onChange:e=>X(e.target.value),placeholder:"\u05dc\u05d3\u05d5\u05d2\u05de\u05d4: \u05e2\u05d5\u05f4\u05d3 \u05d9\u05e9\u05e8\u05d0\u05dc \u05d9\u05e9\u05e8\u05d0\u05dc\u05d9",className:"w-full px-4 py-3 border border-white/20 rounded-lg text-sm bg-slate-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-500",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?Y():"Escape"===e.key&&(B(null),X(""))}}),(0,f.jsx)("p",{className:"text-blue-300/70 text-xs mt-2",children:"\u2139\ufe0f \u05e9\u05dd \u05d6\u05d4 \u05d9\u05d5\u05e4\u05d9\u05e2 \u05dc\u05d9\u05d3 \u05db\u05dc \u05d4\u05d8\u05e2\u05e0\u05d5\u05ea \u05d5\u05d4\u05de\u05e1\u05de\u05db\u05d9\u05dd \u05de\u05e6\u05d3 \u05d4\u05d9\u05e8\u05d9\u05d1"})]}),(0,f.jsxs)("div",{className:"flex gap-4",children:[(0,f.jsx)("button",{onClick:()=>{B(null),X("")},className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors font-semibold",children:"\u05d1\u05d9\u05d8\u05d5\u05dc"}),(0,f.jsx)("button",{onClick:Y,disabled:!G.trim()||G.trim().length<2,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"\u2705 \u05d0\u05d9\u05e9\u05d5\u05e8"})]})]})})]})]})}}}]);
//# sourceMappingURL=6060.8f94cd2e.chunk.js.map