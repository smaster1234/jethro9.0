{"version":3,"file":"static/js/3246.43456bbd.chunk.js","mappings":"iNAkBA,MAwJA,EAxJkDA,IAO3C,IAP4C,OACjDC,EAAM,QACNC,EAAO,YACPC,EAAW,mBACXC,EAAkB,aAClBC,EAAY,YACZC,EAAc,QACfN,EACC,MAAMO,GAAWC,EAAAA,EAAAA,MAEjB,IAAKP,EAAQ,OAAO,KAEpB,MAwCMQ,EAxCW,CACfC,MAAO,CACLC,KAAM,QACNC,MAAO,WACPC,SAAU,CACR,gFACA,8CACA,gEACA,6DAEFC,SAAU,6BAEZC,aAAc,CACZJ,KAAM,eACNC,MAAO,YACPC,SAAU,CACR,gFACA,+CACA,wBACA,0DACA,gEACA,uEAEFC,SAAU,+BAEZE,WAAY,CACVL,KAAM,aACNC,MAAO,YACPC,SAAU,CACR,mFACA,yFACA,2DACA,sBACA,sCACA,cAEFC,SAAU,+BAIcT,GAQ5B,OACEY,EAAAA,EAAAA,KAAA,OAAKC,UAAU,uFAAuFC,IAAI,MAAKC,UAC7GC,EAAAA,EAAAA,MAAA,OAAKH,UAAU,wJAAuJE,SAAA,EAEpKC,EAAAA,EAAAA,MAAA,OAAKH,UAAS,oBAAAI,OAAsBb,EAAWK,SAAQ,qDAAoDM,SAAA,EACzGC,EAAAA,EAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,EAAAA,KAAA,OAAKC,UAAU,oEAAmEE,UAChFH,EAAAA,EAAAA,KAACM,EAAAA,EAAI,CAACC,KAAM,QAEdH,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,EAAAA,KAAA,MAAIC,UAAU,qBAAoBE,SAAC,wDACnCH,EAAAA,EAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAEjB,WAG/Cc,EAAAA,EAAAA,KAAA,UACEQ,QAASvB,EACTgB,UAAU,qDAAoDE,UAE9DH,EAAAA,EAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,WAKbH,EAAAA,EAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,CACxBhB,IACCa,EAAAA,EAAAA,KAAA,OAAKC,UAAU,wDAAuDE,UACpEH,EAAAA,EAAAA,KAAA,KAAGC,UAAU,2BAA0BE,SAAEhB,OAI7Ca,EAAAA,EAAAA,KAAA,OAAKC,UAAU,OAAME,UACnBC,EAAAA,EAAAA,MAAA,KAAGH,UAAU,qCAAoCE,SAAA,CAAC,uDACrCH,EAAAA,EAAAA,KAAA,UAAQC,UAAU,kBAAiBE,SAAEjB,IAAsB,sDAAW,KACjFc,EAAAA,EAAAA,KAAA,UAAQC,UAAS,kDAAAI,OAAoDb,EAAWK,UAAWM,SACxFX,EAAWE,OAEb,IAAI,wCAKTU,EAAAA,EAAAA,MAAA,OAAKH,UAAS,qBAAAI,OAAuBb,EAAWK,SAAQ,iDAAgDM,SAAA,EACtGC,EAAAA,EAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,EAAAA,KAAA,MAAIC,UAAU,qCAAoCE,SAAEX,EAAWE,QAC/DM,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,8FAEvCC,EAAAA,EAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBH,EAAAA,EAAAA,KAAA,KAAGC,UAAU,gCAA+BE,SAAEX,EAAWG,SACzDK,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,0CAIzCH,EAAAA,EAAAA,KAAA,OAAKC,UAAU,iBAAgBE,SAC5BX,EAAWI,SAASc,IAAI,CAACC,EAASC,KACjCR,EAAAA,EAAAA,MAAA,OAAiBH,UAAU,qCAAoCE,SAAA,EAC7DH,EAAAA,EAAAA,KAACa,EAAAA,EAAK,CAACN,KAAM,GAAIN,UAAU,mBAC3BD,EAAAA,EAAAA,KAAA,QAAMC,UAAU,UAASE,SAAEQ,MAFnBC,OAOdR,EAAAA,EAAAA,MAAA,UACEI,QArEUM,KACpB7B,IAEAK,EAAS,gBAAiB,CAAEyB,MAAO,CAAEC,cAAe5B,MAmE1Ca,UAAU,mIAAkIE,SAAA,EAE5IH,EAAAA,EAAAA,KAACiB,EAAAA,EAAK,CAACV,KAAM,KAAM,iEAMvBP,EAAAA,EAAAA,KAAA,OAAKC,UAAU,0DAAyDE,UACtEC,EAAAA,EAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCH,EAAAA,EAAAA,KAACkB,EAAAA,EAAI,CAACjB,UAAU,qCAAqCM,KAAM,MAC3DH,EAAAA,EAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBH,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBE,UAClCH,EAAAA,EAAAA,KAAA,UAAAG,SAAQ,0DAEVC,EAAAA,EAAAA,MAAA,KAAGH,UAAU,6BAA4BE,SAAA,CAAC,gBACpCX,EAAWE,KAAK,ia,kmBC1FtC,MAAMyB,GACM,CACRC,MAAO,uCACPC,MAAO,MACPC,QAAS,kCACTC,SAAU,aACVC,UAAW,eACXC,IAAK,IAPHN,GASE,CACJC,MAAO,iCACPC,MAAO,SACPC,QAAS,wCACTC,SAAU,gBACVC,UAAW,kBACXC,IAAK,IAfHN,GAiBI,CACNC,MAAO,6CACPC,MAAO,SACPC,QAAS,wCACTC,SAAU,gBACVC,UAAW,kBACXC,IAAK,IAvBHN,GAyBC,CACHC,MAAO,qBACPC,MAAO,OACPC,QAAS,oCACTC,SAAU,cACVC,UAAW,gBACXC,IAAK,GA2DHC,GAAgC3C,IAAA,IAAC,MAAE4C,EAAK,OAAEC,EAAM,MAAER,EAAK,WAAES,EAAU,aAAEC,GAAc/C,EAAA,OACvFqB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+BAA8BE,SAAA,EAC3CH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAW4B,KAC/B7B,EAAAA,GAAAA,KAAA,QAAMC,UAAU,sCAAqCE,SAAEiB,QAGzDhB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oDAAmDE,SAAA,EAChEC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,wCAAuCE,SAAA,CAAC,IACjDwB,EAAM,OAGTC,IACCxB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uEAAsEE,SAAA,EACnFC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,wBAAuBE,SAAA,CAAC,gBAClCyB,KAELE,IACC1B,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMsB,EAAaF,GAC5B3B,UAAU,sFAAqFE,SAAA,EAE/FH,EAAAA,GAAAA,KAACgC,GAAAA,EAAY,CAACzB,KAAM,KAAM,kCA6LxC,GA/KsD0B,IAK/C,IAADC,EAAA,IALiD,cACrDC,EAAa,KACbC,EAAI,aACJN,EAAY,UACZ7B,EAAY,IACbgC,EACC,MAAOI,EAAYC,IAAiBC,EAAAA,EAAAA,WAAS,GAGvCC,EAAOL,GAlEaC,KAAqC,IAADK,EAAAC,EAAAC,EAAAC,EAE9D,MAAMC,EAAcT,EAAKU,MAAM,gHACzBC,EAAcX,EAAKU,MAAM,gHACzBE,EAAeZ,EAAKU,MAAM,kGAC1BG,EAAeb,EAAKU,MAAM,iGAC1BI,EAAad,EAAKU,MAAM,0GAE9B,MAAO,CACLK,QAAmB,OAAXN,QAAW,IAAXA,GAAgB,QAALJ,EAAXI,EAAc,UAAE,IAAAJ,OAAL,EAAXA,EAAkBW,SAAU,KACpCC,QAAmB,OAAXN,QAAW,IAAXA,GAAgB,QAALL,EAAXK,EAAc,UAAE,IAAAL,OAAL,EAAXA,EAAkBU,SAAU,KACpCE,SAAqB,OAAZN,QAAY,IAAZA,GAAiB,QAALL,EAAZK,EAAe,UAAE,IAAAL,OAAL,EAAZA,EAAmBS,SAAU,KACtCG,SAAqB,OAAZN,QAAY,IAAZA,GAAiB,QAALL,EAAZK,EAAe,UAAE,IAAAL,OAAL,EAAZA,EAAmBQ,SAAU,KACtCI,MAAON,EAAaO,SAASP,EAAW,SAAMQ,IAqDlBC,CAAmBvB,GAAQ,IACnDoB,EA9EgBI,KACtB,GAAY,OAARA,QAAwBF,IAARE,EAAmB,OACvC,MAAMC,EAAIC,OAAOF,GACjB,OAAIE,OAAOC,MAAMF,QAAjB,EAEIA,GAAK,GAAKA,GAAK,EAAUG,KAAKC,MAAU,IAAJJ,GACpCA,GAAK,GAAKA,GAAK,IAAYG,KAAKC,MAAMJ,GACnCG,KAAKE,IAAI,EAAGF,KAAKvC,IAAI,IAAKuC,KAAKC,MAAMJ,MAuE9BM,CAAkC,QAApBjC,EAAEM,EAAagB,aAAK,IAAAtB,EAAAA,EAAKM,EAAa4B,gBAC5DC,OAAqBX,IAAVF,EAlGQA,IACrBA,GAAS,GAAWrC,GACpBqC,GAAS,GAAWrC,GACpBqC,GAAS,GAAWrC,GACjBA,GA8FgCmD,CAAkBd,QAASE,EAIlE,MA/FgCa,KAChC,MAAMC,GAAKD,GAAK,IAAIE,cACpB,OACED,EAAEE,SAAS,gDACXF,EAAEE,SAAS,sDACXF,EAAEE,SAAS,+EACXF,EAAEE,SAAS,+EACXF,EAAEE,SAAS,qFACXF,EAAEE,SAAS,yEAoFWC,CAAyBvC,GAAQ,KAGlCA,GAEnBhC,EAAAA,GAAAA,MAAA,OAAKH,UAAS,yEAAAI,OAA2EJ,GAAYE,SAAA,EACnGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDH,EAAAA,GAAAA,KAAC4E,EAAAA,EAAa,CAACrE,KAAM,GAAIN,UAAU,oBACnCD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uBAAsBE,SAAC,mFAEzCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,0CAAyCE,UACtDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAEiC,SAOzCI,EAAKW,QAAWX,EAAKa,SAAUjB,GA6BlChC,EAAAA,GAAAA,MAAA,OAAKH,UAAS,qBAAAI,OAAuBgE,EAAWA,EAAS/C,QAAU,sCAAqC,qBAAAjB,OAAoBJ,GAAYE,SAAA,EAEtIC,EAAAA,GAAAA,MAAA,OACEH,UAAU,sFACVO,QAASA,IAAM8B,GAAeD,GAAYlC,SAAA,EAE1CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,WAAUE,SAAA,EACvBH,EAAAA,GAAAA,KAAC6E,EAAAA,EAAM,CAACtE,KAAM,GAAIN,UAAWoE,EAAWA,EAAS7C,UAAY,wBAClDkC,IAAVF,GAAuBA,GAAS,KAC/BxD,EAAAA,GAAAA,KAAC8E,GAAAA,EAAG,CAACvE,KAAM,GAAIN,UAAU,iDAI7BG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uBAAsBE,SAAC,mCACtCkE,GACCrE,EAAAA,GAAAA,KAAA,QAAMC,UAAS,oCAAAI,OAAsCgE,EAAS/C,QAAO,KAAAjB,OAAIgE,EAAS7C,WAAYrB,SAC3FkE,EAASjD,SAGZpB,EAAAA,GAAAA,KAAA,QAAMC,UAAU,6FAA4FE,SAAC,mDAKhHqC,EAAKuC,OACJ/E,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAEqC,EAAKuC,eAKvCrB,IAAVF,GAAuBa,IACtBjE,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAA0B+E,MAAM,iEAAmB7E,SAAA,EAChEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sDAAqDE,UAClEH,EAAAA,GAAAA,KAAA,OACEC,UAAS,UAAAI,OAAYgE,EAAS9C,SAAQ,gCACtC0D,MAAO,CAAEC,MAAM,GAAD7E,OAAKmD,EAAK,WAG5BxD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,sCAAqCE,SAAEqD,QAI3DxD,EAAAA,GAAAA,KAAA,UAAQC,UAAU,sDAAqDE,SACpEkC,GAAarC,EAAAA,GAAAA,KAACmF,EAAAA,EAAS,CAAC5E,KAAM,MAASP,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,UAK9D8B,IACCjC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,CAExBqC,EAAKW,SACJnD,EAAAA,GAAAA,KAAC0B,GAAS,CACRC,MAAOa,EAAKW,OACZvB,OAAQY,EAAKc,QACblC,MAAM,mCACNS,WAAW,gBACXC,aAAcA,IAKjBU,EAAKW,QAAUX,EAAKa,SACnBjD,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iDAAgDE,SAAA,EAC7DH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,6BACfD,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sCAAqCE,UAClDH,EAAAA,GAAAA,KAAC4E,EAAAA,EAAa,CAACrE,KAAM,GAAIN,UAAU,uBAErCD,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAKlBuC,EAAKa,SACJrD,EAAAA,GAAAA,KAAC0B,GAAS,CACRC,MAAOa,EAAKa,OACZzB,OAAQY,EAAKe,QACbnC,MAAM,mCACNS,WAAW,kBACXC,aAAcA,OAMnBU,EAAK6C,cACJrF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,qCAAoCE,UACjDC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,wBAAuBE,SAAA,CAAC,gBAC/BqC,EAAK6C,iBAMd7C,EAAK8C,WAAa9C,EAAK8C,UAAUC,OAAS,IACzCnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,qCAAoCE,SAAA,EACjDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,2CAA0CE,SAAC,uFACxDH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,YAAWE,SACtBqC,EAAK8C,UAAUE,MAAM,EAAG,GAAG9E,IAAI,CAAC+E,EAAGC,KAClCtF,EAAAA,GAAAA,MAAA,MAAYH,UAAU,+CAA8CE,SAAA,EAClEC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,gBAAeE,SAAA,CAAEuF,EAAI,EAAE,QACvC1F,EAAAA,GAAAA,KAAA,QAAAG,SAAOsF,MAFAC,gBAjIrBtF,EAAAA,GAAAA,MAAA,OAAKH,UAAS,qBAAAI,OAAuBgE,EAAWA,EAAS/C,QAAU,sCAAqC,qBAAAjB,OAAoBJ,GAAYE,SAAA,EACtIC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDH,EAAAA,GAAAA,KAAC6E,EAAAA,EAAM,CAACtE,KAAM,GAAIN,UAAWoE,EAAWA,EAAS7C,UAAY,oBAC7DxB,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uBAAsBE,SACnCkE,EAAQ,kCAAAhE,OAAYgE,EAASjD,OAAU,mEAE1CpB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gBACJyD,IAAVF,GAAuBa,IACtBjE,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAA0B+E,MAAM,iEAAmB7E,SAAA,EAChEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,oDAAmDE,UAChEH,EAAAA,GAAAA,KAAA,OACEC,UAAS,UAAAI,OAAYgE,EAAS9C,SAAQ,mBACtC0D,MAAO,CAAEC,MAAM,GAAD7E,OAAKmD,EAAK,WAG5BxD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAEqD,WAI/CxD,EAAAA,GAAAA,KAAA,OAAKC,UAAU,0CAAyCE,UACtDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAEiC,UC/L1CuD,GAAuC,CAE3CC,KAAM,qbAGNC,OAAQ,uMAGRC,SAAU,gWAGVC,KAAM,8EAIFC,GAAiD,CACrDJ,KAAM,CACJ3F,UAAW,wEACXgG,KAAM,gBAERJ,OAAQ,CACN5F,UAAW,sEACXgG,KAAM,gBAERH,SAAU,CACR7F,UAAW,yJACXgG,KAAM,gBAERF,KAAM,CACJ9F,UAAW,0DACXgG,KAAM,iBAIJC,GAA0C,CAC9CN,KAAM,iCACNC,OAAQ,2BACRC,SAAU,2BACVC,KAAM,4BA4CFI,GAAkCpH,IAA8B,IAA7B,KAAEgG,EAAI,KAAE3C,EAAI,QAAE5B,GAASzB,EAC9D,MAAMkG,EAAQe,GAAcjB,GAE5B,OACE/E,EAAAA,GAAAA,KAAA,QACEC,UAAWgF,EAAMhF,UACjBO,QAASA,EACTwE,MAAK,GAAA3E,OAAK4E,EAAMgB,KAAI,KAAA5F,OAAI6F,GAAYnB,IAAQ5E,SAE3CiC,KASDgE,GAAgDnE,IAA8C,IAA7C,KAAEG,EAAI,cAAEiE,EAAa,UAAEpG,EAAY,IAAIgC,EAC5F,IAAKG,EAAM,OAAO,KAElB,MAAMkE,EAzDclE,KACpB,MAAMkE,EAAqB,GAE3B,IAAK,MAAOvB,EAAMwB,KAAYC,OAAOC,QAAQd,IAAqC,CAChF,IAAI7C,EAGJ,IADAyD,EAAQG,UAAY,EACoB,QAAhC5D,EAAQyD,EAAQI,KAAKvE,KAC3BkE,EAASM,KAAK,CACZ7B,OACA3C,KAAMU,EAAM,GACZ+D,MAAO/D,EAAMlC,MACbkG,IAAKhE,EAAMlC,MAAQkC,EAAM,GAAGyC,QAGlC,CAGAe,EAASS,KAAK,CAACC,EAAGC,IAAMD,EAAEH,MAAQI,EAAEJ,OAEpC,MAAMK,EAAqB,GAC3B,IAAIC,EAAU,EACd,IAAK,MAAMC,KAAUd,EACfc,EAAOP,OAASM,IAClBD,EAASN,KAAKQ,GACdD,EAAUC,EAAON,KAIrB,OAAOI,GA4BUG,CAAajF,GAG9B,GAAwB,IAApBkE,EAASf,OACX,OAAOvF,EAAAA,GAAAA,KAAA,QAAMC,UAAWA,EAAUE,SAAEiC,IAItC,MAAMkF,EAAgB,GACtB,IAAIZ,EAAY,EAEhB,IAAK,MAAMU,KAAUd,EAEfc,EAAOP,MAAQH,GACjBY,EAAMV,KAAK,CACT7B,KAAM,OACNwC,QAASnF,EAAKoD,MAAMkB,EAAWU,EAAOP,SAK1CS,EAAMV,KAAK,CACT7B,KAAM,SACNyC,WAAYJ,EAAOrC,KACnBwC,QAASH,EAAOhF,OAGlBsE,EAAYU,EAAON,IAWrB,OAPIJ,EAAYtE,EAAKmD,QACnB+B,EAAMV,KAAK,CACT7B,KAAM,OACNwC,QAASnF,EAAKoD,MAAMkB,MAKtB1G,EAAAA,GAAAA,KAAA,QAAMC,UAAWA,EAAUE,SACxBmH,EAAM5G,IAAI,CAAC+G,EAAM7G,IACE,SAAd6G,EAAK1C,MACA/E,EAAAA,GAAAA,KAAA,QAAAG,SAAmBsH,EAAKF,SAAb3G,IAGlBZ,EAAAA,GAAAA,KAACmG,GAAU,CAETpB,KAAM0C,EAAKD,WACXpF,KAAMqF,EAAKF,QACX/G,QAASA,IAAmB,OAAb6F,QAAa,IAAbA,OAAa,EAAbA,EAAgBoB,EAAKD,WAAaC,EAAKF,UAHjD3G,OA+BjB,M,0cCxMM8G,IAAiBC,EAAAA,EAAAA,MAAK,IAAM,yDAG5BC,GAAgB,CACpBzF,cAAe,CACb8D,KAAMpB,EAAAA,EACNxD,MAAO,MACPC,QAAS,kCACTE,UAAW,eACXqG,WAAY,eACZC,SAAU,CAAC,2BAAQ,gBAAiB,2BAAQ,2BAAQ,uCAAU,sDAEhEC,QAAS,CACP9B,KAAM+B,EAAAA,EACN3G,MAAO,QACPC,QAAS,sCACTE,UAAW,iBACXqG,WAAY,iBACZC,SAAU,CAAC,2BAAQ,UAAW,kFAAkB,uCAAU,iCAAS,mCAErEG,eAAgB,CACdhC,KAAMiC,EAAAA,EACN7G,MAAO,UACPC,QAAS,0CACTE,UAAW,mBACXqG,WAAY,mBACZC,SAAU,CAAC,2BAAQ,2BAAQ,YAAa,iCAAS,iCAAS,iCAAS,WAErEK,QAAS,CACPlC,KAAMrB,EAAAA,EACNvD,MAAO,MACPC,QAAS,kCACTE,UAAW,eACXqG,WAAY,eACZC,SAAU,CAAC,2BAAQ,UAAW,iCAAS,oDAAa,kCAAU,uCAAU,6BAE1ElG,OAAQ,CACNqE,KAAMlE,EAAAA,EACNV,MAAO,OACPC,QAAS,oCACTE,UAAW,gBACXqG,WAAY,gBACZC,SAAU,CAAC,2BAAQ,SAAU,2BAAQ,2BAAQ,2BAAQ,2BAAQ,mCAE/DM,SAAU,CACRnC,KAAMoC,EAAAA,EACNhH,MAAO,SACPC,QAAS,wCACTE,UAAW,kBACXqG,WAAY,kBACZC,SAAU,CAAC,uCAAU,WAAY,iCAAS,2BAAQ,mCAEpDQ,OAAQ,CACNrC,KAAMpB,EAAAA,EACNxD,MAAO,OACPC,QAAS,oCACTE,UAAW,gBACXqG,WAAY,gBACZC,SAAU,CAAC,2BAAQ,SAAU,iCAAS,uCAAU,mDAAY,aAE9DS,MAAO,CACLtC,KAAMuC,EAAAA,EACNnH,MAAO,SACPC,QAAS,wCACTE,UAAW,kBACXqG,WAAY,kBACZC,SAAU,CAAC,2BAAQ,QAAS,qBAAO,iCAAS,iCAAS,2BAAQ,6BAE/DW,SAAU,CACRxC,KAAMyC,GAAAA,EACNrH,MAAO,QACPC,QAAS,sCACTE,UAAW,iBACXqG,WAAY,iBACZC,SAAU,CAAC,2BAAQ,WAAY,iCAAS,wEAE1Ca,SAAU,CACR1C,KAAM2C,GAAAA,EACNvH,MAAO,OACPC,QAAS,oCACTE,UAAW,gBACXqG,WAAY,gBACZC,SAAU,CAAC,qBAAO,WAAY,gEAAe,mCAE/Ce,QAAS,CACP5C,KAAM6C,EAAAA,EACNzH,MAAO,QACPC,QAAS,sCACTE,UAAW,iBACXqG,WAAY,iBACZC,SAAU,CAAC,iCAAS,UAAW,uCAAU,oCAKvCiB,GAAmB5I,GACC,kBAAbA,GACFH,EAAAA,GAAAA,KAACoG,GAAiB,CAAChE,KAAMjC,IAE9B6I,MAAMC,QAAQ9I,GACTA,EAASO,IAAI,CAACwI,EAAOxD,IACL,kBAAVwD,GACFlJ,EAAAA,GAAAA,KAACoG,GAAiB,CAAShE,KAAM8G,GAATxD,GAE1BwD,GAGJ/I,EAIHgJ,GAAyB,CAC7BC,GAAIrK,IAAA,IAAC,KAACsK,EAAI,SAAElJ,GAAmBpB,EAANuK,GAAKC,EAAAA,EAAAA,GAAAxK,EAAAyK,IAAA,OAAMxJ,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,4CAA+CqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OACzHuJ,GAAIzH,IAAA,IAAC,KAACoH,EAAI,SAAElJ,GAAmB8B,EAANqH,GAAKC,EAAAA,EAAAA,GAAAtH,EAAA0H,IAAA,OAAM3J,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,6CAAgDqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OAC1HyJ,GAAIC,IAAA,IAAC,KAACR,EAAI,SAAElJ,GAAmB0J,EAANP,GAAKC,EAAAA,EAAAA,GAAAM,EAAAC,IAAA,OAAM9J,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,iDAAoDqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OAE9H4J,GAAIC,IAAA,IAAC,KAACX,EAAI,SAAElJ,GAAmB6J,EAANV,GAAKC,EAAAA,EAAAA,GAAAS,EAAAC,IAAA,OAC5BjK,EAAAA,GAAAA,KAAA,OAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAKxJ,UAAU,kBAAqBqJ,GAAK,IAAAnJ,SAAGA,MAE9C+J,GAAIC,IAAA,IAAC,KAACd,EAAI,SAAElJ,GAAmBgK,EAANb,GAAKC,EAAAA,EAAAA,GAAAY,EAAAC,IAAA,OAC5BpK,EAAAA,GAAAA,KAAA,OAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAKxJ,UAAU,kBAAqBqJ,GAAK,IAAAnJ,SAAGA,MAE9CkK,GAAIC,IAAA,IAAC,KAACjB,EAAI,SAAElJ,GAAmBmK,EAANhB,GAAKC,EAAAA,EAAAA,GAAAe,EAAAC,IAAA,OAC5BnK,EAAAA,GAAAA,MAAA,OAAAqJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAKxJ,UAAU,2EAA8EqJ,GAAK,IAAAnJ,SAAA,EAChGH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,2DAChBD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uBAAsBE,SAAE4I,GAAgB5I,UAG5DqK,EAAGC,IAAA,IAAC,KAACpB,EAAI,SAAElJ,GAAmBsK,EAANnB,GAAKC,EAAAA,EAAAA,GAAAkB,EAAAC,IAAA,OAAM1K,EAAAA,GAAAA,KAAA,KAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAGxJ,UAAU,wCAA2CqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OACnHwK,OAAQC,IAAA,IAAC,KAACvB,EAAI,SAAElJ,GAAmByK,EAANtB,GAAKC,EAAAA,EAAAA,GAAAqB,EAAAC,IAAA,OAAM7K,EAAAA,GAAAA,KAAA,UAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAQxJ,UAAU,4BAA+BqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OACjH2K,GAAIC,IAAA,IAAC,KAAC1B,EAAI,SAAElJ,GAAmB4K,EAANzB,GAAKC,EAAAA,EAAAA,GAAAwB,EAAAC,IAAA,OAAMhL,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,wBAA2BqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OACrG8K,KAAMC,IAAoD,IAAnD,KAAC7B,EAAI,OAAE8B,EAAM,UAAElL,EAAS,SAAEE,GAAmB+K,EAAN5B,GAAKC,EAAAA,EAAAA,GAAA2B,EAAAE,IAGjD,GAFkB,mBAAmBC,KAAKpL,GAAa,MAErCkL,EAAQ,CACxB,MAAMG,EAAYC,OAAOpL,GAAUqL,QAAQ,MAAO,IAClD,OACExL,EAAAA,GAAAA,KAACyL,EAAAA,SAAQ,CAACC,UACR1L,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sEAAqEE,UAClFH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,oCAAmCE,SAAC,6EAEtDA,UACCH,EAAAA,GAAAA,KAAC0H,GAAc,CAACiE,MAAOL,EAAWrL,UAAU,UAGlD,CAEA,OAAIkL,GACKnL,EAAAA,GAAAA,KAAA,QAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAMxJ,UAAU,sEAAyEqJ,GAAK,IAAAnJ,SAAGA,MAGnGH,EAAAA,GAAAA,KAAA,QAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAMxJ,UAAU,gHAAmHqJ,GAAK,IAAAnJ,SAAGA,MAEpJyL,IAAKC,IAAA,IAAC,KAACxC,EAAI,SAAElJ,GAAmB0L,GAADtC,EAAAA,EAAAA,GAAAsC,EAAAC,IAAA,OAAM9L,EAAAA,GAAAA,KAAA+L,GAAAA,SAAA,CAAA5L,SAAGA,KACxC6L,WAAYC,IAAA,IAAC,KAAC5C,EAAI,SAAElJ,GAAmB8L,EAAN3C,GAAKC,EAAAA,EAAAA,GAAA0C,EAAAC,IAAA,OACpClM,EAAAA,GAAAA,KAAA,cAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAYxJ,UAAU,6DAAgEqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OAEhH6G,EAAGmF,IAAA,IAAC,KAAC9C,EAAI,SAAElJ,GAAmBgM,EAAN7C,GAAKC,EAAAA,EAAAA,GAAA4C,EAAAC,IAAA,OAAMpM,EAAAA,GAAAA,KAAA,KAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAGxJ,UAAU,8CAA8CoM,OAAO,SAASC,IAAI,uBAA0BhD,GAAK,IAAAnJ,SAAGA,MACpJoM,MAAOC,IAAA,IAAC,KAACnD,EAAI,SAAElJ,GAAmBqM,EAANlD,GAAKC,EAAAA,EAAAA,GAAAiD,EAAAC,IAAA,OAC/BzM,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uBAAsBE,UACnCH,EAAAA,GAAAA,KAAA,SAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAOxJ,UAAU,gEAAmEqJ,GAAK,IAAAnJ,SAAGA,QAGhGuM,MAAOC,IAAA,IAAC,KAACtD,EAAI,SAAElJ,GAAmBwM,EAANrD,GAAKC,EAAAA,EAAAA,GAAAoD,EAAAC,IAAA,OAAM5M,EAAAA,GAAAA,KAAA,SAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAOxJ,UAAU,eAAkBqJ,GAAK,IAAAnJ,SAAGA,MAClF0M,MAAOC,IAAA,IAAC,KAACzD,EAAI,SAAElJ,GAAmB2M,EAANxD,GAAKC,EAAAA,EAAAA,GAAAuD,EAAAC,IAAA,OAAM/M,EAAAA,GAAAA,KAAA,SAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAOxJ,UAAU,4BAA+BqJ,GAAK,IAAAnJ,SAAGA,MAC/F6M,GAAIC,IAAA,IAAC,KAAC5D,EAAI,SAAElJ,GAAmB8M,EAAN3D,GAAKC,EAAAA,EAAAA,GAAA0D,EAAAC,IAAA,OAAMlN,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,sCAAyCqJ,GAAK,IAAAnJ,SAAGA,MACnGgN,GAAIC,IAAA,IAAC,KAAC/D,EAAI,SAAElJ,GAAmBiN,EAAN9D,GAAKC,EAAAA,EAAAA,GAAA6D,EAAAC,IAAA,OAAMrN,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,kFAAqFqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,OAC/JmN,GAAIC,IAAA,IAAC,KAAClE,EAAI,SAAElJ,GAAmBoN,EAANjE,GAAKC,EAAAA,EAAAA,GAAAgE,EAAAC,IAAA,OAAMxN,EAAAA,GAAAA,KAAA,MAAAyJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CAAIxJ,UAAU,mCAAsCqJ,GAAK,IAAAnJ,SAAG4I,GAAgB5I,QAI5GsN,GAAqBzI,IACzB,MAAM0I,EAAa1I,EAAMP,cAEzB,IAAK,MAAOM,EAAM4I,KAAWnH,OAAOC,QAAQmB,IAC1C,GAAI+F,EAAO7F,SAAS8F,KAAKrH,GAAWmH,EAAWhJ,SAAS6B,EAAQ9B,gBAC9D,OAAOM,EAKX,OAAIC,EAAMN,SAAS,iBAASM,EAAMN,SAAS,gBAAc,UACrDM,EAAMN,SAAS,WAAQM,EAAMN,SAAS,gBAAc,iBACpDM,EAAMN,SAAS,iBAASM,EAAMN,SAAS,gBAAc,UACrDM,EAAMN,SAAS,iBAASM,EAAMN,SAAS,gBAAc,SACrDM,EAAMN,SAAS,iBAASM,EAAMN,SAAS,gBAAc,WACrDM,EAAMN,SAAS,iBAASM,EAAMN,SAAS,gBAAc,QACrDM,EAAMN,SAAS,iBAASM,EAAMN,SAAS,sBAAe,WACtDM,EAAMN,SAAS,WAAQM,EAAMN,SAAS,gBAAc,WAEjD,MAuFHmJ,GAAkBC,UACtB,UACQC,UAAUC,UAAUC,UAAU1C,OAAOnJ,GAAQ,IACrD,CAAE,MAAA8L,GACA,GAOEC,GAAcC,IAA0B,IAAzB,QAAEC,EAAO,OAAEC,GAAQF,EACtC,MAAMT,EAASU,EAAQtJ,KAAO6C,GAAcyG,EAAQtJ,MAAQ,KACtDwJ,GAAa,OAANZ,QAAM,IAANA,OAAM,EAANA,EAAQ1H,OAAQuI,EAAAA,EAG7B,OAAIH,EAAQI,SAERzO,EAAAA,GAAAA,KAAA,OAAKC,UAAS,gCAAAI,OAAmCiO,EAAkB,GAAT,QAAcnO,UACtEH,EAAAA,GAAAA,KAAC0O,EAAAA,GAAa,CAACC,cAAe,CAACC,EAAAA,GAAYC,WAAY1F,GAAuBhJ,SAC3EkO,EAAQ9G,aAOZ8G,EAAQtJ,MAAQsJ,EAAQrJ,OAEzB5E,EAAAA,GAAAA,MAAA,OAAKH,UAAS,wFAAAI,OAA2FiO,EAAkB,GAAT,QAAcnO,SAAA,EAC9HC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EH,EAAAA,GAAAA,KAACwO,EAAAA,EAAa,CAACjO,KAAM,GAAIN,UAAU,oBACnCD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,8CAA6CE,SAC1DkO,EAAQrJ,SAEXhF,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMqN,GAAgB,GAADxN,OAAIgO,EAAQrJ,MAAK,QAAA3E,OAAOgO,EAAQ9G,SAAW,KACzEtH,UAAU,sFACV+E,MAAM,2BAAM7E,UAEZH,EAAAA,GAAAA,KAAC8O,EAAAA,EAAI,CAACvO,KAAM,WAGhBP,EAAAA,GAAAA,KAAA,OAAKC,UAAU,YAAWE,UACxBH,EAAAA,GAAAA,KAAC0O,EAAAA,GAAa,CAACC,cAAe,CAACC,EAAAA,GAAYC,WAAY1F,GAAuBhJ,SAC3EkO,EAAQ9G,eAQE,kBAAjB8G,EAAQtJ,MAER/E,EAAAA,GAAAA,KAAA,OAAKC,UAAS,kBAAAI,OAAqBiO,EAAkB,GAAT,QAAcnO,UACxDH,EAAAA,GAAAA,KAAC+O,GAAiB,CAChB3M,KAAI,GAAA/B,OAAKgO,EAAQrJ,MAAK,MAAA3E,OAAKgO,EAAQ9G,cAQzCnH,EAAAA,GAAAA,MAAA,OAAKH,UAAS,qBAAAI,OAAuBsN,EAAOrM,QAAO,oCAAAjB,OAAoCiO,EAAkB,GAAT,QAAcnO,SAAA,EAE5GC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EH,EAAAA,GAAAA,KAACuO,EAAI,CAAChO,KAAM,GAAIN,UAAW0N,EAAOnM,aAClCxB,EAAAA,GAAAA,KAAA,QAAMC,UAAS,gCAAAI,OAAkCsN,EAAO9F,YAAa1H,SAClEkO,EAAQrJ,SAEXhF,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMqN,GAAgB,GAADxN,OAAIgO,EAAQrJ,MAAK,QAAA3E,OAAOgO,EAAQ9G,SAAW,KACzEtH,UAAU,sFACV+E,MAAM,2BAAM7E,UAEZH,EAAAA,GAAAA,KAAC8O,EAAAA,EAAI,CAACvO,KAAM,QAEdP,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAjGKwO,KAAmC,IAAlC,SAAEC,EAAQ,MAAEjK,EAAK,QAAEuC,GAASyH,EACnD,MAAME,EAAY3D,OAAOvG,GAAS,IAAIwG,QAAQ,KAAM,SAASA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,QAC3F2D,EAAO5D,OAAOhE,GAAW,IAC5BiE,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,MAAO,SACZ4D,EAAI,gFAAA/O,OAAmF6O,EAAS,uCAAA7O,OAAsC8O,EAAI,wBAC1IE,EAAO,IAAIC,KAAK,CAACF,GAAO,CAAErK,KAAM,uBAChCwK,EAAMC,IAAIC,gBAAgBJ,GAC1BrI,EAAIlB,SAAS4J,cAAc,KACjC1I,EAAE2I,KAAOJ,EACTvI,EAAE4I,SAAWX,GAAY,YACzBjI,EAAE6I,QACFL,IAAIM,gBAAgBP,IAmFGQ,CAAgB,CAC7Bd,SAAS,SAAD5O,QAAYgO,EAAQrJ,OAAS,WAAWQ,MAAM,EAAG,IAAG,QAC5DR,MAAOqJ,EAAQrJ,OAAS,2BACxBuC,QAAS8G,EAAQ9G,SAAW,KAE9BtH,UAAU,sFACV+E,MAAM,2BAAM7E,UAEZH,EAAAA,GAAAA,KAACgQ,EAAAA,EAAQ,CAACzP,KAAM,WAKpBP,EAAAA,GAAAA,KAAA,OAAKC,UAAU,YAAWE,UACxBH,EAAAA,GAAAA,KAAC0O,EAAAA,GAAa,CAACC,cAAe,CAACC,EAAAA,GAAYC,WAAY1F,GAAuBhJ,SAC3EkO,EAAQ9G,gBA8DnB,GAlD8B0I,IAAkC,IAAjC,QAAE1I,EAAO,UAAEtH,EAAY,IAAIgQ,EACxD,MAAMC,GAAWC,EAAAA,EAAAA,SAAQ,IA/LQ5I,KACjC,IAAKA,EAAS,MAAO,GAErB,MAAM6I,EAAQ7I,EAAQ8I,MAAM,MACtBH,EAAW,GACjB,IAAII,EAAiB,KACjBC,EAAe,GAEnB,IAAK,MAAMC,KAAQJ,EAAO,CACxB,MAAMK,EAAcD,EAAK1N,MAAM,qBACzB4N,EAAmBF,EAAK1N,MAAM,2MAC9B6N,EAAkBH,EAAK1N,MAAM,0BAEnC,GAAI2N,GAAeC,GAAoBC,EAAiB,CACtD,GAAIL,EACFJ,EAAStJ,KAAK0J,QACT,GAAIC,EAAahL,OAAS,EAAG,CAClC,MAAMqL,EAAYL,EAAaM,KAAK,MAAMzN,OACtCwN,GACFV,EAAStJ,KAAK,CACZ7B,KAAM,KACNC,MAAO,KACPuC,QAASqJ,EACTnC,SAAS,GAGf,CAEA,MAAMzJ,EAAQyL,EAAcA,EAAY,GAAMC,EAAmBA,EAAiB,GAAKC,EAAgB,GAGvGL,EAAiB,CACfvL,KAHkB0I,GAAkBzI,GAIpCA,MAAOA,EAAM5B,OACbmE,QAAS,GACT6I,MAAO,GAEX,MAAWE,EACTA,EAAeF,MAAMxJ,KAAK4J,GAE1BD,EAAa3J,KAAK4J,EAEtB,CAeA,OAbIF,GACFA,EAAe/I,QAAU+I,EAAeF,MAAMS,KAAK,MAAMzN,cAClDkN,EAAeF,MACtBF,EAAStJ,KAAK0J,IACLC,EAAahL,OAAS,GAAyB,IAApB2K,EAAS3K,QAC7C2K,EAAStJ,KAAK,CACZ7B,KAAM,KACNC,MAAO,KACPuC,QAASgJ,EAAaM,KAAK,MAAMzN,OACjCqL,SAAS,IAINyB,EAASxP,IAAI2N,IACdA,EAAQ+B,QACV/B,EAAQ9G,QAAU8G,EAAQ+B,MAAMS,KAAK,MAAMzN,cACpCiL,EAAQ+B,OAEV/B,IACNyC,OAAOtM,GAAKA,EAAE+C,SAAW/C,EAAEQ,QAgIC+L,CAA0BxJ,GAAU,CAACA,IAGpE,OAAwB,IAApB2I,EAAS3K,QAAqC,IAApB2K,EAAS3K,QAAgB2K,EAAS,GAAGzB,SAAWlH,EAAQhC,OAAS,KAE3FvF,EAAAA,GAAAA,KAAA,OAAKC,UAAS,iCAAAI,OAAmCJ,GAAYE,UAC3DH,EAAAA,GAAAA,KAAC0O,EAAAA,GAAa,CAACC,cAAe,CAACC,EAAAA,GAAYC,WAAY1F,GAAuBhJ,SAC3EoH,OAOPnH,EAAAA,GAAAA,MAAA,OAAKH,UAAS,4CAAAI,OAA8CJ,GAAYE,SAAA,CAErE+P,EAAS3K,OAAS,IACjBvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4BAA2BE,SACvC+P,EAASxP,IAAI,CAAC8D,EAAG5D,KAChB,GAAI4D,EAAEiK,QAAS,OAAO,KACtB,MAAMd,EAASnJ,EAAEO,KAAO6C,GAAcpD,EAAEO,MAAQ,KAC1CwJ,GAAa,OAANZ,QAAM,IAANA,OAAM,EAANA,EAAQ1H,OAAQuI,EAAAA,EAC7B,OACEpO,EAAAA,GAAAA,MAAA,KAEEuP,KAAI,YAAAtP,OAAcO,GAClBX,UAAU,gKAA+JE,SAAA,EAEzKH,EAAAA,GAAAA,KAACuO,EAAI,CAAChO,KAAM,GAAIN,WAAiB,OAAN0N,QAAM,IAANA,OAAM,EAANA,EAAQnM,YAAa,mBAChDxB,EAAAA,GAAAA,KAAA,QAAAG,UAAQqE,EAAEQ,OAAK,4BAAA3E,OAAYO,EAAQ,IAAK4E,MAAM,EAAG,QAAW,GAAAnF,OALpDmE,EAAEQ,OAAS,UAAS,KAAA3E,OAAIO,QAazCsP,EAASxP,IAAI,CAAC2N,EAASzN,KACtBZ,EAAAA,GAAAA,KAAA,OAAiBgR,GAAE,WAAA3Q,OAAaO,GAAQT,UACtCH,EAAAA,GAAAA,KAACmO,GAAW,CACVE,QAASA,EACTC,OAAQ1N,IAAUsP,EAAS3K,OAAS,KAH9B3E,QChbZqQ,GAAiB,CACrB,2BACA,iCACA,2BACA,iCACA,iCACA,uCACA,iCACA,iCACA,2BACA,4BAGIC,GAAkB,CACtB,2BACA,2BACA,iCACA,2BACA,2BACA,iCACA,2BACA,iCACA,2BACA,4BAGIC,GAAiB,CACrB,2BACA,2BACA,2BACA,2BACA,iCACA,2BACA,2BACA,2BACA,iCACA,4BAGIC,GAAgB,CACpB,iCACA,iCACA,2BACA,2BACA,2BACA,4BAGIC,GAAgB,CACpB,eACA,2BACA,2BACA,iCACA,2BACA,iCACA,2BACA,2BACA,iCACA,2BACA,2BACA,2BACA,2BACA,2BACA,iCACA,iCACA,2BACA,4BAGIC,GAAgB,CACpB,2BACA,2BACA,iCACA,iCACA,iCACA,2BACA,2BACA,2BACA,iCACA,2BACA,2BACA,4BAIIC,GAAiB,CACrB,iCACA,iCACA,iCACA,iCACA,iCACA,iCACA,iCACA,iCACA,kCAIIC,GAAY,IACbP,MACAC,MACAC,MACAC,MACAC,MACAC,MACAC,IAMCE,GAAwG,CAC5GC,SAAU,CAAEC,MAAOV,GAAgBW,SAAU,IAAMC,SAAU,IAAMC,UAAW,KAC9EC,UAAW,CAAEJ,MAAOT,GAAiBU,SAAU,KAAMC,SAAU,KAAMC,UAAW,KAChFE,SAAU,CAAEL,MAAOR,GAAgBS,SAAU,IAAMC,SAAU,KAAMC,UAAW,GAC9EG,QAAS,CAAEN,MAAOP,GAAeQ,SAAU,IAAKC,SAAU,KAAMC,UAAW,KAC3EI,QAAS,CAAEP,MAAON,GAAeO,SAAU,IAAMC,SAAU,IAAMC,UAAW,GAC5EK,QAAS,CAAER,MAAOL,GAAeM,SAAU,IAAMC,SAAU,IAAMC,UAAW,GAC5EM,MAAO,CAAET,MAAOJ,GAAgBK,SAAU,IAAMC,SAAU,IAAMC,UAAW,MAGvEO,GAAgB,CAAC,WAAY,YAAa,WAAY,UAAW,UAAW,UAAW,SAyQ7F,GAnQwCtT,IAMjC,IANkC,KACvCwB,EAAO,GAAE,UACTN,EAAY,GAAE,SACdqS,GAAW,EAAI,SACfC,EAAQ,gBACRC,GACDzT,EACC,MAAO0T,EAAaC,IAAkBnQ,EAAAA,EAAAA,UAASiP,GAAU,KAClDmB,EAAMC,IAAWrQ,EAAAA,EAAAA,UAAe,cAChCuP,EAAWe,IAAgBtQ,EAAAA,EAAAA,UAAS,MACpCuQ,EAAiBC,IAAsBxQ,EAAAA,EAAAA,WAAS,GACjDyQ,GAAaC,EAAAA,EAAAA,QAA8B,MAC3CC,GAAiBD,EAAAA,EAAAA,QAA8B,MAG/CE,EAAgBA,CAAC1R,EAAayC,IAClCF,KAAKoP,MAAMpP,KAAKqP,UAAYnP,EAAMzC,EAAM,IAAMA,EAG1C6R,EAAkBC,IACtB,MAAM5B,EAAQF,GAAY8B,GAAa5B,MACvC,OAAOA,EAAM3N,KAAKoP,MAAMpP,KAAKqP,SAAW1B,EAAMpM,UAI1CiO,EAAoBD,IACxB,MAAM5F,EAAS8D,GAAY8B,GACrBE,EAAQN,EAAcxF,EAAOiE,SAAUjE,EAAOkE,UAEpDmB,EAAWU,QAAUC,WAAW,KAC9BZ,GAAmB,GACnBY,WAAW,KACTjB,EAAeY,EAAeC,IAC9BR,GAAmB,GACnBS,EAAiBD,IAChB,MACFE,IAICG,EAAqBA,KACzB,MAAMH,EAAQN,EAAc,IAAM,KAElCD,EAAeQ,QAAUC,WAAW,KAElC,IAAIE,EACJ,GACEA,EAAUxB,GAAMrO,KAAKoP,MAAMpP,KAAKqP,SAAWhB,GAAM9M,eAC1CsO,IAAYlB,GAAQN,GAAM9M,OAAS,GAE5CqN,EAAQiB,GACRhB,EAAapB,GAAYoC,GAAS/B,WAClCY,EAAeY,EAAeO,IAG1Bb,EAAWU,SACbI,aAAad,EAAWU,SAE1BF,EAAiBK,GACjBD,KACCH,KAGLM,EAAAA,EAAAA,WAAU,KAERrB,EAAeY,EAAeX,IAC9Ba,EAAiBb,GACjBiB,IAEO,KACDZ,EAAWU,SAASI,aAAad,EAAWU,SAC5CR,EAAeQ,SAASI,aAAaZ,EAAeQ,WAEzD,KAGHK,EAAAA,EAAAA,WAAU,KACRlB,EAAapB,GAAYkB,GAAMb,YAC9B,CAACa,IAGJ,MAAMqB,OAA2BtQ,IAAb6O,GAA0BA,GAAY,EAG1D,OACEnS,EAAAA,GAAAA,MAAA,OAAKH,UAAS,8BAAAI,OAAgCJ,GAAYE,SAAA,EAExDC,EAAAA,GAAAA,MAAA,OACEH,UAAU,WACVgF,MAAO,CACLC,MAAO3E,EACP0T,OAAQ1T,GACRJ,SAAA,EAGFH,EAAAA,GAAAA,KAAA,OACEC,UAAU,wBACVgF,MAAO,CACLC,MAAc,IAAP3E,EACP0T,OAAe,IAAP1T,EACR2T,IAAK,MACLC,KAAM,MACNC,UAAW,wBACXC,WAAqB,YAAT1B,EACR,4CACA,4CACJ2B,UAAoB,YAAT3B,EACP,mCACA,mCACJ4B,UAAU,gBAADlU,OAA2B,YAATsS,EAAqB,OAAS,KAAI,4BAKhE,CAAC,EAAG,EAAG,EAAG,GAAGjS,IAAKgF,IACjB1F,EAAAA,GAAAA,KAAA,OAEEC,UAAU,wBACVgF,MAAO,CACLiP,IAAK,MACLC,KAAM,MACNC,UAAW,wBACXI,OAAiB,YAAT7B,EACJ,oCACA,oCACJ4B,UAAU,eAADlU,OAAiByR,EAAS,uBACnC2C,eAAe,GAADpU,OAAKqF,GAAKoM,EAAY,GAAE,KACtC4C,QAAS,IAXNhP,IAiBR,CAAC,EAAG,GAAGhF,IAAKgF,IACX1F,EAAAA,GAAAA,KAAA,OAEEC,UAAU,wBACVgF,MAAO,CACLiP,IAAK,MACLC,KAAM,MACNC,UAAW,wBACXC,WAAqB,YAAT1B,EAAkB,sLAG9B4B,UAAU,aAADlU,OAA2B,IAAZyR,EAAe,0BACvC2C,eAAe,GAADpU,OAAKqF,GAAiB,IAAZoM,GAAiB,OACzC,QAAAzR,OAXWqF,QAiBlB4M,IACCtS,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4CAA2CE,UACxDC,EAAAA,GAAAA,MAAA,QACEH,UAAS,mDAAAI,OACPyS,EAAkB,0BAA4B,4BAA2B,KAAAzS,OAEhE,YAATsS,EAAqB,oBAAsB,oBAC1CxS,SAAA,CAEFsS,EAAY,YAOjBrS,EAAAA,GAAAA,MAAA,OAAKH,UAAU,4BAA2BE,SAAA,CACvCqS,IACCxS,EAAAA,GAAAA,KAAA,OAAKC,UAAU,oDAAmDE,SAC/DqS,KAGLxS,EAAAA,GAAAA,KAAA,OAAKC,UAAU,iDAAgDE,SAC5D6T,GAEChU,EAAAA,GAAAA,KAAA,OACEC,UAAS,4DAAAI,OACE,YAATsS,EACI,6CACA,gDAEN1N,MAAO,CAAEC,MAAM,GAAD7E,OAAK2D,KAAKvC,IAAI,IAAKuC,KAAKE,IAAI,EAAGqO,GAAY,IAAG,SAI9DvS,EAAAA,GAAAA,KAAA,OACEC,UAAS,6BAAAI,OACE,YAATsS,EACI,6CACA,gDAEN1N,MAAO,CACLsP,UAAW,wDAKlBP,IACC5T,EAAAA,GAAAA,MAAA,OAAKH,UAAU,6CAA4CE,SAAA,CACxD6D,KAAKC,MAAMsO,GAAY,GAAG,WAOnCvS,EAAAA,GAAAA,KAAA,SAAAG,SAAA,ihC,0BCxUN,MAoHA,GApHwCpB,IAQjC,IARkC,UACvC4V,EAAS,OACTC,EAAM,eACNC,EAAc,QACdC,EAAO,cACPC,EAAgB,EAAC,KACjBxU,EAAO,GAAE,UACTyU,GAAY,GACbjW,EACC,MAAOkW,EAAQC,IAAa3S,EAAAA,EAAAA,UAASwS,IAC9BI,EAAaC,IAAkB7S,EAAAA,EAAAA,UAAS,IACxC8S,EAAcC,IAAmB/S,EAAAA,EAAAA,WAAS,IAC1CgT,EAAUC,IAAejT,EAAAA,EAAAA,UAASwS,EAAgB,GAEnDU,GAAeC,EAAAA,EAAAA,aAAY5H,UAC/B,IAAIuH,GAAiBT,EAArB,CAEAU,GAAgB,GAChB,UAEQK,EAAAA,EAAAA,IAAQ,cAADtV,OAAeuU,EAAM,qBAAqB,CACrDgB,WAAYjB,EACZM,OAAQY,EACRC,iBAA+B,OAAdjB,QAAc,IAAdA,OAAc,EAAdA,EAAgBrP,MAAM,EAAG,OAAQ,GAClDuQ,cAAe,eACd,CAAEC,gBAAgB,IAErBd,EAAUW,GACVL,GAAY,GACL,OAAPV,QAAO,IAAPA,GAAAA,EAAUe,GAGNA,GAAa,EACfI,EAAAA,GAAMC,QAAQ,mLACLL,GAAa,EACtBI,EAAAA,GAAME,KAAK,wEAEXF,EAAAA,GAAME,KAAK,mFAEf,CAAE,MAAOC,GACPC,GAAAA,EAAOC,MAAM,gCAAiCF,GAE9ClB,EAAUW,GACVL,GAAY,EACd,CAAC,QACCF,GAAgB,EAClB,CA/BmC,GAgClC,CAACV,EAAQD,EAAWE,EAAgBQ,EAAcP,IAO/CyB,EAAgBpB,GAAeF,EAUrC,OACE7U,EAAAA,GAAAA,MAAA,OAAKH,UAAS,iEAAAI,OACZkV,EACI,6CACA,2EACHpV,SAAA,CACA6U,IACC5U,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACpCoV,IAAYvV,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACjW,KAAM,GAAIN,UAAU,qBAC5CD,EAAAA,GAAAA,KAAA,QAAMC,UAAS,uBAAAI,OAAyBkV,EAAW,iBAAmB,mBAAoBpV,SACvFoV,EAAW,kCAAW,6EAI7BvV,EAAAA,GAAAA,KAAA,OAAKC,UAAU,0BAAyBE,SACrC,CAAC,EAAG,EAAG,EAAG,EAAG,GAAGO,IAAK+V,IACpBzW,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,KAAMkW,OAjCJC,EAiCgBF,OAhC/BlB,GAAYN,IAAW0B,GAC3BlB,EAAakB,IAFMA,OAkCXC,aAAcA,KAAOrB,GAAYH,EAAeqB,GAChDI,aAAcA,IAAMzB,EAAe,GACnC0B,SAAUzB,EACVpV,UAAS,kDAAAI,OACPgV,EAAe,yBACfE,EAAW,iBAAmB,yCAEhCvQ,MAAK,GAAA3E,OAAKoW,EAAI,yCAAUtW,UAExBH,EAAAA,GAAAA,KAAC+W,GAAAA,EAAI,CACHxW,KAAMA,EACNN,UAAS,+BAAAI,OACPoW,GAAQF,EACJ,2EACA,wCAAuC,KAAAlW,QACxCkV,GAAYJ,GAAesB,EAAO,0CAA4C,OAjBhFA,MAsBVlB,GAAYN,EAAS,IACpBjV,EAAAA,GAAAA,KAAA,QAAMC,UAAS,kDAAAI,OACb4U,GAAU,EAAI,iCACdA,GAAU,EAAI,mCACd,oCACC9U,UApDe6W,EAqDA/B,EApDF,IAAhB+B,EAA0B,kCACV,IAAhBA,EAA0B,8CACV,IAAhBA,EAA0B,2BACV,IAAhBA,EAA0B,qBACvB,oDALeA,O,0BClE1B,MAEaC,IAAsBC,EAAAA,GAAAA,IAAAA,EACjCC,EAAAA,GAAAA,IACGC,IAAG,CACF3Q,QAAS,GACT4Q,aAAa,EAEbC,SAAWC,GACTH,EAAKrW,IACH,MAAMyW,EAAyB,kBAAbD,EAAMC,GAAkBD,EAAMC,GAAKC,KAAKC,MACpDC,EAA6B,CACjC3G,GAAG,GAAD3Q,OAAKmX,EAAE,KAAAnX,OAAI2D,KAAKqP,SAASuE,SAAS,IAAIpS,MAAM,EAAG,KACjDgS,KACAzS,KAAMwS,EAAMxS,KACZ8S,MAAON,EAAMM,MACbC,QAASP,EAAMO,QACfC,KAAMR,EAAMQ,MAGd,MAAO,CAAEtR,QADI,IAAI1F,EAAM0F,QAASkR,GACTnS,OApBb,QAuBdwS,MAAOA,IAAMZ,EAAI,CAAE3Q,QAAS,KAE5BwR,aAAeC,GAAcd,EAAI,CAAEC,YAAaa,MAElD,CACExY,KAAM,qBACNyY,WAAapX,IAAK,CAChB0F,QAAS1F,EAAM0F,QACf4Q,YAAatW,EAAMsW,iB,mCCH3B,MAAMe,GAAsC,CAC1CC,QAAS,wCACTC,UAAW,2BACXC,UAAW,2BACXC,WAAY,2BACZC,WAAY,2BACZC,UAAW,iCACXC,kBAAmB,gEACnBC,iBAAkB,iEAIdC,GAA4C,CAChDC,IAAK,iCACLC,OAAQ,+BACRC,KAAM,kCAGFC,GAA4C,CAChDH,IAAK,gEACLC,OAAQ,4EACRC,KAAM,iEAGO,SAASE,GAAoBna,GAIb,IAJc,OAC3C6V,EAAM,uBACNuE,EAAsB,QACtBC,GAAU,GACgBra,EAC1B,MAAOsa,EAAgBC,IAAqB/W,EAAAA,EAAAA,UAAqC,OAC1EgX,EAASC,IAAcjX,EAAAA,EAAAA,WAAS,IAChCkX,EAAWC,IAAgBnX,EAAAA,EAAAA,WAAS,IACpCoX,EAAcC,IAAmBrX,EAAAA,EAAAA,WAAS,IAC1CsX,EAAkBC,IAAuBvX,EAAAA,EAAAA,WAAS,GACnDwX,GAA0B9G,EAAAA,EAAAA,SAAO,GAGjC+G,EAAsBlM,UAC1B,IACE,MAAMtL,QAAayX,EAAAA,EAAAA,QAAM,cAAA5Z,OAAoCuU,EAAM,oBACnE0E,EAAkB9W,EACpB,CAAE,MAAO8T,GACP4D,QAAQ5D,MAAM,kCAAmCA,EACnD,CAAC,QACCkD,GAAW,EACb,IAGFzF,EAAAA,EAAAA,WAAU,KACRiG,KACC,CAACpF,KAGJb,EAAAA,EAAAA,WAAU,KACHsF,IACDA,EAAec,cACfd,EAAee,YAA4C,YAA9Bf,EAAee,YAC5CL,EAAwBrG,UAC5BqG,EAAwBrG,SAAU,EAElC2G,OAEC,CAAe,OAAdhB,QAAc,IAAdA,OAAc,EAAdA,EAAgBc,aAA4B,OAAdd,QAAc,IAAdA,OAAc,EAAdA,EAAgBe,aAGlD,MAAME,EAAwBxM,MAAOyM,EAAcC,KACjD,IACE,MAAMC,QAAiB9E,EAAAA,EAAAA,IAAO,cAAAtV,OAAwDuU,EAAM,2BAA2B,CACrH8F,eAAgBH,EAChBI,YAAaH,IAEflB,EAAkBmB,EAASpB,gBAC3BS,GAAoB,GACE,OAAtBX,QAAsB,IAAtBA,GAAAA,EAAyBoB,EAC3B,CAAE,MAAOjE,GACP4D,QAAQ5D,MAAM,oCAAqCA,EACrD,GAII+D,EAAiBvM,UACrB4L,GAAa,GACb,IACE,MAAMe,QAAiB9E,EAAAA,EAAAA,IAAO,cAAAtV,OAAyDuU,EAAM,2BAA2B,CAAC,GACrH6F,EAASpB,gBACXC,EAAkBmB,EAASpB,eAE/B,CAAE,MAAO/C,GACP4D,QAAQ5D,MAAM,oCAAqCA,EACrD,CAAC,QACCoD,GAAa,EACf,GAIIkB,EAAsB9M,UAC1B,UACQ+M,EAAAA,EAAAA,IAAU,cAADxa,OAAeuU,EAAM,0BAC9BoF,IACgB,OAAtBb,QAAsB,IAAtBA,GAAAA,EAAyB,UAC3B,CAAE,MAAO7C,GACP4D,QAAQ5D,MAAM,kCAAmCA,EACnD,GAGF,GAAIiD,EACF,OAAO,KAGT,IAAKF,EACH,OAAO,KAGT,MAAMyB,EAAczB,EAAec,aAC7BY,EAAyC,YAA9B1B,EAAee,YAA4Bf,EAAe2B,YAAc,IACnFC,EAAcH,EAAczB,EAAeqB,eAAiBrB,EAAee,WAGjF,IAAKU,GAA6C,YAA9BzB,EAAee,WACjC,OAAIhB,EAAgB,MAGlBhZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDH,EAAAA,GAAAA,KAAC4I,GAAAA,EAAU,CAACrI,KAAM,GAAIN,UAAU,oBAChCD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,UAASE,SAAC,wiBAK5BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBC,EAAAA,GAAAA,MAAA,UACEI,QAAS6Z,EACTvD,SAAU2C,EACVxZ,UAAU,0IAAyIE,SAAA,CAElJsZ,GACCzZ,EAAAA,GAAAA,KAACkb,GAAAA,EAAS,CAAC3a,KAAM,GAAIN,UAAU,kBAE/BD,EAAAA,GAAAA,KAACkb,GAAAA,EAAS,CAAC3a,KAAM,KACjB,0EAGJH,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,wHAAuHE,SAAA,EAEjIH,EAAAA,GAAAA,KAACwI,EAAAA,EAAK,CAACjI,KAAM,KAAM,6DAOxBsZ,IACCzZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,8BAA6BE,SAAC,iHAC3CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,SACnDqG,OAAOC,QAAQ2R,IACbtH,OAAO7O,IAAA,IAAEkZ,GAAIlZ,EAAA,MAAa,YAARkZ,IAClBza,IAAImJ,IAAA,IAAEsR,EAAK/Z,GAAMyI,EAAA,OAChB7J,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,IAAM8Z,EAAsBa,GACrClb,UAAU,wFAAuFE,SAEhGiB,GAJI+Z,QAQbnb,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,+CAA8CE,SACzD,yCAUX,GAAI2a,EACF,OAAI1B,GAEAhZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kCAAiCE,SAAA,EAC9CH,EAAAA,GAAAA,KAACob,GAAAA,EAAK,CAAC7a,KAAM,GAAIN,UAAU,oBAC3BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,iBAAgBE,SAAEiY,GAAY6C,IAAgBA,KAC9Djb,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,0CAAyCE,SACpD,2BAQLC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iEAAgEE,SAAA,EAC7EC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAACa,EAAAA,EAAK,CAACN,KAAM,GAAIN,UAAU,oBAC3BG,EAAAA,GAAAA,MAAA,QAAMH,UAAU,6BAA4BE,SAAA,CAAC,mCACnCiY,GAAY6C,IAAgBA,EACnC5B,EAAesB,cACdva,EAAAA,GAAAA,MAAA,QAAMH,UAAU,yBAAwBE,SAAA,CAAC,IAAEkZ,EAAesB,YAAY,cAI5Eva,EAAAA,GAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,8FAA6FE,SACxG,wBAGDH,EAAAA,GAAAA,KAAA,UACEQ,QAASoa,EACT3a,UAAU,wEACV+E,MAAM,sGAAqB7E,UAE3BH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,aAMdsZ,IACCzZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,SACnDqG,OAAOC,QAAQ2R,IACbtH,OAAO9G,IAAA,IAAEmR,GAAInR,EAAA,MAAa,YAARmR,IAClBza,IAAIyJ,IAAA,IAAEgR,EAAK/Z,GAAM+I,EAAA,OAChBnK,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,IAAM8Z,EAAsBa,GACrClb,UAAS,+CAAAI,OACP8a,IAAQF,EACJ,0BACA,6CACH9a,SAEFiB,GARI+Z,QAYbnb,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,+CAA8CE,SACzD,yCAUX,GAAI4a,EAAU,CACZ,MAAMM,EAAkBxC,GAAkBQ,EAAeiC,mBAAqBzC,GAAkBC,IAC1FyC,EAAkBtC,GAAkBI,EAAeiC,mBAAqB,gEAE9E,OAAIlC,GAEAhZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kCAAiCE,SAAA,EAC9CH,EAAAA,GAAAA,KAACob,GAAAA,EAAK,CAAC7a,KAAM,GAAIN,UAAU,mBAC3BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,gBAAeE,SAAEiY,GAAY6C,MAC7C7a,EAAAA,GAAAA,MAAA,QAAMH,UAAS,iCAAAI,OAAmCgb,GAAkBlb,SAAA,CACjE6D,KAAKC,MAAkC,IAA5BoV,EAAe2B,YAAkB,WAOnD5a,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+DAA8DE,SAAA,EAC3EC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAACob,GAAAA,EAAK,CAAC7a,KAAM,GAAIN,UAAU,mBAC3BG,EAAAA,GAAAA,MAAA,QAAMH,UAAU,gBAAeE,SAAA,CAAC,+GACRH,EAAAA,GAAAA,KAAA,UAAAG,SAASiY,GAAY6C,SAE7Cjb,EAAAA,GAAAA,KAAA,QAAMC,UAAS,+BAAAI,OAAiCgb,GAAkBlb,SAC/Dob,QAGLnb,EAAAA,GAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAM8Z,EAAsBW,GACrChb,UAAU,wHAAuHE,SAAA,EAEjIH,EAAAA,GAAAA,KAACa,EAAAA,EAAK,CAACN,KAAM,KAAM,+BAGrBH,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,wHAAuHE,SAAA,EAEjIH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,KAAM,iDAOpB8Y,EAAemC,cAAcjW,OAAS,IACrCnF,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMoZ,GAAiBD,GAChC1Z,UAAU,yEAAwEE,SAAA,CAEjFwZ,GAAe3Z,EAAAA,GAAAA,KAACmF,EAAAA,EAAS,CAAC5E,KAAM,MAASP,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,KAC5DoZ,EAAe,0DAAe,4FAKlCA,GAAgBN,EAAemC,cAAcjW,OAAS,IACrDvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yBAAwBE,SACpCkZ,EAAemC,cAAchW,MAAM,EAAG,GAAG9E,IAAI,CAAC+a,EAAU/V,KACvDtF,EAAAA,GAAAA,MAAA,OAAaH,UAAU,sDAAqDE,SAAA,EAC1EC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,yBAAwBE,SAAA,CAAEsb,EAASC,OAAO,QAC1Dtb,EAAAA,GAAAA,MAAA,KAAGH,UAAU,iCAAiCC,IAAI,MAAKC,SAAA,CAAC,IACpDsb,EAASE,MAAM,SAHXjW,MAWfmU,IACCzZ,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8DAA6DE,SAAA,EAC1EH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,8BAA6BE,SAAC,wFAC3CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,SACnDqG,OAAOC,QAAQ2R,IACbtH,OAAOxG,IAAA,IAAE6Q,GAAI7Q,EAAA,MAAa,YAAR6Q,IAClBza,IAAI+J,IAAA,IAAE0Q,EAAK/Z,GAAMqJ,EAAA,OAChBzK,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,IAAM8Z,EAAsBa,GACrClb,UAAU,wFAAuFE,SAEhGiB,GAJI+Z,QAQbnb,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sCAAqCE,UAClDH,EAAAA,GAAAA,KAAA,UACEQ,QAASoa,EACT3a,UAAU,0CAAyCE,SACpD,oHAIHH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMsZ,GAAoB,GACnC7Z,UAAU,oDAAmDE,SAC9D,wCAOX,CAEA,OAAO,IACT,C,eChUO2N,eAAe8N,GAAoBhH,GACxC,OAAOqF,EAAAA,EAAAA,QAAM,cAAA5Z,OAAyCwb,mBAAmBjH,GAAO,iBAClF,CCrDA,MAAMkH,GAA0C,CAC9CC,SAAU,4BACV3T,SAAU,+BACV4T,OAAQ,+BACRC,aAAc,8BACdC,QAAS,8BACTC,YAAa,8BAGTC,GAAmG,CACvGC,UAAW,CACTjb,MAAO,2BACPkb,MAAO,0CACPla,KAAM,mBACNma,IAAK,kBAEPC,cAAe,CACbpb,MAAO,gEACPkb,MAAO,sCACPla,KAAM,iBACNma,IAAK,gBAEPE,aAAc,CACZrb,MAAO,sDACPkb,MAAO,wCACPla,KAAM,kBACNma,IAAK,iBAEPG,cAAe,CACbtb,MAAO,sDACPkb,MAAO,kCACPla,KAAM,eACNma,IAAK,cAEPI,YAAa,CACXvb,MAAO,iCACPkb,MAAO,kCACPla,KAAM,eACNma,IAAK,cAEPzF,SAAU,CACR1V,MAAO,iCACPkb,MAAO,sCACPla,KAAM,iBACNma,IAAK,iBAIHK,GAA2C,CAC/CC,OAAQ,wVACRC,eAAgB,sUAChBxW,SAAU,0VACVyW,SAAU,iSACVC,SAAU,gUACV5U,SAAU,sUACV6U,YAAa,mTACbC,gBAAiB,6UACjBC,eAAgB,iTAChBC,kBAAmB,yQACnBC,gBAAiB,yRACjBC,kBAAmB,oQACnBC,cAAe,2UACfC,OAAQ,6VACRC,WAAY,yMACZC,KAAM,wRAGO,SAASC,GAAgB5e,GAA0E,IAAzE,OAAEC,EAAM,QAAEC,EAAO,mBAAE2e,EAAkB,OAAEhJ,GAA+B7V,EAC7G,MAAO8e,EAAgBC,IAAqBvb,EAAAA,EAAAA,UAAwB,OAC7Dwb,EAAaC,IAAkBzb,EAAAA,EAAAA,UAAS,KACxCgX,EAASC,IAAcjX,EAAAA,EAAAA,WAAS,IAChC+T,EAAO2H,IAAY1b,EAAAA,EAAAA,UAAwB,OAC3C2b,EAASC,IAAc5b,EAAAA,EAAAA,UAA0C,OACjE6b,EAAYC,IAAiB9b,EAAAA,EAAAA,UAAwB,OACrD+b,EAA0BC,IAA+Bhc,EAAAA,EAAAA,WAAS,IAEzEwR,EAAAA,EAAAA,WAAU,KACR,IAAIyK,GAAY,EAiBhB,OADIxf,GAfJ8O,iBACE0L,GAAW,GACXyE,EAAS,MACT,IACE,MAAMQ,EAAM7J,QAAegH,GAAoBhH,SDnChD9G,iBACL,OAAOmM,EAAAA,EAAAA,QAAiC,oBAC1C,CCiCuEyE,GAC/D,GAAIF,EAAW,OACfL,EAAWM,GACXX,EAAmBa,IAAI,IAAA1c,EAAA2c,EAAAC,EAAA,OAAoC,QAApC5c,EAAS,OAAJ0c,QAAI,IAAJA,EAAAA,EAAsB,QAAlBC,EAAIH,EAAIK,kBAAU,IAAAF,GAAK,QAALC,EAAdD,EAAiB,UAAE,IAAAC,OAAL,EAAdA,EAAqB7N,UAAE,IAAA/O,EAAAA,EAAI,MACjE,CAAE,MAAO8c,GACP,GAAIP,EAAW,OACfP,EAASc,aAAaC,MAAQD,EAAEjH,QAAU,2GAC5C,CAAC,QACM0G,GAAWhF,GAAW,EAC7B,CACF,CACiByF,GACV,KACLT,GAAY,IAEb,CAACxf,EAAQ4V,IAEZ,MAAMsK,GAAuC/O,EAAAA,EAAAA,SAAQ,KACnD,MAAM1K,GAAKsY,GAAe,IAAI3a,OACxB+b,EAAWC,IACV3Z,IACE2Z,EAAE1f,KAAKgF,SAASe,IAAM2Z,EAAEC,YAAY3a,SAASe,IAAM2Z,EAAEE,QAAQ5a,SAASe,IAAM2Z,EAAEpO,GAAGtM,SAASe,IAG7F8Z,EAA8B,GACpC,IAAK,MAAMC,KAAc,OAAPtB,QAAO,IAAPA,OAAO,EAAPA,EAASY,aAAc,GAAI,CAC3C,MAAMW,GAAkCD,EAAIE,cAAgB,IAEzD5O,OAAQsO,GAAmB,aAAbA,EAAEO,QAChBjf,IAAK0e,IAAC,CACLpO,GAAIoO,EAAEpO,GACNtR,KAAM0f,EAAEQ,QACRP,YAAaD,EAAES,eACfP,QAAS1C,GAAiBwC,EAAEpO,KAAG,uDAAA3Q,OAAmB+e,EAAEQ,SACpD3Z,KAAMmZ,EAAEnZ,MAAQ,SAChB0Z,OAAQP,EAAEO,OACVG,iBAAkBV,EAAEU,iBACpBC,WAAYX,EAAEW,WACdC,gBAAiBZ,EAAEY,gBACnBC,WAAYb,EAAEa,WACdC,gBAAiBd,EAAEc,gBACnBC,cAAef,EAAEe,iBAElBrP,OAAOqO,GAEY,IAAlBM,EAAOla,QACXga,EAAI3Y,KAAK,CACPoK,GAAIwO,EAAIxO,GACRtR,KAAM8f,EAAII,QACV3Z,KAAMuZ,EAAIvZ,MAAQ,eAClB5E,MAAOya,GAAgB0D,EAAIxO,KAAO,8BAClC0O,aAAcD,GAElB,CAGA,GAAmB,IAAfF,EAAIha,QAAgB2Y,EAAS,CAC/B,MAAMkC,EDpEL,SAA6BlC,GAClC,OAAY,OAAPA,QAAO,IAAPA,GAAAA,EAASY,WACPZ,EAAQY,WAAWuB,QAASjB,GAAMA,EAAEM,cAAgB,IAD1B,EAEnC,CCiEmBY,CAAoBpC,GAE9BpN,OAAQsO,GAAmB,aAAbA,EAAEO,QACbY,EAAU,IAAIC,IACpB,IAAK,MAAMpB,KAAKgB,EAAM,CACpB,MAAMK,EAA2B,CAC/BzP,GAAIoO,EAAEpO,GACNtR,KAAM0f,EAAEQ,QACRP,YAAaD,EAAES,eACfP,QAAS1C,GAAiBwC,EAAEpO,KAAG,uDAAA3Q,OAAmB+e,EAAEQ,SACpD3Z,KAAMmZ,EAAEnZ,MAAQ,SAChB0Z,OAAQP,EAAEO,OACVG,iBAAkBV,EAAEU,iBACpBC,WAAYX,EAAEW,WACdC,gBAAiBZ,EAAEY,gBACnBC,WAAYb,EAAEa,WACdC,gBAAiBd,EAAEc,gBACnBC,cAAef,EAAEe,eAEnB,IAAKhB,EAAQsB,GAAK,SAClB,MAAMtF,EAAMiE,EAAEsB,UAAY,QAC1BH,EAAQnJ,IAAI+D,EAAK,IAAKoF,EAAQI,IAAIxF,IAAQ,GAAKsF,GACjD,CACA,IAAK,MAAOzP,EAAI4P,KAASL,EAAQ9Z,UAC/B8Y,EAAI3Y,KAAK,CACPoK,KACAtR,KAAMsR,EACN/K,KAAM,eACN5E,MAAOya,GAAgB9K,IAAO,8BAC9B0O,aAAckB,GAGpB,CAEA,OAAOrB,GACN,CAACrB,EAASH,IAEb,IAAK/e,EAAQ,OAAO,KAEpB,MAAM6hB,EAAS3B,EAAa4B,KAAM1B,GAAMA,EAAEpO,KAAO6M,IAAmBqB,EAAa,GA+FjF,OACE9e,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0DAAyDE,SAAA,EACtEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gDAAgDO,QAASvB,KAExEmB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oHAAmHE,SAAA,EAChIC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iEAAgEE,SAAA,EAC7EC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sGAAqGE,UAClHH,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACvW,UAAU,aAAaM,KAAM,QAEzCH,EAAAA,GAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,+BAA8BE,SAAC,oGAC7CH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SACjCyU,EAAS,8LAA0C,8HAI1D5U,EAAAA,GAAAA,KAAA,UACEQ,QAASvB,EACTgB,UAAU,oFAAmFE,UAE7FH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,WAIbP,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAA8BE,UAC3CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,WAAUE,SAAA,EACvBH,EAAAA,GAAAA,KAAC+gB,GAAAA,EAAM,CAAC9gB,UAAU,0DAA0DM,KAAM,MAClFP,EAAAA,GAAAA,KAAA,SACE+E,KAAK,OACLic,YAAY,uDACZC,MAAOlD,EACPmD,SAAWnC,GAAMf,EAAee,EAAE1S,OAAO4U,OACzChhB,UAAU,4JAMdsZ,IAAYjD,GAAS4I,EAAa3Z,OAAS,IAC3CvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,YAAWE,UACxBH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,kCAAiCE,SAC7C+e,EAAaxe,IAAK8e,IACjB,MAAM2B,IAAkB,OAANN,QAAM,IAANA,OAAM,EAANA,EAAQ7P,KAAMwO,EAAIxO,MAAQwO,EAAIxO,GAChD,OACE5Q,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAMsd,EAAkB0B,EAAIxO,IACrC/Q,UAAS,6EAAAI,OACP8gB,EACI,mDACA,8DAENnc,MAAOwa,EAAI9f,KAAKS,SAAA,EAEhBH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,OAAME,SAAEqf,EAAIvZ,OAC3BuZ,EAAI9f,OAVA8f,EAAIxO,WAkBrB5Q,EAAAA,GAAAA,MAAA,OAAKH,UAAU,6CAA4CE,SAAA,CACxDoZ,IACCvZ,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yEAAwEE,SAAC,wEAGzFmW,IACClW,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oGAAmGE,SAAA,EAChHH,EAAAA,GAAAA,KAAC4E,EAAAA,EAAa,CAACrE,KAAM,GAAIN,UAAU,YACnCG,EAAAA,GAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,cAAaE,SAAC,yEAC7BH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gBAAeE,SAAEmW,WAKpCiD,IAAYjD,GAAiC,IAAxB4I,EAAa3Z,SAClCvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yEAAwEE,SAAC,qHAGzF0gB,IACCzgB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oDAAmDE,SAAA,EAChEH,EAAAA,GAAAA,KAAA,OAAKC,UAAS,+BAAAI,OAAiCwgB,EAAOxf,MAAK,kBAAiBlB,UAC1EC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,kCAAiCE,SAAE0gB,EAAO5a,QAC1DjG,EAAAA,GAAAA,KAAA,QAAMC,UAAU,yBAAwBE,SAAE0gB,EAAOnhB,QACjDU,EAAAA,GAAAA,MAAA,QAAMH,UAAU,wBAAuBE,SAAA,CAAC,IAAE0gB,EAAOnB,aAAana,OAAO,kDAIzEvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,2BAA0BE,SACtC0gB,EAAOnB,aAAahf,IAAK0gB,IAAgB,IAADC,EAAAC,EAAAC,EAAAC,EACvC,MAAMC,EAAoC,cAAtBL,EAAWzB,OACzB+B,IAAcN,EAAWpB,mBAAqBpL,EAC9C+M,EAASvD,IAAegD,EAAWpQ,GACzC,OACEhR,EAAAA,GAAAA,KAAA,OAEEC,UAAS,gCAAAI,OACO,8BACbF,UAEHC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,4CAA2CE,SAAEihB,EAAWnb,QACxE7F,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,4CAA2CE,SAAA,EACxDH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,kCAAiCE,SAAEihB,EAAW1hB,QAC9DU,EAAAA,GAAAA,MAAA,QACEH,UAAS,qEAAAI,QACqB,QAA5BghB,EAAAjF,GAAUgF,EAAWzB,eAAO,IAAA0B,OAAA,EAA5BA,EAA8B/E,QAAS,6BAA4B,KAAAjc,QACrC,QAA5BihB,EAAAlF,GAAUgF,EAAWzB,eAAO,IAAA2B,OAAA,EAA5BA,EAA8Blf,OAAQ,iBAC1C4C,MAAOoc,EAAWtB,kBAAoBsB,EAAWrB,iBAAcrc,EAAUvD,SAAA,EAEzEH,EAAAA,GAAAA,KAAA,QAAMC,UAAS,4BAAAI,QAA0D,QAA5BkhB,EAAAnF,GAAUgF,EAAWzB,eAAO,IAAA4B,OAAA,EAA5BA,EAA8BhF,MAAO,kBACrD,QAA5BiF,EAAApF,GAAUgF,EAAWzB,eAAO,IAAA6B,OAAA,EAA5BA,EAA8BpgB,QAASggB,EAAWzB,cAIvDvf,EAAAA,GAAAA,MAAA,OAAKH,UAAU,wCAAuCE,SAAA,EAClDihB,EAAWrB,YAAcqB,EAAWtB,oBACpC9f,EAAAA,GAAAA,KAAA,QAAMgF,MAAOoc,EAAWrB,YAAcqB,EAAWtB,uBAAoBpc,EAAUvD,UAC7EH,EAAAA,GAAAA,KAAC4I,GAAAA,EAAU,CAACrI,KAAM,GAAIN,UAAU,oBAGnCwhB,GACCzhB,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KACPod,EAAmBwD,GACnBniB,KAEFgB,UAAU,0FAAyFE,SACpG,8BAIDH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAzObsN,WAC1B,GAAK8G,GAIL,GAAKwM,EAAWpB,gBAGhB,GAA0B,iBAAtBoB,EAAWzB,OAIf,GAA0B,kBAAtByB,EAAWzB,OAIf,GAA0B,gBAAtByB,EAAWzB,QAAkD,aAAtByB,EAAWzB,OAMtD,GAAIyB,EAAWpB,gBAAgBtb,SAAS,kCACtC6Z,GAA4B,QAI9B,IAAK,IAADqD,EAAAC,EACFxD,EAAc+C,EAAWpQ,IAGzB,MAAM8Q,EAA0D,QAA7BF,EAAGR,EAAWlB,uBAAe,IAAA0B,EAAAA,EAAI,KAC9DG,EAA4D,QAA3BF,EAAGT,EAAWjB,qBAAa,IAAA0B,EAAAA,EAAI,CAAC,EAEvE,GAAuB,sBAAnBC,EAAwC,CAC1C,GAAiB,OAAZC,QAAY,IAAZA,IAAAA,EAAcC,cAEjB,YADA/L,EAAAA,GAAMK,MAAM,sJAGRX,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,sBAAsB,CAC1EqN,cAAeF,EAAaC,cAC5BE,QAAS,CAAEC,eAAe,KAE5BlM,EAAAA,GAAMC,QAAQ,wHAChB,MAAO,GAAuB,cAAnB4L,QACHnM,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,cAAc,CAClEwN,KAAML,EAAaK,MAAQ,SAE7BnM,EAAAA,GAAMC,QAAQ,oGACT,CAEL,MAAM3G,EAAM6R,EAAWnB,iBAAcvc,EACrC,IAAK6L,EAEH,YADA0G,EAAAA,GAAMK,MAAM,+HAGRX,EAAAA,EAAAA,IAAQpG,EAAKwS,GAAgB,CAAC,GACpC9L,EAAAA,GAAMC,QAAQ,4EAChB,CAGA,MAAMuI,QAAY7C,GAAoBhH,GACtCuJ,EAAWM,GACXX,EAAmBa,IAAI,IAAA9U,EAAAwY,EAAAC,EAAA,OAAoC,QAApCzY,EAAS,OAAJ8U,QAAI,IAAJA,EAAAA,EAAsB,QAAlB0D,EAAI5D,EAAIK,kBAAU,IAAAuD,GAAK,QAALC,EAAdD,EAAiB,UAAE,IAAAC,OAAL,EAAdA,EAAqBtR,UAAE,IAAAnH,EAAAA,EAAI,MACjE,CAAE,MAAOkV,GACP,MAAMwD,GAAO,OAADxD,QAAC,IAADA,OAAC,EAADA,EAAGjH,UAAW,qGAEtBvM,QAAQ,OAADwT,QAAC,IAADA,OAAC,EAADA,EAAGY,SAAU,IAAI6C,WAAW,QAAUjX,OAAOgX,GAAK7d,SAAS,kBACpE6Z,GAA4B,GAE5BtI,EAAAA,GAAMK,MAAMiM,EAEhB,CAAC,QACClE,EAAc,KAChB,MAzDEpI,EAAAA,GAAM6B,QAAQsJ,EAAWtB,kBAAoB,qIAJ7C7J,EAAAA,GAAMK,MAAM8K,EAAWtB,kBAAoB,wHAJ3C7J,EAAAA,GAAMK,MAAM8K,EAAWtB,kBAAoB,uJAP3C7J,EAAAA,GAAMK,MAAM,uIAuO+BmM,CAAoBrB,GACnCtK,UAAW4K,GAAaC,EACxB1hB,UAAS,8CAAAI,OACNqhB,EAEG,2CADA,+CAGN1c,MAAOoc,EAAWpB,sBAAmBtc,EAAUvD,SAE9CwhB,EAAS,MAASP,EAAWpB,iBAAmB,0CAMzDhgB,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAEihB,EAAW/B,cACrDoC,IACCrhB,EAAAA,GAAAA,MAAA,KAAGH,UAAU,uDAAsDE,SAAA,EACjEH,EAAAA,GAAAA,KAAC4I,GAAAA,EAAU,CAACrI,KAAM,KAAM,0CACd6gB,EAAW9B,QAAQ,QAG/BmC,IACAzhB,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SACtCihB,EAAWtB,kBAAoBsB,EAAWrB,YAAc,0EAhE5DqB,EAAWpQ,eA6E9BhR,EAAAA,GAAAA,KAAA,OAAKC,UAAU,0CAAyCE,UACtDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,oCAAmCE,SAAC,iSAKpDme,IACCle,EAAAA,GAAAA,MAAA,OAAKH,UAAU,4DAA4DO,QAASA,IAAM+d,GAA4B,GAAOpe,SAAA,EAC3HH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,kCACfG,EAAAA,GAAAA,MAAA,OACEH,UAAU,0FACVO,QAAUue,GAAMA,EAAE2D,kBAClBxiB,IAAI,MAAKC,SAAA,EAETC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uBAAsBE,SAAC,oIACtCH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAM+d,GAA4B,GAAQte,UAAU,qCAAoCE,UACvGH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,WAGbP,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,kYAG1CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yBAAwBE,SACpC,CACC,CAAE6Q,GAAI,aAAc5P,MAAO,4BAC3B,CAAE4P,GAAI,aAAc5P,MAAO,4BAC3B,CAAE4P,GAAI,YAAa5P,MAAO,4BAC1B,CAAE4P,GAAI,YAAa5P,MAAO,4BAC1B,CAAE4P,GAAI,YAAa5P,MAAO,kCAC1B,CAAE4P,GAAI,QAAS5P,MAAO,uBACtBV,IAAK8D,IACLxE,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,IAnOKsN,WAC5B,GAAK8G,EACL,IACEyJ,EAAc,OAADhe,OAAQqa,UACf/E,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,2BAA2B,CAAE8F,mBACnFzE,EAAAA,GAAMC,QAAQ,oFACdqI,GAA4B,GAC5B,MAAME,QAAY7C,GAAoBhH,GACtCuJ,EAAWM,EACb,CAAE,MAAOM,GACP9I,EAAAA,GAAMK,OAAO,OAADyI,QAAC,IAADA,OAAC,EAADA,EAAGjH,UAAW,qGAC5B,CAAC,QACCuG,EAAc,KAChB,GAsN6B/D,CAAsB9V,EAAEwM,IACvC8F,SAAUsH,IAAU,OAAA/d,OAAYmE,EAAEwM,IAClC/Q,UAAU,mGAAkGE,SAE3Gie,IAAU,OAAA/d,OAAYmE,EAAEwM,IAAO,MAAQxM,EAAEpD,OALrCoD,EAAEwM,QASbhR,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,4YAQtD,CCleA,MAAMwiB,GAAgB,CACpBC,KAAM,CACJ,CACE5R,GAAI,WACJ5P,MAAO,iCACP6E,KAAMlE,EAAAA,EACN8gB,OACE,4lDAOJ,CACE7R,GAAI,YACJ5P,MAAO,8CACP6E,KAAM6c,EAAAA,EACND,OACE,iyCAONE,IAAK,CACH,CACE/R,GAAI,WACJ5P,MAAO,iCACP6E,KAAMlE,EAAAA,EACN8gB,OACE,2nDASJ,CACE7R,GAAI,WACJ5P,MAAO,mDACP6E,KAAMoC,EAAAA,EACNwa,OACE,inDAUJ,CACE7R,GAAI,OACJ5P,MAAO,gEACP6E,KAAM+c,EAAAA,EACNH,OACE,u9CASJ,CACE7R,GAAI,YACJ5P,MAAO,8CACP6E,KAAM6c,EAAAA,EACND,OACE,s5CAQJ,CACE7R,GAAI,cACJ5P,MAAO,6CACP6E,KAAMpB,EAAAA,EACNge,OACE,+qEAOFI,SAAS,IAGbljB,WAAY,CACV,CACEiR,GAAI,WACJ5P,MAAO,iCACP6E,KAAMlE,EAAAA,EACN8gB,OACE,kuDAUJ,CACE7R,GAAI,WACJ5P,MAAO,mDACP6E,KAAMoC,EAAAA,EACNwa,OACE,i7CASJ,CACE7R,GAAI,OACJ5P,MAAO,gEACP6E,KAAM+c,EAAAA,EACNH,OACE,y3CASJ,CACE7R,GAAI,oBACJ5P,MAAO,0DACP6E,KAAMlE,EAAAA,EACN8gB,OACE,imDAUJ,CACE7R,GAAI,YACJ5P,MAAO,8CACP6E,KAAM6c,EAAAA,EACND,OACE,osCAQJ,CACE7R,GAAI,cACJ5P,MAAO,6CACP6E,KAAMpB,EAAAA,EACNge,OACE,k5EAQFI,SAAS,EACTljB,YAAY,KAOZmjB,GAAoB,CACxB,CAAE/H,IAAK,YAAa/Z,MAAO,uCAAU4D,MAAO,qLAAqCme,aAAc,QAC/F,CAAEhI,IAAK,cAAe/Z,MAAO,uCAAU4D,MAAO,sJAA+Bme,aAAc,QAC3F,CAAEhI,IAAK,cAAe/Z,MAAO,mDAAY4D,MAAO,mKAAkCme,aAAc,gBAChG,CAAEhI,IAAK,YAAa/Z,MAAO,uCAAU4D,MAAO,gIAA6Bme,aAAc,iBAiBnFC,IAAYC,EAAAA,EAAAA,YAAW,CAAAtkB,EAc1BukB,KAAS,IAdkB,OAC5B1O,EAAM,SACN2O,EAAQ,eACRC,EAAiB,KAAI,UACrBC,EAAS,gBACTC,EAAe,UACfC,EAAS,eACTC,EAAc,UACdC,EAAS,SACTC,EAAW,OAAM,UACjBC,GAAY,EAAK,aACjBC,GAAe,EAAK,oBACpBC,EAAsB,KAAI,2BAC1BC,EAA6B,MAC9BnlB,EACC,MAAMO,GAAWC,EAAAA,EAAAA,OACX,MAAE4kB,EAAK,WAAEC,EAAU,aAAEC,IAAiBC,EAAAA,EAAAA,KACtCC,EAAStN,GAAqBzS,GAAMA,EAAE8S,WAErCkN,EAAUC,IAAeliB,EAAAA,EAAAA,UAAS,KAElCmiB,EAAmBC,IAAwBpiB,EAAAA,EAAAA,UAAS,IACpDqiB,EAAOC,IAAYtiB,EAAAA,EAAAA,UAAS,KAC5BuiB,EAAWC,IAAgBxiB,EAAAA,EAAAA,WAAS,IACpCyiB,GAAeC,KAAoB1iB,EAAAA,EAAAA,UAAS,KAC5C2iB,GAAmBC,KAAwB5iB,EAAAA,EAAAA,UAAS,OACpD6iB,GAAaC,KAAkB9iB,EAAAA,EAAAA,WAAS,IACxC+iB,GAAUC,KAAehjB,EAAAA,EAAAA,UAAS,CAAC,IACnCijB,GAAiBC,KAAsBljB,EAAAA,EAAAA,UAAS,OAChDmjB,GAAaC,KAAkBpjB,EAAAA,EAAAA,UAAS,KAExCqjB,GAAqBC,KAA0BtjB,EAAAA,EAAAA,WAAS,IACxDujB,GAAiBC,KAAsBxjB,EAAAA,EAAAA,UAAS,KAChDyjB,GAAgBC,KAAqB1jB,EAAAA,EAAAA,UAAS,uEAAAlC,QAAuB,IAAIoX,MAAOyO,mBAAmB,YACnGC,GAAeC,KAAoB7jB,EAAAA,EAAAA,WAAS,IAI5C8jB,GAAkBC,MAHArT,EAAAA,EAAAA,QAAO,OAGgB1Q,EAAAA,EAAAA,WAAS,KAClDgkB,GAAkBC,KAAuBjkB,EAAAA,EAAAA,UAAS,CACvDrD,YAAa,GACbC,mBAAoB,GACpBC,aAAc,kBAITqnB,GAAmBC,KAAwBnkB,EAAAA,EAAAA,UAAS,KACpDokB,GAAqBC,KAA0BrkB,EAAAA,EAAAA,WAAS,IACxDskB,GAAgBC,KAAqBvkB,EAAAA,EAAAA,UAAS,OAG9CwkB,GAAuBC,KAA4BzkB,EAAAA,EAAAA,UAAS,OAG5D0kB,GAAcC,KAAmB3kB,EAAAA,EAAAA,UAAS,OAC1C4kB,GAAWC,KAAgB7kB,EAAAA,EAAAA,UAAS,KACpC8kB,GAAUC,KAAe/kB,EAAAA,EAAAA,UAAS,OAClCglB,GAAeC,KAAoBjlB,EAAAA,EAAAA,UAAS,KAC5CklB,GAAaC,KAAkBnlB,EAAAA,EAAAA,UAAS,KACxColB,GAAeC,KAAoBrlB,EAAAA,EAAAA,UAAS,MAC7CslB,IAAoB5U,EAAAA,EAAAA,SAAO,GAC3B6U,IAAqB7U,EAAAA,EAAAA,SAAO,IAG3B8U,GAAaC,KAAkBzlB,EAAAA,EAAAA,UAAS,OACxC0lB,GAAkBC,KAAuB3lB,EAAAA,EAAAA,WAAS,IAClD4lB,GAAgBC,KAAqB7lB,EAAAA,EAAAA,WAAS,IAC9C8lB,GAAaC,KAAkB/lB,EAAAA,EAAAA,UAAS,CAC7CgmB,OAAQ,GACRC,YAAa,GACbC,YAAa,YACbC,aAAc,GACdC,kBAAmB,GACnBC,kBAAmB,YACnBC,mBAAoB,GACpBC,YAAa,GACbC,kBAAmB,GACnBC,kBAAmB,MAIdC,GAAkBC,KAAuB3mB,EAAAA,EAAAA,WAAS,IAGlD4mB,GAAqBC,KAA0B7mB,EAAAA,EAAAA,UAAS,MAEzD8mB,IAAiBpW,EAAAA,EAAAA,QAAO,MACxBqW,IAAuBrW,EAAAA,EAAAA,QAAO,MAC9BsW,IAAWtW,EAAAA,EAAAA,QAAO,MAClBuW,IAAevW,EAAAA,EAAAA,QAAO,OAG5BwW,EAAAA,EAAAA,qBAAoBnG,EAAK,MACvBoG,gBAAkB/U,IAAe,IAADgV,EAC9B,MAAMC,EAAwC,QAA/BD,EAAGL,GAAqB5V,eAAO,IAAAiW,OAAA,EAA5BA,EAA8BE,cAAc,qBAADxpB,OAAsBsU,EAAS,OACxFiV,IACFA,EAAUE,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAEtDJ,EAAUK,UAAUC,IAAI,SAAU,mBAClCvW,WAAW,IAAMiW,EAAUK,UAAUE,OAAO,SAAU,mBAAoB,OAG9EC,YAAaA,IAAM5F,IACjB,CAACA,IAGL,MAAQ6F,aAAcC,ICpWjB,SAAoCvrB,GAIH,IAJI,OAC1C6V,EAAM,QACN2V,GAAU,EAAI,QACdC,GACmCzrB,EACnC,MAAM0rB,GAAgBxX,EAAAA,EAAAA,QAAsB,MACtCyX,GAAazX,EAAAA,EAAAA,QAA8B,MAC3C0X,GAA0B1X,EAAAA,EAAAA,SAAO,GAEjC2X,GAAclV,EAAAA,EAAAA,aAAY5H,UAC9B,GAAK8G,GAAW2V,EAEhB,IAAK,IAADM,EAAAC,EACF,MAAMrQ,QAAiBR,EAAAA,EAAAA,QAAM,cAAA5Z,OACbuU,EAAM,oBACpB,CAAEoB,gBAAgB,IAGd+U,EAAoB,OAARtQ,QAAQ,IAARA,GAAyB,QAAjBoQ,EAARpQ,EAAUuQ,uBAAe,IAAAH,GAAa,QAAbC,EAAzBD,EAA2BI,mBAAW,IAAAH,OAA9B,EAARA,EAAwCnL,OAY1D,GATkB,YAAdoL,GAA4BJ,EAAwBjX,UACtDiX,EAAwBjX,SAAU,EAClCuC,EAAAA,GAAMsD,QAAQ,gPAAmD,CAC/DvI,GAAG,kBAAD3Q,OAAoBuU,GACtBsW,SAAU,OAKI,cAAdH,GAAuD,YAA1BN,EAAc/W,QAAuB,CAAC,IAADyX,EAAAC,EAAAC,EAAAC,EACpE,MAAMC,GAAwB,OAAR9Q,QAAQ,IAARA,GAAyB,QAAjB0Q,EAAR1Q,EAAUuQ,uBAAe,IAAAG,GAAa,QAAbC,EAAzBD,EAA2BF,mBAAW,IAAAG,OAA9B,EAARA,EAAwCI,iBAAkB,EAC1EC,GAAgB,OAARhR,QAAQ,IAARA,GAAyB,QAAjB4Q,EAAR5Q,EAAUuQ,uBAAe,IAAAK,GAAa,QAAbC,EAAzBD,EAA2BJ,mBAAW,IAAAK,OAA9B,EAARA,EAAwCG,QAAS,EAG/DxV,EAAAA,GAAMyV,QAAQ,kBAADrrB,OAAmBuU,IAGhCqB,EAAAA,GAAMC,QAAQ,0HAAD7V,OACgBkrB,EAAa,qCAAAlrB,OAAWorB,EAAK,0CACxD,CACEza,GAAG,aAAD3Q,OAAeuU,GACjBsW,SAAU,IACV7L,YAAa,uPAKjBsL,EAAwBjX,SAAU,EAC9BgX,EAAWhX,UACbiY,cAAcjB,EAAWhX,SACzBgX,EAAWhX,QAAU,MAGhB,OAAP8W,QAAO,IAAPA,GAAAA,GACF,CAEAC,EAAc/W,QAAUqX,GAAa,IACvC,CAAE,MAAOzU,GAEP4D,QAAQ0R,MAAM,8CAA+CtV,EAC/D,GACC,CAAC1B,EAAQ2V,EAASC,IA4BrB,OAzBAzW,EAAAA,EAAAA,WAAU,KACR,GAAKa,GAAW2V,EAShB,OANAK,IAGAF,EAAWhX,QAAUmY,YAAYjB,EAAa,KAGvC,KACDF,EAAWhX,UACbiY,cAAcjB,EAAWhX,SACzBgX,EAAWhX,QAAU,QAGxB,CAACkB,EAAQ2V,EAASK,IASd,CAAEP,cANY3U,EAAAA,EAAAA,aAAY,KAC/BiV,EAAwBjX,SAAU,EAClC+W,EAAc/W,QAAU,KACxBkX,KACC,CAACA,IAGN,CDyQmDkB,CAA4B,CAC3ElX,SACA2V,UAAW3V,IAIPmX,IAA2BrW,EAAAA,EAAAA,aAAY5H,UAC3C,GAAK8G,EACL,IAAK,IAADoX,EACF,MAAMxpB,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,GAAU,CAAEoB,gBAAgB,IAC9D2J,GAAa,OAAJnd,QAAI,IAAJA,GAAU,QAANwpB,EAAJxpB,EAAMypB,YAAI,IAAAD,OAAN,EAAJA,EAAYrM,UAAc,OAAJnd,QAAI,IAAJA,OAAI,EAAJA,EAAMmd,SAAU,YACrDyJ,GAAuBzJ,EACzB,CAAE,MAAAzR,GACA,GAED,CAAC0G,KAEJb,EAAAA,EAAAA,WAAU,KACR,IAAKa,EAAQ,OACbmX,KACA,MAAMG,EAAWL,YAAYE,GAA0B,KACvD,MAAO,IAAMJ,cAAcO,IAC1B,CAACtX,EAAQmX,KAGZ,MAAMI,IAAehc,EAAAA,EAAAA,SAAQ,IACvB6T,EAAqBrB,GAAc5iB,WACnCgkB,EAAkBpB,GAAcI,IAC7BJ,GAAcC,KACpB,CAACmB,EAAWC,IAEToI,IAAUjc,EAAAA,EAAAA,SAAQ,KACtB,MAAMkc,EAAa,CAAEzJ,KAAM,EAAGnjB,MAAO,EAAGK,aAAc,EAAGC,WAAY,EAAGusB,MAAO,GACzEC,GAAiBzI,GAAY,QAAQrf,cAC3C,OAAQrF,IAAY,IAAAotB,EAAAC,EAAA,OACQ,QAA1BD,EAACH,EAAWE,UAAc,IAAAC,EAAAA,EAAI,KAA+B,QAA9BC,EAAMJ,EAAWjtB,UAAa,IAAAqtB,EAAAA,EAAI,KAClE,CAAC3I,IAEE4I,IAAmBhX,EAAAA,EAAAA,aAAY,CAACxW,EAAaC,EAAoBC,KAIrEonB,GAAoB,CAClBtnB,YAAaA,GAAe,0DAC5BC,mBAAoBA,GAAsB,2IAC1CC,aANuC,UAAjBA,GAA6C,iBAAjBA,GAAoD,eAAjBA,EACnFA,EACA,iBAMJknB,IAAoB,IACnB,IAUGqG,KAPqBxc,EAAAA,EAAAA,SAAQ,IAC1Bgc,IAAgB,GACtB,CAACA,MAKmBzW,EAAAA,EAAAA,aAAY,WAAwB,IAADkX,EAAA,IAAtB7C,EAAQ8C,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,OACvB,QAAtBD,EAAAvD,GAAe3V,eAAO,IAAAkZ,GAAtBA,EAAwB9C,eAAe,CAAEC,YAC3C,EAAG,KAkBG+C,KAfgBpX,EAAAA,EAAAA,aAAaf,IAAe,IAADoY,EAC/C,MAAMnD,EAAwC,QAA/BmD,EAAGzD,GAAqB5V,eAAO,IAAAqZ,OAAA,EAA5BA,EAA8BlD,cAAc,qBAADxpB,OAAsBsU,EAAS,OACxFiV,IACFA,EAAUE,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAEtDJ,EAAUK,UAAUC,IAAI,SAAU,kBAAmB,mBACrDvW,WAAW,IAAMiW,EAAUK,UAAUE,OAAO,SAAU,kBAAmB,mBAAoB,OAE9F,KAGqBzU,EAAAA,EAAAA,aAAasX,IACnC/W,EAAAA,GAAMC,QAAQ,4BAAD7V,OAAS2sB,EAAYznB,OAAM,0EACvC,KAEkB0N,EAAAA,EAAAA,QAAO,OACtBga,IAAkBha,EAAAA,EAAAA,QAAO,GACzBia,IAAexX,EAAAA,EAAAA,aAAY,KAC/B,MAAMyX,EAAK7D,GAAqB5V,QAChC,IAAKyZ,EAAI,OAAO,EAEhB,OADiBA,EAAGC,aAAeD,EAAGE,UAAYF,EAAGG,aACnC,KACjB,IAEGC,IAAqB7X,EAAAA,EAAAA,aAAaqU,IAEtC,IAAKmD,KAAgB,OACrB,MAAMxV,EAAMD,KAAKC,MACA,SAAbqS,GAAuBrS,EAAMuV,GAAgBvZ,QAAU,KAC3DuZ,GAAgBvZ,QAAUgE,EACtBoV,GAAapZ,SAAS8Z,qBAAqBV,GAAapZ,SAC5DoZ,GAAapZ,QAAU+Z,sBAAsB,IAAMd,GAAe5C,MACjE,CAACmD,GAAcP,MAElB5Y,EAAAA,EAAAA,WAAU,KACRwZ,GAAmB,WAClB,CAAC/I,EAAU+I,MAEdxZ,EAAAA,EAAAA,WAAU,KACHqR,IACLmI,GAAmB,SAClB,CAACvI,GAAeI,GAAamI,MAGhCxZ,EAAAA,EAAAA,WAAU,KACR,MAAM2Z,EAAWC,IAGfhJ,EAAsBiJ,GAAMA,EAAI,IAGlC,OADAC,OAAOC,iBAAiB,eAAgBJ,GACjC,IAAMG,OAAOE,oBAAoB,eAAgBL,IACvD,KAGH3Z,EAAAA,EAAAA,WAAU,KACsBjG,WAC5B,IAAI8G,EAAJ,CAEAgS,IAAuB,GACvB,UAEQxC,IAEN,MAAM5hB,QAAayX,EAAAA,EAAAA,QAAO,yBAA0B,CAAEjE,gBAAgB,IACtE0Q,GAAqBlkB,EAAK2hB,OAAS,GACrC,CAAE,MAAO/N,GACP8D,QAAQ5D,MAAM,sCAAuCF,EACvD,CAAC,QACCwQ,IAAuB,EACzB,CAbkB,GAgBpBoH,IACC,CAACpZ,EAAQwP,KAIZrQ,EAAAA,EAAAA,WAAU,KACR,IAAIka,GAAc,EAgClB,MA9BoBngB,WAClB,GAAK8G,EAEL,IACE,MAAMrF,EAAMkU,EAAS,cAAApjB,OACHuU,EAAM,6BAAAvU,OAA4BojB,GAAS,cAAApjB,OAC3CuU,EAAM,iBAElBpS,QAAayX,EAAAA,EAAAA,QAAO1K,EAAK,CAAEyG,gBAAgB,IAGjD,GAAIiY,EAAa,OAEjBxJ,EAAYjiB,EAAKgiB,UAAY,KAIxBf,GAAajhB,EAAK0rB,YAAcxK,GACnCA,EAAgBlhB,EAAK0rB,WAEzB,CAAE,MAAO9X,GACF6X,GACH/T,QAAQ5D,MAAM,0BAA2BF,EAE7C,GAGF+X,GAGO,KACLF,GAAc,IAEf,CAACrZ,EAAQ6O,EAAWC,EAAiBgB,KAGxC3Q,EAAAA,EAAAA,WAAU,KACgBjG,WACtB,GAAK8G,EACL,IACE,MAAM6F,QAAiBR,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,YAAY,CAAEoB,gBAAgB,IAChF,GAAIyE,GAAYA,EAAS2T,aAAe3T,EAAS4T,QAAS,CACxD,MAAMC,EAAM7T,EAAS4T,QACrBrG,GAAesG,GACfhG,GAAe,CACbC,QAAS+F,EAAI/F,QAAU,IAAI7nB,IAAI6tB,GAAKA,EAAE7uB,MAAMmR,KAAK,MACjD2X,YAAa8F,EAAIE,eAAiB,GAClC/F,YAAa6F,EAAIG,eAAiB,YAClC/F,aAAc4F,EAAII,gBAAkB,GACpC/F,kBAAmB2F,EAAIK,6BAA+BL,EAAIM,qBAAuB,GACjFhG,kBAAmB0F,EAAIO,6BAA+BP,EAAIQ,qBAAuB,YACjFjG,mBAAoByF,EAAIS,sBAAwB,GAChDjG,aAAcwF,EAAIU,cAAgB,IAAItuB,IAAIuuB,GAAKA,EAAEvvB,MAAMmR,KAAK,MAC5DkY,mBAAoBuF,EAAIY,oBAAsB,IAAIxuB,IAAIuuB,GAAKA,EAAEvvB,MAAMmR,KAAK,MACxEmY,kBAAmBsF,EAAIa,oBAAsB,IAEjD,CACF,CAAE,MAAO/Y,GACP8D,QAAQ5D,MAAM,+BAAgCF,EAChD,GAEFgZ,IACC,CAACxa,KAGqBzE,EAAAA,EAAAA,SAAQ,KAE/B,IAAKyE,EAAQ,OAAO,EAEpB,IAAKmT,GAAa,OAAO,EAIzB,QADmBA,GAAYyG,eAAiBzG,GAAY4G,8BAE3D,CAAC5G,GAAanT,EAAQyS,MA+BzBtT,EAAAA,EAAAA,WAAU,KACUjG,WAChB,GAAK8G,EACL,IAAK,IAADya,EACF,MAAM7sB,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,GAAU,CAAEoB,gBAAgB,IAC5D,OAAJxT,QAAI,IAAJA,GAAAA,EAAM8sB,OACRlI,GAAa5kB,EAAK8sB,OAEpB,MAAMC,GAAS,OAAJ/sB,QAAI,IAAJA,OAAI,EAAJA,EAAMgtB,aAAiB,OAAJhtB,QAAI,IAAJA,GAAU,QAAN6sB,EAAJ7sB,EAAMypB,YAAI,IAAAoD,OAAN,EAAJA,EAAYG,YAAa,KACvDlI,GAAYiI,EACd,CAAE,MAAOnZ,GACP8D,QAAQ5D,MAAM,6BAA8BF,EAC9C,GAEFqZ,IACC,CAAC7a,KAGJb,EAAAA,EAAAA,WAAU,KACsBjG,WAC5B,GAAK8G,IACD4O,IACAqE,GAAkBnU,QAAtB,CACAmU,GAAkBnU,SAAU,EAC5B,IACE,MAAMlR,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,aAAa,CAAEoB,gBAAgB,IAC7E4R,GAAiBplB,EACnB,CAAE,MAAO4T,GACP,CANmC,GASvCsZ,IACC,CAAC9a,EAAQ4O,IAEZ,MAAMmM,GAAoBnM,GAAkBmE,GAGtCiI,IAAsBla,EAAAA,EAAAA,aAAama,IACvCrI,GAAiB7I,GACIA,EAAK/Q,KAAKkiB,GAAKA,EAAE9e,KAAO6e,EAAK7e,IAEvC2N,EAAK7N,OAAOgf,GAAKA,EAAE9e,KAAO6e,EAAK7e,IAEjC,IAAI2N,EAAMkR,KAElB,IAIGE,IAAcra,EAAAA,EAAAA,aAAY5H,iBAA6C,IAAtC1L,EAAIyqB,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAGjI,EAAOoL,EAAWnD,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KACjE,IAAKzqB,EAAKgB,QAAiC,IAAvBsiB,GAAYngB,OAAc,OAI9C,IAAI0qB,EAAkBrb,EAEtB,IAAKqb,EAGH,OAFAha,EAAAA,GAAME,KAAK,2MACXoO,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,OAAQC,QAAS,oHAIjDyM,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,OAAQC,QAAS,kEAE/C,MAAMoY,EAAc,CAClBlf,GAAG,QAAD3Q,OAAUoX,KAAKC,OACjByY,KAAM,OACN5oB,QAASyoB,GAAe5tB,EACxBguB,WAAW,IAAI3Y,MAAO4Y,eAGxB5L,EAAY9F,GAAQ,IAAIA,EAAMuR,IAC9BrL,EAAS,IACTE,GAAa,GACbE,GAAiB,IAEjB,IAEE,MAAMqL,EAAgC,iBAAhBluB,EAAKgB,OAErBmtB,EAAwB,cAAAlwB,OACZ4vB,EADDK,EACgB,oBACA,SAG3BE,EAAQC,EAAa,aAAAC,WAAWF,MAEhCG,EAAU,GAGhB,GAA2B,IAAvBjL,GAAYngB,QAAiB+qB,EAwK1B,GAAI5K,GAAYngB,OAAS,EAAG,CACjCgf,EAAO,CAAExf,KAAM,SAAU8S,MAAO,OAAQC,QAAQ,4BAADzX,OAAUqlB,GAAYngB,OAAM,0EAE3E,MAAMqrB,EAAW,IAAIC,SACrBD,EAASE,OAAO,UAAW1uB,GACvBqhB,GAAWmN,EAASE,OAAO,aAAcrN,GAG7C,MAAMsN,EAAUrL,GAAYhlB,IAAIswB,GAAQA,EAAKpvB,QAAU,QACvDgvB,EAASE,OAAO,eAAgBG,KAAKC,UAAUH,IAC/CrL,GAAYyL,QAAQH,IAClB,MAAMI,EAAaJ,EAAKnB,MAAQmB,EAChCJ,EAASE,OAAO,QAASM,KAG3B,MAAM3W,QAAiB4W,MAAM,GAADhxB,OAAIswB,GAAOtwB,OAAGkwB,GAAY,CACpDe,OAAQ,OACRC,QAAS,CACP,cAAiBf,EAAK,UAAAnwB,OAAamwB,GAAU,IAE/CgB,KAAMZ,EACNa,YAAa,YAGf,IAAKhX,EAASiX,GAAI,CAChB,MAAMC,QAAkBlX,EAASmX,OAAOC,MAAM,MAAS,IAEvD,IAAIC,EAAe,2GACnB,GAAIH,EAAUI,OACZ,IAIED,GAH2C,kBAArBH,EAAUI,OAC5Bd,KAAKe,MAAML,EAAUI,QACrBJ,EAAUI,QACQja,SAAW6Z,EAAUI,MAC7C,CAAE,MAAAE,GACAH,EAAeH,EAAUI,MAC3B,CAEF,MAAM,IAAI/S,MAAM8S,EAClB,CAEA,MAAMtvB,QAAaiY,EAASmX,OACtBM,EAAmB,CACvBlhB,GAAIxO,EAAKoT,YAAU,OAAAvV,OAAWoX,KAAKC,OACnCyY,KAAM,YACN5oB,QAAS/E,EAAKiY,SACd2V,WAAW,IAAI3Y,MAAO4Y,cACtB8B,YAAa3vB,EAAK2vB,YAClBC,YAAa5vB,EAAK4vB,YAClBC,kBAAmB7vB,EAAK6vB,mBAG1B5N,EAAY9F,GAAQ,IAAIA,EAAMuT,IAC9B3N,EAAO,CAAExf,KAAM,SAAU8S,MAAO,UAAWC,QAAS,4IACpDyM,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,UAAWC,QAAS,wEAE9CtV,EAAK0rB,YAAcxK,GACrBA,EAAgBlhB,EAAK0rB,WAEzB,KAAO,CAEL,MAAM1rB,QAAamT,EAAAA,EAAAA,IAAQ4a,EAAU,CACnCzY,QAAS,wJACToW,WAAYzK,IAGRyO,EAAmB,CACvBlhB,GAAIxO,EAAKoT,YAAU,OAAAvV,OAAWoX,KAAKC,OACnCyY,KAAM,YACN5oB,QAAS/E,EAAKiY,SACd2V,WAAW,IAAI3Y,MAAO4Y,cACtB8B,YAAa3vB,EAAK2vB,YAClBC,YAAa5vB,EAAK4vB,YAClBE,gBAAgB,GAGlB7N,EAAY9F,GAAQ,IAAIA,EAAMuT,IAC9B3N,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,UAAWC,QAAS,wEAE9CtV,EAAK0rB,YAAcxK,GACrBA,EAAgBlhB,EAAK0rB,WAEzB,KA1PgD,CAC9C,MAAM0C,EAAW,IAAIC,SACrBD,EAASE,OAAO,UAAW1uB,GAEvB4tB,GAAeA,IAAgB5tB,GACjCwuB,EAASE,OAAO,eAAgBd,GAE9BvM,GAAWmN,EAASE,OAAO,aAAcrN,GAE7C,MAAMhJ,QAAiB4W,MAAM,GAADhxB,OAAIswB,GAAOtwB,OAAGkwB,GAAY,CACpDe,OAAQ,OACRC,QAAS,CACP,cAAiBf,EAAK,UAAAnwB,OAAamwB,GAAU,GAC7C,oBAAqB,QAEvBgB,KAAMZ,EACNa,YAAa,YAGf,IAAKhX,EAASiX,GAAI,CAChB,MAAMC,QAAkBlX,EAASmX,OAAOC,MAAM,MAAS,IAEvD,IAAIC,EAAe,2GACnB,GAAIH,EAAUI,OACZ,IAIED,GAH2C,kBAArBH,EAAUI,OAC5Bd,KAAKe,MAAML,EAAUI,QACrBJ,EAAUI,QACQja,SAAW6Z,EAAUI,MAC7C,CAAE,MAAAQ,GACAT,EAAeH,EAAUI,MAC3B,CAEF,MAAM,IAAI/S,MAAM8S,EAClB,CAKA,IAHoBrX,EAAS8W,QAAQ5Q,IAAI,iBAAmB,IAG5Cjc,SAAS,qBAAsB,CAC7C2gB,IAAe,GACf,MAAMmN,EAAS/X,EAAS+W,KAAKiB,YACvBC,EAAU,IAAIC,YACpB,IAAIC,EAAW,GACXje,EAAY,KACZke,EAAe,KACfC,EAAa,KACbC,EAAa,KACbC,EAAgB,GAChBC,EAAiB,EACjBC,EAAmB,KACnBC,EAAY,GAEhB,OAAa,CACX,MAAM,KAAEC,EAAI,MAAEnS,SAAgBuR,EAAOa,OACrC,GAAID,EAAM,MAGVD,GADcT,EAAQY,OAAOrS,EAAO,CAAEsS,QAAQ,IAI9C,MAAMC,EAASL,EAAU9iB,MAAM,QAE/B8iB,EAAYK,EAAOC,OAAS,GAG5B,MAAMrjB,EAAQojB,EAAOnT,QAAQqT,GAASA,EAAMrjB,MAAM,OAElD,IAAK,MAAMG,KAAQJ,EACjB,GAAII,EAAKgS,WAAW,UAClB,IACE,MAAMhgB,EAAOyuB,KAAKe,MAAMxhB,EAAKhL,MAAM,IAEnC,GAAkB,UAAdhD,EAAKuC,MAAoBvC,EAAKmxB,MAChCf,GAAYpwB,EAAKmxB,MACjB1O,GAAiB2N,QACZ,GAAkB,YAAdpwB,EAAKuC,KAEdmV,QAAQ0Z,KAAK,+BAAsBpxB,EAAKsV,SAExC8a,GAAQ,oBAAAvyB,OAAcmC,EAAKsV,SAC3BmN,GAAiB2N,QACZ,GAAkB,aAAdpwB,EAAKuC,KAEdogB,GAAqB,CACnB0O,MAAOrxB,EAAKqxB,MACZthB,SAAU/P,EAAK+P,SACfuF,QAAStV,EAAKsV,eAEX,GAAkB,qBAAdtV,EAAKuC,KAEd6tB,EAAWpwB,EAAK+E,QAChB0d,GAAiB2N,GACjBzN,GAAqB,CAAE5S,SAAU,IAAKuF,QAAS,iCAAS+b,MAAO,kBAC1D,GAAkB,iBAAdrxB,EAAKuC,KAEdmV,QAAQ4Z,IAAI,uCAA8BtxB,EAAKsV,cAC1C,GAAkB,SAAdtV,EAAKuC,KACd4P,EAAYnS,EAAKoT,WACjBid,EAAerwB,EAAK0rB,WACpB4E,EAAatwB,EAAK2vB,YAClBY,EAAavwB,EAAK4vB,YAElBY,EAAgBxwB,EAAKuxB,gBAAkB,GACvCd,EAAiBzwB,EAAKwxB,iBAAmB,EACzCd,EAAmB1wB,EAAK6vB,mBAAqB,KAEzC7vB,EAAKyxB,uBACPjN,GAAyBrS,GAEzBqS,GAAyB,MAGvBxkB,EAAK0xB,YAAc1xB,EAAKyxB,yBAC1BrB,GAAY,iSAET,GAAkB,UAAdpwB,EAAKuC,KACd,MAAM,IAAIia,MAAMxc,EAAKsV,SAAW,sEAEpC,CAAE,MAAOqc,GACP,CAIR,CAGA,MAAMjC,EAAmB,CACvBlhB,GAAI2D,GAAS,OAAAtU,OAAWoX,KAAKC,OAC7ByY,KAAM,YACN5oB,QAASqrB,EACTxC,WAAW,IAAI3Y,MAAO4Y,cACtB8B,YAAaW,EACbV,YAAaW,EACbgB,eAAgBf,EAChBgB,gBAAiBf,EACjBZ,kBAAmBa,GAGrBzO,EAAY9F,GAAQ,IAAIA,EAAMuT,IAC9B7M,IAAe,GACfJ,GAAiB,IACjBE,GAAqB,MACrBZ,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,UAAWC,QAAS,wEAE9C+a,GAAgBnP,GAClBA,EAAgBmP,EAEpB,KAAO,CAEL,MAAMrwB,QAAaiY,EAASmX,OACtBM,EAAmB,CACvBlhB,GAAIxO,EAAKoT,YAAU,OAAAvV,OAAWoX,KAAKC,OACnCyY,KAAM,YACN5oB,QAAS/E,EAAKiY,SACd2V,WAAW,IAAI3Y,MAAO4Y,cACtB8B,YAAa3vB,EAAK2vB,YAClBC,YAAa5vB,EAAK4vB,YAClBC,kBAAmB7vB,EAAK6vB,mBAG1B5N,EAAY9F,GAAQ,IAAIA,EAAMuT,IAC9B3N,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,UAAWC,QAAS,wEAE9CtV,EAAK0rB,YAAcxK,GACrBA,EAAgBlhB,EAAK0rB,WAEzB,CACF,CAmFF,CAAE,MAAO9X,GACP8D,QAAQ5D,MAAM,0BAA2BF,GACzCH,EAAAA,GAAMK,MAAMF,EAAI0B,SAAW,4GAC3B2M,EAAY9F,GAAQA,EAAKnZ,MAAM,GAAI,IACnC6f,IAAe,GACfJ,GAAiB,IACjBV,EAAO,CAAExf,KAAM,OAAQ8S,MAAO,QAASC,QAAS,8JAClD,CAAC,QACCiN,GAAa,GACbY,GAAe,GAQjB,CACF,EAAG,CAACf,EAAOc,GAAa9Q,EAAQ6O,EAAWC,EAAiBpkB,EAAUilB,KAGtExQ,EAAAA,EAAAA,WAAU,KACR,MAAM2Z,EAAWC,IAAS,IAADyG,EACvB,MAAMrC,GAAY,OAAHpE,QAAG,IAAHA,OAAG,EAAHA,EAAKoE,SAAU,CAAC,EACzBlP,EAASkP,EAAOlP,OAChBmN,EAAgC,QAArBoE,EAAGrC,EAAO/B,mBAAW,IAAAoE,EAAAA,EAAI,KACpB,kBAAXvR,GAAuBA,EAAOzf,QACvC2sB,GAAYlN,EAAQmN,IAIxB,OADAnC,OAAOC,iBAAiB,YAAaJ,GAC9B,IAAMG,OAAOE,oBAAoB,YAAaL,IACpD,CAACqC,KAKJ,MAAMsE,IAAsB3e,EAAAA,EAAAA,aAAY,SAAC4e,GAA+B,IAApBpW,EAAO2O,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KAI5D,MAAM0H,EAAY,gyEAiBlB,OAAQD,GAIN,IAAK,YACH,MAAM,+qFAANj0B,OAkBNk0B,GAKI,IAAK,YACH,MAAM,y4FAANl0B,OAoBNk0B,GAKI,IAAK,YACH,MAAM,uvGAANl0B,OAoBNk0B,GAKI,IAAK,cACH,MAAM,81GAANl0B,OAsBNk0B,GAEI,IAAK,UACL,IAAK,WAAY,CACf,MAAMC,EACG,OAAPtW,QAAO,IAAPA,GAAAA,EAASuW,mBAAkB,KAAAp0B,OAAQ6d,EAAQuW,mBAAkB,KAAM,GACrE,MAAM,mJAANp0B,OAAuCm0B,EAAU,ioFAAAn0B,OAkBvDk0B,EACI,CAIA,IAAK,OACH,MAAM,8vGAANl0B,OAsBNk0B,GAKI,IAAK,eACH,MAAM,8iHAANl0B,OAsBNk0B,GAKI,IAAK,cACH,MAAM,wlIAANl0B,OAsBNk0B,GAEI,QACE,OAAO,KAEb,EAAG,IAGGG,GAAwB,CAE5BC,UAAW,2HACXC,UAAW,6IACXC,UAAW,+GACX5X,YAAa,8IACb6X,KAAM,yGACN7Y,aAAc,qKACd8Y,YAAa,iIAEbC,SAAU,iFACV5sB,SAAU,4FACV6sB,UAAW,mGACXC,YAAa,iIACbC,kBAAmB,uFAEnBC,aAAc,sFACdC,kBAAmB,0EACnBC,WAAY,qHACZC,gBAAiB,sFACjBC,WAAY,6FAGRC,IAAkB/f,EAAAA,EAAAA,aAAY5H,eAAOwmB,GAA+B,IAApBpW,EAAO2O,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KAC9D,IAAKyH,EAAW,OAGhB,MAAMoB,EAAMxS,GAAkBpC,KAAKvc,GAAKA,EAAE4W,MAAQmZ,IAAc,KAChE,GAAIoB,EAAK,CACP,MAAMt2B,EAAes2B,EAAIvS,cAAgB,OAEzC,IADgBiJ,GAAQhtB,GAGtB,YADAstB,GAAiBgJ,EAAIt0B,MAAOs0B,EAAI1wB,MAAO5F,EAG3C,CAGA,GAAkB,iBAAdk1B,EAA8B,CAChC,MAAMqB,EAAatB,GAAoB,OAAQnW,GACzC0X,EAAcvB,GAAoB,eAAgBnW,GAIxD,OAFIyX,SAAkB5F,GAAY4F,EAAYjB,GAA4B,WACtEkB,SAAmB7F,GAAY6F,EAAalB,GAAoC,cAEtF,CAEA,MAAM7R,EAASwR,GAAoBC,EAAWpW,GACxC8R,EAAc0E,GAAsBJ,IAAU,yCAAAj0B,OAAei0B,EAAS,OAExEzR,SAAckN,GAAYlN,EAAQmN,EACxC,EAAG,CAACqE,GAAqBjI,GAASM,GAAkBqD,MAGpDhc,EAAAA,EAAAA,WAAU,KACHa,GACAqP,IACD6D,GAAmBpU,UACvBoU,GAAmBpU,SAAU,EAC7B+hB,GAAgBxR,EAAqBC,MACpC,CAACtP,EAAQqP,EAAqBC,EAA4BuR,KAG7D,MAAMI,IAAiBngB,EAAAA,EAAAA,aAAY5H,UACjC,GAAKiZ,IAA0BnS,EAA/B,CAEAmQ,GAAa,GACbE,GAAiB,IACjB+B,GAAyB,MAEzB,IACE,MAAMwJ,EAAQC,EAAa,aAAAC,WAAWF,MAChCG,EAAU,GAEVlW,QAAiB4W,MAAM,GAADhxB,OAAIswB,EAAO,eAAAtwB,OAAcuU,EAAM,SAAS,CAClE0c,OAAQ,OACRC,QAAS,CACP,cAAiBf,EAAK,UAAAnwB,OAAamwB,GAAU,GAC7C,oBAAqB,OACrB,eAAgB,oBAElBgB,KAAMP,KAAKC,UAAU,CACnBpZ,QAAS,2BACToW,WAAYzK,EACZqS,cAAe/O,KAEjB0K,YAAa,YAGf,IAAKhX,EAASiX,GAAI,CAChB,MAAMC,QAAkBlX,EAASmX,OAAOC,MAAM,MAAS,IACvD,MAAM,IAAI7S,MAAM2S,EAAUI,QAAU,qGACtC,CAIA,IADoBtX,EAAS8W,QAAQ5Q,IAAI,iBAAmB,IAC5Cjc,SAAS,qBAAsB,CAC7C,MAAM8tB,EAAS/X,EAAS+W,KAAKiB,YACvBC,EAAU,IAAIC,YACpB,IAAIC,EAAW,GACXje,EAAY,KACZke,EAAe,KACfM,EAAY,GAIhB,IAFA9N,IAAe,KAEF,CACX,MAAM,KAAE+N,EAAI,MAAEnS,SAAgBuR,EAAOa,OACrC,GAAID,EAAM,MAGVD,GADcT,EAAQY,OAAOrS,EAAO,CAAEsS,QAAQ,IAI9C,MAAMC,EAASL,EAAU9iB,MAAM,QAC/B8iB,EAAYK,EAAOC,OAAS,GAC5B,MAAMrjB,EAAQojB,EAAOnT,QAAQqT,GAASA,EAAMrjB,MAAM,OAElD,IAAK,MAAMG,KAAQJ,EACjB,GAAII,EAAKgS,WAAW,UAClB,IACE,MAAMhgB,EAAOyuB,KAAKe,MAAMxhB,EAAKhL,MAAM,IAEjB,UAAdhD,EAAKuC,MAAoBvC,EAAKmxB,OAChCf,GAAYpwB,EAAKmxB,MACjB1O,GAAiB2N,IACM,iBAAdpwB,EAAKuC,KACdmV,QAAQ4Z,IAAI,4CACW,SAAdtxB,EAAKuC,OACd4P,EAAYnS,EAAKoT,WACjBid,EAAerwB,EAAK0rB,WAChB1rB,EAAKyxB,wBACPjN,GAAyBrS,GAG/B,CAAE,MAAOwf,GACP,CAIR,CAGA,MAAMjC,EAAmB,CACvBlhB,GAAI2D,GAAS,OAAAtU,OAAWoX,KAAKC,OAC7ByY,KAAM,YACN5oB,QAASqrB,EACTxC,WAAW,IAAI3Y,MAAO4Y,cACtB0F,gBAAgB,GAGlBtR,EAAY9F,GAAQ,IAAIA,EAAMuT,IAC9B7M,IAAe,GACfJ,GAAiB,IAEb4N,GAAgBnP,GAClBA,EAAgBmP,EAEpB,CACF,CAAE,MAAOvc,GACP4D,QAAQ5D,MAAM,sBAAuBA,GACrCL,EAAAA,GAAMK,MAAMA,EAAMwB,SAAW,qGAC/B,CAAC,QACCiN,GAAa,EACf,CApG6C,GAqG5C,CAACgC,GAAuBnS,EAAQ6O,EAAWC,IAGxCsS,IAActgB,EAAAA,EAAAA,aAAY,SAACugB,GAAsB,IAADC,EAAA,IAAf5G,EAAKzC,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,GACzChK,EAAS,GAGb,OAAQoT,EAAKjlB,IACX,IAAK,eACH,GAAIse,EAAM/pB,OAAS,EAEjB,YADA0Q,EAAAA,GAAMK,MAAM,uIAGduM,EAAM,2HAAAxiB,OAA+BivB,EAAM5uB,IAAIovB,GAAKA,EAAE7gB,UAAU4B,KAAK,QAAO,qiHAwC5E,MAEF,IAAK,oBACH,GAAqB,IAAjBye,EAAM/pB,OAER,YADA0Q,EAAAA,GAAMK,MAAM,qIAGduM,EAAM,mGAAAxiB,OAA2BivB,EAAM5uB,IAAIovB,GAAKA,EAAE7gB,UAAU4B,KAAK,MAAK,s0IAgDtE,MAEF,IAAK,aACHgS,EAAM,ozHA0CN,MAEF,IAAK,kBAEH,GAAqB,QAAjBqT,EAACD,EAAKlY,mBAAW,IAAAmY,IAAhBA,EAAkB9yB,OAErB,YADA6S,EAAAA,GAAMK,MAAM,kEAGduM,EAAM,uHAAAxiB,OAAgC41B,EAAKlY,YAAW,2kGAqCtD,MAEF,IAAK,aACH8E,EAAM,w0HA2EN,MAEF,QACE,OAGJqE,GAAgB,MAChBM,GAAiB,IACjBE,GAAe,IACfqI,GAAYlN,EACd,EAAG,CAACkN,KAgHEoG,KA7GmBzgB,EAAAA,EAAAA,aAAaugB,KAChCA,EAAKhT,SAAYc,EAKjBkS,EAAKG,YACPlP,GAAgB+O,GAChBzO,GAAiB,IACjBE,GAAe,KACNuO,EAAKI,YACdnP,GAAgB+O,GAChBvO,GAAe,KAEfsO,GAAYC,GAZZvJ,GAAiBuJ,EAAKv2B,KAAMu2B,EAAK5W,YAAa,iBAc/C,CAAC0E,EAAWiS,GAAatJ,MA0DJhX,EAAAA,EAAAA,aAAY5H,iBAA0B,IAAnBsU,EAAIyK,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,OAChD,GAAKjY,EACL,IACEqB,EAAAA,GAAME,KAAK,4GACLR,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,cAAc,CAAEwN,SACtEnM,EAAAA,GAAMC,QAAQ,6PACd,IACQ,OAANqO,QAAM,IAANA,GAAAA,EAAS,CACPxf,KAAM,WACN8S,MAAO,OACPC,QAAQ,iGAADzX,OAAwB+hB,EAAI,KACnCrK,KAAM,CAAEnD,WAEZ,CAAE,MAAA0hB,GACA,CAEJ,CAAE,MAAOlgB,GACP,MAAMmM,GAAS,OAAHnM,QAAG,IAAHA,OAAG,EAAHA,EAAK0B,UAAW,qGAC5B7B,EAAAA,GAAMK,MAAMiM,EACd,CACF,EAAG,CAAC3N,EAAQ2P,IAeMzW,eAAOvG,GAAwD,IAA/CmZ,EAAQmM,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,OAAQ0J,EAAe1J,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KACrE,MAAM2J,QAAe7S,EAAU,CAC7Bpc,UACAmZ,WACA+V,kBAAmBF,IAGjBC,EAAOtgB,QACTD,EAAAA,GAAMC,QAAQ,oFACa,UAAlBsgB,EAAOE,OAChBzgB,EAAAA,GAAMK,MAAM,2IAEZL,EAAAA,GAAMK,MAAM,sEAEhB,GAgCMqgB,GAAiB,CACrB,CAAE1V,MAAO,OAAQ7f,MAAO,wCAAWC,MAAO,WAC1C,CAAE4f,MAAO,WAAY7f,MAAO,wCAAWC,MAAO,OAC9C,CAAE4f,MAAO,QAAS7f,MAAO,2DAAeC,MAAO,QAC/C,CAAE4f,MAAO,cAAe7f,MAAO,2DAAeC,MAAO,UA0HvD,OACEjB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+BAA8BE,SAAA,EAE3CH,EAAAA,GAAAA,KAAA,SAAAG,SA5rDsB,oLAisDtBH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAA8BE,UAE3CH,EAAAA,GAAAA,KAAA,OAAKsjB,IAAKgG,GAAsBrpB,UAAU,uCAAsCE,SAC3D,IAApBqkB,EAASjf,OAEPqP,GA6JCxU,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+DAA8DE,SAAA,EAC3EH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,6GAA4GE,UACzHH,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACjW,KAAM,GAAIN,UAAU,kBAEhCD,EAAAA,GAAAA,KAAA,MAAIC,UAAU,oCAAmCE,SAAC,2EAClDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,sCAAqCE,SAAC,gfAMnDH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uBAAsBE,UACnCH,EAAAA,GAAAA,KAACkZ,GAAoB,CAACtE,OAAQA,EAAQwE,SAAS,OAIjDpZ,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+CAA8CE,SAC1DgsB,GAAazrB,IAAKk2B,IACjB,MAAMroB,EAAOqoB,EAAO3wB,KACd4wB,EAAYD,EAAO3T,UAAYc,GAAe6S,EAAO72B,aAAeikB,EACpEsM,EAA8B,gBAAdsG,EAAO5lB,GAE7B,OACE5Q,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAzcFo2B,KAAY,IAADE,EAAAC,EACpC,GAAIH,EAAO3T,UAAYc,EAErB,YADA2I,GAAiBkK,EAAOx1B,MAAO,kJAA0C,gBAG3E,GAAIw1B,EAAO72B,aAAeikB,EAExB,YADA0I,GAAiBkK,EAAOx1B,MAAO,0IAAuC,cAKxE,MAAM4F,EAAI2oB,GAIJqH,GAH6C,QAA1BF,EAAI,OAAD9vB,QAAC,IAADA,OAAC,EAADA,EAAGiwB,4BAAoB,IAAAH,EAAAA,EAAK9tB,MAAMC,QAAS,OAADjC,QAAC,IAADA,OAAC,EAADA,EAAG8V,gBAAkB9V,EAAE8V,eAAevX,OAAS,IAC9E,QAApBwxB,EAAI,OAAD/vB,QAAC,IAADA,OAAC,EAADA,EAAGkwB,sBAAc,IAAAH,EAAAA,EAAK/tB,MAAMC,QAAS,OAADjC,QAAC,IAADA,OAAC,EAADA,EAAGgW,UAAYhW,EAAEgW,SAASzX,OAAS,IACtEyD,MAAMC,QAAS,OAADjC,QAAC,IAADA,OAAC,EAADA,EAAGmwB,oBAAsBnwB,EAAEmwB,mBAAmB5xB,OAAS,GACV,EAE5E6xB,EAAiBtH,IACrB,MAAMuH,EAAK9rB,QAAQ,OAADukB,QAAC,IAADA,OAAC,EAADA,EAAGwH,iBAAkB,OAADxH,QAAC,IAADA,OAAC,EAADA,EAAGyH,WAAY,IAAI9yB,cACnD+yB,EAAKjsB,QAAQ,OAADukB,QAAC,IAADA,OAAC,EAADA,EAAG7gB,WAAY,IAAIxK,cACrC,MAAO,CAAC,QAAS,UAAW,QAAS,YAAYC,SAAS2yB,IAAOG,EAAG9yB,SAAS,sDAAgB8yB,EAAG9yB,SAAS,gDAAe8yB,EAAG9yB,SAAS,sDAAgB8yB,EAAG9yB,SAAS,mCAE5J+yB,GAAoBtQ,IAAa,IAAIvZ,KAAKkiB,GAAKsH,EAActH,IAAgC,WAAxB,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGluB,SAAU,SACjF81B,GAAwBvQ,IAAa,IAAIvZ,KAAKkiB,GAAKsH,EAActH,IAAgC,eAAxB,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGluB,SAAU,SACrF+1B,GAAkBxQ,IAAa,IAAIvZ,KAAKkiB,GAAKsH,EAActH,IAC3D8H,KAAkC,OAAX7P,SAAW,IAAXA,IAAAA,GAAagH,sBAAmC,OAAX1G,SAAW,IAAXA,IAAAA,GAAaQ,oBAE/E,GAAkB,SAAd+N,EAAO5lB,MACHymB,IAAoBC,GAExB,YADAzhB,EAAAA,GAAMK,MAAM,mTAKhB,GAAkB,aAAdsgB,EAAO5lB,GAAmB,CAC5B,IAAK2mB,EAEH,YADA1hB,EAAAA,GAAMK,MAAM,+SAGd,IAAKshB,EAEH,YADA3hB,EAAAA,GAAMK,MAAM,+RAGd,IAAK0gB,EAEH,YADA/gB,EAAAA,GAAMK,MAAM,0dAGhB,CAGA,MAAM0Z,EAAW,gBAAA3vB,OAASu2B,EAAOx1B,MAAK,OACtC2uB,GAAY6G,EAAO/T,OAAQmN,IAsZM6H,CAAkBjB,GACjC32B,UAAS,wGAAAI,OACPw2B,EACI,oEACAvG,EACE,yMACA,4MAERtrB,MAAO6xB,EAAW,+FAAsBD,EAAOx1B,MAAMjB,SAAA,EAErDH,EAAAA,GAAAA,KAACuO,EAAI,CAAChO,KAAM,GAAIN,UAAS,8CAAAI,OAAgDiwB,EAAgB,iBAAmB,OAC5GtwB,EAAAA,GAAAA,KAAA,QAAAG,SAAOy2B,EAAOx1B,QACby1B,IAAY72B,EAAAA,GAAAA,KAACiB,EAAAA,EAAK,CAACV,KAAM,GAAIN,UAAU,0BAbnC22B,EAAO5lB,YAnLtB5Q,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kCAAiCE,SAAA,EAC9CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mBAAkBE,SAAA,EAC/BH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,qHAAoHE,UACjIH,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACjW,KAAM,GAAIN,UAAU,kBAEhCD,EAAAA,GAAAA,KAAA,MAAIC,UAAU,oCAAmCE,SAAC,2EAClDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,yCAAwCE,SAAC,8WAMxDH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAA8BE,UAC3CH,EAAAA,GAAAA,KAAA,OACEQ,QAASA,IAAMqjB,EAAYA,IAAcvkB,EAAS,mBAClDW,UAAU,4NAA2NE,UAErOC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mCAAkCE,SAAA,EAC/CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,oHAAmHE,UAChIH,EAAAA,GAAAA,KAAC83B,EAAAA,EAAU,CAACv3B,KAAM,GAAIN,UAAU,uBAElCG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,cAAaE,SAAA,EAC1BH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,mCAAkCE,SAAC,kIAChDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,sFAE5CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,gIAA+HE,SAAA,EAC5IH,EAAAA,GAAAA,KAAC+3B,EAAAA,EAAI,CAACx3B,KAAM,KAAM,qEAQ1BH,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uDAAsDE,SAAA,EACnEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,6BACfD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAC,iFACxCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gCAIjBG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCC,EAAAA,GAAAA,MAAA,MAAIH,UAAU,yDAAwDE,SAAA,EACpEH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,GAAIN,UAAU,kBAAkB,6DAI/C0mB,IAAuBtC,GACtBrkB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,UACpDH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,+BAA+BM,KAAM,OAExDkmB,GAAkBlhB,OAAS,GAC7BvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,YAAWE,SACvBsmB,GAAkB/lB,IAAKw3B,IAAQ,IAAAC,EAAAC,EAAA,OAC9Bh4B,EAAAA,GAAAA,MAAA,OAEEH,UAAU,yGAAwGE,SAAA,EAGlHC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMsmB,GAAkBD,KAAmBqR,EAASG,QAAU,KAAOH,EAASG,SACvFp4B,UAAU,6FAA4FE,SAAA,EAEtGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,GAAIN,UAAU,mBAC5BG,EAAAA,GAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yBAAwBE,SAAE+3B,EAASI,WAAa,qCAC/Dl4B,EAAAA,GAAAA,MAAA,OAAKH,UAAU,gDAA+CE,SAAA,EAC5DC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,0BAAyBE,SAAA,EACvCH,EAAAA,GAAAA,KAACu4B,EAAAA,EAAa,CAACh4B,KAAM,MACH,QAAjB43B,EAAAD,EAASM,gBAAQ,IAAAL,OAAA,EAAjBA,EAAmB5yB,SAAU,EAAE,qCAEjC2yB,EAASO,aACRr4B,EAAAA,GAAAA,MAAA,QAAMH,UAAU,0BAAyBE,SAAA,EACvCH,EAAAA,GAAAA,KAAC04B,EAAAA,EAAQ,CAACn4B,KAAM,KACf,IAAIkX,KAAKygB,EAASO,YAAYvS,mBAAmB,sBAM5DlmB,EAAAA,GAAAA,KAAC24B,EAAAA,EAAY,CAACp4B,KAAM,GAAIN,UAAS,sCAAAI,OAAwCwmB,KAAmBqR,EAASG,QAAU,YAAc,SAI9HxR,KAAmBqR,EAASG,UAA4B,QAAjBD,EAAAF,EAASM,gBAAQ,IAAAJ,OAAA,EAAjBA,EAAmB7yB,QAAS,IAClEnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,qDAAoDE,SAAA,CAChE+3B,EAASM,SAAShzB,MAAM,EAAG,GAAG9E,IAAKk4B,IAClCx4B,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAMlB,EAAS,UAADe,OAAW63B,EAASG,QAAO,kBAAAh4B,OAAiBu4B,EAAQ1K,aAC3EjuB,UAAU,+FAA8FE,SAAA,EAExGH,EAAAA,GAAAA,KAACu4B,EAAAA,EAAa,CAACh4B,KAAM,GAAIN,UAAU,qBACnCG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,iCAAgCE,SAAEy4B,EAAQ5zB,OAAS,8DAClEhF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wBAAuBE,SACnCy4B,EAAQC,YAAc,IAAIphB,KAAKmhB,EAAQC,YAAY3S,mBAAmB,gBARtE0S,EAAQ1K,cAcjBluB,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,UAADe,OAAW63B,EAASG,QAAO,UAClDp4B,UAAU,qGAAoGE,SAC/G,uEAOJ0mB,KAAmBqR,EAASG,UAC3Br4B,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,UAADe,OAAW63B,EAASG,QAAO,UAClDp4B,UAAU,4GAA2GE,SACtH,4CA9DE+3B,EAASG,aAqElBlU,EAAM5e,OAAS,GAEjBvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,YAAWE,SACvBgkB,EAAM3e,MAAM,EAAG,IAAI9E,IAAKw3B,IACvB93B,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAMlB,EAAS,UAADe,OAAW63B,EAASlnB,GAAE,UAC7C/Q,UAAU,yJAAwJE,SAAA,EAElKH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,GAAIN,UAAU,mBAC5BG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,SAAQE,SAAA,EACrBH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,yBAAwBE,SAAE+3B,EAASI,WAAaJ,EAASx4B,MAAQ,qCAChFM,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wBAAuBE,SACnC+3B,EAASO,YAAc,IAAIhhB,KAAKygB,EAASO,YAAYvS,mBAAmB,eAG7ElmB,EAAAA,GAAAA,KAAC24B,EAAAA,EAAY,CAACp4B,KAAM,GAAIN,UAAU,oBAX7Bi4B,EAASlnB,QAgBpB5Q,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iCAAgCE,SAAA,EAC7CH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,GAAIN,UAAU,6BAC5BD,EAAAA,GAAAA,KAAA,KAAAG,SAAG,mGACHH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,UAASE,SAAC,+HAqDjCC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,CACGqkB,EAAS9jB,IAAI,CAACoX,EAASlX,KAAK,IAAAk4B,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAC3Bt5B,EAAAA,GAAAA,KAAA,OAEE,kBAAiB8X,EAAQ9G,GACzB/Q,UAAS,QAAAI,OAA2B,SAAjByX,EAAQqY,KAAkB,cAAgB,gBAAe,gCAC5ElrB,MAAO,CACLsP,UAAW,wBACXglB,kBAAmB,OACnB9kB,eAAe,GAADpU,OAAK2D,KAAKvC,IAAY,GAARb,EAAY,KAAI,OAC5CT,UAEFC,EAAAA,GAAAA,MAAA,OACEH,UAAS,wFAAAI,OACU,SAAjByX,EAAQqY,KACJ,oEACY,QAAZ2I,EAAAhhB,EAAQC,YAAI,IAAA+gB,GAAZA,EAAcU,aACZ,0GACA,qDACLr5B,SAAA,CAGF2X,EAAQwa,iBACPlyB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,6DAA4DE,SAAA,EACzEH,EAAAA,GAAAA,KAAC6E,EAAAA,EAAM,CAACtE,KAAM,GAAIN,UAAU,oBAC5BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,qCAAoCE,SAAC,+EACrDH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAC,6DAK/B,QAAZ44B,EAAAjhB,EAAQC,YAAI,IAAAghB,OAAA,EAAZA,EAAcS,gBACbp5B,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mEAAkEE,SAAA,EAC/EH,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACjW,KAAM,GAAIN,UAAU,sBAC9BG,EAAAA,GAAAA,MAAA,QAAMH,UAAU,uCAAsCE,SAAA,CAAC,kCACR,IAAtC2X,EAAQC,KAAKyhB,aAAaC,QAAgB,gCAAW,IAAAp5B,OAAOyX,EAAQC,KAAKyhB,aAAaC,YAE9F3hB,EAAQC,KAAKyhB,aAAavqB,WACzB7O,EAAAA,GAAAA,MAAA,QAAMH,UAAU,+CAA+C+E,MAAO8S,EAAQC,KAAKyhB,aAAavqB,SAAS9O,SAAA,CAAC,gBACpG2X,EAAQC,KAAKyhB,aAAavqB,YAGjC6I,EAAQC,KAAKyhB,aAAaE,cACzB15B,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uEAAsEE,SAAC,oEAQ3E,cAAjB2X,EAAQqY,MACPnwB,EAAAA,GAAAA,KAAC25B,GAAqB,CAACpyB,QAASuQ,EAAQvQ,WAExCvH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,4CAA2CE,SACrD2X,EAAQvQ,UAKK,cAAjBuQ,EAAQqY,OAAyBrY,EAAQic,iBAA8B,QAAhBiF,EAAIlhB,EAAQC,YAAI,IAAAihB,OAAA,EAAZA,EAAcjF,mBAAoBjc,EAAQic,iBAA8B,QAAhBkF,EAAInhB,EAAQC,YAAI,IAAAkhB,OAAA,EAAZA,EAAclF,iBAAgBxuB,OAAS,IAC7JnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,4BAA2BE,SAAA,EACtC2X,EAAQic,iBAA8B,QAAhBmF,EAAIphB,EAAQC,YAAI,IAAAmhB,OAAA,EAAZA,EAAcnF,iBAAgBvuB,MAAM,EAAG,GAAG9E,IAAI,CAACk5B,EAAKC,KAC9Ez5B,EAAAA,GAAAA,MAAA,OAEEH,UAAU,4JACV+E,MAAO40B,EAAI3qB,SAAS9O,SAAA,EAEpBH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAU,mBAC9BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uCAAsCE,SACnDy5B,EAAI3qB,WAEN2qB,EAAInO,OAASmO,EAAInO,MAAMlmB,OAAS,IAC/BnF,EAAAA,GAAAA,MAAA,QAAMH,UAAU,4BAA2BE,SAAA,CAAC,iBACrCy5B,EAAInO,MAAMjmB,MAAM,EAAG,GAAGqL,KAAK,MAAO+oB,EAAInO,MAAMlmB,OAAS,EAAI,MAAQ,MAGzEq0B,EAAIE,YACH15B,EAAAA,GAAAA,MAAA,QAAMH,UAAU,mEAAkEE,SAAA,CAC/Ey5B,EAAIE,UAAU,SAfdD,KAoBP/hB,EAAQic,iBAA8B,QAAhBoF,EAAIrhB,EAAQC,YAAI,IAAAohB,OAAA,EAAZA,EAAcpF,iBAAgBxuB,OAAS,IACjEnF,EAAAA,GAAAA,MAAA,QAAMH,UAAU,oCAAmCE,SAAA,CAAC,KAC/C2X,EAAQic,iBAA8B,QAAhBqF,EAAIthB,EAAQC,YAAI,IAAAqhB,OAAA,EAAZA,EAAcrF,iBAAgBxuB,OAAS,EAAE,8CAO5D,cAAjBuS,EAAQqY,OAAoC,QAAhBkJ,EAAIvhB,EAAQC,YAAI,IAAAshB,OAAA,EAAZA,EAAcU,iBAAkBjiB,EAAQC,KAAKgiB,eAAex0B,OAAS,IACpGvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4BAA2BE,SACvC2X,EAAQC,KAAKgiB,eAAer5B,IAAI,CAACk5B,EAAKC,KACrCz5B,EAAAA,GAAAA,MAAA,OAEEH,UAAU,sGACV+E,MAAO40B,EAAI3qB,SAAS9O,SAAA,EAEpBH,EAAAA,GAAAA,KAACg6B,EAAAA,EAAS,CAACz5B,KAAM,GAAIN,UAAU,mBAC/BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uCAAsCE,SACnDy5B,EAAI3qB,WAEN2qB,EAAInO,OAASmO,EAAInO,MAAMlmB,OAAS,IAC/BnF,EAAAA,GAAAA,MAAA,QAAMH,UAAU,gBAAeE,SAAA,CAAC,iBACzBy5B,EAAInO,MAAM5a,KAAK,WAVnBgpB,MAmBK,cAAjB/hB,EAAQqY,OAAyBrY,EAAQua,oBAAiC,QAAhBiH,EAAIxhB,EAAQC,YAAI,IAAAuhB,OAAA,EAAZA,EAAcjH,qBAC3E,CAAC4H,IACC,MAAMC,EAAOpiB,EAAQua,oBAAiC,QAAhB4H,EAAIniB,EAAQC,YAAI,IAAAkiB,OAAA,EAAZA,EAAc5H,mBAClDxV,GAAa,OAAJqd,QAAI,IAAJA,OAAI,EAAJA,EAAMC,gBAAiB,GAChCrd,GAAqB,OAAJod,QAAI,IAAJA,OAAI,EAAJA,EAAME,wBAAyB,GAChD9zB,GAAe,OAAJ4zB,QAAI,IAAJA,OAAI,EAAJA,EAAMG,kBAAmB,GACpCC,EAAuC,kBAAnB,OAAJJ,QAAI,IAAJA,OAAI,EAAJA,EAAMK,cAA4BL,EAAKK,aAAe,KACtEC,EAA+C,kBAA3B,OAAJN,QAAI,IAAJA,OAAI,EAAJA,EAAMjD,sBAAoCiD,EAAKjD,qBAAuB,KACtFwD,EAAyC,kBAArB,OAAJP,QAAI,IAAJA,OAAI,EAAJA,EAAMQ,gBAA8BR,EAAKQ,eAAiB,KAOhF,OAJG1xB,MAAMC,QAAQ4T,IAAWA,EAAOtX,OAAS,GACzCyD,MAAMC,QAAQ6T,IAAmBA,EAAevX,OAAS,GACzDyD,MAAMC,QAAQ3C,IAAaA,EAASf,OAAS,GAK9CnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAE7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kDAAiDE,SAAA,EAC9DH,EAAAA,GAAAA,KAAA,QAAAG,SAAM,kBACNC,EAAAA,GAAAA,MAAA,QAAAD,SAAA,CAAM,yDAEQ,OAAXm6B,GAA8B,OAAXE,GAA8B,OAAXC,EAAe,oCAAAp6B,OACvCi6B,EAAM,+CAAAj6B,OAAam6B,EAAM,+CAAAn6B,OAAao6B,EAAM,KACvD,SAKPzxB,MAAMC,QAAQ4T,IAAWA,EAAOtX,OAAS,IACxCnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,cAAaE,SAAA,CACzB0c,EAAOrX,MAAM,EAAG,GAAG9E,IAAI,CAAC0e,EAAGya,KAAG,IAAAc,EAAA,OAC7Bv6B,EAAAA,GAAAA,MAAA,OAAeH,UAAU,mFAAkFE,SAAA,EACzGH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,+DAChBG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAEif,EAAEhd,MAAQ,MACxC,QAAVu4B,EAAAvb,EAAEwb,gBAAQ,IAAAD,OAAA,EAAVA,EAAY1rB,YACX7O,EAAAA,GAAAA,MAAA,QAAMH,UAAU,iCAAgCE,SAAA,CAAC,gBAC3Cif,EAAEwb,SAAS3rB,SAAUmQ,EAAEwb,SAAS70B,KAAI,kBAAA1F,OAAW+e,EAAEwb,SAAS70B,MAAS,WANrE8zB,KAYXhd,EAAOtX,OAAS,IACfnF,EAAAA,GAAAA,MAAA,QAAMH,UAAU,4BAA2BE,SAAA,CAAC,IAAE0c,EAAOtX,OAAS,EAAE,6EAMrEyD,MAAMC,QAAQ6T,IAAmBA,EAAevX,OAAS,IACxDvF,EAAAA,GAAAA,KAAA,OAAKC,UAAU,cAAaE,SACzB2c,EAAetX,MAAM,EAAG,GAAG9E,IAAI,CAAC0e,EAAGya,KAAG,IAAAgB,EAAA,OACrCz6B,EAAAA,GAAAA,MAAA,OAAeH,UAAU,iFAAgFE,SAAA,EACvGH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,8DAChBG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wBAAuBE,SAAEif,EAAEC,aAAeD,EAAEhd,MAAQ,MACzD,QAAVy4B,EAAAzb,EAAEwb,gBAAQ,IAAAC,OAAA,EAAVA,EAAY5rB,YACX7O,EAAAA,GAAAA,MAAA,QAAMH,UAAU,gCAA+BE,SAAA,CAAC,gBAC1Cif,EAAEwb,SAAS3rB,SAAUmQ,EAAEwb,SAAS70B,KAAI,kBAAA1F,OAAW+e,EAAEwb,SAAS70B,MAAS,WANrE8zB,OAgBf7wB,MAAMC,QAAQ3C,IAAaA,EAASf,OAAS,IAC5CnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,CACpCmG,EAASd,MAAM,EAAG,GAAG9E,IAAI,CAACqe,EAAG8a,KAAG,IAAAiB,EAAA,OAC/B96B,EAAAA,GAAAA,KAAA,QAEEC,UAAU,4FACV+E,MAAiB,QAAV81B,EAAA/b,EAAE6b,gBAAQ,IAAAE,GAAVA,EAAY7rB,SAAQ,GAAA5O,OAAM0e,EAAE6b,SAAS3rB,UAAQ5O,OAAG0e,EAAE6b,SAAS70B,KAAI,kBAAA1F,OAAW0e,EAAE6b,SAAS70B,MAAS,IAAO,GAAG5F,SAE9G4e,EAAErf,MAAQqf,EAAE3c,MAAQ,IAJhBy3B,KAORvzB,EAASf,OAAS,IACjBnF,EAAAA,GAAAA,MAAA,QAAMH,UAAU,wCAAuCE,SAAA,CAAC,IAAEmG,EAASf,OAAS,WArElE,IA2ErB,EAzFD,GA6FgB,cAAjBuS,EAAQqY,MAAwBrY,EAAQic,gBAAoD,IAAlCjc,EAAQic,eAAexuB,QAA4C,IAA5BuS,EAAQkc,kBACxG5zB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mHAAkHE,SAAA,EAC/HH,EAAAA,GAAAA,KAAC+6B,EAAAA,EAAW,CAACx6B,KAAM,MACnBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,uMAKT2X,EAAQqa,cACP/xB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yDAAwDE,SAAA,CACpE2X,EAAQsa,cACPhyB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,qDAAoDE,SAAA,EACjEH,EAAAA,GAAAA,KAAA,QAAAG,SAAO2X,EAAQsa,YAAYnsB,QAC3BjG,EAAAA,GAAAA,KAAA,QAAAG,SAAO2X,EAAQsa,YAAYptB,WAI9BgE,MAAMC,QAAQ6O,EAAQqa,cAAgBra,EAAQqa,YAAYzxB,IAAI,CAACswB,EAAM6I,KACpEz5B,EAAAA,GAAAA,MAAA,OAAeH,UAAU,oCAAmCE,SAAA,EAC1DH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,+BAA8BE,SAAE6wB,EAAK5uB,MAAQ4uB,EAAK3R,aAAe4R,KAAKC,UAAUF,MAChGhxB,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAM21B,GAAUnF,EAAK5uB,MAAQ4uB,EAAK3R,YAAa2R,EAAKjsB,MAAQ,OAAQ+S,EAAQ9G,IACrF/Q,UAAU,oHACV+E,MAAM,2BAAM7E,UAEZH,EAAAA,GAAAA,KAACg7B,EAAAA,EAAG,CAACz6B,KAAM,SAPLs5B,OAeE,cAAjB/hB,EAAQqY,OACP/vB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,6EAA4EE,SAAA,EAEzFC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAM21B,GAAUre,EAAQvQ,QAAS,UAAWuQ,EAAQ9G,IAC7D/Q,UAAU,0FACV+E,MAAM,0DAAY7E,UAElBH,EAAAA,GAAAA,KAACg7B,EAAAA,EAAG,CAACz6B,KAAM,QAEbP,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IA/oBbsN,OAAO6G,EAAWpN,KACpC,UACQwG,UAAUC,UAAUC,UAAU1G,GACpCke,GAAmB9Q,GACnBhB,WAAW,IAAM8R,GAAmB,MAAO,KAC3CxP,EAAAA,GAAMC,QAAQ,iCAChB,CAAE,MAAOE,GACPH,EAAAA,GAAMK,MAAM,sEACd,GAuoBqC2kB,CAAYnjB,EAAQ9G,GAAI8G,EAAQvQ,SAC/CtH,UAAU,sFACV+E,MAAM,2BAAM7E,SAEXqlB,KAAoB1N,EAAQ9G,IAC3BhR,EAAAA,GAAAA,KAACa,EAAAA,EAAK,CAACN,KAAM,GAAIN,UAAU,oBAE3BD,EAAAA,GAAAA,KAAC8O,EAAAA,EAAI,CAACvO,KAAM,WAMlBP,EAAAA,GAAAA,KAACk7B,GAAU,CACTvmB,UAAWmD,EAAQ9G,GACnB4D,OAAQA,EACRC,eAAgBiD,EAAQvQ,QACxBwN,cAAeuQ,GAASxN,EAAQ9G,KAAO,EACvC8D,QAAUG,GAAWsQ,GAAY5G,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUkV,GAAI,IAAE,CAAC7G,EAAQ9G,IAAKiE,KACnE1U,KAAM,GACNyU,WAAW,OAMC,cAAjB8C,EAAQqY,MAAwBvvB,IAAU4jB,EAASjf,OAAS,IAAMuf,IAAcM,KAC/EhlB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,8DAC1CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uBAAsBE,SAClC2X,EAAQwa,gBACPlyB,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAMuvB,GAAY,4IAA+B9vB,UAAU,mHAAkHE,SAAC,yGAG/LH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAMuvB,GAAY,0HAA4B9vB,UAAU,mHAAkHE,SAAC,uEAK9LC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAMuvB,GAAY,4DAAgB9vB,UAAU,mHAAkHE,SAAC,iDAGhLH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAMuvB,GAAY,4DAAgB9vB,UAAU,mHAAkHE,SAAC,iDAGhLH,EAAAA,GAAAA,KAAA,UAAQQ,QAASA,IAAMuvB,GAAY,qKAAoC9vB,UAAU,mHAAkHE,SAAC,qFA3S3M2X,EAAQ9G,MAwThBoU,IAAeJ,KACdhlB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,qBAAoBE,UACjCC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0EAAyEE,SAAA,EAEtFH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4DAA2DE,SACvE6kB,KAIFE,KACCllB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,qCAAoCE,UACjDH,EAAAA,GAAAA,KAACm7B,GAAU,CACT56B,KAAM,GACN+R,UAAU,EACVC,SAAU2S,GAAkB3S,SAC5BC,gBAAiB0S,GAAkB2O,eAS7C/O,IAAcM,IAAiBA,KAAgBJ,IAAiBE,IAChEllB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,2BAA0BE,UACvCH,EAAAA,GAAAA,KAACm7B,GAAU,CACT56B,KAAM,GACN+R,UAAU,EACVC,SAA2B,OAAjB2S,SAAiB,IAAjBA,QAAiB,EAAjBA,GAAmB3S,SAC7BC,iBAAkC,OAAjB0S,SAAiB,IAAjBA,QAAiB,EAAjBA,GAAmBpN,WAA4B,OAAjBoN,SAAiB,IAAjBA,QAAiB,EAAjBA,GAAmB2O,WAGpE,KAGH9M,KAA0BjC,IAAcM,KACvCplB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,2BAA0BE,UACvCC,EAAAA,GAAAA,MAAA,UACEI,QAASq1B,GACT51B,UAAU,6QAKuBE,SAAA,EAEjCH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,sBAAqBE,SAAC,oEACtCH,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,GAAIN,UAAU,2DAKvCD,EAAAA,GAAAA,KAAA,OAAKsjB,IAAK+F,YAOfpC,KACC7mB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yFAAwFE,SAAA,EACrGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,CACrC,MAAS,MAAMoO,EAAO0Y,GAAahhB,KAAM,OAAOjG,EAAAA,GAAAA,KAACuO,EAAI,CAAChO,KAAM,GAAIN,UAAU,mBAAuB,EAAjG,IACDD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,yBAAwBE,SAAE8mB,GAAavnB,WAEzDM,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KAAQ0mB,GAAgB,MAAOM,GAAiB,IAAKE,GAAe,KAC7EznB,UAAU,+DAA8DE,UAExEH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,UAKZ0mB,GAAamP,aACZh2B,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,6BAA4BE,SAAA,CAAC,sBACT,IAA1B8mB,GAAamU,SAAiB,wEAAmB,2BAAO,mDAE/Dp7B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sEAAqEE,SACjFgnB,GAAUzmB,IAAKmvB,IACdzvB,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAMovB,GAAoBC,GACnC5vB,UAAS,6DAAAI,OACPknB,GAAc3Z,KAAKkiB,GAAKA,EAAE9e,KAAO6e,EAAK7e,IAClC,sDACA,qEACH7Q,SAAA,EAEHH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAU,gBAC7B4vB,EAAK5gB,WATD4gB,EAAK7e,OAaM,IAArBmW,GAAU5hB,SACTvF,EAAAA,GAAAA,KAAA,KAAGC,UAAU,yCAAwCE,SAAC,wFAM3D8mB,GAAaoP,aACZr2B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,OAAME,UACnBH,EAAAA,GAAAA,KAAA,SACE+E,KAAK,OACLkc,MAAOwG,GACPvG,SAAWnC,GAAM2I,GAAe3I,EAAE1S,OAAO4U,OACzCD,YAAY,oFACZ/gB,UAAU,oJACVo7B,UAAYtc,GAAgB,UAAVA,EAAE5D,KAAmB6a,IAAWvsB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIwd,IAAY,IAAElJ,YAAa0J,KAAeF,SAMxGvnB,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMw1B,IAAWvsB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIwd,IAAY,IAAElJ,YAAa0J,KAAeF,IAC1EzQ,SACGmQ,GAAamP,YAAc7O,GAAchiB,QAAU0hB,GAAamU,UAAY,IAC5EnU,GAAaoP,aAAe5O,GAAYrkB,OAE3CnD,UAAU,4MAA2ME,SAEpN8mB,GAAamP,WAAU,sBAAA/1B,OACb4mB,GAAavnB,KAAI,MAAAW,OAAKknB,GAAchiB,OAAM,oCACjD0hB,GAAaoP,WACX,qBAAK,sBAAAh2B,OACE4mB,GAAavnB,WAO/BgmB,GAAYngB,OAAS,IACpBnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,qDAAoDE,SAAA,EACjEC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,wBAAuBE,SAAA,CAAC,qFAAkBulB,GAAYngB,OAAO,6FAC5EnF,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMuvB,GAAY,2GAAuB,uEAClDjZ,SAAUgO,EACV7kB,UAAU,sJAAqJE,SAAA,EAE/JH,EAAAA,GAAAA,KAACg6B,EAAAA,EAAS,CAACz5B,KAAM,KAAM,iEAI3BP,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sBAAqBE,SACjCulB,GAAYhlB,IAAI,CAAC46B,EAAUzB,KAC1B,MAAM0B,EAAgBD,EAAS15B,QAAU,OAEzC,OACExB,EAAAA,GAAAA,MAAA,OAEEH,UAAU,iFAAgFE,SAAA,EAE1FH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAU,mCAC9BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,wCAAuCE,SAAEm7B,EAAS57B,QAGlEM,EAAAA,GAAAA,KAAA,UACEihB,MAAOsa,EACPra,SAAWnC,IAAMyc,OA9zBT56B,EA8zB0Bi5B,EA9zBnB4B,EA8zBwB1c,EAAE1S,OAAO4U,MA7zBhE0E,GAAehH,GAAQA,EAAKje,IAAI,CAACswB,EAAMtrB,IACrCA,IAAM9E,GAAK6I,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQunB,GAAI,IAAEpvB,OAAQ65B,IAAczK,SAEjDzM,EAAO,CAAExf,KAAM,SAAU8S,MAAO,OAAQC,QAAQ,0EAADzX,OAAqBO,EAAQ,EAAC,OAAAP,OAAMo7B,KAJ5DD,IAAC56B,EAAO66B,GA+zBfx7B,UAAS,yGAAAI,OACa,SAAlBk7B,EAA2B,yCACT,aAAlBA,EAA+B,iCACb,UAAlBA,EAA4B,mCAC5B,sCAAuCp7B,SAE1Cw2B,GAAej2B,IAAIg7B,IAClB17B,EAAAA,GAAAA,KAAA,UAA2BihB,MAAOya,EAAOza,MAAM9gB,SAC5Cu7B,EAAOt6B,OADGs6B,EAAOza,WAMxBjhB,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KAAMm7B,OAl1Bb/6B,EAk1BwBi5B,OAj1B1ClU,GAAehH,GAAQA,EAAK7N,OAAO,CAAC8qB,EAAGl2B,IAAMA,IAAM9E,IADjCA,OAm1BFX,UAAU,yDACV+E,MAAM,8CAAU7E,UAEhBH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,SA5BNs5B,WAsCjBz5B,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mGAAkGE,SAAA,CAE9GyU,IACC5U,EAAAA,GAAAA,KAAA,OAAKC,UAAU,eAAcE,UAC3BH,EAAAA,GAAAA,KAACkZ,GAAoB,CAACtE,OAAQA,EAAQwE,SAAO,MAGhDxE,GAAU,CAAC,YAAa,aAAc,WAAWlQ,SAAS6G,OAAO4d,IAAuB,OACvF/oB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8FAA6FE,SAAA,EAC1GH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,qBAAoBE,SAAC,sFACpCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gBAAeE,SAAC,+kBAKnCC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,gCAA+BE,SAAA,CAE3CyjB,IACCxjB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,UACEQ,QAASojB,EACT3jB,UAAU,6QAIkDE,UAE5DH,EAAAA,GAAAA,KAAC83B,EAAAA,EAAU,CAACv3B,KAAM,GAAIN,UAAU,qBAGlCG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iNAGwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,sCAAqCE,SAAC,yGACnDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,2RAM3CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,SACE+E,KAAK,OACLue,IAAKkG,GACLtI,SA75BcnC,IACxB,MAAMuQ,EAAQtmB,MAAM6yB,KAAK9c,EAAE1S,OAAOijB,OAClC,GAAIA,EAAM/pB,OAAS,EAEjB,YADA0Q,EAAAA,GAAMK,MAAM,+GAId,MAAMwlB,EAAkBxM,EAAM5uB,IAAImvB,IAAI,CACpCA,OACAjuB,OAAQ,OACRlC,KAAMmwB,EAAKnwB,QAEbimB,GAAemW,GACfvX,EAAO,CAAExf,KAAM,SAAU8S,MAAO,OAAQC,QAAQ,kCAADzX,OAAWy7B,EAAgBv2B,OAAM,2EAi5BtEw2B,UAAQ,EACRC,OAAO,uBACP/7B,UAAU,YAEZD,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KAAA,IAAAy7B,EAAA,OAA0B,QAA1BA,EAAMzS,GAAa9V,eAAO,IAAAuoB,OAAA,EAApBA,EAAsBpsB,SACrC5P,UAAU,sGAAqGE,UAE/GH,EAAAA,GAAAA,KAACg6B,EAAAA,EAAS,CAACz5B,KAAM,GAAIN,UAAU,qBAGjCG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iNAGwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,sCAAqCE,SAAC,mGACnDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAChCyU,EAEe,cAAbyS,GACE,8MACA,wJAHF,wLASVrnB,EAAAA,GAAAA,KAAA,OAAKC,UAAU,0BAAyBE,UACtCH,EAAAA,GAAAA,KAAA,YACEsjB,IAAKiG,GACLtI,MAAO2D,EACP1D,SAAWnC,GAAM8F,EAAS9F,EAAE1S,OAAO4U,OACnCoa,UAxzBWtc,IAYrB,GAVc,UAAVA,EAAE5D,KAAoB4D,EAAEmd,WAC1Bnd,EAAEod,iBACFpM,MAGY,UAAVhR,EAAE5D,MAAoB4D,EAAEqd,SAAWrd,EAAEsd,WACvCtd,EAAEod,iBACFpM,MAGY,YAAVhR,EAAE5D,KAA+B,KAAVyJ,GAAgBJ,EAASjf,OAAS,EAAG,CAC9D,MAAM+2B,EAAkB,IAAI9X,GAAU+X,UAAUzb,KAAK0b,GAAgB,SAAXA,EAAErM,MACxDmM,IACFzX,EAASyX,EAAgB/0B,SACzBwX,EAAEod,iBAEN,GAuyBUnb,YAAY,8DACZyb,KAAM,EACNx8B,UAAU,kNACVgF,MAAO,CAAEy3B,UAAW,OAAQC,UAAW,cAK3Cv8B,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+BAA8BE,SAAA,EAC3CC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAM0oB,IAAoB,GACnCjpB,UAAU,gMAIV+E,MAAM,0MACN,aAAW,8HAAyB7E,SAAA,EAEpCH,EAAAA,GAAAA,KAACwW,EAAAA,EAAQ,CAACjW,KAAM,GAAIN,UAAU,mBAC9BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,yCAAwCE,SAAC,6CAE3DC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,sNAGwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,yCAAwCE,SAAC,4FACtDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,4bAOzCH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMuvB,KACfjZ,SAAUgO,IAAeF,EAAMxhB,QAAiC,IAAvBsiB,GAAYngB,OACrDtF,UAAS,sDAAAI,OACPykB,IAAeF,EAAMxhB,QAAiC,IAAvBsiB,GAAYngB,OACvC,8CACA,gDACHpF,SAEF2kB,GACC9kB,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAAC13B,KAAM,GAAIN,UAAU,gCAE7BD,EAAAA,GAAAA,KAAC48B,EAAAA,EAAI,CAACr8B,KAAM,GAAIN,UAAU,2BAOlCD,EAAAA,GAAAA,KAAC2d,GAAgB,CACf3e,OAAQiqB,GACRhqB,QAASA,IAAMiqB,IAAoB,GACnCtU,OAAQA,EACRgJ,mBAAqBwD,IAEnB,MAAMyb,EAAW,IAAIC,IAAI,CAAC,SAAU,iBAAkB,WAAY,YAAa,WAAY,aACvFloB,GAAUioB,EAASE,IAAI3b,EAAWpQ,KAEpC2E,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,sBAAsB,CACpEoN,cAAeZ,EAAWpQ,GAC1BkR,QAAS,CAAEC,eAAe,KAEzB6a,KAAK,IAAM/mB,EAAAA,GAAMC,QAAQ,yCAAD7V,OAAY+gB,EAAW1hB,QAC/CmyB,MAAO9S,GAAM9I,EAAAA,GAAMK,OAAO,OAADyI,QAAC,IAADA,OAAC,EAADA,EAAGjH,UAAW,uGAK5CiY,GAAY3O,EAAW9B,QAAS8B,EAAW1hB,UAI/CM,EAAAA,GAAAA,KAACi9B,GAAAA,QAAY,CACXj+B,OAAQqnB,GACRpnB,QAASA,IAAMqnB,IAAoB,GACnCpnB,YAAaqnB,GAAiBrnB,YAC9BC,mBAAoBonB,GAAiBpnB,mBACrCC,aAAcmnB,GAAiBnnB,aAC/BC,YAAaykB,SASrBV,GAAU8Z,YAAc,YAExB,Y,yBEjwFUt4B,EAAAA,EAMAgE,GAAAA,EAMAu0B,GAAAA,EAMAC,GAAAA,EAMA5mB,EAAAA,E,yDCFV,MAycA,GAzcwDzX,IAKjD,IALkD,cACvDs+B,EAAa,iBACbC,EAAgB,gBAChBC,EAAe,kBACfC,GACDz+B,EACC,MAAMO,GAAWC,EAAAA,EAAAA,OACV4kB,EAAOsZ,IAAYl7B,EAAAA,EAAAA,UAAqB,KACxCm7B,EAAgBC,IAAqBp7B,EAAAA,EAAAA,WAAS,IAC9Cq7B,EAAeC,IAAoBt7B,EAAAA,EAAAA,UAAsB,IAAIu6B,MAC7DgB,EAAcC,IAAmBx7B,EAAAA,EAAAA,UAAwC,CAAC,IAC1E4kB,EAAWC,IAAgB7kB,EAAAA,EAAAA,UAAqC,CAAC,IACjEy7B,EAAiBC,IAAsB17B,EAAAA,EAAAA,UAAsB,IAAIu6B,MACjEoB,EAAcC,IAAmB57B,EAAAA,EAAAA,UAAsB,IAAIu6B,MAG3DsB,EAAYC,IAAiB97B,EAAAA,EAAAA,UAAqB,CAAC,IACnD+7B,EAAYC,IAAiBh8B,EAAAA,EAAAA,WAAS,IACtCi8B,EAASC,IAAcl8B,EAAAA,EAAAA,WAAS,IAChCm8B,EAAmBC,IAAwBp8B,EAAAA,EAAAA,UAAsB,IAAIu6B,IAAI,CAAC,YAAa,kBAGxF1Y,GAAa1O,EAAAA,EAAAA,aAAY5H,UAC7B6vB,GAAkB,GAClB,IACE,MAAMn7B,QAAayX,EAAAA,EAAAA,QAA8B,aAAc,CAAEjE,gBAAgB,IACjFynB,EAASj7B,EAAK2hB,OAAS,GACzB,CAAE,MAAO/N,GACP8D,QAAQ5D,MAAM,yBAA0BF,EAC1C,CAAC,QACCunB,GAAkB,EACpB,GACC,IAGGiB,GAAgBlpB,EAAAA,EAAAA,aAAY5H,UAChCmwB,EAAmBtf,GAAQ,IAAIme,IAAIne,GAAMuL,IAAItV,IAC7C,IACE,MAAMpS,QAAayX,EAAAA,EAAAA,QAAM,cAAA5Z,OACTuU,EAAM,kBACpB,CAAEoB,gBAAgB,IAEpB+nB,EAAgBpf,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUkV,GAAI,IAAE,CAAC/J,GAASpS,EAAKg2B,UAAY,KACjE,CAAE,MAAOpiB,GACP8D,QAAQ5D,MAAM,4BAA6BF,GAC3C2nB,EAAgBpf,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUkV,GAAI,IAAE,CAAC/J,GAAS,KAChD,CAAC,QACCqpB,EAAmBtf,IACjB,MAAMkgB,EAAO,IAAI/B,IAAIne,GAErB,OADAkgB,EAAKC,OAAOlqB,GACLiqB,GAEX,GACC,IAGGE,GAAarpB,EAAAA,EAAAA,aAAY5H,UAC7BqwB,EAAgBxf,GAAQ,IAAIme,IAAIne,GAAMuL,IAAItV,IAC1C,IACE,MAAMpS,QAAayX,EAAAA,EAAAA,QAAM,cAAA5Z,OACTuU,EAAM,UACpB,CAAEoB,gBAAgB,IAEpBoR,EAAazI,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUkV,GAAI,IAAE,CAAC/J,GAASpS,EAAK8sB,OAAS,KAC3D,CAAE,MAAOlZ,GACP8D,QAAQ5D,MAAM,yBAA0BF,GACxCgR,EAAazI,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUkV,GAAI,IAAE,CAAC/J,GAAS,KAC7C,CAAC,QACCupB,EAAgBxf,IACd,MAAMkgB,EAAO,IAAI/B,IAAIne,GAErB,OADAkgB,EAAKC,OAAOlqB,GACLiqB,GAEX,GACC,IAGGG,GAAkBtpB,EAAAA,EAAAA,aAAY5H,MAAO8G,EAAgB6O,KACzD8a,GAAc,GACd,IACE,MAAM/7B,QAAayX,EAAAA,EAAAA,QAAM,cAAA5Z,OACTuU,EAAM,mBAAAvU,OAAkBojB,EAAS,qBAC/C,CAAEzN,gBAAgB,IAEpBqoB,EAAc77B,EAAKy8B,KAAO,CAAC,EAC7B,CAAE,MAAO7oB,GACP8D,QAAQ5D,MAAM,+BAAgCF,GAC9CioB,EAAc,CAAC,EACjB,CAAC,QACCE,GAAc,EAChB,GACC,IAGGW,GAAmBxpB,EAAAA,EAAAA,aAAY5H,UACnC,IACE,MAAMtL,QAAamT,EAAAA,EAAAA,IAAO,cAAAtV,OACVuU,EAAM,qBACpB,CAAC,GAGCpS,EAAK0rB,mBAED0Q,EAAchqB,GAEpB2oB,EAAgB3oB,EAAQpS,EAAK0rB,YAC7BjY,EAAAA,GAAMC,QAAQ,oFAElB,CAAE,MAAOE,GACP8D,QAAQ5D,MAAM,gCAAiCF,GAC/CH,EAAAA,GAAMK,MAAM,wHACd,GACC,CAACsoB,EAAerB,KAGnBxpB,EAAAA,EAAAA,WAAU,KACRqQ,KACC,CAACA,KAGJrQ,EAAAA,EAAAA,WAAU,KACJspB,GAAiBC,EACnB0B,EAAgB3B,EAAeC,GAE/Be,EAAc,CAAC,IAEhB,CAAChB,EAAeC,EAAkB0B,KAGrCjrB,EAAAA,EAAAA,WAAU,KACJspB,IAAkBO,EAAcb,IAAIM,KACtCQ,EAAiBlf,GAAQ,IAAIme,IAAIne,GAAMuL,IAAImT,IACtCS,EAAaT,IAChBuB,EAAcvB,GAEXlW,EAAUkW,IACb0B,EAAW1B,KAGd,CAACA,EAAeO,EAAeE,EAAc3W,EAAWyX,EAAeG,IAG1E,MAsBMI,EAAcC,IAClB,IAEE,OADa,IAAI3nB,KAAK2nB,GACVlZ,mBAAmB,QAAS,CAAEmZ,IAAK,UAAWC,MAAO,SACnE,CAAE,MAAApxB,GACA,MAAO,EACT,GAIIqxB,EAAcH,IAClB,IAEE,OADa,IAAI3nB,KAAK2nB,GACVI,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,WACrE,CAAE,MAAAnN,GACA,MAAO,EACT,GAiBIoN,EAA0F,CAC9Fr6B,UAAW,CAAEW,MAAMjG,EAAAA,GAAAA,KAAC4I,GAAAA,EAAU,CAACrI,KAAM,KAAQa,MAAO,iCAASC,MAAO,QACpEu+B,aAAc,CAAE35B,MAAMjG,EAAAA,GAAAA,KAAC+gB,GAAAA,EAAM,CAACxgB,KAAM,KAAQa,MAAO,4EAAiBC,MAAO,OAC3Ew+B,gBAAiB,CAAE55B,MAAMjG,EAAAA,GAAAA,KAACgI,EAAAA,EAAS,CAACzH,KAAM,KAAQa,MAAO,uCAAUC,MAAO,UAC1Ey+B,UAAW,CAAE75B,MAAMjG,EAAAA,GAAAA,KAACgjB,EAAAA,EAAS,CAACziB,KAAM,KAAQa,MAAO,6CAAWC,MAAO,SACrE0+B,MAAO,CAAE95B,MAAMjG,EAAAA,GAAAA,KAACggC,GAAAA,EAAG,CAACz/B,KAAM,KAAQa,MAAO,qBAAOC,MAAO,SAInD4+B,EAAkBz5B,OAAO05B,OAAO9B,GAAY+B,OAAO,CAACC,EAAK35B,IAAY25B,IAAc,OAAP35B,QAAO,IAAPA,OAAO,EAAPA,EAASlB,SAAU,GAAI,GAEzG,OACEnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uBAAsBE,SAAA,EAEnCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAA8BE,UAC3CC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDC,EAAAA,GAAAA,MAAA,MAAIH,UAAU,8DAA6DE,SAAA,EACzEH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,KAAM,0EAGtBP,EAAAA,GAAAA,KAAA,UACEQ,QAAS4jB,EACTnkB,UAAU,4DACV+E,MAAM,2BAAM7E,UAEZH,EAAAA,GAAAA,KAACkb,GAAAA,EAAS,CAAC3a,KAAM,YAMtB+8B,GAAoB2C,EAAkB,IACrC7/B,EAAAA,GAAAA,MAAA,OAAKH,UAAU,2BAA0BE,SAAA,EACvCC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMi+B,GAAYD,GAC3Bv+B,UAAU,wFAAuFE,SAAA,EAEjGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,wCAAuCE,SAAA,EACpDH,EAAAA,GAAAA,KAACqgC,GAAAA,EAAI,CAAC9/B,KAAM,GAAIN,UAAU,qBAC1BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,sBAAqBE,SAAC,yEACtCC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,4BAA2BE,SAAA,CAAC,IAAE8/B,EAAgB,UAE/DzB,GACCx+B,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,GAAIN,UAAU,mBAEjCD,EAAAA,GAAAA,KAAC24B,EAAAA,EAAY,CAACp4B,KAAM,GAAIN,UAAU,qBAIrCu+B,IACCx+B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+CAA8CE,SAC1Dm+B,GACCt+B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,UACpDH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAAC13B,KAAM,GAAIN,UAAU,mCAG/BuG,OAAOC,QAAQ23B,GAAY19B,IAAIuB,IAA0B,IAAxBq+B,EAAU75B,GAAQxE,EACjD,IAAKwE,GAA8B,IAAnBA,EAAQlB,OAAc,OAAO,KAC7C,MAAMoI,EAASgyB,EAAeW,IAAaX,EAAeI,MACpD19B,EAAaq8B,EAAkB3B,IAAIuD,GAEzC,OACElgC,EAAAA,GAAAA,MAAA,OAAoBH,UAAU,cAAaE,SAAA,EAEzCC,EAAAA,GAAAA,MAAA,UACEI,QAASA,KAAM+/B,OA9EbC,EA8E4BF,OA7ElD3B,EAAqBhgB,IACnB,MAAMkgB,EAAO,IAAI/B,IAAIne,GAMrB,OALIkgB,EAAK9B,IAAIyD,GACX3B,EAAKC,OAAO0B,GAEZ3B,EAAK3U,IAAIsW,GAEJ3B,IARa2B,OA+EFvgC,UAAS,0HAAAI,OACY,SAAjBsN,EAAOtM,MAAmB,gBAAkB,GAAE,gCAAAhB,OAC7B,QAAjBsN,EAAOtM,MAAkB,eAAiB,GAAE,gCAAAhB,OAC3B,WAAjBsN,EAAOtM,MAAqB,kBAAoB,GAAE,gCAAAhB,OACjC,UAAjBsN,EAAOtM,MAAoB,iBAAmB,GAAE,gCAAAhB,OAC/B,SAAjBsN,EAAOtM,MAAmB,gBAAkB,GAAE,8BAChDlB,SAAA,CAEDkC,GAAarC,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,MAASP,EAAAA,GAAAA,KAAC24B,EAAAA,EAAY,CAACp4B,KAAM,KAC7DoN,EAAO1H,MACRjG,EAAAA,GAAAA,KAAA,QAAMC,UAAU,cAAaE,SAAEwN,EAAOvM,SACtChB,EAAAA,GAAAA,MAAA,QAAMH,UAAU,4BAA2BE,SAAA,CAAC,IAAEsG,EAAQlB,OAAO,UAI9DlD,IACCrC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,mBAAkBE,SAC9BsG,EAAQ/F,IAAK6W,IACZnX,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAuB,OAAjBg9B,QAAiB,IAAjBA,OAAiB,EAAjBA,EAAoBjmB,EAAM3B,YACzC3V,UAAS,0HAAAI,OACIsN,EAAOtM,MAAK,6CAAAhB,OACrBkX,EAAMkpB,YAAc,EAAI,aAAe,GAAE,oCAC3CtgC,SAAA,EAEFC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,uCAAsCE,SAAEoX,EAAMvS,QAC7DuS,EAAMkpB,YAAc,IACnBzgC,EAAAA,GAAAA,KAAA,QAAMC,UAAU,2CAA0CE,SAAEoX,EAAMmpB,qBAGrEnpB,EAAM6Y,YACLpwB,EAAAA,GAAAA,KAAA,QAAMC,UAAU,yCAAwCE,SACrDo/B,EAAWhoB,EAAM6Y,eAfjB7Y,EAAM3B,iBAvBX0qB,WAuDxBtgC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uCAAsCE,SAClDu9B,GACC19B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,UACpDH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,6BAA6BM,KAAM,OAErC,IAAjB4jB,EAAM5e,QACRnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mBAAkBE,SAAA,EAC/BH,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAAC/3B,UAAU,6BAA6BM,KAAM,MACrDP,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,uDACrCH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,mBACxBW,UAAU,iDAAgDE,SAC3D,gEAKHgkB,EAAMzjB,IAAK0e,IAAO,IAADuhB,EAAAC,EACf,MAAMv+B,EAAau7B,EAAcb,IAAI3d,EAAEpO,IACjC6vB,EAAgBzhB,EAAEpO,KAAOqsB,EACzB7E,EAAWsF,EAAa1e,EAAEpO,KAAO,GACjC8vB,EAAgB9C,EAAgBjB,IAAI3d,EAAEpO,IAE5C,OACE5Q,EAAAA,GAAAA,MAAA,OAAgBH,UAAU,cAAaE,SAAA,EAErCC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAvMNsN,WACE8vB,EAAcb,IAAInoB,GAGnCipB,EAAiBlf,IACf,MAAMkgB,EAAO,IAAI/B,IAAIne,GAErB,OADAkgB,EAAKC,OAAOlqB,GACLiqB,KAGThB,EAAiBlf,GAAQ,IAAIme,IAAIne,GAAMuL,IAAItV,IAEtCkpB,EAAalpB,IAChBgqB,EAAchqB,GAEXuS,EAAUvS,IACbmqB,EAAWnqB,KAuLcmsB,CAAW3hB,EAAEpO,IAC5B/Q,UAAS,iFAAAI,OACPwgC,EACI,yDACA,kCACH1gC,SAAA,CAEF2gC,GACC9gC,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAAC13B,KAAM,GAAIN,UAAU,+BAC3BoC,GACFrC,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAAC7E,KAAM,GAAIN,UAAU,mBAEjCD,EAAAA,GAAAA,KAAC24B,EAAAA,EAAY,CAACp4B,KAAM,GAAIN,UAAU,kBAEnCoC,GACCrC,EAAAA,GAAAA,KAACghC,GAAAA,EAAU,CAACzgC,KAAM,GAAIN,UAAU,mBAEhCD,EAAAA,GAAAA,KAACg4B,EAAAA,EAAM,CAACz3B,KAAM,GAAIN,UAAU,sBAE9BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,6BAA4BE,SACzCif,EAAE1f,MAAI,sBAAAW,OAAW+e,EAAEpO,GAAGxL,MAAM,EAAG,GAAE,SAEnC4Z,EAAE6hB,YAAc,IACf7gC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,qDAAoDE,SAAA,EAClEH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,KACf6e,EAAE6hB,kBAMR5+B,IACCjC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+CAA8CE,SAAA,EAE3DC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,cAAaE,SAAA,EAC1BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8CAA6CE,SAAA,EAC1DH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6CAA4CE,SAAC,oCAC1DC,EAAAA,GAAAA,MAAA,UACEI,QAAUue,IACRA,EAAE2D,kBACFwc,EAAiB9f,EAAEpO,KAErB/Q,UAAU,8FACV+E,MAAM,oDAAW7E,SAAA,EAEjBH,EAAAA,GAAAA,KAAC+3B,EAAAA,EAAI,CAACx3B,KAAM,MACZP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,6BAGTq4B,EAASjzB,OAAS,EACjBizB,EAAS93B,IAAKk4B,IACZ,MAAMsI,EAAmBtI,EAAQ5nB,KAAOssB,EACxC,OACEl9B,EAAAA,GAAAA,MAAA,UAEEI,QAASA,IAAM+8B,EAAgBne,EAAEpO,GAAI4nB,EAAQ5nB,IAC7C/Q,UAAS,gFAAAI,OACP6gC,EACI,+DACA,wCACH/gC,SAAA,EAEHH,EAAAA,GAAAA,KAACmhC,GAAAA,EAAc,CAAC5gC,KAAM,GAAIN,UAAU,qBACpCD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,6BAA4BE,SACzCy4B,EAAQ5zB,OAAS,8BAEpB5E,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oDAAmDE,SAAA,CAC/Dy4B,EAAQwI,cAAgB,IACvBphC,EAAAA,GAAAA,KAAA,QAAAG,SAAOy4B,EAAQwI,iBAEjBphC,EAAAA,GAAAA,KAACqhC,GAAAA,EAAK,CAAC9gC,KAAM,KACbP,EAAAA,GAAAA,KAAA,QAAAG,SAAOg/B,EAAWvG,EAAQC,YAAcD,EAAQH,mBAjB7CG,EAAQ5nB,OAuBnBhR,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6CAA4CE,SAAC,0FAK7C,QAAfwgC,EAAAxZ,EAAU/H,EAAEpO,WAAG,IAAA2vB,OAAA,EAAfA,EAAiBp7B,QAAS,GAAK24B,EAAanB,IAAI3d,EAAEpO,OAClD5Q,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mBAAkBE,SAAA,EAC/BH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,iDAAgDE,SAAC,yCAC7D+9B,EAAanB,IAAI3d,EAAEpO,KAClBhR,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,UACpDH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAAC13B,KAAM,GAAIN,UAAU,kCAGhB,QAFT2gC,EAENzZ,EAAU/H,EAAEpO,WAAG,IAAA4vB,OAAA,EAAfA,EAAiBlgC,IAAKmvB,IACpBzvB,EAAAA,GAAAA,MAAA,OAEEH,UAAU,0GAAyGE,SAAA,EAEnHH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAU,kCAC9BD,EAAAA,GAAAA,KAAA,QAAMC,UAAU,6BAA4BE,SACzC0vB,EAAK5gB,aALH4gB,EAAK7e,aA/FhBoO,EAAEpO,Y,yDC9X1B,MAAMswB,GAAgB,CAAC,eAAgB,aAAc,MAAO,SACtD3K,GAAiB,CACrB,CAAE1V,MAAO,OAAQ7f,MAAO,+CACxB,CAAE6f,MAAO,WAAY7f,MAAO,+CAC5B,CAAE6f,MAAO,QAAS7f,MAAO,4DACzB,CAAE6f,MAAO,cAAe7f,MAAO,sCAG3BmgC,GAAmB,CACvB,CAAEtgB,MAAO,QAAS7f,MAAO,kEACzB,CAAE6f,MAAO,UAAW7f,MAAO,kEAC3B,CAAE6f,MAAO,WAAY7f,MAAO,iEAC5B,CAAE6f,MAAO,YAAa7f,MAAO,+CAC7B,CAAE6f,MAAO,QAAS7f,MAAO,oCAuzB3B,GApzBmBrC,IAAyD,IAADyiC,EAAA,IAAvD,OAAE5sB,EAAM,SAAE2O,EAAQ,eAAEC,EAAiB,CAAC,EAAC,QAAEvkB,GAASF,EACpE,MAAMO,GAAWC,EAAAA,EAAAA,MACXq7B,GAAW6G,EAAAA,EAAAA,OAGVC,EAAgBC,IAAqBp/B,EAAAA,EAAAA,WAAS,IAC9Cq/B,EAAmBC,IAAwBt/B,EAAAA,EAAAA,WAAS,IACpDu/B,EAAsBC,IAA2Bx/B,EAAAA,EAAAA,WAAS,IAG1Dy/B,EAAeC,IAAoB1/B,EAAAA,EAAAA,UAAS,OAC5C2/B,EAAkBC,IAAuB5/B,EAAAA,EAAAA,WAAS,GAGnD6/B,GAAeC,EAAAA,GAAAA,GAAgB,CAAEztB,SAAQ2O,WAAUC,oBAGlD8e,EAAaC,IAAkBhgC,EAAAA,EAAAA,UAAS,IAEzCigC,EAAwB5tB,EAAM,2BAAAvU,OAA8BuU,GAAW,MAGtE0oB,EAAkBmF,IAAuBlgC,EAAAA,EAAAA,UAAS,KACvD,IACE,IAAKqS,EAAQ,OAAO,KACpB,MACM8tB,EADS,IAAIC,gBAAgB9U,OAAO+M,SAAS5e,QAAU,IACtC2E,IAAI,WACrBiiB,EAAcJ,EAAwBK,aAAaC,QAAQN,GAAyB,KAC1F,OAAOE,GAAWE,GAAe,IACnC,CAAE,MAAA10B,GACA,OAAO,IACT,KAIK60B,EAAiBC,IAAsBzgC,EAAAA,EAAAA,WAAS,IAChDmjB,EAAaC,IAAkBpjB,EAAAA,EAAAA,UAAS,KACxC0gC,EAAWC,IAAgB3gC,EAAAA,EAAAA,WAAS,GACrCinB,GAAevW,EAAAA,EAAAA,QAAO,OACrBkwB,EAAgBC,IAAqB7gC,EAAAA,EAAAA,UAAS,KAC9C8gC,EAAcC,IAAmB/gC,EAAAA,EAAAA,UAASqS,GAAU,KAGnDpS,KAAM+gC,IAAqBC,EAAAA,GAAAA,KAC7B1f,KAA4B,OAAhByf,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBE,QAAwB,OAAhBF,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBG,oBAAqB,QAAQj/B,cACrFk/B,GAAqC,WAAX,OAAhBJ,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBpT,MAC5BpM,GAAYud,GAAc58B,SAASof,KAAa6f,GAChD3f,GAA4B,eAAbF,IAA6B6f,IAGlD5vB,EAAAA,EAAAA,WAAU,KACR,MAAM6vB,EAAeA,KACf/V,OAAOgW,WAAa,KACtBlC,GAAkB,GAClBE,GAAqB,GACrBE,GAAwB,IACflU,OAAOgW,WAAa,OAC7BhC,GAAqB,GACrBE,GAAwB,KAM5B,OAFA6B,IACA/V,OAAOC,iBAAiB,SAAU8V,GAC3B,IAAM/V,OAAOE,oBAAoB,SAAU6V,IACjD,KAGH7vB,EAAAA,EAAAA,WAAU,KAAO,IAAD+vB,EACD,OAARlJ,QAAQ,IAARA,GAAe,QAAPkJ,EAARlJ,EAAU75B,aAAK,IAAA+iC,GAAfA,EAAiBC,cACtBzkC,EAAS,GAADe,OAAIu6B,EAASoJ,UAAQ3jC,OAAGu6B,EAAS5e,QAAU,IAAM,CAAExQ,SAAS,EAAMzK,MAAO,CAAC,KAEjF,CAAS,OAAR65B,QAAQ,IAARA,GAAe,QAAP4G,EAAR5G,EAAU75B,aAAK,IAAAygC,OAAP,EAARA,EAAiBuC,gBAGrBhwB,EAAAA,EAAAA,WAAU,KAUJa,GAToB9G,WACtB,IACE,MAAMtL,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,WAAW,CAAEoB,gBAAgB,IAC3EusB,EAAe//B,EAAKyhC,OAAS,GAC/B,CAAE,MAAO7tB,GACP8D,QAAQ5D,MAAM,+BAAgCF,EAChD,GAIA8tB,IAED,CAACtvB,IAGJ,MAAMuvB,IAAgBzuB,EAAAA,EAAAA,aAAY5H,UAEhC,IAAKiW,IAAaue,EAAY/8B,QAAU,GAEtC,MAAO,CAAE2Q,SAAS,EAAOwgB,OAAQ,SAGnC,IACE,MAAM0N,QAAgBzuB,EAAAA,EAAAA,IAAQ,cAADtV,OAAeuU,EAAM,WAAWoc,GAE7D,OADAuR,EAAe5jB,GAAQ,CAACylB,KAAYzlB,IAC7B,CAAEzI,SAAS,EACpB,CAAE,MAAOE,GACP8D,QAAQ5D,MAAM,sBAAuBF,EACvC,CACA,MAAO,CAAEF,SAAS,IACjB,CAACtB,EAAQmP,GAAWue,EAAY/8B,SAe7B8+B,KAZkB3uB,EAAAA,EAAAA,aAAY5H,UAClC,IAGE,aAFM+M,EAAAA,EAAAA,IAAU,cAADxa,OAAeuU,EAAM,YAAAvU,OAAWikC,IAC/C/B,EAAe5jB,GAAQA,EAAK7N,OAAOkgB,GAAQA,EAAKhgB,KAAOszB,KAChD,CACT,CAAE,MAAOluB,GACP8D,QAAQ5D,MAAM,wBAAyBF,EACzC,CACA,OAAO,GACN,CAACxB,KAGwBc,EAAAA,EAAAA,aAAa+N,IACvCgf,EAAoBhf,GACpB,IAKE,GAJI+e,GAAyB/e,GAC3Bof,aAAa0B,QAAQ/B,EAAuBj3B,OAAOkY,IAGjD7O,GAAU6O,EAAW,CACvB,MAAM+gB,EAAS,IAAI7B,gBAAgB/H,EAAS5e,QAAU,IACtDwoB,EAAOptB,IAAI,UAAW7L,OAAOkY,IAC7BnkB,EAAS,UAADe,OAAWuU,EAAM,UAAAvU,OAASmkC,EAAO5sB,YAAc,CAAEpM,SAAS,GACpE,CACF,CAAE,MAAA+mB,GACA,GAED,CAAC3d,EAAQ4tB,EAAuB5H,EAAS5e,OAAQ1c,MAIpDyU,EAAAA,EAAAA,WAAU,KACR,IAAKa,EAAQ,OACb,MACM8tB,EADS,IAAIC,gBAAgB/H,EAAS5e,QAAU,IAC/B2E,IAAI,WACrBiiB,EAAcJ,EAAwBK,aAAaC,QAAQN,GAAyB,KACpF3D,EAAO6D,GAAWE,GAAe,KAEnC/D,IAASvB,GACXmF,EAAoB5D,IAErB,CAACjqB,EAAQ0oB,EAAkBkF,EAAuB5H,EAAS5e,SAG9D,MAAMyoB,IAAexxB,EAAAA,EAAAA,QAAO,OAGrByxB,GAAQC,KAAapiC,EAAAA,EAAAA,WAAS,GAG/BqiC,IAAqBlvB,EAAAA,EAAAA,aAAaf,IAAe,IAADkwB,EAC5B,QAAxBA,EAAIJ,GAAa/wB,eAAO,IAAAmxB,GAApBA,EAAsBnb,iBACxB+a,GAAa/wB,QAAQgW,gBAAgB/U,IAEtC,IAGGmwB,IAAyBpvB,EAAAA,EAAAA,aAAY5H,UAAa,IAADi3B,EACrD,GAAwB,QAAxBA,EAAIN,GAAa/wB,eAAO,IAAAqxB,GAApBA,EAAsB3a,YAAa,CACrC,MAAM5F,EAAWigB,GAAa/wB,QAAQ0W,cACtC,GAAwB,IAApB5F,EAASjf,OAEX,YADA0Q,EAAAA,GAAMK,MAAM,gGAId,MAAMlU,EAAOoiB,EAAS9jB,IAAI87B,GAAC,GAAAn8B,OACX,SAAXm8B,EAAErM,KAAkB,kCAAW,wCAAS,OAAA9vB,OAAMm8B,EAAEj1B,UACnDsJ,KAAK,qBAED9C,UAAUC,UAAUC,UAAU7L,GACpCuiC,IAAU,GACV1uB,EAAAA,GAAMC,QAAQ,wEACdvC,WAAW,IAAMgxB,IAAU,GAAQ,IACrC,GACC,IAGGK,IAA6BtvB,EAAAA,EAAAA,aAAY,KAAO,IAADuvB,EACnD,GAAwB,QAAxBA,EAAIR,GAAa/wB,eAAO,IAAAuxB,GAApBA,EAAsB7a,YAAa,CACrC,MAAM5F,EAAWigB,GAAa/wB,QAAQ0W,cACtC,GAAwB,IAApB5F,EAASjf,OAEX,YADA0Q,EAAAA,GAAMK,MAAM,gGAKd,MAAMtR,EAAK,oEAAA3E,OAAqBkjB,GAAY,sBACtC3d,GAAO,IAAI6R,MAAOyO,mBAAmB,SACrCsL,EAAOhN,EAAS9jB,IAAK87B,IACzB,MAAM0I,EAAiB,SAAX1I,EAAErM,KAAkB,qBAAQ,2BAClChhB,EAAO5D,OAAOixB,EAAEj1B,SAAW,IAC9BiE,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,MAAO,SAClB,MAAM,OAANnL,OAAc6kC,EAAG,2DAAA7kC,OAA0D8O,EAAI,YAC9E0B,KAAK,MACFzB,EAAI,gFAAA/O,OAAmF2E,EAAK,4CAAA3E,OAAkBuF,EAAI,QAAAvF,OAAOmxB,EAAI,kBAE7HniB,EAAO,IAAIC,KAAK,CAACF,GAAO,CAAErK,KAAM,uBAChCwK,EAAMC,IAAIC,gBAAgBJ,GAC1BrI,EAAIlB,SAAS4J,cAAc,KACjC1I,EAAE2I,KAAOJ,EACTvI,EAAE4I,SAAQ,4BAAAvP,OAAWkjB,GAAY,qBAAK,KAAAljB,QAAI,IAAIoX,MAAO4Y,cAAchgB,MAAM,KAAK,GAAE,QAChFrJ,EAAE6I,QACFL,IAAIM,gBAAgBP,GACpB0G,EAAAA,GAAMC,QAAQ,iEAChB,GACC,CAACqN,IAGE4hB,IAAqBzvB,EAAAA,EAAAA,aAAY,KACrCstB,GAAmB,IAClB,IAIGoC,GAAkB,IAAItI,IAAI,CAC9B,SAAU,iBAAkB,WAAY,YAAa,WAAY,aAG7DuI,IAAwB3vB,EAAAA,EAAAA,aAAY5H,UACxC,IAAK8G,EAEH,YADAqB,EAAAA,GAAMK,MAAM,sIAQd,GAHA2rB,EAAiB,MAGbmD,GAAgBrI,IAAIuI,GAAe,CACrC,IAAK,IAADC,QAEI5vB,EAAAA,EAAAA,IAAQ,cAADtV,OAAewb,mBAAmBjH,GAAO,sBAAsB,CAC1EoN,cAAesjB,EACfpjB,QAAS,CAAEC,eAAe,KAE5B,MAAMqjB,GAAoE,QAA1DD,EAAAnD,EAAa1iB,aAAaoB,KAAK1B,GAAKA,EAAEpO,KAAOs0B,UAAa,IAAAC,OAAA,EAA1DA,EAA4D3lB,UAAW0lB,EACvFrvB,EAAAA,GAAMC,QAAQ,yCAAD7V,OAAYmlC,GAC3B,CAAE,MAAOpvB,GACPH,EAAAA,GAAMK,OAAS,OAAHF,QAAG,IAAHA,OAAG,EAAHA,EAAK0B,UAAW,qGAC9B,CACA,MACF,CAGA,MAAM2tB,EAAMrD,EAAa1iB,aAAaoB,KAAK1B,GAAKA,EAAEpO,KAAOs0B,GACzD,GAAIG,EAAK,CAEP,MA0BM5iB,EA1BqB,CAEzBza,SAAU,4lBACV6U,YAAa,umBACbC,gBAAiB,yiBACjBK,cAAe,odAEf1U,QAAS,gcACTvC,SAAU,qdAEVo/B,WAAY,qeACZC,gBAAiB,uaACjBtoB,gBAAiB,+dACjBC,kBAAmB,qgBAEnBsoB,kBAAmB,obACnB1Q,YAAa,qZACb2Q,UAAW,6YACXC,aAAc,qZAEdjR,UAAW,+UACXkR,mBAAoB,qYACpBC,mBAAoB,yUACpBC,oBAAqB,iYAGWX,IAAa,uDAAAjlC,OAC9BolC,EAAI7lB,QAAO,0PAE5BiO,OAAOqY,cACL,IAAIC,YAAY,YAAa,CAC3BpU,OAAQ,CAAElP,SAAQmN,YAAayV,EAAI7lB,WAGzC,GACC,CAAChL,EAAQwtB,EAAa1iB,eAEnB0mB,IAAoB1wB,EAAAA,EAAAA,aAAa2wB,IAErCnsB,QAAQ4Z,IAAI,kBAAmBuS,IAC9B,IAEGC,IAAsB5wB,EAAAA,EAAAA,aAAa+F,IAEvCvB,QAAQ4Z,IAAI,oBAAqBrY,IAChC,KAGH1H,EAAAA,EAAAA,WAAU,KACR,IAAIwyB,GAAQ,EAqBZ,OApBAz4B,iBACE,GAAKi1B,EACL,GAAInuB,EACF0uB,EAAgB1uB,QAGlB,IACE,MAAMpS,QAAayX,EAAAA,EAAAA,QAAO,aAAc,CAAEjE,gBAAgB,IACpDmO,GAAY,OAAJ3hB,QAAI,IAAJA,OAAI,EAAJA,EAAM2hB,QAAS,GAC7B,IAAKoiB,EAAO,OACZnD,EAAkBjf,IAEbkf,GAAgBlf,EAAM5e,OAAS,GAClC+9B,EAAgBnf,EAAM,GAAGnT,GAE7B,CAAE,MAAOoF,GACP8D,QAAQ5D,MAAM,wBAAyBF,EACzC,CACF,CACAowB,GACO,KAAQD,GAAQ,IAEtB,CAACxD,EAAiBnuB,IAGrB,MAAM6xB,IAAmB/wB,EAAAA,EAAAA,aAAaqJ,IACpC,MAAMuQ,EAAQtmB,MAAM6yB,KAAK9c,EAAE1S,OAAOijB,OAAS,IACrCoX,EAAkB,CAAC,OAAQ,OAAQ,OAAQ,QAAS,QAAS,OAAQ,QAAS,QAG9EC,EAAarX,EAAMxe,OAAO+e,IAC9B,MAAM+W,EAAM,IAAM/W,EAAKnwB,KAAK2Q,MAAM,KAAKojB,MAAMhvB,cAC7C,OAAKiiC,EAAgBhiC,SAASkiC,KAI1B/W,EAAKtvB,KARK,YASZ0V,EAAAA,GAAMK,MAAM,yEAADjW,OAAmBwvB,EAAKnwB,KAAI,gCAChC,IALPuW,EAAAA,GAAMK,MAAM,sFAADjW,OAAsBwvB,EAAKnwB,QAC/B,KASXimB,EAAehH,IACb,MAAMkoB,EAAgBloB,EAAKje,IAAIovB,GAAKA,EAAEpwB,MAChConC,EAAWH,EAAW71B,OAAOgf,IAAM+W,EAAcniC,SAASorB,EAAEpwB,OAClE,MAAO,IAAIif,KAASmoB,EAASpmC,IAAImvB,IAAI,CACnCA,OACAnwB,KAAMmwB,EAAKnwB,KACXa,MAAOsvB,EAAKtvB,KAAO,KAAO,MAAMwmC,QAAQ,GAAK,MAC7CnlC,OAAQ,OACRolC,aAAc,QACdvS,mBAAoB,SAKpBjL,EAAa9V,UACf8V,EAAa9V,QAAQuN,MAAQ,KAE9B,IAGGgmB,IAAoBvxB,EAAAA,EAAAA,aAAY5H,UACpC,MAAMmiB,EAAkBrb,GAAUyuB,EAClC,GAA2B,IAAvB3d,EAAYngB,OAAc,OAC9B,IAAK0qB,EAEH,YADAha,EAAAA,GAAMK,MAAM,iGAQd,GAH6BoP,EAAY9X,KACtCkiB,GAAmB,aAAbA,EAAEluB,UAA2BkuB,EAAE2E,qBAAuBlpB,OAAOukB,EAAE2E,oBAAoBrxB,SAG1F6S,EAAAA,GAAMK,MAAM,iLADd,CAKA4sB,GAAa,GAEb,IAAK,IAADgE,EAEF,MAAMC,EAAK,QAAA9mC,OAAW4vB,IACtBmX,EAAAA,GAAAA,IAAe,CACbp2B,GAAIm2B,EACJpiC,KAAM,OACNrF,KAAM6jB,IAA+D,QAAvD2jB,EAAK/D,EAAeriB,KAAK1B,GAAKA,EAAEpO,KAAOif,UAAgB,IAAAiX,OAAA,EAAlDA,EAAoDxnC,OAAS,qBAChF2nC,WAAY3hB,EAAYngB,OACxB+hC,UAAW5hB,EAAYhlB,IAAIovB,IAAC,CAC1B7gB,SAAU6gB,EAAEpwB,KACZigB,OAAQ,UACR4nB,UAAU,OAId,MAAM3W,EAAW,IAAIC,SAGrBD,EAASE,OAAO,iBAAkB,QAC9BwM,GAEF1M,EAASE,OAAO,kBAAmBwM,GAIrC,MAAMkK,EAAe9hB,EAAYhlB,IAAIovB,GAAKA,EAAEkX,cAAgB,SACtDS,EAAc/hB,EAAYhlB,IAAIovB,GAAKA,EAAEluB,QAAU,QAC/C8lC,EAAsBhiB,EAAYhlB,IAAIovB,GAAmB,aAAbA,EAAEluB,QAAyBkuB,EAAE2E,oBAA4B,IAC3G7D,EAASE,OAAO,iBAAkBG,KAAKC,UAAUsW,IACjD5W,EAASE,OAAO,eAAgBG,KAAKC,UAAUuW,IAC/C7W,EAASE,OAAO,wBAAyBG,KAAKC,UAAUwW,IAExDhiB,EAAYyL,QAAQrB,IAClBc,EAASE,OAAO,QAAShB,EAAED,cAGvB8X,EAAAA,EAAAA,IAAU,cAADtnC,OACCwb,mBAAmBoU,GAAgB,UACjDW,EACA,CAAE5a,gBAAgB,EAAM4xB,UAAW,MAGrC3xB,EAAAA,GAAMC,QAAQ,GAAD7V,OAA2B,IAAvBqlB,EAAYngB,OAAe,gEAAa,GAAAlF,OAAMqlB,EAAYngB,OAAM,kEAAc,2CAE/F,IACEsoB,OAAOqY,cAAc,IAAIC,YAAY,eAAgB,CAAEpU,OAAQ,CAAEnd,OAAQqb,EAAiBxM,UAAW6Z,KACvG,CAAE,MAAArL,GACA,CAIF+Q,GAAmB,GACnBrd,EAAe,GAEjB,CAAE,MAAOvP,GACP8D,QAAQ5D,MAAM,iBAAkBF,GAChCH,EAAAA,GAAMK,MAAMF,EAAI0B,SAAW,2GAC7B,CAAC,QACCorB,GAAa,EACf,CA/DA,GAgEC,CAACxd,EAAa9Q,EAAQyuB,EAAc9f,EAAU4f,EAAgB7F,IAG3DuK,IAAmBnyB,EAAAA,EAAAA,aAAaoyB,IACpCniB,EAAehH,GAAQA,EAAK7N,OAAOgf,GAAKA,EAAEpwB,OAASooC,KAClD,IAEH,OACE1nC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uFAAuFC,IAAI,MAAKC,SAAA,EAE7GC,EAAAA,GAAAA,MAAA,UAAQH,UAAU,wGAAuGE,SAAA,EACvHC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,+BAA8BE,SAAC,8BAC7CH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,gBAAeE,SAAC,OAChCH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,+CAA8CE,SAC3DojB,GAAY,2DAKjBnjB,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EAEtCH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMqhC,GAAsBD,GACrC3hC,UAAS,oCAAAI,OACPuhC,EAAoB,+BAAiC,oDAEvD58B,MAAO48B,EAAoB,+FAAsB,yFAAmBzhC,SAEnEyhC,GAAoB5hC,EAAAA,GAAAA,KAAC+nC,EAAAA,EAAe,CAACxnC,KAAM,MAASP,EAAAA,GAAAA,KAACgoC,EAAAA,EAAc,CAACznC,KAAM,QAG7EP,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMmhC,GAAmBD,GAClCzhC,UAAS,oCAAAI,OACPqhC,EAAiB,mCAAqC,oDAExD18B,MAAO08B,EAAiB,wFAAoB,kFAAiBvhC,SAE5DuhC,GAAiB1hC,EAAAA,GAAAA,KAACioC,EAAAA,EAAc,CAAC1nC,KAAM,MAASP,EAAAA,GAAAA,KAACkoC,EAAAA,EAAa,CAAC3nC,KAAM,OAIvEmhC,IACC1hC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAA8BE,SAC1C,CAAC,KAAM,KAAM,MAAMO,IAAKynC,IACvBnoC,EAAAA,GAAAA,KAAA,UAEEQ,QAASA,IAAMyhC,EAAiBkG,GAChCloC,UAAS,+CAAAI,OACP2hC,IAAkBmG,EACd,2CACA,uDAENnjC,MAAiB,OAAVmjC,EAAiB,8CAAuB,OAAVA,EAAiB,gEAAgB,gEAAchoC,SAEnFgoC,EAAMC,eATFD,OAebnoC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BAGfD,EAAAA,GAAAA,KAAA,UACEQ,QAASskC,GACT7kC,UAAU,oFACV+E,MAAM,oDAAW7E,SAEhBukC,IAAS1kC,EAAAA,GAAAA,KAACa,EAAAA,EAAK,CAACN,KAAM,GAAIN,UAAU,oBAAsBD,EAAAA,GAAAA,KAAC8O,EAAAA,EAAI,CAACvO,KAAM,QAGzEP,EAAAA,GAAAA,KAAA,UACEQ,QAASwkC,GACT/kC,UAAU,oFACV+E,MAAM,oDAAW7E,UAEjBH,EAAAA,GAAAA,KAACgQ,EAAAA,EAAQ,CAACzP,KAAM,QAGlBP,EAAAA,GAAAA,KAAA,UACEC,UAAU,oFACV+E,MAAM,uCAAQ7E,UAEdH,EAAAA,GAAAA,KAACqoC,EAAAA,EAAQ,CAAC9nC,KAAM,OAGjBtB,IACCmB,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+BACfD,EAAAA,GAAAA,KAAA,UACEQ,QAASvB,EACTgB,UAAU,wFACV+E,MAAM,+CAAW7E,UAEjBH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,iBAQnBH,EAAAA,GAAAA,MAAA,OAAKH,UAAU,sCAAqCE,SAAA,EAElDH,EAAAA,GAAAA,KAAA,OACEC,UAAS,kHAAAI,OACPuhC,EAAoB,mBAAqB,iBACxCzhC,SAEFyhC,IACC5hC,EAAAA,GAAAA,KAACsoC,GAAkB,CACjBjL,cAAezoB,EACf0oB,iBAAkBA,EAClBC,gBAAiBA,CAACgL,EAAgBC,KAEhCnE,GAAoBmE,GAChBD,IAAmB3zB,GAErBtV,EAAS,UAADe,OAAWkoC,EAAc,kBAAAloC,OAAiBmoC,KAGtDhL,kBAAmBoH,QAMzB5kC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uDAAsDE,UACnEH,EAAAA,GAAAA,KAACojB,GAAS,CACRE,IAAKmhB,GACL7vB,OAAQA,EACR2O,SAAUA,EACVC,eAAgBA,EAChBC,UAAW6Z,EACX5Z,gBAAiB2gB,GACjB1gB,UAAWwgB,GACXvgB,eAAgBuhB,GAChBrhB,SAAUA,GACVC,UAAWA,GACXC,aAAcA,GAEdC,oBACW,OAAR2W,QAAQ,IAARA,GAAAA,EAAU75B,OAAS65B,EAAS75B,MAAMgjC,aAAgBnJ,EAAS75B,MAAMgjC,aAAe,KAEnF7f,2BACW,OAAR0W,QAAQ,IAARA,GAAAA,EAAU75B,OAAS65B,EAAS75B,MAAM0nC,oBAAuB7N,EAAS75B,MAAM0nC,oBAAsB,SAMpG3G,IACC9hC,EAAAA,GAAAA,KAAC0oC,GAAAA,EAAY,CACXhpB,aAAc0iB,EAAa1iB,aAC3BqR,QAASqR,EAAarR,QACtB4X,gBAAiB,GACjBC,YAAaxG,EAAawG,aAAe,GACzCC,kBAAmBxD,GACnByD,cAAe1C,GACf2C,gBAAkB/3B,GAAOkJ,QAAQ4Z,IAAI,YAAa9iB,MAKtDhR,EAAAA,GAAAA,KAAA,OACEC,UAAS,kHAAAI,OACPqhC,EAAiB,mBAAqB,iBACrCvhC,SAEFuhC,IACC1hC,EAAAA,GAAAA,KAACgpC,GAAAA,EAAc,CACbC,aAAcjH,EACdkH,cAAe9G,EAAa8G,cAC5BC,OAAQ/G,EAAa+G,OACrBC,OAAQhH,EAAagH,OACrBC,OAAQjH,EAAaiH,OACrBC,cAAerH,EACfsH,gBAAiBjD,GACjBkD,aAAeC,GAAYvvB,QAAQ4Z,IAAI,iBAAkB2V,GACzDC,aAAeC,GAAYzvB,QAAQ4Z,IAAI,iBAAkB6V,GACzDd,kBAAmBxD,UAO1BtC,IACC/iC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uFAAsFE,UACnGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,mFAAkFE,SAAA,EAE/FC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,gGAA+FE,SAAA,EAC5GC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAC4pC,EAAAA,EAAM,CAACrpC,KAAM,MACdP,EAAAA,GAAAA,KAAA,MAAIC,UAAU,YAAWE,SAAC,qGAE5BH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KAAQwiC,GAAmB,GAAQrd,EAAe,KAC3D1lB,UAAU,qDAAoDE,UAE9DH,EAAAA,GAAAA,KAACS,EAAAA,EAAC,CAACF,KAAM,WAKbH,EAAAA,GAAAA,MAAA,OAAKH,UAAU,gBAAeE,SAAA,EAE1ByU,IACAxU,EAAAA,GAAAA,MAAA,OAAKH,UAAU,YAAWE,SAAA,EACxBC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDH,EAAAA,GAAAA,KAAA,SAAOC,UAAU,8BAA6BE,SAAC,8DAC/CH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,mBACxBW,UAAU,sDACV+E,MAAM,2DAAa7E,SACpB,iEAIHC,EAAAA,GAAAA,MAAA,UACE6gB,MAAOoiB,EACPniB,SAAWnC,GAAMukB,EAAgBvkB,EAAE1S,OAAO4U,OAC1ChhB,UAAU,mFAAkFE,SAAA,EAE5FH,EAAAA,GAAAA,KAAA,UAAQihB,MAAM,GAAGnK,UAAQ,EAAA3W,SAAC,gDACzBgjC,EAAeziC,IAAK0e,IACnBpf,EAAAA,GAAAA,KAAA,UAAmBihB,MAAO7B,EAAEpO,GAAG7Q,SAC5Bif,EAAE1f,MAAQ0f,EAAEkZ,WAAalZ,EAAEpO,IADjBoO,EAAEpO,YASvB5Q,EAAAA,GAAAA,MAAA,OACEH,UAAU,gJACVO,QAASA,KAAA,IAAAy7B,EAAA,OAA0B,QAA1BA,EAAMzS,EAAa9V,eAAO,IAAAuoB,OAAA,EAApBA,EAAsBpsB,SAAQ1P,SAAA,EAE7CH,EAAAA,GAAAA,KAAA,SACEsjB,IAAKkG,EACLzkB,KAAK,OACLg3B,UAAQ,EACRC,OAAO,6CACP9a,SAAUulB,GACVxmC,UAAU,YAEZD,EAAAA,GAAAA,KAAC4pC,EAAAA,EAAM,CAACrpC,KAAM,GAAIN,UAAU,gCAC5BD,EAAAA,GAAAA,KAAA,KAAGC,UAAU,gBAAeE,SAAC,2JAC7BH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,2EAI3CulB,EAAYngB,OAAS,IACpBnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,qCAAoCE,SAAA,EACjDC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,wBAAuBE,SAAA,CAAC,wEAAeulB,EAAYngB,OAAO,QACtEmgB,EAAYhlB,IAAKmvB,IAChB7vB,EAAAA,GAAAA,KAAA,OAEEC,UAAU,+DAA8DE,UAExEC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAC+B,EAAAA,EAAQ,CAACxB,KAAM,GAAIN,UAAU,wCAC9BG,EAAAA,GAAAA,MAAA,OAAKH,UAAU,iBAAgBE,SAAA,EAC7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0CAAyCE,SAAA,EACtDH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,yBAAwBE,SAAE0vB,EAAKnwB,QAC/CM,EAAAA,GAAAA,KAAA,QAAMC,UAAU,8BAA6BE,SAAE0vB,EAAKtvB,WAItDH,EAAAA,GAAAA,MAAA,OAAKH,UAAU,8BAA6BE,SAAA,EAC1CH,EAAAA,GAAAA,KAAA,UACEihB,MAAO4O,EAAKjuB,QAAU,OACtBsf,SAAWnC,IACT,MAAM0c,EAAY1c,EAAE1S,OAAO4U,MAC3B0E,EAAgBhH,GAASA,EAAKje,IAAKovB,GAAMA,EAAEpwB,OAASmwB,EAAKnwB,MAAI+J,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQqmB,GAAC,IAAEluB,OAAQ65B,IAAc3L,KAEhG7vB,UAAU,8EACV+E,MAAM,6EAAgB7E,SAErBw2B,GAAej2B,IAAImpC,IAClB7pC,EAAAA,GAAAA,KAAA,UAAwBihB,MAAO4oB,EAAI5oB,MAAM9gB,SAAE0pC,EAAIzoC,OAAlCyoC,EAAI5oB,WAIrBjhB,EAAAA,GAAAA,KAAA,UACEihB,MAAO4O,EAAKmX,cAAgB,QAC5B9lB,SAAWnC,IACT,MAAM+qB,EAAU/qB,EAAE1S,OAAO4U,MACzB0E,EAAgBhH,GAASA,EAAKje,IAAKovB,GAAMA,EAAEpwB,OAASmwB,EAAKnwB,MAAI+J,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQqmB,GAAC,IAAEkX,aAAc8C,IAAYha,KAEpG7vB,UAAU,8EACV+E,MAAM,8CAAU7E,SAEfohC,GAAiB7gC,IAAImpC,IACpB7pC,EAAAA,GAAAA,KAAA,UAAwBihB,MAAO4oB,EAAI5oB,MAAM9gB,SAAE0pC,EAAIzoC,OAAlCyoC,EAAI5oB,aAMN,aAAhB4O,EAAKjuB,SACJ5B,EAAAA,GAAAA,KAAA,OAAKC,UAAU,OAAME,UACnBH,EAAAA,GAAAA,KAAA,SACEihB,MAAO4O,EAAK4E,oBAAsB,GAClCvT,SAAWnC,IACT,MAAMgrB,EAAIhrB,EAAE1S,OAAO4U,MACnB0E,EAAgBhH,GAASA,EAAKje,IAAKovB,GAAMA,EAAEpwB,OAASmwB,EAAKnwB,MAAI+J,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQqmB,GAAC,IAAE2E,mBAAoBsV,IAAMja,KAEpG9O,YAAY,6FACZ/gB,UAAU,oHAMlBD,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMqnC,GAAiBhY,EAAKnwB,MACrCO,UAAU,uEACV+E,MAAM,qBAAK7E,UAEXH,EAAAA,GAAAA,KAACgqC,EAAAA,EAAM,CAACzpC,KAAM,WA/DbsvB,EAAKnwB,WAwElBU,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kBAAiBE,SAAA,EAC9BH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KAAQwiC,GAAmB,GAAQrd,EAAe,KAC3D1lB,UAAU,uGAAsGE,SACjH,oCAGDH,EAAAA,GAAAA,KAAA,UACEQ,QAASymC,GACTnwB,SAAiC,IAAvB4O,EAAYngB,QAAgB09B,EACtChjC,UAAU,gPAA+OE,SAExP8iC,GACC7iC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAAC13B,KAAM,GAAIN,UAAU,iBAAiB,kCAIhDG,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAAC4pC,EAAAA,EAAM,CAACrpC,KAAM,KAAM,4BACdmlB,EAAYngB,OAAS,EAAC,IAAAlF,OAAOqlB,EAAYngB,OAAM,KAAM,YAMnEvF,EAAAA,GAAAA,KAAA,KAAGC,UAAU,oCAAmCE,SAAC,0XCp0BrD8pC,EAAAA,EASA7uB,GAAAA,EASA5S,EAAAA,EASAA,EAAAA,EAQA64B,GAAAA,EAQAtgB,GAAAA,EAQAA,GAAAA,EAQAga,EAAAA,EAQAsG,GAAAA,EAQAv8B,GAAAA,EAQAic,GAAAA,E,0BC9FV,MAAMmpB,GAAe,CACnB,iBACA,SACA,WACA,WACA,UACA,aACA,eACA,SAGIC,GAAyC,CAC7C,MAAS,iCACT,SAAY,iCACZ,OAAU,sEACV,SAAY,uCACZ,QAAW,iCACX,MAAS,iCACT,QAAW,uCACX,MAAS,iCAET,eAAkB,uCAClB,OAAU,iCACV,SAAY,uCACZ,SAAY,uCACZ,QAAW,oDACX,WAAc,yDACd,aAAgB,eAChB,MAAS,kCAoFX,GA7EgDprC,IAAmB,IAAlB,SAAEwkB,GAAUxkB,EAC3D,MACMqrC,GADW3I,EAAAA,EAAAA,MAC4BuC,SAAS3zB,MAAM,KAAKS,OAAOu5B,SAwBlEC,EAAoBA,CAACC,EAAiB3pC,IAEV,UAA5BwpC,EAAaxpC,EAAQ,KACrBwpC,EAAaxpC,EAAQ,KAzBL2pC,IACZL,GAAmCxlC,SAAS6lC,GAyBhDC,CAAaJ,EAAaxpC,EAAQ,IAMxC,OAA4B,IAAxBwpC,EAAa7kC,OACR,MAIPnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uCAAuCC,IAAI,MAAKC,SAAA,EAC7DC,EAAAA,GAAAA,MAACqqC,EAAAA,GAAI,CACHC,GAAG,IACHzqC,UAAU,2EAA0EE,SAAA,EAEpFH,EAAAA,GAAAA,KAAC2qC,GAAAA,EAAI,CAACpqC,KAAM,MACZP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,4CAGPiqC,EAAa1pC,IAAI,CAAC6pC,EAAS3pC,KAC1B,IAAK0pC,EAAkBC,EAAS3pC,GAAQ,OAAO,KAE/C,MAAM0N,EAAS1N,IAAUwpC,EAAa7kC,OAAS,EACzCqlC,EAhCehqC,IAClB,IAAMwpC,EAAa5kC,MAAM,EAAG5E,EAAQ,GAAGiQ,KAAK,KA+BlCg6B,CAAkBjqC,GACzBQ,EA/Ce0pC,EAACP,EAAiB3pC,IAEvCupC,GAAeI,GACVJ,GAAeI,GAIQ,UAA5BH,EAAaxpC,EAAQ,IAAkB2iB,EAClCA,EAGFgnB,EAoCWO,CAAmBP,EAAS3pC,GAE1C,OACER,EAAAA,GAAAA,MAAC2qC,EAAAA,SAAc,CAAA5qC,SAAA,EACbH,EAAAA,GAAAA,KAACgrC,GAAAA,EAAW,CAACzqC,KAAM,GAAIN,UAAU,kBAChCqO,GACCtO,EAAAA,GAAAA,KAAA,QAAMC,UAAU,2BAA0BE,SAAEiB,KAE5CpB,EAAAA,GAAAA,KAACyqC,EAAAA,GAAI,CACHC,GAAIE,EACJ3qC,UAAU,mDAAkDE,SAE3DiB,MATcR,S,eCzESmgB,GAAAA,EACSnc,EAAAA,EACLy8B,GAAAA,EACCh5B,EAAAA,E,8BClCnC0Y,GAAAA,EACAA,GAAAA,EACQnc,EAAAA,EACNyD,EAAAA,EACAg5B,GAAAA,EACE74B,EAAAA,EACFyhC,EAAAA,EACDgB,GAAAA,E,0BCFMlqB,GAAAA,EACJmqB,GAAAA,EACDnpC,EAAAA,EACGopC,GAAAA,E,wECQf,MAAMC,IAAezjC,EAAAA,EAAAA,MAAK,IAAM,gCAC1B0jC,IAAc1jC,EAAAA,EAAAA,MAAK,IAAM,gCACzB2jC,IAAkB3jC,EAAAA,EAAAA,MAAK,IAAM,gCAC7B4jC,IAAqB5jC,EAAAA,EAAAA,MAAK,IAAM,gCAChCs1B,IAAet1B,EAAAA,EAAAA,MAAK,IAAM,uCAC1B6jC,IAAmB7jC,EAAAA,EAAAA,MAAK,IAAM,8BAC9B8jC,IAAe9jC,EAAAA,EAAAA,MAAK,IAAM,gCAC1B+jC,IAAqB/jC,EAAAA,EAAAA,MAAK,IAAM,gCAChCuR,IAAuBvR,EAAAA,EAAAA,MAAK,IAAM,gCAClCgkC,IAAwBhkC,EAAAA,EAAAA,MAAK,IAAM,gCAKnCikC,GAAmBA,KACvB5rC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wCAAuCE,UACpDH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,6BAA6BM,KAAM,OA0wC1D,GAtwCiBsrC,KAAO,IAAD/H,EAAAgI,EAAAC,EAAAC,EACrB,MAAM,OAAEp3B,EAAM,IAAE8gB,IAAQuW,EAAAA,EAAAA,KAClB3sC,GAAWC,EAAAA,EAAAA,MACXq7B,GAAW6G,EAAAA,EAAAA,OACVyK,IAAgBC,EAAAA,EAAAA,MACjBC,EAAgD,SAA/BF,EAAavrB,IAAI,UAGlC0rB,GAAgD,KAAlB,QAAdvI,EAAAlJ,EAAS75B,aAAK,IAAA+iC,OAAA,EAAdA,EAAgBwI,cAGhC,cAAEC,EAAeC,aAAcC,EAAoBC,eAAgBC,IAAyBC,EAAAA,GAAAA,MAG3FC,EAAWC,IAAgBvqC,EAAAA,EAAAA,UAASmzB,GAAO,SAC3CqX,EAAcC,IAAmBzqC,EAAAA,EAAAA,WAAS,IAC1C0qC,EAAaC,IAAkB3qC,EAAAA,EAAAA,WAAS,IACxC4qC,EAAUC,IAAe7qC,EAAAA,EAAAA,UAAS,OAClCihB,EAAgB6pB,IAAqB9qC,EAAAA,EAAAA,UAAS,OAC9CgX,EAASC,IAAcjX,EAAAA,EAAAA,WAAS,IAChC+qC,EAAaC,IAAkBhrC,EAAAA,EAAAA,WAAS,IACxCirC,EAAkBC,IAAuBlrC,EAAAA,EAAAA,WAAS,IAElDmrC,EAAaC,IAAkBprC,EAAAA,EAAAA,WAAUmzB,GAAe,SAARA,IAChD,CAAEkY,IAAqBrrC,EAAAA,EAAAA,UAAS,OAChC+T,EAAO2H,IAAY1b,EAAAA,EAAAA,UAAS,OAE5BsrC,EAAaC,IAAkBvrC,EAAAA,EAAAA,WAAS,GACzCwrC,GAAmB96B,EAAAA,EAAAA,SAAO,IAEzB+6B,GAAkBC,KAAuB1rC,EAAAA,EAAAA,UAAS,OAClD2rC,GAAkBC,KAAuB5rC,EAAAA,EAAAA,UAAS,OAClD6rC,GAAcC,KAAmB9rC,EAAAA,EAAAA,UAAS,CAAE+rC,UAAU,EAAMC,QAAQ,EAAOj4B,MAAO,QAClFk4B,GAAUC,KAAelsC,EAAAA,EAAAA,UAAS,OAElCmsC,GAAcC,KAAmBpsC,EAAAA,EAAAA,UAAS,OAC1CqsC,GAAWC,KAAgBtsC,EAAAA,EAAAA,UAAS,OAEpCusC,GAAiBC,KAAsBxsC,EAAAA,EAAAA,WAAS,IAChDysC,GAAcC,KAAmB1sC,EAAAA,EAAAA,WAAS,IAE1C2sC,GAAcC,KAAmB5sC,EAAAA,EAAAA,UAASsrB,OAAOgW,WAAa,IAAM,OAAS,UAC7EuL,GAAcC,KAAmB9sC,EAAAA,EAAAA,UAAS,CAC/CvD,QAAQ,EACRE,YAAa,GACbC,mBAAoB,GACpBC,aAAc,kBAGTkwC,GAAgBC,KAAqBhtC,EAAAA,EAAAA,UAAS,OAG9CitC,GAAoBC,KAAyBltC,EAAAA,EAAAA,WAAS,IACtDmtC,GAAgBC,KAAqBptC,EAAAA,EAAAA,UAAS,KAC9CqtC,GAAeC,KAAoBttC,EAAAA,EAAAA,WAAS,GAC7C8pB,GAAa,CAAEzJ,KAAM,EAAGnjB,MAAO,EAAGK,aAAc,EAAGC,WAAY,EAAGusB,MAAO,GACzEwjB,KAAuB,OAARtB,SAAQ,IAARA,QAAQ,EAARA,GAAU9K,oBAAqB,QAAQj/B,cACtD8nB,GACe,WAAX,OAARiiB,SAAQ,IAARA,QAAQ,EAARA,GAAUre,OAA4B,OAARqe,SAAQ,IAARA,IAAAA,GAAUuB,SAAW,QAAUD,GACzD1jB,GAAWhtB,IAAY,IAAAotB,EAAAC,EAAA,OACD,QAA1BD,EAACH,GAAWE,WAAc,IAAAC,EAAAA,EAAI,KAA+B,QAA9BC,EAAMJ,GAAWjtB,UAAa,IAAAqtB,EAAAA,EAAI,KAG9C4V,EAAAA,GAAAA,GAAgB,CACnCztB,SACA2O,SAAkB,OAAR4pB,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,KACpB8jB,iBACA8jB,UAAmB,OAAR6F,QAAQ,IAARA,OAAQ,EAARA,EAAU7d,SAIvBvb,EAAAA,EAAAA,WAAU,KACJa,GACF23B,EAAc33B,GAAgB,OAARu4B,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,OAAQ,OAEzC,CAACkV,EAAgB,OAARu4B,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,KAAM6sC,KAG5Bx4B,EAAAA,EAAAA,WAAU,KACJg6B,EAAiBr6B,UAAYm6B,IAE/B53B,EAAAA,GAAMC,QAAQ,yOAAiD,CAC7DgV,SAAU,IACV0L,OAAQ,CACNx1B,MAAO,6CACPZ,QAASA,IAAMssC,EAAa,gBAIhCkD,MAEFjC,EAAiBr6B,QAAUm6B,GAE1B,CAACA,KAGJ95B,EAAAA,EAAAA,WAAU,KACJ85B,EACFpB,GAAmB,EAAM,GAEzBE,KAED,CAACkB,EAAapB,EAAoBE,IAErC,MAAMjgB,GAAmBA,CAACxtB,EAAaC,EAAoBC,KACzDiwC,GAAgB,CACdrwC,QAAQ,EACRE,cACAC,qBACAC,kBAOE6wC,IAAev6B,EAAAA,EAAAA,aACnB,SAACw6B,GAA+B,IAApB1kC,IAAOqhB,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,KAAAA,UAAA,GACZjY,GACLtV,EAAS,UAADe,OAAWuU,EAAM,KAAAvU,OAAI6vC,GAAa,CAAE1kC,WAC9C,EACA,CAACoJ,EAAQtV,IAIL6wC,IAAqBz6B,EAAAA,EAAAA,aACzB,WAAsD,IAArDquB,EAAYlX,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KAAM4b,EAAmB5b,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,KACrCjY,IACL+4B,GAAe,GACfb,EAAa,QACbxtC,EAAS,UAADe,OAAWuU,EAAM,SAAS,CAChCpJ,SAAS,EACTzK,MAAOgjC,EAAe,CAAEA,eAAc0E,uBAAwB,CAAC,IAEnE,EACA,CAAC7zB,EAAQtV,IAGL8wC,IAAgB16B,EAAAA,EAAAA,aACpB,WAAmC,IAAlC,YAAE26B,GAAc,GAAOxjB,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,CAAC,EACtBwjB,EACFF,GAAmB,KAAM,OAGtBzC,GAAaC,GAAe,GACf,SAAdd,GAAsBC,EAAa,QACzC,EACA,CAACD,EAAWsD,GAAoBzC,IAG5B4C,IAAiB56B,EAAAA,EAAAA,aACrB,WAAmC,IAAlC,YAAE26B,GAAc,GAAOxjB,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,CAAC,EAI1B,GAHI6gB,GACFC,GAAe,GAEC,SAAdd,EAAsB,CACxB,MAAM0D,EAAc,cACpBzD,EAAayD,GACTF,GACFJ,GAAaM,EAEjB,CACF,EACA,CAAC1D,EAAWa,EAAauC,MAI3Bl8B,EAAAA,EAAAA,WAAU,KACR,GAAI2hB,EAAK,CAEP,MAAM8a,EAAe,CACnB5b,UAAW,YACXC,UAAW,YACX4b,QAAS,UACTC,SAAU,UACVz0B,aAAc,eACd00B,IAAK,MAGP,GAAY,eAARjb,EAEF,YADAp2B,EAAS,UAADe,OAAWuU,EAAM,cAAc,CAAEpJ,SAAS,IAIpD,GAAIhF,OAAOoqC,UAAUC,eAAeC,KAAKN,EAAc9a,GAAM,CAC3D,MAAMkB,EAAS4Z,EAAa9a,GAE5B,YADAya,GAAmBvZ,EAAQ,KAE7B,CAEAkW,EAAapX,GAGQ,CACnB,cACA,aAGehxB,SAASgxB,IACxBsX,GAAgB,GAEN,SAARtX,EACF0a,GAAc,CAAEC,aAAa,IAG7B1C,GAAe,EAEnB,GACC,CAACjY,EAAK0a,GAAeD,GAAoB7wC,EAAUsV,KAwBtDb,EAAAA,EAAAA,WAAU,KACR,GAAIk5B,EAAa,OAEF,gBADe,OAAdzpB,QAAc,IAAdA,OAAc,EAAdA,EAAgB7D,UAAkB,OAARwtB,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,SAAU,IAAIlb,eAEhEuoC,GAAgB,IAEjB,CAAe,OAAdxpB,QAAc,IAAdA,OAAc,EAAdA,EAAgB7D,OAAgB,OAARwtB,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,OAAQstB,KAG9Cl5B,EAAAA,EAAAA,WAAU,KACR,MAAMg9B,EAAgBhyB,IACN,WAAVA,EAAE5D,KAAoBuyB,GACxB4C,GAAe,CAAED,aAAa,KAKlC,OADAvqC,SAASgoB,iBAAiB,UAAWijB,GAC9B,IAAMjrC,SAASioB,oBAAoB,UAAWgjB,IACpD,CAACrD,EAAa4C,MAGjBv8B,EAAAA,EAAAA,WAAU,KACR,MAAM6vB,EAAeA,KACnBuL,GAAgBthB,OAAOgW,WAAa,IAAM,OAAS,UAGrD,OADAhW,OAAOC,iBAAiB,SAAU8V,GAC3B,IAAM/V,OAAOE,oBAAoB,SAAU6V,IACjD,KAGH7vB,EAAAA,EAAAA,WAAU,KACR,MAAMi9B,EAAuBjyB,IAC3B,MAAQ2W,IAAKwa,GAAcnxB,EAAEgT,QAAU,CAAC,EACxC,GAAIme,EAAW,CAcbC,GAZsB,CACpBrzB,eAAgB,YAChBm0B,SAAU,YACVp0B,OAAQ,YACRG,SAAU,YACVk0B,MAAO,UACPC,WAAY,UACZT,SAAU,UACV1b,SAAU,YACV/Y,aAAc,gBAEai0B,IAAcA,EAChB,KAC7B,GAIF,OADAriB,OAAOC,iBAAiB,kBAAmBkjB,GACpC,IAAMnjB,OAAOE,oBAAoB,kBAAmBijB,IAC1D,CAACb,KAGJ,MAAMiB,GAA0BtjC,UAC9B,IACEuI,GAAAA,EAAOyd,IAAI,gDACX,MAAMud,EAAa,IAAIC,gBAEjBC,EAAY59B,WAAW,IAAM09B,EAAWG,QAAS,MAEjD/2B,QAAiB4W,MAAM,GAADhxB,OAAIoxC,GAAAA,EAAY,gBAAgB,CAC1DngB,OAAQ,MACR5V,OAAQ21B,EAAW31B,SAClBmW,MAAM,IAAM,MAIf,OAFA/d,aAAay9B,GAET92B,GAAYA,EAASiX,IACvBrb,GAAAA,EAAOyd,IAAI,2BACXua,GAAgB,CAAEC,UAAU,EAAOC,QAAQ,EAAMj4B,MAAO,QACjD,IAEPD,GAAAA,EAAOud,KAAK,2CACZya,GAAgB,CACdC,UAAU,EACVC,QAAQ,EACRj4B,MAAO,8IAEF,EAEX,CAAE,MAAOA,GAOP,OANAD,GAAAA,EAAOC,MAAM,2CAAuCA,GACpD+3B,GAAgB,CACdC,UAAU,EACVC,QAAQ,EACRj4B,MAAM,wGAADjW,OAA0BiW,EAAMwB,YAEhC,CACT,IAIMtV,KAAM+gC,GAAgB,kBAAEmO,KAAsBlO,EAAAA,GAAAA,KAGhDmO,GAAe7jC,UACnB,IACE,MAAMtL,QAAakvC,KACflvC,GACFisC,GAAYjsC,EAEhB,CAAE,MAAO8T,GACPD,GAAAA,EAAOC,MAAM,4BAA6BA,EAE5C,IAIFvC,EAAAA,EAAAA,WAAU,KACJwvB,KAAqBiL,IACvBC,GAAYlL,KAEb,CAACA,GAAkBiL,MAEtBz6B,EAAAA,EAAAA,WAAU,KACKjG,WAKX,GAJAuI,GAAAA,EAAOyd,IAAI,kDAADzzB,OAAyCuU,EAAM,qBAAAvU,OAAoBgsC,IAC7E8B,GAAoB,MAGhB9B,EAgBF,OAfAh2B,GAAAA,EAAOyd,IAAI,kEACXta,GAAW,GACX+zB,GAAe,GACfI,GAAe,GAEfP,EAAY,CACVp8B,GAAI4D,EACJlV,KAAK,mEAADW,QAAmB,IAAIoX,MAAOyO,mBAAmB,UACrDsJ,UAAW,YACX7P,OAAQ,cAGVkO,OAAO+jB,QAAQC,aAAa,CAAC,EAAG/rC,SAASd,YAEzC2sC,KAIF,MAAMG,QAAiBV,KAEvB,GADA/6B,GAAAA,EAAOyd,IAAI,2CAADzzB,OAAkCyxC,EAAW,SAAW,YAC9DA,EACF,IAEEz7B,GAAAA,EAAOyd,IAAI,2CACX,MAAMie,QAAqB93B,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,IAMhD,GALAyB,GAAAA,EAAOyd,IAAI,iCAADzzB,OAAyC,OAAZ0xC,QAAY,IAAZA,OAAY,EAAZA,EAAcviB,YACrD4d,EAAY2E,GACZxE,GAAe,GAGiB,eAAhB,OAAZwE,QAAY,IAAZA,OAAY,EAAZA,EAAcviB,WAMhB,OALAnZ,GAAAA,EAAOyd,IAAI,oEACXta,GAAW,GACXm0B,GAAe,QAEfgE,KAKFt7B,GAAAA,EAAOyd,IAAI,kEACLke,QAAQC,IAAI,CAChBN,KACA3B,KACAkC,OAEF77B,GAAAA,EAAOyd,IAAI,0CACb,CAAE,MAAOxd,GAEPD,GAAAA,EAAOC,MAAM,sCAAkCA,GAC/CkD,GAAW,GACX+zB,GAAe,EACjB,MAEAl3B,GAAAA,EAAOC,MAAM,8CAEbkD,GAAW,GACX+zB,GAAe,GACftvB,EAAS,yPAIbk0B,IAEC,CAACv9B,EAAQy3B,IACZ,MAAM6F,GAAuBpkC,UAC3B,GAAK8G,EACL,IAEE,MAAMpS,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,eAAe,CAC3DoB,gBAAgB,IAEV,OAAJxT,QAAI,IAAJA,GAAAA,EAAM4vC,QAAU5vC,EAAKqG,SACvBslC,GAAoB3rC,EAAKqG,QAE7B,CAAE,MAAOyN,GACPD,GAAAA,EAAOud,KAAK,oCAAqCtd,EACnD,GAII+7B,GAAevkC,iBAAyB,IAAlBoU,EAAO2K,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,CAAC,EACrC,MAAM,OAAEylB,GAAS,GAAUpwB,EAG3B,GAFA7L,GAAAA,EAAOyd,IAAI,8CAADzzB,OAAqCuU,EAAM,aAAAvU,OAAYiyC,EAAM,MAClEA,GAAQ/E,GAAe,IACvB34B,EAGH,OAFAyB,GAAAA,EAAOC,MAAM,uDACbi3B,GAAe,GAGjB,IACEl3B,GAAAA,EAAOyd,IAAI,8CAADzzB,OAAqCuU,IAC/C,MAAMpS,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,IACxCyB,GAAAA,EAAOyd,IAAI,qCAAiCtxB,GAC5C4qC,EAAY5qC,GACZyb,EAAS,MAGW,cAAhBzb,EAAKmd,QAA0C,eAAhBnd,EAAKmd,QAEtCmuB,GAAe,GAEft0B,GAAW,IACc,cAAhBhX,EAAKmd,QAA0C,UAAhBnd,EAAKmd,OAE7CmuB,GAAe,GAIfA,EAA+B,cAAhBtrC,EAAKmd,QAA0C,eAAhBnd,EAAKmd,OAEvD,CAAE,MAAOrJ,GACPD,GAAAA,EAAOC,MAAM,4BAA6BA,GAC1C,MAAMwb,EAAexb,aAAiB0I,MAAQ1I,EAAMwB,QAAU,8HAC9DmG,EAAS6T,GACT7b,EAAAA,GAAMK,MAAM,8HACd,CAAC,QACCi3B,GAAe,EACjB,CACF,EAEMyC,GAAqBliC,iBAA2B,IAApBykC,EAAU1lB,UAAAtnB,OAAA,QAAA7B,IAAAmpB,UAAA,GAAAA,UAAA,GAAG,EAG7C,IAAK,IAAD2lB,EAAAC,EAAAC,EAIFr8B,GAAAA,EAAOyd,IAAI,0CAADzzB,OAAiCuU,EAAM,cAAAvU,OAAakyC,EAAa,EAAC,KAAAlyC,OAAIsyC,EAAe,MAG/F,MAAMnwC,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,aAAa,CACzDg+B,MAAOL,EAVS,EAWhBM,WAXgB,EAWUN,EAC1Bv8B,eAAgBu8B,GAZA,IAclBl8B,GAAAA,EAAOyd,IAAI,uCAAmC,CAC5CnU,OAAQnd,EAAKmd,OACb7C,gBAAmC,QAAnB01B,EAAAhwC,EAAKsa,sBAAc,IAAA01B,OAAA,EAAnBA,EAAqBjtC,SAAU,EAC/CutC,mBAAoBtwC,EAAKyZ,cAA6B,QAAjBw2B,EAAIjwC,EAAKuwC,gBAAQ,IAAAN,GAAbA,EAAex2B,gBAG1DoxB,EAAkB7qC,GAClByb,EAAS,MACT,MAAM+0B,GACA,OAAJxwC,QAAI,IAAJA,OAAI,EAAJA,EAAMywC,qBACF,OAAJzwC,QAAI,IAAJA,GAAc,QAAVkwC,EAAJlwC,EAAMuwC,gBAAQ,IAAAL,OAAV,EAAJA,EAAgBO,oBAChB,KACF9E,GAAoB6E,GACfA,GACHd,KAEFtE,EAAkBprC,EAAKmd,SAAkB,OAARwtB,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,SAGvB,cAAhBnd,EAAKmd,QAA0C,eAAhBnd,EAAKmd,OAEtCmuB,GAAe,GACU,cAAhBtrC,EAAKmd,QAA0C,UAAhBnd,EAAKmd,QAAsC,WAAhBnd,EAAKmd,QAExEmuB,GAAe,GAGbtrC,EAAKuwC,UAAYvwC,EAAKuwC,SAAS92B,cACjC5F,GAAAA,EAAOyd,IAAI,4CACXma,GAAoBzrC,EAAKuwC,SAAS92B,eACzBzZ,EAAKyZ,eACd5F,GAAAA,EAAOyd,IAAI,wCACXma,GAAoBzrC,EAAKyZ,cAG7B,CAAE,MAAO3F,GACPD,GAAAA,EAAOC,MAAM,iCAA6BA,GAC1C+2B,EAAkB,MAClB,MAAMvb,EAAexb,aAAiB0I,MAAQ1I,EAAMwB,QAAU,8HAC9DmG,EAAS6T,EAEX,CAAC,QACCtY,GAAW,EACb,CACF,GAwCAzF,EAAAA,EAAAA,WAAU,KACU,UAAd84B,GAA0B+B,IAAcI,IAnBxBlhC,WACpB,GAAK8G,EAEL,IACEq6B,IAAgB,GAEhB,MAAMzsC,QAAayX,EAAAA,EAAAA,QAAO,cAAD5Z,OAAeuU,EAAM,wBAAwB,CAAEoB,gBAAgB,IACxFK,GAAAA,EAAOyd,IAAI,uBAAmBtxB,GAC9BqsC,GAAarsC,EACf,CAAE,MAAO8T,GACPD,GAAAA,EAAOC,MAAM,8BAA0BA,EAEzC,CAAC,QACC24B,IAAgB,EAClB,GAMEiE,IAGD,CAACrG,KAG2Bn3B,EAAAA,EAAAA,aAAay9B,IAC1C98B,GAAAA,EAAOyd,IAAI,sCAAkCqf,GAEzCA,IAAoBv+B,IACtBy9B,KACArC,OAKD,CAACp7B,IAuCJ,OAAI2E,GAAW+zB,GAEXttC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,gDAA+CE,UAC5DC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,cAAaE,SAAA,EAC1BH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,yDACnBD,EAAAA,GAAAA,KAAA,KAAGC,UAAU,gBAAeE,SAAEmtC,EAAc,iDAAgB,oEAO/DH,EAoBDO,GAEA1tC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4DACVgF,MAAO,CAAEmuC,MAAOlE,IAAe/uC,UAClCH,EAAAA,GAAAA,KAACqzC,GAAU,CACTz+B,OAAQA,EACR2O,SAAkB,OAAR4pB,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,KACpB8jB,eAAgBA,EAChBvkB,QAASA,IAAMqxC,GAAe,CAAED,aAAa,SAOnDrwC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,kBAAiBE,UAC5BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,6BAA4BE,SAAA,EAEvCiuC,GAAaG,SAAWH,GAAaE,WACrCtuC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,4DAA2DE,UACxEC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAC+6B,EAAAA,EAAW,CAAC96B,UAAU,6BAA6BM,KAAM,MAC1DH,EAAAA,GAAAA,MAAA,OAAKH,UAAU,SAAQE,SAAA,EACrBH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,sCAAqCE,SAAC,6FACpDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,oBAAmBE,SAAEiuC,GAAa93B,SAC/CtW,EAAAA,GAAAA,KAAA,UACEQ,QAASsN,UACPugC,GAAgB,CAAEC,UAAU,EAAMC,QAAQ,EAAOj4B,MAAO,aACjC86B,MAErBpB,MAGJ/vC,UAAU,qGAAoGE,SAE7GiuC,GAAaE,UACZluC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,eAAeM,KAAM,MACxCP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,oCAGRC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAAC/yC,KAAM,MAChBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,6FAUxBH,EAAAA,GAAAA,KAACuzC,GAAW,CAAChwB,SAAkB,OAAR4pB,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,OAGR,eAAhB,OAARytC,QAAQ,IAARA,OAAQ,EAARA,EAAU3d,YAA6B5a,IACtC5U,EAAAA,GAAAA,KAACyL,EAAAA,SAAQ,CAACC,SAAU,KAAKvL,UACvBH,EAAAA,GAAAA,KAACkZ,GAAoB,CAACtE,OAAQA,MAKT,eAAhB,OAARu4B,QAAQ,IAARA,OAAQ,EAARA,EAAU3d,YAA6B5a,GAA+B,eAAb,OAARu4B,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,UAC1D3f,EAAAA,GAAAA,KAACyL,EAAAA,SAAQ,CAACC,SAAU,KAAKvL,UACvBH,EAAAA,GAAAA,KAAC2rC,GAAqB,CAAC/2B,OAAQA,OAKnCxU,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,GAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,KACxBW,UAAU,8DAA6DE,SACxE,gFAGDH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,qCAAoCE,SAAEgtC,EAASztC,QAC7DU,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oCAAmCE,SAAA,EAChDC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,gBAAeE,SAAA,CACL,cAApBgtC,EAASxtB,QAA0B,6EACf,UAApBwtB,EAASxtB,QAAsB,kLACX,cAApBwtB,EAASxtB,QAA0B,qCACf,eAApBwtB,EAASxtB,QAA2B,qCAChB,WAApBwtB,EAASxtB,QAAuB,0EAId,cAApBwtB,EAASxtB,SACR3f,EAAAA,GAAAA,KAAA+L,GAAAA,SAAA,CAAA5L,SACGisB,GAAQ,iBAEPhsB,EAAAA,GAAAA,MAAA,QAAMH,UAAU,+HAA8HE,SAAA,EAC5IH,EAAAA,GAAAA,KAACiqC,EAAAA,EAAK,CAAC1pC,KAAM,KAAM,sFAKrBH,EAAAA,GAAAA,MAAA,UACEI,QAASA,IACPksB,GACE,eACA,kOACA,gBAGJzsB,UAAU,gKACV+E,MAAM,oFAA4B7E,SAAA,EAElCH,EAAAA,GAAAA,KAACiqC,EAAAA,EAAK,CAAC1pC,KAAM,KAAM,8DAO1BijB,IACCpjB,EAAAA,GAAAA,MAAA,QAAMH,UAAU,wBAAuBE,SAAA,EACf,QAArB2rC,EAAAtoB,EAAe3G,cAAM,IAAAivB,OAAA,EAArBA,EAAuBvmC,SAAU,EAAE,0CACZ,QAAvBwmC,EAAAvoB,EAAeld,gBAAQ,IAAAylC,OAAA,EAAvBA,EAAyBxmC,SAAU,EAAE,kDAO9CnF,EAAAA,GAAAA,MAAA,OAAKH,UAAU,uBAAsBE,SAAA,EAEnCC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAM4vC,GAAc,CAAEC,aAAa,IAC5CpwC,UAAU,kOAAiOE,SAAA,EAE3OH,EAAAA,GAAAA,KAACwO,EAAAA,EAAa,CAACjO,KAAM,MACrBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,iEAGRC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMivC,IAAsB,GACrCxvC,UAAU,wRACV6W,SAAU+2B,GAAmC,cAApBV,EAASxtB,OAClC3a,MAAM,6LAAsC7E,SAAA,EAE5CH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAAC/yC,KAAM,MAChBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,sEAGRC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMitC,GAAoB,GACnCxtC,UAAU,6SACV6W,UAAW0M,GAAsC,cAApB2pB,EAASxtB,OAAuBxf,SAAA,EAE7DH,EAAAA,GAAAA,KAACgQ,EAAAA,EAAQ,CAACzP,KAAM,MAChBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,4CASXmW,IACCtW,EAAAA,GAAAA,KAACwzC,GAAAA,EAAY,CACXl9B,MAAOA,EACPm9B,QAASA,KACPx1B,EAAS,MACTo0B,KACArC,MAEF0D,UAAWA,IAAMz1B,EAAS,MAC1BjZ,MAAM,+FACN/E,UAAU,SAKbktC,MAA4B,OAAd3pB,QAAc,IAAdA,GAAAA,EAAgBld,WAA+C,IAAnCkd,EAAeld,SAASf,SAAqC,cAApB4nC,EAASxtB,SAC3F3f,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wGAAuGE,UACpHC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yBAAwBE,SAAA,EACrCH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,sFAAqFE,UAClGH,EAAAA,GAAAA,KAAA,QAAMC,UAAU,WAAUE,SAAC,oBAE7BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,SAAQE,SAAA,EACrBH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,wCAAuCE,SAAC,+GACtDC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,yBAAwBE,SAAA,CAAC,mPACaH,EAAAA,GAAAA,KAAA,UAAAG,SAAQ,qDAAiB,WAAEH,EAAAA,GAAAA,KAAA,UAAAG,SAAQ,+CAAiB,mJAGvGC,EAAAA,GAAAA,MAAA,UACEI,QAASA,IAAMlB,EAAS,UAADe,OAAWuU,EAAM,aACxC3U,UAAU,uHAAsHE,SAAA,EAEhIH,EAAAA,GAAAA,KAAA,QAAAG,SAAM,gFACNH,EAAAA,GAAAA,KAAA,QAAAG,SAAM,sBAUfgtC,IACC/sC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EAEEC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,OAAME,SAAA,EAEnBC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,GAAAA,KAAA,UACEQ,QA1pBSmzC,KACvB,MAAMC,GAAW7G,EAKjB,GAJAG,GAAe,GACfF,EAAgB4G,IAGA,IAAZA,EAAmB,CAGF,CAAC,cAAe,OAAQ,SAC3BlvC,SAASmoC,KACvBvtC,EAAS,UAADe,OAAWuU,EAAM,iBACzBk4B,EAAa,eAEjB,GA6oBc7sC,UAAS,yEAAAI,OACP0sC,EACI,gGACA,uGACH5sC,SAEF4sC,GACC3sC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAAC/yC,KAAM,MAChBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,0DAGRC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACiqC,EAAAA,EAAK,CAAC1pC,KAAM,MACbP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,sDAMZH,EAAAA,GAAAA,KAAA,OAAKC,UAAS,gCAAAI,OACZ0sC,EACI,+DACA,6DACH5sC,SACA4sC,GACC/sC,EAAAA,GAAAA,KAAA,QAAAG,SAAM,+WAENH,EAAAA,GAAAA,KAAA,QAAAG,SAAM,6SAKZC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,wBAAuBE,SAAA,CAAC,2DACzB4sC,EAAe,8CAAa,2DAK5C/sC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,2BAA0BE,SACtC4sC,GAEC3sC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,+CAA8CE,SAC1D,CACC,CAAE6Q,GAAI,OAAQ5P,MAAO,2BAAQyyC,KAAM,8EACnC,CAAE7iC,GAAI,eAAgB5P,MAAO,qEAAeyyC,KAAM,mJAClD,CAAE7iC,GAAI,OAAQ5P,MAAO,uCAAUyyC,KAAM,2DACrC,CAAE7iC,GAAI,OAAQ5P,MAAO,2BAAQyyC,KAAM,yEACnCnzC,IAAKozC,IACL,MAAM90C,EAASswC,KAAmBwE,EAAE9iC,GACpC,OACE5Q,EAAAA,GAAAA,MAAA,UAEEI,QAASA,KACP,GAAa,SAATszC,EAAE9iC,GAIJ,OAHAo/B,GAAc,CAAEC,aAAa,IAC7BvD,EAAa,aACbyC,GAAkB,MAGpBA,GAAmB5wB,GAAUA,IAASm1B,EAAE9iC,GAAK,KAAO8iC,EAAE9iC,KAExD/Q,UAAS,0EAAAI,OACPrB,EACI,yCACA,+EAENgG,MAAO8uC,EAAED,KAAK1zC,SAAA,CAEb2zC,EAAE1yC,MAAM,IAAEpC,GAASgB,EAAAA,GAAAA,KAACmF,EAAAA,EAAS,CAAClF,UAAU,oBAAoBM,KAAM,MAASP,EAAAA,GAAAA,KAACoF,EAAAA,EAAW,CAACnF,UAAU,oBAAoBM,KAAM,OAjBxHuzC,EAAE9iC,QAuBds+B,KACCtvC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,OAAME,UACnBH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uDAAsDE,SAClE,CAAC4zC,IACA,MAAMC,EAAW,CACf,CAAE74B,IAAK,cAAe/Z,MAAO,8CAAY6E,MAAMjG,EAAAA,GAAAA,KAAC8I,EAAAA,EAAU,CAACvI,KAAM,KAAQ0zC,QAAS,mJAAiC9wB,aAAc,QACjI,CAAEhI,IAAK,YAAa/Z,MAAO,8CAAY6E,MAAMjG,EAAAA,GAAAA,KAACiqC,EAAAA,EAAK,CAAC1pC,KAAM,KAAQ0zC,QAAS,mKAAkC9wB,aAAc,SAWvH+wB,EAAW,CACf,CAAE/4B,IAAK,QAAS/Z,MAAO,8CAAY6E,KAAM,KAAMkuC,OAAe,OAARhH,QAAQ,IAARA,GAAe,QAAP4G,EAAR5G,EAAU7d,aAAK,IAAAykB,OAAP,EAARA,EAAiBxuC,SAAU,EAAG0uC,QAAS,mFAAmB9wB,aAAc,SAShI,OALqB,SAAnBmsB,GAA4B0E,EACT,iBAAnB1E,GAfuB,CACvB,CAAEn0B,IAAK,iBAAkB/Z,MAAO,8CAAY6E,KAAM,KAAMguC,QAAS,sGAAuB9wB,aAAc,QACtG,CAAEhI,IAAK,iBAAkB/Z,MAAO,gEAAe6E,KAAM,KAAMguC,QAAS,8FAAoB9wB,aAAc,gBACtG,CAAEhI,IAAK,aAAc/Z,MAAO,8CAAY6E,KAAM,KAAMguC,QAAS,4EAAiB9wB,aAAc,gBAC5F,CAAEhI,IAAK,gBAAiB/Z,MAAO,+FAAqB6E,KAAM,KAAMguC,QAAS,+HAA4B9wB,aAAc,gBACnH,CAAEhI,IAAK,iBAAkB/Z,MAAO,oDAAa6E,KAAM,KAAMguC,QAAS,qGAAsB9wB,aAAc,cACtG,CAAEhI,IAAK,aAAc/Z,MAAO,uEAAiB6E,KAAM,KAAMguC,QAAS,yMAA+C9wB,aAAc,gBAC/H,CAAEhI,IAAK,iBAAkB/Z,MAAO,8BAAqB6E,KAAM,KAAMguC,QAAS,4FAAiC9wB,aAAc,iBAStG,SAAnBmsB,GAA4B4E,EAC5B,IAEkBxzC,IAAK0zC,IACvB,MAAMh1C,EAAeg1C,EAAQjxB,cAAgB,OAEvC0T,GADUzK,GAAQhtB,GAElBi1C,EAA8B,eAAjBj1C,EACf,aACiB,iBAAjBA,EACE,eACA,QAEN,OACEgB,EAAAA,GAAAA,MAAA,UAEEI,QAASA,KACHq2B,EACFnK,GACE0nB,EAAQhzC,MACRgzC,EAAQH,SAAW,2IACnB70C,IAIJE,EAAS,UAADe,OAAWuU,EAAM,KAAAvU,OAAI+zC,EAAQj5B,MACrC2xB,EAAasH,EAAQj5B,KACrBo0B,GAAkB,QAEpBvqC,MAAO6xB,EAAQ,GAAAx2B,OAAM+zC,EAAQH,SAAW,GAAE,qCAAA5zC,OAAWg0C,GAAeD,EAAQH,QAC5Eh0C,UAAS,6FAAAI,OACPw2B,EACI,2CACAgW,IAAcuH,EAAQj5B,IACpB,mDACA,+EACLhb,SAAA,CAEFi0C,EAAQnuC,MACTjG,EAAAA,GAAAA,KAAA,QAAMC,UAAU,oBAAmBE,SAAEi0C,EAAQhzC,aAC1BsC,IAAlB0wC,EAAQD,QAAuB/zC,EAAAA,GAAAA,MAAA,QAAMH,UAAU,gBAAeE,SAAA,CAAC,IAAEi0C,EAAQD,MAAM,OAC/EC,EAAQE,UAAWt0C,EAAAA,GAAAA,KAAA,QAAMC,UAAU,oDAAmDE,SAAC,WACvF02B,IACCz2B,EAAAA,GAAAA,MAAA,QAAMH,UAAU,wGAAuGE,SAAA,EACrHH,EAAAA,GAAAA,KAACM,EAAAA,EAAI,CAACC,KAAM,MACZH,EAAAA,GAAAA,MAAA,QAAAD,SAAA,CAAOk0C,EAAW,YA9BjBD,EAAQj5B,MAoCpB,EAxEA,UA+ET,CACE,CAAEA,IAAK,cAAe/Z,MAAO,uCAAU6E,MAAMjG,EAAAA,GAAAA,KAAC8I,EAAAA,EAAU,CAACvI,KAAM,KAAQ0zC,QAAS,oJAChF,CAAE94B,IAAK,OAAQ/Z,MAAO,iEAAgB6E,MAAMjG,EAAAA,GAAAA,KAACwO,EAAAA,EAAa,CAACjO,KAAM,KAAQ0zC,QAAS,wGAClF,CAAE94B,IAAK,QAAS/Z,MAAO,iCAAS+yC,OAAe,OAARhH,QAAQ,IAARA,GAAe,QAAPnB,EAARmB,EAAU7d,aAAK,IAAA0c,OAAP,EAARA,EAAiBzmC,SAAU,EAAG0uC,QAAS,qFAC9EvzC,IAAK0zC,IACLh0C,EAAAA,GAAAA,MAAA,UAEEI,QAASA,KACa,SAAhB4zC,EAAQj5B,IACVi1B,GAAc,CAAEC,aAAa,KAE7B/wC,EAAS,UAADe,OAAWuU,EAAM,KAAAvU,OAAI+zC,EAAQj5B,MACrC2xB,EAAasH,EAAQj5B,OAGzBnW,MAAOovC,EAAQH,QACfh0C,UAAS,wFAAAI,OACPwsC,IAAcuH,EAAQj5B,KAAwB,SAAhBi5B,EAAQj5B,KAAkBuyB,EACpD,0CACA,kCACHvtC,SAAA,CAEFi0C,EAAQnuC,KACRmuC,EAAQhzC,MAAM,SAAoBsC,IAAlB0wC,EAAQD,OAAmB,IAAA9zC,OAAQ+zC,EAAQD,MAAK,OAjB5DC,EAAQj5B,YAyBvBnb,EAAAA,GAAAA,KAAA,OAAKC,UAAU,OAAME,UACnBC,EAAAA,GAAAA,MAACqL,EAAAA,SAAQ,CAACC,UAAU1L,EAAAA,GAAAA,KAAC4rC,GAAgB,IAAIzrC,SAAA,CAC1B,gBAAd0sC,IACC7sC,EAAAA,GAAAA,KAACsrC,GAAe,CACd12B,OAAQA,EACRu4B,SAAUA,EACV3pB,eAAgBA,GAAkB,CAAC,EACnC+wB,WAAYA,IAAMnE,GAAc,CAAEC,aAAa,MAGpC,cAAdxD,IACC7sC,EAAAA,GAAAA,KAAA+L,GAAAA,SAAA,CAAA5L,UACGoZ,GAAYiK,GAAmB2pB,GAG9BntC,EAAAA,GAAAA,KAACurC,GAAkB,CACjB4B,SAAUA,EACV3pB,eAAgBA,GAAkB,CAAC,EACnC0qB,iBAAkBA,GAClBF,iBAAkBA,GAClBQ,SAAUA,GACV55B,OAAQA,EACR2/B,WAAYA,IAAMnE,GAAc,CAAEC,aAAa,OATjDrwC,EAAAA,GAAAA,KAACw0C,GAAAA,GAAgB,OAkBb,OAAT3H,QAAS,IAATA,OAAS,EAATA,EAAWrqB,WAAW,YAA2B,eAAdqqB,IAClC7sC,EAAAA,GAAAA,KAACwrC,GAAgB,CACf52B,OAAQA,EACR6/B,SAAU5H,EAAUrhC,QAAQ,SAAU,IACtCkpC,iBAAmB7xB,IACjButB,GAAc,CAAEC,aAAa,IAEzBxtB,GACFvjB,EAAS,UAADe,OAAWuU,EAAM,SAAS,CAChCpJ,SAAS,EACTzK,MAAO,CAAEgjC,aAAc,MAAO0E,oBAAqB,CAAE5lB,gBAQhD,eAAdgqB,IACC7sC,EAAAA,GAAAA,KAACyL,EAAAA,SAAQ,CAACC,UAAU1L,EAAAA,GAAAA,KAAC4rC,GAAgB,IAAIzrC,UACvCH,EAAAA,GAAAA,KAACyrC,GAAY,CAAC72B,OAAQA,MAKX,mBAAdi4B,IACC7sC,EAAAA,GAAAA,KAACyL,EAAAA,SAAQ,CAACC,UAAU1L,EAAAA,GAAAA,KAAC4rC,GAAgB,IAAIzrC,UACvCH,EAAAA,GAAAA,KAAC0rC,GAAkB,CAAC92B,OAAQA,EAAQ2O,SAAkB,OAAR4pB,QAAQ,IAARA,OAAQ,EAARA,EAAUztC,SAI7C,UAAdmtC,IACC7sC,EAAAA,GAAAA,KAACqrC,GAAW,CACVz2B,OAAQA,EACR2O,SAAU4pB,EAASztC,KACnB4vB,MAAO6d,EAAS7d,OAAS,GACzB8c,eAAgBA,EAChBuI,cAAgBne,IAAY,IAADoe,GAIf,OAANpe,QAAM,IAANA,GAAsB,QAAhBoe,EAANpe,EAAQuD,sBAAc,IAAA6a,OAAhB,EAANA,EAAwBrvC,QAAS,GACnC6nC,EAAYzuB,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACXkV,GAAI,IACP2Q,MAAO,KAAS,OAAJ3Q,QAAI,IAAJA,OAAI,EAAJA,EAAM2Q,QAAS,MAAQkH,EAAOuD,mBAIpC,OAANvD,QAAM,IAANA,GAAAA,EAAQqe,aAEVxC,GAAa,CAAEC,QAAQ,IAEvBxE,GAAe,GAEfsC,GAAc,CAAEC,aAAa,IAE7Bp6B,EAAAA,GAAME,KAAK,sTAAkE,CAC3E+U,SAAU,QAGZ8kB,KAEA/5B,EAAAA,GAAMC,QAAQ,sIAW1BqD,IAAY4zB,IACZ/sC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oBAAmBE,SAAA,EAChCH,EAAAA,GAAAA,KAAC+6B,EAAAA,EAAW,CAAC96B,UAAU,yCACvBD,EAAAA,GAAAA,KAAA,MAAIC,UAAU,qCAAoCE,SAAC,kGACnDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,gBAAeE,SAAC,6MAOV,eAAb,OAARgtC,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,SAA+C,gBAAb,OAARwtB,QAAQ,IAARA,OAAQ,EAARA,EAAUxtB,WAC9Cvf,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oBAAmBE,SAAA,EAChCH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAACrzC,UAAU,0DACpBD,EAAAA,GAAAA,KAAA,MAAIC,UAAU,qCAAoCE,SAAC,uEACnDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,gBAAeE,SAAC,mTAOhCqtC,IACCxtC,EAAAA,GAAAA,KAACorC,GAAY,CACXx2B,OAAQA,EACR2O,SAAU4pB,EAASztC,KACnB8jB,eAAgBA,EAChBvkB,QAASA,IAAMwuC,GAAoB,MAIvCztC,EAAAA,GAAAA,KAACi9B,GAAY,CACXj+B,OAAQowC,GAAapwC,OACrBC,QAnkCoB61C,IACxBzF,GAAiB1wB,IAAIlV,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWkV,GAAI,IAAE3f,QAAQ,KAmkC1CE,YAAakwC,GAAalwC,YAC1BC,mBAAoBiwC,GAAajwC,mBACjCC,aAAcgwC,GAAahwC,aAC3BC,YAAqB,OAARmvC,SAAQ,IAARA,QAAQ,EAARA,GAAU9K,oBAIxB8L,KACCxvC,EAAAA,GAAAA,KAAA,OAAKC,UAAU,uFAAsFE,UACnGC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,kHAAiHE,SAAA,EAC9HC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,+BAA8BE,SAAA,EAC3CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,wEAAuEE,UACpFH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAACrzC,UAAU,iBAAiBM,KAAM,QAE7CH,EAAAA,GAAAA,MAAA,OAAAD,SAAA,EACEH,EAAAA,GAAAA,KAAA,MAAIC,UAAU,+BAA8BE,SAAC,mEAC7CH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,wBAAuBE,SAAC,6MAIzCC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,OAAME,SAAA,EACnBH,EAAAA,GAAAA,KAAA,SAAOC,UAAU,sCAAqCE,SAAC,sJAGvDH,EAAAA,GAAAA,KAAA,SACE+E,KAAK,OACLkc,MAAOyuB,GACPxuB,SAAWnC,GAAM4wB,GAAkB5wB,EAAE1S,OAAO4U,OAC5CD,YAAY,qNACZ/gB,UAAU,+KACVC,IAAI,SAENF,EAAAA,GAAAA,KAAA,KAAGC,UAAU,6BAA4BE,SAAC,wSAK5CH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,iEAAgEE,UAC7EC,EAAAA,GAAAA,MAAA,KAAGH,UAAU,yBAAwBE,SAAA,EACnCH,EAAAA,GAAAA,KAAA,UAAAG,SAAQ,qCAAgB,6mBAK5BC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,aAAYE,SAAA,EACzBH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,KACPivC,IAAsB,GACtBE,GAAkB,KAEpB1vC,UAAU,oGAAmGE,SAC9G,oCAGDH,EAAAA,GAAAA,KAAA,UACEQ,QAvpBUsN,UACtB,GAAK4hC,GAAetsC,OAKpB,IACEysC,IAAiB,GACjB,MAAMp1B,QAAiBs6B,EAAAA,EAAAA,IAAc,cAAD10C,OAAeuU,EAAM,cAAc,CACrE0c,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMP,KAAKC,UAAU,CAAE8jB,YAAatF,GAAetsC,WAGrD,GAAIqX,EAASiX,GACXzb,EAAAA,GAAMC,QAAQ,+GAAD7V,OAA2BqvC,GAAc,MACtDD,IAAsB,GACtBE,GAAkB,IAElB7B,GAAe,GAEfuE,GAAa,CAAEC,QAAQ,QAClB,CACL,MAAMh8B,QAAcmE,EAASmX,OAC7B3b,EAAAA,GAAMK,MAAMA,EAAMyb,QAAU,oIAC9B,CACF,CAAE,MAAOzb,GACPD,GAAAA,EAAOC,MAAM,sBAAuBA,GACpCL,EAAAA,GAAMK,MAAM,oIACd,CAAC,QACCu5B,IAAiB,EACnB,MA7BE55B,EAAAA,GAAMK,MAAM,mJAspBFQ,SAAU84B,KAAkBF,GAAetsC,OAC3CnD,UAAU,gPAA+OE,SAExPyvC,IACCxvC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACi4B,EAAAA,EAAO,CAACh4B,UAAU,eAAeM,KAAM,MACxCP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,yEAGRC,EAAAA,GAAAA,MAAA2L,GAAAA,SAAA,CAAA5L,SAAA,EACEH,EAAAA,GAAAA,KAACszC,EAAAA,EAAQ,CAAC/yC,KAAM,MAChBP,EAAAA,GAAAA,KAAA,QAAAG,SAAM,8GAjnBpBH,EAAAA,GAAAA,KAAA,OAAKC,UAAU,MAAKE,UAClBC,EAAAA,GAAAA,MAAA,OAAKH,UAAU,oBAAmBE,SAAA,EAChCH,EAAAA,GAAAA,KAAC+6B,EAAAA,EAAW,CAAC96B,UAAU,yCACvBD,EAAAA,GAAAA,KAAA,MAAIC,UAAU,qCAAoCE,SAAC,8DACnDH,EAAAA,GAAAA,KAAA,KAAGC,UAAU,qBAAoBE,SAAC,uOAClCH,EAAAA,GAAAA,KAAA,UACEQ,QAASA,IAAMlB,EAAS,KACxBW,UAAU,gEAA+DE,SAC1E,6E","sources":["components/UpgradeModal.tsx","components/chat/ContradictionCard.tsx","components/chat/EntityHighlighter.tsx","components/chat/SmartResponseRenderer.jsx","components/chat/WaveLoader.tsx","components/chat/StarRating.tsx","store/useActivityLogStore.ts","components/RepresentationBanner.tsx","services/capabilities.ts","components/chat/CapabilitiesMenu.tsx","components/chat/ChatPanel.jsx","hooks/useDocumentProcessingStatus.ts","components/chat/PinnedPanel.tsx","components/chat/CasesSessionsPanel.tsx","components/chat/ChatLayout.jsx","components/chat/CTACapabilityButtons.tsx","components/Breadcrumbs.tsx","components/notebook/NotebookChatInput.tsx","components/notebook/chat/SuggestedActions.tsx","components/notebook/playbook/SegmentedTabs.tsx","pages/CasePage.jsx"],"sourcesContent":["/**\n * UpgradeModal -   \n *     ' \n */\n\nimport React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { X, Crown, Check, Lock, Info } from 'lucide-react';\n\ninterface UpgradeModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  featureName: string;\n  featureDescription?: string;\n  requiredTier: 'basic' | 'professional' | 'enterprise';\n  currentTier?: string;\n}\n\nconst UpgradeModal: React.FC<UpgradeModalProps> = ({\n  isOpen,\n  onClose,\n  featureName,\n  featureDescription,\n  requiredTier,\n  currentTier = 'free'\n}) => {\n  const navigate = useNavigate();\n\n  if (!isOpen) return null;\n\n  const tierInfo = {\n    basic: {\n      name: 'Basic',\n      price: '99',\n      features: [\n        ' 10  ',\n        '50,000 ',\n        ' ',\n        '\\'  '\n      ],\n      gradient: 'from-blue-500 to-cyan-500'\n    },\n    professional: {\n      name: 'Professional',\n      price: '299',\n      features: [\n        ' 50  ',\n        '200,000 ',\n        'Intelligence Analysis',\n        'RAG -  ',\n        ' ',\n        ' '\n      ],\n      gradient: 'from-purple-500 to-pink-500'\n    },\n    enterprise: {\n      name: 'Enterprise',\n      price: '999',\n      features: [\n        '  ',\n        '  ',\n        ' \\'',\n        'Deep Legal Profiler',\n        ' 24/7',\n        'API Access'\n      ],\n      gradient: 'from-orange-500 to-red-500'\n    }\n  };\n\n  const targetTier = tierInfo[requiredTier];\n\n  const handleUpgrade = () => {\n    onClose();\n    // Prefer the subscription/payment flow page for upgrades\n    navigate('/subscription', { state: { highlightTier: requiredTier } });\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\" dir=\"rtl\">\n      <div className=\"bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 rounded-2xl shadow-2xl w-full max-w-lg md:max-w-2xl border border-white/20 overflow-hidden\">\n        {/* Header */}\n        <div className={`bg-gradient-to-r ${targetTier.gradient} p-6 text-white flex items-center justify-between`}>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center\">\n              <Lock size={24} />\n            </div>\n            <div>\n              <h2 className=\"text-2xl font-bold\">' </h2>\n              <p className=\"text-blue-100 text-sm mt-1\">{featureName}</p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n          >\n            <X size={24} />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-4 md:p-8\">\n          {featureDescription && (\n            <div className=\"mb-6 bg-white/5 rounded-lg p-4 border border-white/10\">\n              <p className=\"text-white/80 text-right\">{featureDescription}</p>\n            </div>\n          )}\n\n          <div className=\"mb-6\">\n            <p className=\"text-white text-lg mb-4 text-right\">\n                -<strong className=\"text-yellow-400\">{featureName}</strong>,  {' '}\n              <strong className={`text-transparent bg-clip-text bg-gradient-to-r ${targetTier.gradient}`}>\n                {targetTier.name}\n              </strong>\n              {' '}.\n            </p>\n          </div>\n\n          {/* Tier Card */}\n          <div className={`bg-gradient-to-br ${targetTier.gradient} rounded-xl p-6 mb-6 border-2 border-white/30`}>\n            <div className=\"flex items-center justify-between mb-4\">\n              <div>\n                <h3 className=\"text-2xl font-bold text-white mb-1\">{targetTier.name}</h3>\n                <p className=\"text-white/80 text-sm\"> </p>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-3xl font-bold text-white\">{targetTier.price}</p>\n                <p className=\"text-white/80 text-sm\"></p>\n              </div>\n            </div>\n\n            <div className=\"space-y-2 mb-4\">\n              {targetTier.features.map((feature, index) => (\n                <div key={index} className=\"flex items-center gap-2 text-white\">\n                  <Check size={18} className=\"flex-shrink-0\" />\n                  <span className=\"text-sm\">{feature}</span>\n                </div>\n              ))}\n            </div>\n\n            <button\n              onClick={handleUpgrade}\n              className=\"w-full bg-white text-slate-900 py-3 rounded-lg font-bold hover:bg-white/90 transition-all flex items-center justify-center gap-2\"\n            >\n              <Crown size={20} />\n               \n            </button>\n          </div>\n\n          {/* Additional Info */}\n          <div className=\"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4\">\n            <div className=\"flex items-start gap-3\">\n              <Info className=\"text-blue-400 flex-shrink-0 mt-0.5\" size={20} />\n              <div className=\"text-right\">\n                <p className=\"text-blue-200 text-sm\">\n                  <strong> ?</strong>\n                </p>\n                <p className=\"text-blue-300 text-xs mt-1\">\n                   {targetTier.name}    ' ,   ,\n                   ,  .\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UpgradeModal;\n","/**\n * ContradictionCard -   \n *\n *  CODE-003: Migrated to TypeScript\n *\n *        :\n * -   \n * -  \n * -  \n */\n\nimport React, { useState, type FC } from 'react';\nimport {\n  Swords,\n  FileText,\n  ChevronDown,\n  ChevronUp,\n  ExternalLink,\n  AlertTriangle,\n  Zap\n} from 'lucide-react';\n\n// ===========================\n// Types\n// ===========================\n\ntype SeverityLevel = 'critical' | 'high' | 'medium' | 'low';\n\ninterface SeverityConfig {\n  label: string;\n  color: string;\n  bgClass: string;\n  barClass: string;\n  iconClass: string;\n  min: number;\n}\n\ninterface ContradictionData {\n  claim1?: string | null;\n  claim2?: string | null;\n  source1?: string | null;\n  source2?: string | null;\n  score?: number;\n  severity_score?: number;\n  type?: string;\n  explanation?: string;\n  questions?: string[];\n}\n\ninterface ContradictionCardProps {\n  contradiction?: ContradictionData;\n  text?: string;\n  onViewSource?: (source: string) => void;\n  className?: string;\n}\n\ninterface ClaimSideProps {\n  claim: string;\n  source?: string | null;\n  label: string;\n  colorClass: string;\n  onViewSource?: (source: string) => void;\n}\n\n// ===========================\n// Constants\n// ===========================\n\nconst SEVERITY_CONFIG: Record<SeverityLevel, SeverityConfig> = {\n  critical: {\n    label: '',\n    color: 'red',\n    bgClass: 'bg-red-500/20 border-red-500/50',\n    barClass: 'bg-red-500',\n    iconClass: 'text-red-400',\n    min: 80\n  },\n  high: {\n    label: '',\n    color: 'orange',\n    bgClass: 'bg-orange-500/20 border-orange-500/50',\n    barClass: 'bg-orange-500',\n    iconClass: 'text-orange-400',\n    min: 60\n  },\n  medium: {\n    label: '',\n    color: 'yellow',\n    bgClass: 'bg-yellow-500/20 border-yellow-500/50',\n    barClass: 'bg-yellow-500',\n    iconClass: 'text-yellow-400',\n    min: 40\n  },\n  low: {\n    label: '',\n    color: 'blue',\n    bgClass: 'bg-blue-500/20 border-blue-500/50',\n    barClass: 'bg-blue-500',\n    iconClass: 'text-blue-400',\n    min: 0\n  }\n};\n\n// ===========================\n// Helper Functions\n// ===========================\n\nconst getSeverityConfig = (score: number): SeverityConfig => {\n  if (score >= 80) return SEVERITY_CONFIG.critical;\n  if (score >= 60) return SEVERITY_CONFIG.high;\n  if (score >= 40) return SEVERITY_CONFIG.medium;\n  return SEVERITY_CONFIG.low;\n};\n\nconst looksLikeNoContradiction = (t: string): boolean => {\n  const s = (t || '').toLowerCase();\n  return (\n    s.includes(' ') ||\n    s.includes(' ') ||\n    s.includes('  ') ||\n    s.includes('  ') ||\n    s.includes('  ') ||\n    s.includes('  ')\n  );\n};\n\nconst normalizeScore = (raw: unknown): number | undefined => {\n  if (raw === null || raw === undefined) return undefined;\n  const n = Number(raw);\n  if (Number.isNaN(n)) return undefined;\n  // Support 0..1 and 0..100\n  if (n >= 0 && n <= 1) return Math.round(n * 100);\n  if (n >= 0 && n <= 100) return Math.round(n);\n  return Math.max(0, Math.min(100, Math.round(n)));\n};\n\n// Parse contradiction from text (AI might format it differently)\nconst parseContradiction = (text: string): ContradictionData => {\n  // Try to extract two claims and sources from text\n  const claim1Match = text.match(/(?:\\s*1|\\s*1|\\s*)[:\\s]*[\"\"]?([^\"\"]+)[\"\"]?/i);\n  const claim2Match = text.match(/(?:\\s*2|\\s*2|\\s*)[:\\s]*[\"\"]?([^\"\"]+)[\"\"]?/i);\n  const source1Match = text.match(/(?:||)[:\\s]*([^\\n,]+)/i);\n  const source2Match = text.match(/(?:| )[:\\s]*([^\\n]+)/i);\n  const scoreMatch = text.match(/(?:||)[:\\s]*(\\d+)/i);\n\n  return {\n    claim1: claim1Match?.[1]?.trim() || null,\n    claim2: claim2Match?.[1]?.trim() || null,\n    source1: source1Match?.[1]?.trim() || null,\n    source2: source2Match?.[1]?.trim() || null,\n    score: scoreMatch ? parseInt(scoreMatch[1]) : undefined\n  };\n};\n\n// ===========================\n// ClaimSide Component\n// ===========================\n\nconst ClaimSide: FC<ClaimSideProps> = ({ claim, source, label, colorClass, onViewSource }) => (\n  <div className=\"flex-1 min-w-0\">\n    <div className=\"flex items-center gap-2 mb-2\">\n      <FileText size={14} className={colorClass} />\n      <span className=\"text-xs font-semibold text-white/60\">{label}</span>\n    </div>\n\n    <div className=\"bg-black/20 rounded-lg p-3 border border-white/10\">\n      <p className=\"text-white/90 text-sm leading-relaxed\">\n        \"{claim}\"\n      </p>\n\n      {source && (\n        <div className=\"mt-2 pt-2 border-t border-white/10 flex items-center justify-between\">\n          <span className=\"text-xs text-white/50\">\n             {source}\n          </span>\n          {onViewSource && (\n            <button\n              onClick={() => onViewSource(source)}\n              className=\"text-xs text-blue-400 hover:text-blue-300 flex items-center gap-1 transition-colors\"\n            >\n              <ExternalLink size={10} />\n              \n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  </div>\n);\n\n// ===========================\n// Main Component\n// ===========================\n\nconst ContradictionCard: FC<ContradictionCardProps> = ({\n  contradiction,\n  text,\n  onViewSource,\n  className = ''\n}) => {\n  const [isExpanded, setIsExpanded] = useState(true);\n\n  // Parse from text if structured data not provided\n  const data = contradiction || parseContradiction(text || '');\n  const score = normalizeScore((data as any).score ?? (data as any).severity_score);\n  const severity = score !== undefined ? getSeverityConfig(score) : undefined;\n  const noContradiction = looksLikeNoContradiction(text || '');\n\n  // If the content explicitly says there's no contradiction, don't render a \"contradiction\" card.\n  if (noContradiction && text) {\n    return (\n      <div className={`rounded-xl border bg-slate-500/10 border-slate-500/30 overflow-hidden ${className}`}>\n        <div className=\"flex items-center gap-3 px-4 py-3\">\n          <AlertTriangle size={18} className=\"text-slate-300\" />\n          <span className=\"font-bold text-white\">  </span>\n        </div>\n        <div className=\"px-4 pb-4 pt-1 border-t border-white/10\">\n          <p className=\"text-white/80 text-sm\">{text}</p>\n        </div>\n      </div>\n    );\n  }\n\n  // If we couldn't parse claims, show simple view\n  if (!data.claim1 && !data.claim2 && text) {\n    return (\n      <div className={`rounded-xl border ${severity ? severity.bgClass : 'bg-slate-500/10 border-slate-500/30'} overflow-hidden ${className}`}>\n        <div className=\"flex items-center gap-3 px-4 py-3\">\n          <Swords size={20} className={severity ? severity.iconClass : 'text-slate-300'} />\n          <span className=\"font-bold text-white\">\n            {severity ? ` ${severity.label}` : ' '}\n          </span>\n          <div className=\"flex-1\" />\n          {score !== undefined && severity && (\n            <div className=\"flex items-center gap-2\" title=\"  (0100)\">\n              <div className=\"w-20 h-2 bg-white/10 rounded-full overflow-hidden\">\n                <div\n                  className={`h-full ${severity.barClass} transition-all`}\n                  style={{ width: `${score}%` }}\n                />\n              </div>\n              <span className=\"text-xs text-white/60\">{score}</span>\n            </div>\n          )}\n        </div>\n        <div className=\"px-4 pb-4 pt-1 border-t border-white/10\">\n          <p className=\"text-white/80 text-sm\">{text}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`rounded-xl border ${severity ? severity.bgClass : 'bg-slate-500/10 border-slate-500/30'} overflow-hidden ${className}`}>\n      {/* Header */}\n      <div\n        className=\"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-white/5 transition-colors\"\n        onClick={() => setIsExpanded(!isExpanded)}\n      >\n        <div className=\"relative\">\n          <Swords size={20} className={severity ? severity.iconClass : 'text-slate-300'} />\n          {score !== undefined && score >= 80 && (\n            <Zap size={10} className=\"absolute -top-1 -right-1 text-yellow-400\" />\n          )}\n        </div>\n\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"font-bold text-white\"></span>\n            {severity ? (\n              <span className={`text-xs px-2 py-0.5 rounded-full ${severity.bgClass} ${severity.iconClass}`}>\n                {severity.label}\n              </span>\n            ) : (\n              <span className=\"text-xs px-2 py-0.5 rounded-full bg-slate-500/10 border border-slate-500/30 text-slate-200\">\n                 \n              </span>\n            )}\n          </div>\n          {data.type && (\n            <span className=\"text-xs text-white/50\">{data.type}</span>\n          )}\n        </div>\n\n        {/* Severity bar */}\n        {score !== undefined && severity && (\n          <div className=\"flex items-center gap-2\" title=\"  (0100)\">\n            <div className=\"w-24 h-2.5 bg-white/10 rounded-full overflow-hidden\">\n              <div\n                className={`h-full ${severity.barClass} transition-all duration-500`}\n                style={{ width: `${score}%` }}\n              />\n            </div>\n            <span className=\"text-sm font-bold text-white/80 w-8\">{score}</span>\n          </div>\n        )}\n\n        <button className=\"text-white/40 hover:text-white/60 transition-colors\">\n          {isExpanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n        </button>\n      </div>\n\n      {/* Content - Side by Side Claims */}\n      {isExpanded && (\n        <div className=\"px-4 pb-4 pt-2 border-t border-white/10\">\n          <div className=\"flex gap-4\">\n            {/* Claim 1 */}\n            {data.claim1 && (\n              <ClaimSide\n                claim={data.claim1}\n                source={data.source1}\n                label=\" '\"\n                colorClass=\"text-blue-400\"\n                onViewSource={onViewSource}\n              />\n            )}\n\n            {/* Divider */}\n            {data.claim1 && data.claim2 && (\n              <div className=\"flex flex-col items-center justify-center px-2\">\n                <div className=\"w-px h-full bg-white/20\" />\n                <div className=\"my-2 p-1.5 rounded-full bg-white/10\">\n                  <AlertTriangle size={14} className=\"text-yellow-400\" />\n                </div>\n                <div className=\"w-px h-full bg-white/20\" />\n              </div>\n            )}\n\n            {/* Claim 2 */}\n            {data.claim2 && (\n              <ClaimSide\n                claim={data.claim2}\n                source={data.source2}\n                label=\" '\"\n                colorClass=\"text-purple-400\"\n                onViewSource={onViewSource}\n              />\n            )}\n          </div>\n\n          {/* Explanation if available */}\n          {data.explanation && (\n            <div className=\"mt-3 pt-3 border-t border-white/10\">\n              <p className=\"text-xs text-white/60\">\n                 {data.explanation}\n              </p>\n            </div>\n          )}\n\n          {/* Questions if available */}\n          {data.questions && data.questions.length > 0 && (\n            <div className=\"mt-3 pt-3 border-t border-white/10\">\n              <p className=\"text-xs font-semibold text-white/70 mb-2\">  :</p>\n              <ul className=\"space-y-1\">\n                {data.questions.slice(0, 3).map((q, i) => (\n                  <li key={i} className=\"text-xs text-white/60 flex items-start gap-2\">\n                    <span className=\"text-white/30\">{i + 1}.</span>\n                    <span>{q}</span>\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ContradictionCard;\n","/**\n * EntityHighlighter -   \n *\n *  CODE-003: Migrated to TypeScript\n *\n *  :\n * -   ()\n * -  ()\n * -  ()\n * -  (   )\n */\n\nimport React, { type FC, type ReactNode, type ComponentType } from 'react';\n\n// ===========================\n// Types\n// ===========================\n\ntype EntityType = 'date' | 'amount' | 'document' | 'page';\n\ninterface Entity {\n  type: EntityType;\n  text: string;\n  start: number;\n  end: number;\n}\n\ninterface EntityStyle {\n  className: string;\n  icon: string;\n}\n\ninterface Part {\n  type: 'text' | 'entity';\n  content: string;\n  entityType?: EntityType;\n}\n\ninterface EntityHighlighterProps {\n  text: string;\n  onEntityClick?: (type: EntityType, text: string) => void;\n  className?: string;\n}\n\ninterface EntitySpanProps {\n  type: EntityType;\n  text: string;\n  onClick?: () => void;\n}\n\n// ===========================\n// Constants\n// ===========================\n\n// Regex patterns for entity detection\nconst PATTERNS: Record<EntityType, RegExp> = {\n  // Hebrew dates: 15.3.2024, 15/3/2024, 15  2024\n  date: /(\\d{1,2}[./]\\d{1,2}[./]\\d{2,4}|\\d{1,2}\\s+?(|||||||||||)\\s+\\d{2,4})/gi,\n\n  // Currency amounts: 50,000, 50,000 \", $1,000\n  amount: /(\\s?[\\d,]+(?:\\.\\d{2})?|[\\d,]+(?:\\.\\d{2})?\\s?(?:\"||||\\$||)|[\\d,]+\\s?)/gi,\n\n  // Document references:  ',  1, , \n  document: /(\\s?[-'\"\\d]+|\\s?[-'\"\\d]+|(?:\\s+\\S+)?|(?:\\s+\\S+)?|\\s+(?:||)|(?:\\s+\\S+)?)/gi,\n\n  // Page references: ' 5,  12\n  page: /([']?\\s?\\d+|\\s?\\d+|page\\s?\\d+)/gi,\n};\n\n// Entity styles\nconst ENTITY_STYLES: Record<EntityType, EntityStyle> = {\n  date: {\n    className: 'bg-green-500/20 text-green-300 px-1 py-0.5 rounded mx-0.5 font-medium',\n    icon: '',\n  },\n  amount: {\n    className: 'bg-amber-500/20 text-amber-300 px-1 py-0.5 rounded mx-0.5 font-bold',\n    icon: '',\n  },\n  document: {\n    className: 'bg-purple-500/20 text-purple-300 px-1 py-0.5 rounded mx-0.5 underline decoration-purple-400/50 cursor-pointer hover:bg-purple-500/30 transition-colors',\n    icon: '',\n  },\n  page: {\n    className: 'bg-blue-500/20 text-blue-300 px-1 py-0.5 rounded mx-0.5',\n    icon: '',\n  },\n};\n\nconst TYPE_LABELS: Record<EntityType, string> = {\n  date: '',\n  amount: '',\n  document: '',\n  page: '',\n};\n\n// ===========================\n// Helper Functions\n// ===========================\n\n// Find all entities in text\nconst findEntities = (text: string): Entity[] => {\n  const entities: Entity[] = [];\n\n  for (const [type, pattern] of Object.entries(PATTERNS) as [EntityType, RegExp][]) {\n    let match;\n    // Reset lastIndex to start from beginning\n    pattern.lastIndex = 0;\n    while ((match = pattern.exec(text)) !== null) {\n      entities.push({\n        type,\n        text: match[0],\n        start: match.index,\n        end: match.index + match[0].length,\n      });\n    }\n  }\n\n  // Sort by position and remove overlaps\n  entities.sort((a, b) => a.start - b.start);\n\n  const filtered: Entity[] = [];\n  let lastEnd = 0;\n  for (const entity of entities) {\n    if (entity.start >= lastEnd) {\n      filtered.push(entity);\n      lastEnd = entity.end;\n    }\n  }\n\n  return filtered;\n};\n\n// ===========================\n// Entity Span Component\n// ===========================\n\nconst EntitySpan: FC<EntitySpanProps> = ({ type, text, onClick }) => {\n  const style = ENTITY_STYLES[type];\n\n  return (\n    <span\n      className={style.className}\n      onClick={onClick}\n      title={`${style.icon} ${TYPE_LABELS[type]}`}\n    >\n      {text}\n    </span>\n  );\n};\n\n// ===========================\n// Main Component\n// ===========================\n\nconst EntityHighlighter: FC<EntityHighlighterProps> = ({ text, onEntityClick, className = '' }) => {\n  if (!text) return null;\n\n  const entities = findEntities(text);\n\n  // If no entities found, return plain text\n  if (entities.length === 0) {\n    return <span className={className}>{text}</span>;\n  }\n\n  // Build parts array with entities and regular text\n  const parts: Part[] = [];\n  let lastIndex = 0;\n\n  for (const entity of entities) {\n    // Add text before entity\n    if (entity.start > lastIndex) {\n      parts.push({\n        type: 'text',\n        content: text.slice(lastIndex, entity.start),\n      });\n    }\n\n    // Add entity\n    parts.push({\n      type: 'entity',\n      entityType: entity.type,\n      content: entity.text,\n    });\n\n    lastIndex = entity.end;\n  }\n\n  // Add remaining text\n  if (lastIndex < text.length) {\n    parts.push({\n      type: 'text',\n      content: text.slice(lastIndex),\n    });\n  }\n\n  return (\n    <span className={className}>\n      {parts.map((part, index) => {\n        if (part.type === 'text') {\n          return <span key={index}>{part.content}</span>;\n        }\n        return (\n          <EntitySpan\n            key={index}\n            type={part.entityType!}\n            text={part.content}\n            onClick={() => onEntityClick?.(part.entityType!, part.content)}\n          />\n        );\n      })}\n    </span>\n  );\n};\n\n// ===========================\n// HOC for Entity Highlighting\n// ===========================\n\nexport const withEntityHighlighting = <P extends { children?: ReactNode }>(\n  Component: ComponentType<P>\n): FC<P> => {\n  return (props: P) => {\n    const { children, ...rest } = props;\n    if (typeof children === 'string') {\n      return (\n        <Component {...(rest as P)}>\n          <EntityHighlighter text={children} />\n        </Component>\n      );\n    }\n    return <Component {...props}>{children}</Component>;\n  };\n};\n\nexport default EntityHighlighter;\n","/**\n * SmartResponseRenderer - Artifact-First Response Rendering\n *\n *  NO accordions\n *  NO collapsible sections\n *  NO \" \"\n *  NO \" \"\n *\n *  Everything displayed as flat cards\n *  All content visible immediately\n *  NotebookLM-style artifact display\n */\n\nimport React, { useMemo, lazy, Suspense } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport {\n  Lightbulb,\n  CheckCircle2,\n  AlertTriangle,\n  FileText,\n  Target,\n  Scale,\n  MessageSquare,\n  Shield,\n  HelpCircle,\n  ListChecks,\n  Swords,\n  Copy,\n  Download\n} from 'lucide-react';\nimport ContradictionCard from './ContradictionCard';\nimport EntityHighlighter from './EntityHighlighter';\n\n// Lazy load MermaidDiagram for better performance\nconst MermaidDiagram = lazy(() => import('./MermaidDiagram'));\n\n// Section type definitions with styling\nconst SECTION_TYPES = {\n  contradiction: {\n    icon: Swords,\n    color: 'red',\n    bgClass: 'bg-red-500/15 border-red-500/40',\n    iconClass: 'text-red-400',\n    titleClass: 'text-red-200',\n    patterns: ['', 'contradiction', '', '', '', ' ']\n  },\n  insight: {\n    icon: Lightbulb,\n    color: 'amber',\n    bgClass: 'bg-amber-500/10 border-amber-500/30',\n    iconClass: 'text-amber-400',\n    titleClass: 'text-amber-200',\n    patterns: ['', 'insight', ' ', '', '', '']\n  },\n  recommendation: {\n    icon: CheckCircle2,\n    color: 'emerald',\n    bgClass: 'bg-emerald-500/10 border-emerald-500/30',\n    iconClass: 'text-emerald-400',\n    titleClass: 'text-emerald-200',\n    patterns: ['', '', 'recommend', '', '', '', 'action']\n  },\n  warning: {\n    icon: AlertTriangle,\n    color: 'red',\n    bgClass: 'bg-red-500/10 border-red-500/30',\n    iconClass: 'text-red-400',\n    titleClass: 'text-red-200',\n    patterns: ['', 'warning', '', ' ', ' ', '', '']\n  },\n  source: {\n    icon: FileText,\n    color: 'blue',\n    bgClass: 'bg-blue-500/10 border-blue-500/30',\n    iconClass: 'text-blue-400',\n    titleClass: 'text-blue-200',\n    patterns: ['', 'source', '', '', '', '', '']\n  },\n  strategy: {\n    icon: Target,\n    color: 'purple',\n    bgClass: 'bg-purple-500/10 border-purple-500/30',\n    iconClass: 'text-purple-400',\n    titleClass: 'text-purple-200',\n    patterns: ['', 'strategy', '', '', '']\n  },\n  battle: {\n    icon: Swords,\n    color: 'rose',\n    bgClass: 'bg-rose-500/10 border-rose-500/30',\n    iconClass: 'text-rose-400',\n    titleClass: 'text-rose-200',\n    patterns: ['', 'battle', '', '', '', 'conflict']\n  },\n  legal: {\n    icon: Scale,\n    color: 'indigo',\n    bgClass: 'bg-indigo-500/10 border-indigo-500/30',\n    iconClass: 'text-indigo-400',\n    titleClass: 'text-indigo-200',\n    patterns: ['', 'legal', '', '', '', '', '']\n  },\n  strength: {\n    icon: Shield,\n    color: 'green',\n    bgClass: 'bg-green-500/10 border-green-500/30',\n    iconClass: 'text-green-400',\n    titleClass: 'text-green-200',\n    patterns: ['', 'strength', '', ' ']\n  },\n  question: {\n    icon: HelpCircle,\n    color: 'cyan',\n    bgClass: 'bg-cyan-500/10 border-cyan-500/30',\n    iconClass: 'text-cyan-400',\n    titleClass: 'text-cyan-200',\n    patterns: ['', 'question', ' ', '']\n  },\n  summary: {\n    icon: ListChecks,\n    color: 'slate',\n    bgClass: 'bg-slate-500/10 border-slate-500/30',\n    iconClass: 'text-slate-300',\n    titleClass: 'text-slate-200',\n    patterns: ['', 'summary', '', '']\n  }\n};\n\n// Helper to process children with entity highlighting\nconst processChildren = (children) => {\n  if (typeof children === 'string') {\n    return <EntityHighlighter text={children} />;\n  }\n  if (Array.isArray(children)) {\n    return children.map((child, i) => {\n      if (typeof child === 'string') {\n        return <EntityHighlighter key={i} text={child} />;\n      }\n      return child;\n    });\n  }\n  return children;\n};\n\n// Enhanced markdown components - NO ul/li, use cards instead\nconst CardMarkdownComponents = {\n  h1: ({node, children, ...props}) => <h4 className=\"text-base font-bold mt-3 mb-2 text-white\" {...props}>{processChildren(children)}</h4>,\n  h2: ({node, children, ...props}) => <h5 className=\"text-sm font-bold mt-2 mb-1 text-white/90\" {...props}>{processChildren(children)}</h5>,\n  h3: ({node, children, ...props}) => <h6 className=\"text-sm font-semibold mt-2 mb-1 text-white/80\" {...props}>{processChildren(children)}</h6>,\n  // Convert lists to card-like items\n  ul: ({node, children, ...props}) => (\n    <div className=\"space-y-2 my-3\" {...props}>{children}</div>\n  ),\n  ol: ({node, children, ...props}) => (\n    <div className=\"space-y-2 my-3\" {...props}>{children}</div>\n  ),\n  li: ({node, children, ...props}) => (\n    <div className=\"flex items-start gap-3 p-3 bg-white/5 rounded-lg border border-white/10\" {...props}>\n      <span className=\"w-2 h-2 rounded-full bg-blue-400 mt-1.5 flex-shrink-0\" />\n      <span className=\"flex-1 text-white/90\">{processChildren(children)}</span>\n    </div>\n  ),\n  p: ({node, children, ...props}) => <p className=\"my-1.5 leading-relaxed text-white/85\" {...props}>{processChildren(children)}</p>,\n  strong: ({node, children, ...props}) => <strong className=\"font-semibold text-white\" {...props}>{processChildren(children)}</strong>,\n  em: ({node, children, ...props}) => <em className=\"text-white/70 italic\" {...props}>{processChildren(children)}</em>,\n  code: ({node, inline, className, children, ...props}) => {\n    const isMermaid = /language-mermaid/.test(className || '');\n\n    if (isMermaid && !inline) {\n      const chartCode = String(children).replace(/\\n$/, '');\n      return (\n        <Suspense fallback={\n          <div className=\"bg-slate-800/50 rounded-xl p-4 border border-white/10 animate-pulse\">\n            <div className=\"text-white/40 text-sm text-center\"> ...</div>\n          </div>\n        }>\n          <MermaidDiagram chart={chartCode} className=\"my-3\" />\n        </Suspense>\n      );\n    }\n\n    if (inline) {\n      return <code className=\"bg-white/10 rounded px-1.5 py-0.5 text-xs font-mono text-amber-200\" {...props}>{children}</code>;\n    }\n\n    return <code className=\"block bg-black/30 rounded-lg p-3 my-2 font-mono text-sm text-white/90 border border-white/10 overflow-x-auto\" {...props}>{children}</code>;\n  },\n  pre: ({node, children, ...props}) => <>{children}</>,\n  blockquote: ({node, children, ...props}) => (\n    <blockquote className=\"border-r-2 border-white/30 pr-3 my-2 text-white/70 italic\" {...props}>{processChildren(children)}</blockquote>\n  ),\n  a: ({node, children, ...props}) => <a className=\"text-blue-300 hover:text-blue-200 underline\" target=\"_blank\" rel=\"noopener noreferrer\" {...props}>{children}</a>,\n  table: ({node, children, ...props}) => (\n    <div className=\"overflow-x-auto my-3\">\n      <table className=\"w-full border-collapse bg-white/5 rounded-lg overflow-hidden\" {...props}>{children}</table>\n    </div>\n  ),\n  thead: ({node, children, ...props}) => <thead className=\"bg-white/10\" {...props}>{children}</thead>,\n  tbody: ({node, children, ...props}) => <tbody className=\"divide-y divide-white/10\" {...props}>{children}</tbody>,\n  tr: ({node, children, ...props}) => <tr className=\"hover:bg-white/5 transition-colors\" {...props}>{children}</tr>,\n  th: ({node, children, ...props}) => <th className=\"px-3 py-2 text-right text-sm font-semibold text-white border-b border-white/20\" {...props}>{processChildren(children)}</th>,\n  td: ({node, children, ...props}) => <td className=\"px-3 py-2 text-sm text-white/90\" {...props}>{processChildren(children)}</td>,\n};\n\n// Detect section type from title\nconst detectSectionType = (title) => {\n  const lowerTitle = title.toLowerCase();\n\n  for (const [type, config] of Object.entries(SECTION_TYPES)) {\n    if (config.patterns.some(pattern => lowerTitle.includes(pattern.toLowerCase()))) {\n      return type;\n    }\n  }\n\n  // Check for emoji patterns\n  if (title.includes('') || title.includes('')) return 'insight';\n  if (title.includes('') || title.includes('')) return 'recommendation';\n  if (title.includes('') || title.includes('')) return 'warning';\n  if (title.includes('') || title.includes('')) return 'source';\n  if (title.includes('') || title.includes('')) return 'strategy';\n  if (title.includes('') || title.includes('')) return 'legal';\n  if (title.includes('') || title.includes('')) return 'strength';\n  if (title.includes('') || title.includes('')) return 'question';\n\n  return null;\n};\n\n// Parse response into sections\nconst parseResponseIntoSections = (content) => {\n  if (!content) return [];\n\n  const lines = content.split('\\n');\n  const sections = [];\n  let currentSection = null;\n  let introContent = [];\n\n  for (const line of lines) {\n    const headerMatch = line.match(/^(#{1,3})\\s*(.+)$/);\n    const emojiHeaderMatch = line.match(/^([])\\s*(.+)$/);\n    const boldHeaderMatch = line.match(/^\\*\\*([^*]+)\\*\\*:?\\s*$/);\n\n    if (headerMatch || emojiHeaderMatch || boldHeaderMatch) {\n      if (currentSection) {\n        sections.push(currentSection);\n      } else if (introContent.length > 0) {\n        const introText = introContent.join('\\n').trim();\n        if (introText) {\n          sections.push({\n            type: null,\n            title: null,\n            content: introText,\n            isIntro: true\n          });\n        }\n      }\n\n      const title = headerMatch ? headerMatch[2] : (emojiHeaderMatch ? emojiHeaderMatch[2] : boldHeaderMatch[1]);\n      const sectionType = detectSectionType(title);\n\n      currentSection = {\n        type: sectionType,\n        title: title.trim(),\n        content: '',\n        lines: []\n      };\n    } else if (currentSection) {\n      currentSection.lines.push(line);\n    } else {\n      introContent.push(line);\n    }\n  }\n\n  if (currentSection) {\n    currentSection.content = currentSection.lines.join('\\n').trim();\n    delete currentSection.lines;\n    sections.push(currentSection);\n  } else if (introContent.length > 0 && sections.length === 0) {\n    sections.push({\n      type: null,\n      title: null,\n      content: introContent.join('\\n').trim(),\n      isIntro: true\n    });\n  }\n\n  return sections.map(section => {\n    if (section.lines) {\n      section.content = section.lines.join('\\n').trim();\n      delete section.lines;\n    }\n    return section;\n  }).filter(s => s.content || s.title);\n};\n\nconst downloadWordDoc = ({ filename, title, content }) => {\n  const safeTitle = String(title || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n  const safe = String(content || '')\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\\n/g, '<br/>');\n  const html = `<!doctype html><html><head><meta charset=\"utf-8\"/></head><body dir=\"rtl\"><h1>${safeTitle}</h1><div style=\"line-height:1.5;\">${safe}</div></body></html>`;\n  const blob = new Blob([html], { type: 'application/msword' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = filename || 'yitro.doc';\n  a.click();\n  URL.revokeObjectURL(url);\n};\n\nconst copyToClipboard = async (text) => {\n  try {\n    await navigator.clipboard.writeText(String(text || ''));\n  } catch {\n    // ignore\n  }\n};\n\n/**\n * SectionCard - ALWAYS EXPANDED, NO COLLAPSE\n */\nconst SectionCard = ({ section, isLast }) => {\n  const config = section.type ? SECTION_TYPES[section.type] : null;\n  const Icon = config?.icon || MessageSquare;\n\n  // For intro sections without a type, use simpler styling\n  if (section.isIntro) {\n    return (\n      <div className={`text-white/90 w-full min-w-0 ${!isLast ? 'mb-4' : ''}`}>\n        <ReactMarkdown remarkPlugins={[remarkGfm]} components={CardMarkdownComponents}>\n          {section.content}\n        </ReactMarkdown>\n      </div>\n    );\n  }\n\n  // For sections with title but no recognized type\n  if (!section.type && section.title) {\n    return (\n      <div className={`rounded-xl border bg-slate-500/10 border-slate-500/30 overflow-hidden w-full min-w-0 ${!isLast ? 'mb-3' : ''}`}>\n        <div className=\"flex items-center gap-2 px-4 py-2.5 border-b border-white/5\">\n          <MessageSquare size={18} className=\"text-slate-300\" />\n          <span className=\"font-semibold text-sm flex-1 text-slate-200\">\n            {section.title}\n          </span>\n          <button\n            onClick={() => copyToClipboard(`${section.title}\\n\\n${section.content || ''}`)}\n            className=\"p-1.5 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors\"\n            title=\"\"\n          >\n            <Copy size={14} />\n          </button>\n        </div>\n        <div className=\"px-4 py-3\">\n          <ReactMarkdown remarkPlugins={[remarkGfm]} components={CardMarkdownComponents}>\n            {section.content}\n          </ReactMarkdown>\n        </div>\n      </div>\n    );\n  }\n\n  // Special rendering for contradiction sections\n  if (section.type === 'contradiction') {\n    return (\n      <div className={`w-full min-w-0 ${!isLast ? 'mb-3' : ''}`}>\n        <ContradictionCard\n          text={`${section.title}\\n${section.content}`}\n        />\n      </div>\n    );\n  }\n\n  // Regular typed section - ALWAYS EXPANDED\n  return (\n    <div className={`rounded-xl border ${config.bgClass} overflow-hidden w-full min-w-0 ${!isLast ? 'mb-3' : ''}`}>\n      {/* Header */}\n      <div className=\"flex items-center gap-2 px-4 py-2.5 border-b border-white/5\">\n        <Icon size={18} className={config.iconClass} />\n        <span className={`font-semibold text-sm flex-1 ${config.titleClass}`}>\n          {section.title}\n        </span>\n        <button\n          onClick={() => copyToClipboard(`${section.title}\\n\\n${section.content || ''}`)}\n          className=\"p-1.5 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors\"\n          title=\"\"\n        >\n          <Copy size={14} />\n        </button>\n        <button\n          onClick={() => downloadWordDoc({\n            filename: `yitro-${(section.title || 'section').slice(0, 24)}.doc`,\n            title: section.title || '',\n            content: section.content || ''\n          })}\n          className=\"p-1.5 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors\"\n          title=\"\"\n        >\n          <Download size={14} />\n        </button>\n      </div>\n\n      {/* Content - ALWAYS VISIBLE */}\n      <div className=\"px-4 py-3\">\n        <ReactMarkdown remarkPlugins={[remarkGfm]} components={CardMarkdownComponents}>\n          {section.content}\n        </ReactMarkdown>\n      </div>\n    </div>\n  );\n};\n\n/**\n * SmartResponseRenderer - Main Component\n *\n * Renders response as flat, non-collapsible cards\n */\nconst SmartResponseRenderer = ({ content, className = '' }) => {\n  const sections = useMemo(() => parseResponseIntoSections(content), [content]);\n\n  // If parsing failed or content is very short, fall back to simple rendering\n  if (sections.length === 0 || (sections.length === 1 && sections[0].isIntro && content.length < 200)) {\n    return (\n      <div className={`text-white/90 leading-relaxed ${className}`}>\n        <ReactMarkdown remarkPlugins={[remarkGfm]} components={CardMarkdownComponents}>\n          {content}\n        </ReactMarkdown>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`space-y-1 w-full min-w-0 overflow-hidden ${className}`}>\n      {/* Section navigation tabs - for jumping, not for collapsing */}\n      {sections.length > 1 && (\n        <div className=\"mb-3 flex flex-wrap gap-2\">\n          {sections.map((s, index) => {\n            if (s.isIntro) return null;\n            const config = s.type ? SECTION_TYPES[s.type] : null;\n            const Icon = config?.icon || MessageSquare;\n            return (\n              <a\n                key={`${s.title || 'section'}-${index}`}\n                href={`#section-${index}`}\n                className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs bg-white/5 text-white/70 border border-white/10 hover:bg-white/10 hover:text-white transition-colors\"\n              >\n                <Icon size={12} className={config?.iconClass || 'text-white/50'} />\n                <span>{(s.title || ` ${index + 1}`).slice(0, 20)}</span>\n              </a>\n            );\n          })}\n        </div>\n      )}\n\n      {/* All sections - ALWAYS EXPANDED */}\n      {sections.map((section, index) => (\n        <div key={index} id={`section-${index}`}>\n          <SectionCard\n            section={section}\n            isLast={index === sections.length - 1}\n          />\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default SmartResponseRenderer;\n","/**\n * WaveLoader -      \n *\n *     (   )\n * +      \n * +   -   ,  \n */\n\nimport React, { useState, useEffect, useRef, type FC } from 'react';\n\n// ===========================\n// Types\n// ===========================\n\ninterface WaveLoaderProps {\n  size?: number;\n  className?: string;\n  showText?: boolean;\n  progress?: number; // 0-100\n  progressMessage?: string;\n}\n\n// ===========================\n// Hebrew Action Words - Grouped by \"mood\"\n// ===========================\n\nconst THINKING_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\nconst ANALYZING_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\nconst LEARNING_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\nconst EXCITED_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\nconst COOKING_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\nconst WORKING_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\n//   -      \nconst INVENTED_WORDS = [\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n];\n\n// Combine all words\nconst ALL_WORDS = [\n  ...THINKING_WORDS,\n  ...ANALYZING_WORDS,\n  ...LEARNING_WORDS,\n  ...EXCITED_WORDS,\n  ...COOKING_WORDS,\n  ...WORKING_WORDS,\n  ...INVENTED_WORDS,\n];\n\n// Mood configurations\ntype Mood = 'thinking' | 'analyzing' | 'learning' | 'excited' | 'cooking' | 'working' | 'weird';\n\nconst MOOD_CONFIG: Record<Mood, { words: string[]; minDelay: number; maxDelay: number; waveSpeed: number }> = {\n  thinking: { words: THINKING_WORDS, minDelay: 4000, maxDelay: 7000, waveSpeed: 4.5 },\n  analyzing: { words: ANALYZING_WORDS, minDelay: 2500, maxDelay: 4500, waveSpeed: 3.5 },\n  learning: { words: LEARNING_WORDS, minDelay: 3000, maxDelay: 5500, waveSpeed: 4.0 },\n  excited: { words: EXCITED_WORDS, minDelay: 800, maxDelay: 1500, waveSpeed: 1.8 },\n  cooking: { words: COOKING_WORDS, minDelay: 3000, maxDelay: 5000, waveSpeed: 4.0 },\n  working: { words: WORKING_WORDS, minDelay: 2000, maxDelay: 4000, waveSpeed: 3.0 },\n  weird: { words: INVENTED_WORDS, minDelay: 2000, maxDelay: 4000, waveSpeed: 2.5 },\n};\n\nconst MOODS: Mood[] = ['thinking', 'analyzing', 'learning', 'excited', 'cooking', 'working', 'weird'];\n\n// ===========================\n// Component\n// ===========================\n\nconst WaveLoader: FC<WaveLoaderProps> = ({\n  size = 60,\n  className = '',\n  showText = true,\n  progress,\n  progressMessage,\n}) => {\n  const [currentWord, setCurrentWord] = useState(ALL_WORDS[0]);\n  const [mood, setMood] = useState<Mood>('analyzing');\n  const [waveSpeed, setWaveSpeed] = useState(3.5);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const moodTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Random number helper\n  const randomBetween = (min: number, max: number) =>\n    Math.floor(Math.random() * (max - min + 1)) + min;\n\n  // Pick random word from current mood's words\n  const pickRandomWord = (currentMood: Mood) => {\n    const words = MOOD_CONFIG[currentMood].words;\n    return words[Math.floor(Math.random() * words.length)];\n  };\n\n  // Schedule next word change with variable timing\n  const scheduleNextWord = (currentMood: Mood) => {\n    const config = MOOD_CONFIG[currentMood];\n    const delay = randomBetween(config.minDelay, config.maxDelay);\n\n    timeoutRef.current = setTimeout(() => {\n      setIsTransitioning(true);\n      setTimeout(() => {\n        setCurrentWord(pickRandomWord(currentMood));\n        setIsTransitioning(false);\n        scheduleNextWord(currentMood);\n      }, 300);\n    }, delay);\n  };\n\n  // Change mood periodically (every 8-20 seconds)\n  const scheduleMoodChange = () => {\n    const delay = randomBetween(8000, 20000);\n\n    moodTimeoutRef.current = setTimeout(() => {\n      // Pick a new random mood (different from current)\n      let newMood: Mood;\n      do {\n        newMood = MOODS[Math.floor(Math.random() * MOODS.length)];\n      } while (newMood === mood && MOODS.length > 1);\n\n      setMood(newMood);\n      setWaveSpeed(MOOD_CONFIG[newMood].waveSpeed);\n      setCurrentWord(pickRandomWord(newMood));\n\n      // Clear existing word timer and start new one with new mood's timing\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      scheduleNextWord(newMood);\n      scheduleMoodChange();\n    }, delay);\n  };\n\n  useEffect(() => {\n    // Initial setup\n    setCurrentWord(pickRandomWord(mood));\n    scheduleNextWord(mood);\n    scheduleMoodChange();\n\n    return () => {\n      if (timeoutRef.current) clearTimeout(timeoutRef.current);\n      if (moodTimeoutRef.current) clearTimeout(moodTimeoutRef.current);\n    };\n  }, []);\n\n  // Update wave speed when mood changes\n  useEffect(() => {\n    setWaveSpeed(MOOD_CONFIG[mood].waveSpeed);\n  }, [mood]);\n\n  // Always show progress bar - use indeterminate animation if no progress value\n  const hasProgress = progress !== undefined && progress >= 0;\n  const showProgress = true; // Always show progress indicator\n\n  return (\n    <div className={`flex flex-col items-center ${className}`}>\n      {/* Wave Animation Container */}\n      <div\n        className=\"relative\"\n        style={{\n          width: size,\n          height: size,\n        }}\n      >\n        {/* Center dot (the \"stone\") */}\n        <div\n          className=\"absolute rounded-full\"\n          style={{\n            width: size * 0.12,\n            height: size * 0.12,\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            background: mood === 'excited'\n              ? 'linear-gradient(135deg, #f59e0b, #ef4444)'\n              : 'linear-gradient(135deg, #60a5fa, #a78bfa)',\n            boxShadow: mood === 'excited'\n              ? '0 0 20px rgba(245, 158, 11, 0.6)'\n              : '0 0 15px rgba(96, 165, 250, 0.5)',\n            animation: `center-pulse ${mood === 'excited' ? '0.5s' : '2s'} ease-in-out infinite`,\n          }}\n        />\n\n        {/* Wave rings - 4 concentric circles with variable speed */}\n        {[0, 1, 2, 3].map((i) => (\n          <div\n            key={i}\n            className=\"absolute rounded-full\"\n            style={{\n              top: '50%',\n              left: '50%',\n              transform: 'translate(-50%, -50%)',\n              border: mood === 'excited'\n                ? '2px solid rgba(245, 158, 11, 0.5)'\n                : '2px solid rgba(96, 165, 250, 0.4)',\n              animation: `wave-ripple ${waveSpeed}s ease-out infinite`,\n              animationDelay: `${i * (waveSpeed / 4)}s`,\n              opacity: 0,\n            }}\n          />\n        ))}\n\n        {/* Subtle glow rings */}\n        {[0, 1].map((i) => (\n          <div\n            key={`glow-${i}`}\n            className=\"absolute rounded-full\"\n            style={{\n              top: '50%',\n              left: '50%',\n              transform: 'translate(-50%, -50%)',\n              background: mood === 'excited'\n                ? `radial-gradient(circle, transparent 30%, rgba(245, 158, 11, 0.08) 70%, transparent 100%)`\n                : `radial-gradient(circle, transparent 30%, rgba(96, 165, 250, 0.06) 70%, transparent 100%)`,\n              animation: `wave-glow ${waveSpeed * 1.5}s ease-in-out infinite`,\n              animationDelay: `${i * (waveSpeed * 0.75)}s`,\n            }}\n          />\n        ))}\n      </div>\n\n      {/* Rotating action word */}\n      {showText && (\n        <div className=\"h-7 flex items-center justify-center mt-3\">\n          <span\n            className={`text-sm font-medium transition-all duration-300 ${\n              isTransitioning ? 'opacity-0 translate-y-2' : 'opacity-100 translate-y-0'\n            } ${\n              mood === 'excited' ? 'text-amber-400/90' : 'text-blue-300/80'\n            }`}\n          >\n            {currentWord}...\n          </span>\n        </div>\n      )}\n\n      {/* Progress Bar - Always visible */}\n      {showProgress && (\n        <div className=\"w-full max-w-[200px] mt-4\">\n          {progressMessage && (\n            <div className=\"text-white/60 text-xs text-center mb-1.5 truncate\">\n              {progressMessage}\n            </div>\n          )}\n          <div className=\"h-1.5 bg-white/10 rounded-full overflow-hidden\">\n            {hasProgress ? (\n              // Determinate progress bar\n              <div\n                className={`h-full rounded-full transition-all duration-500 ease-out ${\n                  mood === 'excited'\n                    ? 'bg-gradient-to-r from-amber-500 to-red-500'\n                    : 'bg-gradient-to-r from-blue-500 to-purple-500'\n                }`}\n                style={{ width: `${Math.min(100, Math.max(0, progress || 0))}%` }}\n              />\n            ) : (\n              // Indeterminate progress bar (animated)\n              <div\n                className={`h-full w-1/3 rounded-full ${\n                  mood === 'excited'\n                    ? 'bg-gradient-to-r from-amber-500 to-red-500'\n                    : 'bg-gradient-to-r from-blue-500 to-purple-500'\n                }`}\n                style={{\n                  animation: 'indeterminate-progress 1.5s ease-in-out infinite',\n                }}\n              />\n            )}\n          </div>\n          {hasProgress && (\n            <div className=\"text-white/40 text-[10px] text-center mt-1\">\n              {Math.round(progress || 0)}%\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* CSS Animations */}\n      <style>{`\n        @keyframes wave-ripple {\n          0% {\n            width: 15%;\n            height: 15%;\n            opacity: 0.7;\n            border-width: 2.5px;\n          }\n          100% {\n            width: 100%;\n            height: 100%;\n            opacity: 0;\n            border-width: 0.5px;\n          }\n        }\n\n        @keyframes wave-glow {\n          0%, 100% {\n            width: 20%;\n            height: 20%;\n            opacity: 0;\n          }\n          50% {\n            width: 85%;\n            height: 85%;\n            opacity: 0.4;\n          }\n        }\n\n        @keyframes center-pulse {\n          0%, 100% {\n            transform: translate(-50%, -50%) scale(1);\n          }\n          50% {\n            transform: translate(-50%, -50%) scale(1.15);\n          }\n        }\n\n        @keyframes indeterminate-progress {\n          0% {\n            transform: translateX(-100%);\n          }\n          100% {\n            transform: translateX(400%);\n          }\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default WaveLoader;\n","/**\n * Star Rating Component for Yitro's advice\n *\n *  CODE-003: Migrated to TypeScript\n *\n * Allows users to rate AI responses from 1-5 stars\n * Connects to the learning system backend\n */\n\nimport { useState, useCallback, type FC } from 'react';\nimport { Star, Sparkles } from 'lucide-react';\nimport { apiPost } from '../../utils/api';\nimport { toast } from 'sonner';\nimport { logger } from '../../utils/logger';\n\n// ===========================\n// Types\n// ===========================\n\ninterface StarRatingProps {\n  messageId?: string;\n  caseId?: string;\n  messageContent?: string;\n  onRated?: (rating: number) => void;\n  initialRating?: number;\n  size?: number;\n  showLabel?: boolean;\n}\n\n// ===========================\n// Component\n// ===========================\n\nconst StarRating: FC<StarRatingProps> = ({\n  messageId,\n  caseId,\n  messageContent,\n  onRated,\n  initialRating = 0,\n  size = 18,\n  showLabel = true\n}) => {\n  const [rating, setRating] = useState(initialRating);\n  const [hoverRating, setHoverRating] = useState(0);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [hasRated, setHasRated] = useState(initialRating > 0);\n\n  const submitRating = useCallback(async (newRating: number): Promise<void> => {\n    if (isSubmitting || !caseId) return;\n\n    setIsSubmitting(true);\n    try {\n      // Submit to learning API\n      await apiPost(`/api/cases/${caseId}/message-feedback`, {\n        message_id: messageId,\n        rating: newRating,\n        message_preview: messageContent?.slice(0, 200) || '',\n        feedback_type: 'star_rating'\n      }, { showErrorToast: false });\n\n      setRating(newRating);\n      setHasRated(true);\n      onRated?.(newRating);\n\n      // Show success feedback based on rating\n      if (newRating >= 4) {\n        toast.success('!      ');\n      } else if (newRating >= 2) {\n        toast.info('  ');\n      } else {\n        toast.info('  ');\n      }\n    } catch (err) {\n      logger.error('Failed to submit star rating:', err);\n      // Don't show error toast - the rating is still visual\n      setRating(newRating);\n      setHasRated(true);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [caseId, messageId, messageContent, isSubmitting, onRated]);\n\n  const handleClick = (starValue: number): void => {\n    if (hasRated && rating === starValue) return; // Already rated with same value\n    submitRating(starValue);\n  };\n\n  const displayRating = hoverRating || rating;\n\n  const getRatingLabel = (ratingValue: number): string => {\n    if (ratingValue === 5) return '!';\n    if (ratingValue === 4) return ' ';\n    if (ratingValue === 3) return '';\n    if (ratingValue === 2) return '';\n    return ' ';\n  };\n\n  return (\n    <div className={`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all ${\n      hasRated\n        ? 'bg-amber-500/10 border border-amber-500/30'\n        : 'bg-purple-500/10 border border-purple-500/20 hover:border-purple-500/40'\n    }`}>\n      {showLabel && (\n        <div className=\"flex items-center gap-1\">\n          {!hasRated && <Sparkles size={12} className=\"text-purple-400\" />}\n          <span className={`text-xs font-medium ${hasRated ? 'text-amber-400' : 'text-purple-300'}`}>\n            {hasRated ? ':' : '  '}\n          </span>\n        </div>\n      )}\n      <div className=\"flex items-center gap-1\">\n        {[1, 2, 3, 4, 5].map((star) => (\n          <button\n            key={star}\n            onClick={() => handleClick(star)}\n            onMouseEnter={() => !hasRated && setHoverRating(star)}\n            onMouseLeave={() => setHoverRating(0)}\n            disabled={isSubmitting}\n            className={`p-0.5 rounded-full transition-all duration-200 ${\n              isSubmitting ? 'opacity-50 cursor-wait' :\n              hasRated ? 'cursor-default' : 'hover:scale-125 hover:bg-amber-500/20'\n            }`}\n            title={`${star} `}\n          >\n            <Star\n              size={size}\n              className={`transition-all duration-200 ${\n                star <= displayRating\n                  ? 'text-amber-400 fill-amber-400 drop-shadow-[0_0_3px_rgba(251,191,36,0.5)]'\n                  : 'text-white/30 hover:text-amber-300/50'\n              } ${!hasRated && hoverRating >= star ? 'text-amber-300 fill-amber-300 scale-110' : ''}`}\n            />\n          </button>\n        ))}\n      </div>\n      {hasRated && rating > 0 && (\n        <span className={`text-xs font-semibold px-2 py-0.5 rounded-full ${\n          rating >= 4 ? 'bg-green-500/20 text-green-400' :\n          rating >= 3 ? 'bg-yellow-500/20 text-yellow-400' :\n          'bg-orange-500/20 text-orange-400'\n        }`}>\n          {getRatingLabel(rating)}\n        </span>\n      )}\n    </div>\n  );\n};\n\nexport default StarRating;\n","import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport type ActivityLogLevel = 'info' | 'success' | 'warning' | 'error';\nexport type ActivityLogType = 'upload' | 'analysis' | 'chat';\n\nexport interface ActivityLogEntry {\n  id: string;\n  ts: number;\n  type: ActivityLogType;\n  level: ActivityLogLevel;\n  message: string;\n  meta?: Record<string, unknown>;\n}\n\ninterface ActivityLogState {\n  entries: ActivityLogEntry[];\n  isCollapsed: boolean;\n  addEntry: (entry: Omit<ActivityLogEntry, 'id' | 'ts'> & { ts?: number }) => void;\n  clear: () => void;\n  setCollapsed: (collapsed: boolean) => void;\n}\n\nconst MAX_ENTRIES = 200;\n\nexport const useActivityLogStore = create<ActivityLogState>()(\n  persist(\n    (set) => ({\n      entries: [],\n      isCollapsed: false,\n\n      addEntry: (entry) =>\n        set((state) => {\n          const ts = typeof entry.ts === 'number' ? entry.ts : Date.now();\n          const newEntry: ActivityLogEntry = {\n            id: `${ts}-${Math.random().toString(36).slice(2, 10)}`,\n            ts,\n            type: entry.type,\n            level: entry.level,\n            message: entry.message,\n            meta: entry.meta\n          };\n          const next = [...state.entries, newEntry];\n          return { entries: next.slice(-MAX_ENTRIES) };\n        }),\n\n      clear: () => set({ entries: [] }),\n\n      setCollapsed: (collapsed) => set({ isCollapsed: collapsed })\n    }),\n    {\n      name: 'yitro_activity_log',\n      partialize: (state) => ({\n        entries: state.entries,\n        isCollapsed: state.isCollapsed\n      })\n    }\n  )\n);\n\n","/**\n *  RepresentationBanner -    \n * =================================================\n *\n * :\n * -  : \"/: []\" +  \"\"\n * -   : \"  : [] (: X)\" +  \n *\n * Never blocks analysis - just informational\n */\n\nimport React, { useState, useEffect, useRef } from 'react'\nimport {\n  Users,\n  Check,\n  X,\n  ChevronDown,\n  ChevronUp,\n  RefreshCw,\n  HelpCircle,\n  Scale,\n} from 'lucide-react'\nimport { apiGet, apiPost, apiDelete } from '../utils/api'\n\n// Types\ninterface EvidenceRef {\n  signal: string\n  doc_id: string\n  page: number\n  quote: string\n}\n\ninterface RepresentationState {\n  side_confirmed: string\n  client_name: string | null\n  confidence: number\n  guess_side: string\n  evidence_refs: EvidenceRef[]\n  last_resolved_at: string | null\n  resolver_version: string\n  is_confirmed: boolean\n  confidence_level: 'low' | 'medium' | 'high'\n}\n\ninterface RepresentationBannerProps {\n  caseId: string\n  onRepresentationChange?: (side: string) => void\n  compact?: boolean\n}\n\n// Side display names\nconst SIDE_LABELS: Record<string, string> = {\n  unknown: ' ',\n  plaintiff: '',\n  defendant: '',\n  petitioner: '',\n  respondent: '',\n  appellant: '',\n  respondent_appeal: ' ',\n  respondent_admin: ' ',\n}\n\n// Confidence level colors\nconst CONFIDENCE_COLORS: Record<string, string> = {\n  low: 'text-amber-400 bg-amber-500/20',\n  medium: 'text-blue-400 bg-blue-500/20',\n  high: 'text-green-400 bg-green-500/20',\n}\n\nconst CONFIDENCE_LABELS: Record<string, string> = {\n  low: ' ',\n  medium: ' ',\n  high: ' ',\n}\n\nexport default function RepresentationBanner({\n  caseId,\n  onRepresentationChange,\n  compact = false,\n}: RepresentationBannerProps) {\n  const [representation, setRepresentation] = useState<RepresentationState | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [resolving, setResolving] = useState(false)\n  const [showEvidence, setShowEvidence] = useState(false)\n  const [showSideSelector, setShowSideSelector] = useState(false)\n  const autoResolveAttemptedRef = useRef(false)\n\n  // Fetch representation state\n  const fetchRepresentation = async () => {\n    try {\n      const data = await apiGet<RepresentationState>(`/api/cases/${caseId}/representation`)\n      setRepresentation(data)\n    } catch (error) {\n      console.error('Failed to fetch representation:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    fetchRepresentation()\n  }, [caseId])\n\n  //  UX: Try auto-detection once per case if nothing is known yet.\n  useEffect(() => {\n    if (!representation) return\n    if (representation.is_confirmed) return\n    if (representation.guess_side && representation.guess_side !== 'unknown') return\n    if (autoResolveAttemptedRef.current) return\n    autoResolveAttemptedRef.current = true\n    // best-effort - don't block UI\n    triggerResolve()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [representation?.is_confirmed, representation?.guess_side])\n\n  // Confirm representation\n  const confirmRepresentation = async (side: string, clientName?: string) => {\n    try {\n      const response = await apiPost<{ representation: RepresentationState }>(`/api/cases/${caseId}/representation/confirm`, {\n        side_confirmed: side,\n        client_name: clientName,\n      })\n      setRepresentation(response.representation)\n      setShowSideSelector(false)\n      onRepresentationChange?.(side)\n    } catch (error) {\n      console.error('Failed to confirm representation:', error)\n    }\n  }\n\n  // Trigger auto-resolve\n  const triggerResolve = async () => {\n    setResolving(true)\n    try {\n      const response = await apiPost<{ representation?: RepresentationState }>(`/api/cases/${caseId}/representation/resolve`, {})\n      if (response.representation) {\n        setRepresentation(response.representation)\n      }\n    } catch (error) {\n      console.error('Failed to resolve representation:', error)\n    } finally {\n      setResolving(false)\n    }\n  }\n\n  // Clear representation (for dual-sided analysis)\n  const clearRepresentation = async () => {\n    try {\n      await apiDelete(`/api/cases/${caseId}/representation`)\n      await fetchRepresentation()\n      onRepresentationChange?.('unknown')\n    } catch (error) {\n      console.error('Failed to clear representation:', error)\n    }\n  }\n\n  if (loading) {\n    return null // Don't show anything while loading\n  }\n\n  if (!representation) {\n    return null\n  }\n\n  const isConfirmed = representation.is_confirmed\n  const hasGuess = representation.guess_side !== 'unknown' && representation.confidence >= 0.65\n  const displaySide = isConfirmed ? representation.side_confirmed : representation.guess_side\n\n  // If no representation info at all, show resolve button\n  if (!isConfirmed && representation.guess_side === 'unknown') {\n    if (compact) return null\n\n    return (\n      <div className=\"bg-slate-800/80 border border-slate-700 rounded-lg p-3 mb-4\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <div className=\"flex items-center gap-2 text-slate-300\">\n            <HelpCircle size={18} className=\"text-slate-400\" />\n            <span className=\"text-sm\">\n                 (//)      .\n                   .\n            </span>\n          </div>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={triggerResolve}\n              disabled={resolving}\n              className=\"px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-1.5 transition-colors disabled:opacity-50\"\n            >\n              {resolving ? (\n                <RefreshCw size={14} className=\"animate-spin\" />\n              ) : (\n                <RefreshCw size={14} />\n              )}\n               \n            </button>\n            <button\n              onClick={() => setShowSideSelector(true)}\n              className=\"px-3 py-1.5 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-lg flex items-center gap-1.5 transition-colors\"\n            >\n              <Scale size={14} />\n               \n            </button>\n          </div>\n        </div>\n\n        {/* Side selector dropdown */}\n        {showSideSelector && (\n          <div className=\"mt-3 p-3 bg-slate-900/50 rounded-lg border border-slate-600\">\n            <p className=\"text-sm text-slate-400 mb-2\">    :</p>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n              {Object.entries(SIDE_LABELS)\n                .filter(([key]) => key !== 'unknown')\n                .map(([key, label]) => (\n                  <button\n                    key={key}\n                    onClick={() => confirmRepresentation(key)}\n                    className=\"px-3 py-2 text-sm bg-slate-700 hover:bg-blue-600 text-white rounded transition-colors\"\n                  >\n                    {label}\n                  </button>\n                ))}\n            </div>\n            <button\n              onClick={() => setShowSideSelector(false)}\n              className=\"mt-2 text-sm text-slate-400 hover:text-white\"\n            >\n              \n            </button>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Confirmed state\n  if (isConfirmed) {\n    if (compact) {\n      return (\n        <div className=\"flex items-center gap-2 text-sm\">\n          <Users size={14} className=\"text-green-400\" />\n          <span className=\"text-green-300\">{SIDE_LABELS[displaySide] || displaySide}</span>\n          <button\n            onClick={() => setShowSideSelector(true)}\n            className=\"text-slate-400 hover:text-white text-xs\"\n          >\n            \n          </button>\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"bg-green-900/30 border border-green-500/30 rounded-lg p-3 mb-4\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <Check size={18} className=\"text-green-400\" />\n            <span className=\"text-green-300 font-medium\">\n              : {SIDE_LABELS[displaySide] || displaySide}\n              {representation.client_name && (\n                <span className=\"text-green-400/70 mr-1\">({representation.client_name})</span>\n              )}\n            </span>\n          </div>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => setShowSideSelector(true)}\n              className=\"px-3 py-1.5 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors\"\n            >\n              \n            </button>\n            <button\n              onClick={clearRepresentation}\n              className=\"px-3 py-1.5 text-sm text-slate-400 hover:text-white transition-colors\"\n              title=\"  -\"\n            >\n              <X size={14} />\n            </button>\n          </div>\n        </div>\n\n        {/* Side selector */}\n        {showSideSelector && (\n          <div className=\"mt-3 p-3 bg-slate-900/50 rounded-lg border border-slate-600\">\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n              {Object.entries(SIDE_LABELS)\n                .filter(([key]) => key !== 'unknown')\n                .map(([key, label]) => (\n                  <button\n                    key={key}\n                    onClick={() => confirmRepresentation(key)}\n                    className={`px-3 py-2 text-sm rounded transition-colors ${\n                      key === displaySide\n                        ? 'bg-green-600 text-white'\n                        : 'bg-slate-700 hover:bg-blue-600 text-white'\n                    }`}\n                  >\n                    {label}\n                  </button>\n                ))}\n            </div>\n            <button\n              onClick={() => setShowSideSelector(false)}\n              className=\"mt-2 text-sm text-slate-400 hover:text-white\"\n            >\n              \n            </button>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Guess state (not confirmed but has guess)\n  if (hasGuess) {\n    const confidenceColor = CONFIDENCE_COLORS[representation.confidence_level] || CONFIDENCE_COLORS.low\n    const confidenceLabel = CONFIDENCE_LABELS[representation.confidence_level] || ' '\n\n    if (compact) {\n      return (\n        <div className=\"flex items-center gap-2 text-sm\">\n          <Users size={14} className=\"text-blue-400\" />\n          <span className=\"text-blue-300\">{SIDE_LABELS[displaySide]}</span>\n          <span className={`px-1.5 py-0.5 text-xs rounded ${confidenceColor}`}>\n            {Math.round(representation.confidence * 100)}%\n          </span>\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"bg-blue-900/30 border border-blue-500/30 rounded-lg p-3 mb-4\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <Users size={18} className=\"text-blue-400\" />\n            <span className=\"text-blue-300\">\n                 : <strong>{SIDE_LABELS[displaySide]}</strong>\n            </span>\n            <span className={`px-2 py-0.5 text-xs rounded ${confidenceColor}`}>\n              {confidenceLabel}\n            </span>\n          </div>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => confirmRepresentation(displaySide)}\n              className=\"px-3 py-1.5 text-sm bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-1.5 transition-colors\"\n            >\n              <Check size={14} />\n              \n            </button>\n            <button\n              onClick={() => setShowSideSelector(true)}\n              className=\"px-3 py-1.5 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-lg flex items-center gap-1.5 transition-colors\"\n            >\n              <X size={14} />\n               \n            </button>\n          </div>\n        </div>\n\n        {/* Evidence toggle */}\n        {representation.evidence_refs.length > 0 && (\n          <button\n            onClick={() => setShowEvidence(!showEvidence)}\n            className=\"mt-2 flex items-center gap-1 text-sm text-blue-400 hover:text-blue-300\"\n          >\n            {showEvidence ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\n            {showEvidence ? ' ' : '  '}\n          </button>\n        )}\n\n        {/* Evidence list */}\n        {showEvidence && representation.evidence_refs.length > 0 && (\n          <div className=\"mt-2 space-y-2 text-sm\">\n            {representation.evidence_refs.slice(0, 3).map((evidence, i) => (\n              <div key={i} className=\"p-2 bg-slate-800/50 rounded border border-slate-700\">\n                <span className=\"text-slate-400 text-xs\">{evidence.signal}:</span>\n                <p className=\"text-slate-300 mt-1 text-right\" dir=\"rtl\">\n                  \"{evidence.quote}\"\n                </p>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Side selector when \"not correct\" */}\n        {showSideSelector && (\n          <div className=\"mt-3 p-3 bg-slate-900/50 rounded-lg border border-slate-600\">\n            <p className=\"text-sm text-slate-400 mb-2\">   :</p>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n              {Object.entries(SIDE_LABELS)\n                .filter(([key]) => key !== 'unknown')\n                .map(([key, label]) => (\n                  <button\n                    key={key}\n                    onClick={() => confirmRepresentation(key)}\n                    className=\"px-3 py-2 text-sm bg-slate-700 hover:bg-blue-600 text-white rounded transition-colors\"\n                  >\n                    {label}\n                  </button>\n                ))}\n            </div>\n            <div className=\"mt-3 pt-3 border-t border-slate-700\">\n              <button\n                onClick={clearRepresentation}\n                className=\"text-sm text-slate-400 hover:text-white\"\n              >\n                  -  -\n              </button>\n            </div>\n            <button\n              onClick={() => setShowSideSelector(false)}\n              className=\"mt-2 mr-4 text-sm text-slate-400 hover:text-white\"\n            >\n              \n            </button>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  return null\n}\n","/**\n * Capabilities Service - Single Source of Truth (from backend)\n *\n * Backend endpoints:\n * - GET /api/capabilities\n * - GET /api/cases/<case_id>/capabilities\n * - GET /api/cases/<case_id>/state\n * - GET /api/ui/microcopy\n */\n\nimport { apiGet } from '../utils/api';\n\n// =============================================================================\n// Types (match backend response models)\n// =============================================================================\n\nexport type CapabilityStatus =\n  | 'available'\n  | 'requires_data'\n  | 'blocked_tier'\n  | 'blocked_quota'\n  | 'coming_soon'\n  | 'disabled';\n\nexport interface Capability {\n  id: string;\n  name_he: string;\n  name_en: string;\n  description_he: string;\n  category: string;\n  icon: string;\n  status: CapabilityStatus;\n  status_reason_he?: string | null;\n  tooltip_he?: string | null;\n  action_url?: string | null;\n  action_label_he?: string | null;\n  action_required?: string | null;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  action_params?: Record<string, any> | null;\n  requires: string[];\n  requires_representation: boolean;\n}\n\nexport interface CapabilityCategory {\n  id: string;\n  name_he: string;\n  icon: string;\n  capabilities: Capability[];\n}\n\nexport interface CapabilitiesListResponse {\n  categories: CapabilityCategory[];\n  total_capabilities: number;\n  available_count: number;\n  requires_data_count: number;\n  blocked_count: number;\n}\n\nexport interface DisplayValue {\n  can_display: boolean;\n  value: number | null;\n  status: string;\n  status_label_he: string;\n  help_text_he?: string | null;\n  error_card?: {\n    title_he: string;\n    message_he: string;\n    action_he?: string | null;\n    action_url?: string | null;\n  } | null;\n}\n\nexport interface CaseStateResponse {\n  case_id: string;\n  has_documents: boolean;\n  ocr_status: string;\n  claims_status: string;\n  contradictions_status: string;\n  representation_confirmed: boolean;\n  representation_side: string;\n  display_values: Record<string, DisplayValue>;\n}\n\nexport interface UIElement {\n  id: string;\n  type: string;\n  label_he: string;\n  tooltip_he?: string;\n  description_he?: string;\n  placeholder_he?: string;\n  error_he?: string;\n  success_he?: string;\n}\n\n// =============================================================================\n// API Functions\n// =============================================================================\n\nexport async function getAllCapabilities(): Promise<CapabilitiesListResponse> {\n  return apiGet<CapabilitiesListResponse>('/api/capabilities');\n}\n\nexport async function getCaseCapabilities(caseId: string): Promise<CapabilitiesListResponse> {\n  return apiGet<CapabilitiesListResponse>(`/api/cases/${encodeURIComponent(caseId)}/capabilities`);\n}\n\nexport async function getCaseState(caseId: string): Promise<CaseStateResponse> {\n  return apiGet<CaseStateResponse>(`/api/cases/${encodeURIComponent(caseId)}/state`);\n}\n\nexport async function getMicrocopy(): Promise<Record<string, UIElement>> {\n  const response = await apiGet<Record<string, UIElement>>('/api/ui/microcopy');\n  // backend returns plain dict; keep compatibility if wrapped in {elements: ...}\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const maybeWrapped = response as any;\n  return maybeWrapped?.elements ?? response;\n}\n\n// =============================================================================\n// Helpers\n// =============================================================================\n\nexport function flattenCapabilities(payload: CapabilitiesListResponse | null): Capability[] {\n  if (!payload?.categories) return [];\n  return payload.categories.flatMap((c) => c.capabilities || []);\n}\n\nexport function isCapabilityAvailable(caps: Capability[], capabilityId: string): boolean {\n  const cap = caps.find((c) => c.id === capabilityId);\n  return cap?.status === 'available';\n}\n\nexport function getBlockedReason(caps: Capability[], capabilityId: string): string | null {\n  const cap = caps.find((c) => c.id === capabilityId);\n  if (!cap) return null;\n  if (cap.status === 'available') return null;\n  return cap.status_reason_he || cap.tooltip_he || null;\n}\n\n","/**\n * CapabilitiesMenu -   \n *\n *     -Backend Capability Registry (  ).\n */\n\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { AlertTriangle, HelpCircle, Search, Sparkles, X } from 'lucide-react';\nimport { toast } from 'sonner';\n\nimport {\n  flattenCapabilities,\n  getAllCapabilities,\n  getCaseCapabilities,\n  type CapabilityStatus,\n  type CapabilitiesListResponse,\n} from '../../services/capabilities';\nimport { apiPost } from '../../utils/api';\n\ninterface SelectableCapability {\n  id: string;\n  name: string;\n  description: string;\n  example: string;\n  icon: string; // emoji/string from backend\n  status: CapabilityStatus;\n  status_reason_he?: string | null;\n  tooltip_he?: string | null;\n  action_label_he?: string | null;\n  action_url?: string | null;\n  action_required?: string | null;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  action_params?: Record<string, any> | null;\n}\n\ninterface CapabilityCategoryVM {\n  id: string;\n  name: string;\n  icon: string; // emoji/string from backend\n  color: string;\n  capabilities: SelectableCapability[];\n}\n\ninterface CapabilitiesMenuProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelectCapability: (capability: SelectableCapability) => void;\n  caseId?: string | null;\n  isPremium?: boolean; // legacy prop (ignored; backend provides real status)\n}\n\nconst CATEGORY_COLORS: Record<string, string> = {\n  analysis: 'from-blue-500 to-cyan-500',\n  strategy: 'from-amber-500 to-orange-500',\n  search: 'from-emerald-500 to-teal-500',\n  intelligence: 'from-purple-500 to-pink-500',\n  reports: 'from-slate-500 to-slate-700',\n  interaction: 'from-indigo-500 to-sky-500',\n};\n\nconst STATUS_UI: Record<CapabilityStatus, { label: string; badge: string; text: string; dot: string }> = {\n  available: {\n    label: '',\n    badge: 'bg-emerald-500/15 border-emerald-500/30',\n    text: 'text-emerald-200',\n    dot: 'bg-emerald-400',\n  },\n  requires_data: {\n    label: ' ',\n    badge: 'bg-amber-500/15 border-amber-500/30',\n    text: 'text-amber-200',\n    dot: 'bg-amber-400',\n  },\n  blocked_tier: {\n    label: ' ()',\n    badge: 'bg-purple-500/15 border-purple-500/30',\n    text: 'text-purple-200',\n    dot: 'bg-purple-400',\n  },\n  blocked_quota: {\n    label: ' ()',\n    badge: 'bg-red-500/15 border-red-500/30',\n    text: 'text-red-200',\n    dot: 'bg-red-400',\n  },\n  coming_soon: {\n    label: '',\n    badge: 'bg-sky-500/15 border-sky-500/30',\n    text: 'text-sky-200',\n    dot: 'bg-sky-400',\n  },\n  disabled: {\n    label: '',\n    badge: 'bg-slate-500/15 border-slate-500/30',\n    text: 'text-slate-200',\n    dot: 'bg-slate-400',\n  },\n};\n\nconst DEFAULT_EXAMPLES: Record<string, string> = {\n  claims: '          .',\n  contradictions: '          .',\n  entities: '  (///)     .',\n  timeline: '         .',\n  disputes: '    ,     .',\n  strategy: '          .',\n  game_theory: '         .',\n  risk_assessment: '   :  /    .',\n  rulings_search: '     5       .',\n  similarity_search: '         .',\n  judge_analytics: '    /  ( )   .',\n  counsel_analytics: '         /.',\n  strategy_memo: '     (, , , , ).',\n  export: '       (, , )  .',\n  draft_mode: '       : ...',\n  chat: '    3      .',\n};\n\nexport default function CapabilitiesMenu({ isOpen, onClose, onSelectCapability, caseId }: CapabilitiesMenuProps) {\n  const [activeCategory, setActiveCategory] = useState<string | null>(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [payload, setPayload] = useState<CapabilitiesListResponse | null>(null);\n  const [actionBusy, setActionBusy] = useState<string | null>(null);\n  const [showRepresentationPicker, setShowRepresentationPicker] = useState(false);\n\n  useEffect(() => {\n    let cancelled = false;\n    async function load() {\n      setLoading(true);\n      setError(null);\n      try {\n        const res = caseId ? await getCaseCapabilities(caseId) : await getAllCapabilities();\n        if (cancelled) return;\n        setPayload(res);\n        setActiveCategory((prev) => prev ?? res.categories?.[0]?.id ?? null);\n      } catch (e) {\n        if (cancelled) return;\n        setError(e instanceof Error ? e.message : '  ');\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n    if (isOpen) void load();\n    return () => {\n      cancelled = true;\n    };\n  }, [isOpen, caseId]);\n\n  const categoriesVM: CapabilityCategoryVM[] = useMemo(() => {\n    const q = (searchQuery || '').trim();\n    const matches = (c: SelectableCapability) => {\n      if (!q) return true;\n      return c.name.includes(q) || c.description.includes(q) || c.example.includes(q) || c.id.includes(q);\n    };\n\n    const out: CapabilityCategoryVM[] = [];\n    for (const cat of payload?.categories || []) {\n      const mapped: SelectableCapability[] = (cat.capabilities || [])\n        //  P0: Filter out disabled capabilities completely (hide until ready)\n        .filter((c) => c.status !== 'disabled')\n        .map((c) => ({\n          id: c.id,\n          name: c.name_he,\n          description: c.description_he,\n          example: DEFAULT_EXAMPLES[c.id] || `  : ${c.name_he}`,\n          icon: c.icon || '',\n          status: c.status,\n          status_reason_he: c.status_reason_he,\n          tooltip_he: c.tooltip_he,\n          action_label_he: c.action_label_he,\n          action_url: c.action_url,\n          action_required: c.action_required,\n          action_params: c.action_params,\n        }))\n        .filter(matches);\n\n      if (mapped.length === 0) continue;\n      out.push({\n        id: cat.id,\n        name: cat.name_he,\n        icon: cat.icon || '',\n        color: CATEGORY_COLORS[cat.id] || 'from-slate-700 to-slate-800',\n        capabilities: mapped,\n      });\n    }\n\n    // Defensive fallback: group flat list by capability.category\n    if (out.length === 0 && payload) {\n      const flat = flattenCapabilities(payload)\n        //  P0: Filter out disabled capabilities in fallback path too\n        .filter((c) => c.status !== 'disabled');\n      const grouped = new Map<string, SelectableCapability[]>();\n      for (const c of flat) {\n        const vm: SelectableCapability = {\n          id: c.id,\n          name: c.name_he,\n          description: c.description_he,\n          example: DEFAULT_EXAMPLES[c.id] || `  : ${c.name_he}`,\n          icon: c.icon || '',\n          status: c.status,\n          status_reason_he: c.status_reason_he,\n          tooltip_he: c.tooltip_he,\n          action_label_he: c.action_label_he,\n          action_url: c.action_url,\n          action_required: c.action_required,\n          action_params: c.action_params,\n        };\n        if (!matches(vm)) continue;\n        const key = c.category || 'other';\n        grouped.set(key, [...(grouped.get(key) || []), vm]);\n      }\n      for (const [id, list] of grouped.entries()) {\n        out.push({\n          id,\n          name: id,\n          icon: '',\n          color: CATEGORY_COLORS[id] || 'from-slate-700 to-slate-800',\n          capabilities: list,\n        });\n      }\n    }\n\n    return out;\n  }, [payload, searchQuery]);\n\n  if (!isOpen) return null;\n\n  const active = categoriesVM.find((c) => c.id === activeCategory) || categoriesVM[0];\n\n  const runCapabilityAction = async (capability: SelectableCapability) => {\n    if (!caseId) {\n      toast.error('    ');\n      return;\n    }\n    if (!capability.action_label_he) return;\n\n    // Never POST for tier/quota/disabled/coming soon  these are informational and/or require UI flows.\n    if (capability.status === 'blocked_tier') {\n      toast.error(capability.status_reason_he || '    ');\n      return;\n    }\n    if (capability.status === 'blocked_quota') {\n      toast.error(capability.status_reason_he || '   ');\n      return;\n    }\n    if (capability.status === 'coming_soon' || capability.status === 'disabled') {\n      toast.message(capability.status_reason_he || '    ');\n      return;\n    }\n\n    // Representation requires user choice\n    if (capability.action_label_he.includes('')) {\n      setShowRepresentationPicker(true);\n      return;\n    }\n\n    try {\n      setActionBusy(capability.id);\n\n      // Prefer explicit action semantics from backend\n      const actionRequired: string | null = capability.action_required ?? null;\n      const actionParams: Record<string, any> = capability.action_params ?? {};\n\n      if (actionRequired === 'analyze_on_demand') {\n        if (!actionParams?.analysis_type) {\n          toast.error(' analysis_type .   .');\n          return;\n        }\n        await apiPost(`/api/cases/${encodeURIComponent(caseId)}/analyze-on-demand`, {\n          capability_id: actionParams.analysis_type,\n          options: { force_refresh: false },\n        });\n        toast.success('   ');\n      } else if (actionRequired === 'reanalyze') {\n        await apiPost(`/api/cases/${encodeURIComponent(caseId)}/reanalyze`, {\n          mode: actionParams.mode || 'full',\n        });\n        toast.success('  ');\n      } else {\n        // Fallback: if we have an action_url, try POST with params\n        const url = capability.action_url || undefined;\n        if (!url) {\n          toast.error('   ');\n          return;\n        }\n        await apiPost(url, actionParams || {});\n        toast.success(' ');\n      }\n\n      // Refresh list\n      const res = await getCaseCapabilities(caseId);\n      setPayload(res);\n      setActiveCategory((prev) => prev ?? res.categories?.[0]?.id ?? null);\n    } catch (e: any) {\n      const msg = e?.message || '  ';\n      // If backend blocks due to missing representation, guide user\n      if (String(e?.status || '').startsWith('428') || String(msg).includes('REPRESENTATION')) {\n        setShowRepresentationPicker(true);\n      } else {\n        toast.error(msg);\n      }\n    } finally {\n      setActionBusy(null);\n    }\n  };\n\n  const confirmRepresentation = async (side_confirmed: string) => {\n    if (!caseId) return;\n    try {\n      setActionBusy(`rep:${side_confirmed}`);\n      await apiPost(`/api/cases/${encodeURIComponent(caseId)}/representation/confirm`, { side_confirmed });\n      toast.success('  ');\n      setShowRepresentationPicker(false);\n      const res = await getCaseCapabilities(caseId);\n      setPayload(res);\n    } catch (e: any) {\n      toast.error(e?.message || '  ');\n    } finally {\n      setActionBusy(null);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\" onClick={onClose} />\n\n      <div className=\"relative bg-slate-900 rounded-2xl border border-white/20 shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden\">\n        <div className=\"p-4 border-b border-white/10 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center\">\n              <Sparkles className=\"text-white\" size={20} />\n            </div>\n            <div>\n              <h2 className=\"text-white font-bold text-lg\">   ?</h2>\n              <p className=\"text-white/60 text-sm\">\n                {caseId ? '   (  )' : '  (  )'}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"p-4 border-b border-white/10\">\n          <div className=\"relative\">\n            <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 text-white/40\" size={18} />\n            <input\n              type=\"text\"\n              placeholder=\" ...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"w-full pr-10 pl-4 py-2.5 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 focus:outline-none focus:border-purple-500\"\n            />\n          </div>\n        </div>\n\n        {/* Category tabs */}\n        {!loading && !error && categoriesVM.length > 0 && (\n          <div className=\"px-4 pt-3\">\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n              {categoriesVM.map((cat) => {\n                const isActive = (active?.id || cat.id) === cat.id;\n                return (\n                  <button\n                    key={cat.id}\n                    onClick={() => setActiveCategory(cat.id)}\n                    className={`px-3 py-1.5 rounded-xl border text-sm whitespace-nowrap transition-colors ${\n                      isActive\n                        ? 'bg-purple-600/30 border-purple-500/40 text-white'\n                        : 'bg-white/5 border-white/10 text-white/70 hover:bg-white/10'\n                    }`}\n                    title={cat.name}\n                  >\n                    <span className=\"ml-1\">{cat.icon}</span>\n                    {cat.name}\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        <div className=\"overflow-y-auto max-h-[50vh] p-4 space-y-3\">\n          {loading && (\n            <div className=\"text-white/60 text-sm p-3 bg-white/5 rounded-xl border border-white/10\"> </div>\n          )}\n\n          {error && (\n            <div className=\"text-red-200 text-sm p-3 bg-red-500/10 rounded-xl border border-red-500/20 flex items-start gap-2\">\n              <AlertTriangle size={16} className=\"mt-0.5\" />\n              <div>\n                <div className=\"font-medium\"> </div>\n                <div className=\"text-white/70\">{error}</div>\n              </div>\n            </div>\n          )}\n\n          {!loading && !error && categoriesVM.length === 0 && (\n            <div className=\"text-white/60 text-sm p-3 bg-white/5 rounded-xl border border-white/10\">   .</div>\n          )}\n\n          {active && (\n            <div className=\"rounded-xl border border-white/10 overflow-hidden\">\n              <div className={`w-full p-3 bg-gradient-to-r ${active.color} bg-opacity-20`}>\n                <div className=\"flex items-center gap-3\">\n                  <span className=\"text-white text-lg leading-none\">{active.icon}</span>\n                  <span className=\"text-white font-medium\">{active.name}</span>\n                  <span className=\"text-white/60 text-sm\">({active.capabilities.length} )</span>\n                </div>\n              </div>\n\n              <div className=\"p-2 space-y-2 bg-white/5\">\n                {active.capabilities.map((capability) => {\n                  const isAvailable = capability.status === 'available';\n                  const canAction = !!capability.action_label_he && !!caseId;\n                  const isBusy = actionBusy === capability.id;\n                  return (\n                    <div\n                      key={capability.id}\n                      className={`w-full p-3 rounded-lg border ${\n                        isAvailable ? 'border-white/10 bg-white/5' : 'border-white/10 bg-white/5'\n                      }`}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <span className=\"mt-0.5 text-white/80 text-lg leading-none\">{capability.icon}</span>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <div className=\"flex items-center gap-2 flex-wrap min-w-0\">\n                              <span className=\"font-medium text-white truncate\">{capability.name}</span>\n                              <span\n                                className={`px-2 py-0.5 text-xs rounded border inline-flex items-center gap-1 ${\n                                  STATUS_UI[capability.status]?.badge || 'bg-white/5 border-white/10'\n                                } ${STATUS_UI[capability.status]?.text || 'text-white/60'}`}\n                                title={capability.status_reason_he || capability.tooltip_he || undefined}\n                              >\n                                <span className={`w-1.5 h-1.5 rounded-full ${STATUS_UI[capability.status]?.dot || 'bg-white/40'}`} />\n                                {STATUS_UI[capability.status]?.label || capability.status}\n                              </span>\n                            </div>\n\n                            <div className=\"flex items-center gap-2 flex-shrink-0\">\n                              {(capability.tooltip_he || capability.status_reason_he) && (\n                                <span title={capability.tooltip_he || capability.status_reason_he || undefined}>\n                                  <HelpCircle size={16} className=\"text-white/40\" />\n                                </span>\n                              )}\n                              {isAvailable ? (\n                                <button\n                                  onClick={() => {\n                                    onSelectCapability(capability);\n                                    onClose();\n                                  }}\n                                  className=\"px-3 py-1.5 rounded-lg bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium\"\n                                >\n                                  \n                                </button>\n                              ) : (\n                                <button\n                                  onClick={() => runCapabilityAction(capability)}\n                                  disabled={!canAction || isBusy}\n                                  className={`px-3 py-1.5 rounded-lg text-xs font-medium ${\n                                    !canAction\n                                      ? 'bg-white/5 text-white/30 cursor-not-allowed'\n                                      : 'bg-white/10 text-white hover:bg-white/15'\n                                  }`}\n                                  title={capability.action_label_he || undefined}\n                                >\n                                  {isBusy ? '...' : (capability.action_label_he || '')}\n                                </button>\n                              )}\n                            </div>\n                          </div>\n\n                          <p className=\"text-sm text-white/60 mt-1\">{capability.description}</p>\n                          {isAvailable && (\n                            <p className=\"text-xs text-purple-300 mt-2 flex items-center gap-1\">\n                              <HelpCircle size={12} />\n                              : \"{capability.example}\"\n                            </p>\n                          )}\n                          {!isAvailable && (\n                            <p className=\"text-xs text-white/50 mt-2\">\n                              {capability.status_reason_he || capability.tooltip_he || '  '}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"p-4 border-t border-white/10 bg-white/5\">\n          <p className=\"text-center text-white/60 text-sm\"> :         -  !</p>\n        </div>\n      </div>\n\n      {/* Representation picker modal */}\n      {showRepresentationPicker && (\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4\" onClick={() => setShowRepresentationPicker(false)}>\n          <div className=\"absolute inset-0 bg-black/70\" />\n          <div\n            className=\"relative bg-slate-900 rounded-2xl border border-white/20 shadow-2xl w-full max-w-lg p-4\"\n            onClick={(e) => e.stopPropagation()}\n            dir=\"rtl\"\n          >\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"text-white font-bold\"> :   ?</div>\n              <button onClick={() => setShowRepresentationPicker(false)} className=\"p-2 text-white/60 hover:text-white\">\n                <X size={18} />\n              </button>\n            </div>\n            <p className=\"text-white/60 text-sm mb-3\">\n                  (//).    .\n            </p>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {[\n                { id: 'petitioner', label: '' },\n                { id: 'respondent', label: '' },\n                { id: 'plaintiff', label: '' },\n                { id: 'defendant', label: '' },\n                { id: 'appellant', label: '' },\n                { id: 'other', label: '' },\n              ].map((s) => (\n                <button\n                  key={s.id}\n                  onClick={() => confirmRepresentation(s.id)}\n                  disabled={actionBusy === `rep:${s.id}`}\n                  className=\"px-3 py-2 rounded-xl bg-white/5 hover:bg-purple-600/30 border border-white/10 text-white text-sm\"\n                >\n                  {actionBusy === `rep:${s.id}` ? '...' : s.label}\n                </button>\n              ))}\n            </div>\n            <p className=\"text-white/40 text-xs mt-3\">\n                 ,   \"\"       .\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport type { SelectableCapability as Capability };\n\n","/**\n * ChatPanel -  ' \n *\n * ':\n * -     \n * - Quick Actions (, , ,  )\n * - Smart Tools (,  ,  ,  )\n * - Pin \n * - Adversarial Analysis (Pro+)\n * - Game Theory analysis (Pro+)\n * - Case-only chat (no free chat)\n */\n\nimport React, { useState, useEffect, useRef, useCallback, useMemo, forwardRef, useImperativeHandle } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Send,\n  Loader2,\n  Copy,\n  Check,\n  Pin,\n  AlertTriangle,\n  AlertCircle,\n  Target,\n  BarChart3,\n  Swords,\n  Brain,\n  Paperclip,\n  X,\n  Sparkles,\n  FileText,\n  Crown,\n  FileSearch,\n  Users,\n  Crosshair,\n  Play,\n  Search,\n  ChevronDown,\n  ChevronUp,\n  Gavel,\n  UserCircle,\n  Edit3,\n  Save,\n  FolderPlus,\n  Plus,\n  Folder,\n  Calendar,\n  MessageCircle,\n  ChevronRight,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { apiPost, apiGet, apiPatch, apiUpload } from '../../utils/api';\nimport { useAuthStore } from '../../store/useAuthStore';\nimport { useCasesStore } from '../../store/useCasesStore';\nimport SmartResponseRenderer from './SmartResponseRenderer';\nimport GavelLoader from './GavelLoader';\nimport WaveLoader from './WaveLoader';\n// TOC is now in CasesSessionsPanel\nimport StarRating from './StarRating';\n// ActivityLogStrip removed - users don't need to see activity log\n// import ActivityLogStrip from './ActivityLogStrip';\nimport { useActivityLogStore } from '../../store/useActivityLogStore';\nimport UpgradeModal from '../UpgradeModal';\nimport RepresentationBanner from '../RepresentationBanner';\nimport { useDocumentProcessingStatus } from '../../hooks/useDocumentProcessingStatus';\nimport CapabilitiesMenu from './CapabilitiesMenu';\n\n// Quick actions configuration - prompts that generate chat responses\n//  UPGRADED TO WORLD-CLASS PROMPTS - December 2024\nconst QUICK_ACTIONS = {\n  free: [\n    {\n      id: 'overview',\n      label: '',\n      icon: FileText,\n      prompt:\n        `        .\\n\\n` +\n        `: (1)    , (2) 5      , ` +\n        `(3)     , (4)   , ` +\n        `(5) 3   , (6) 3   .\\n\\n` +\n        `     .    -  \"   \". ` +\n        `  -    .`,\n    },\n    {\n      id: 'knowledge',\n      label: ' ',\n      icon: Gavel,\n      prompt:\n        `     .\\n\\n` +\n        `: (1)   , (2)    , ` +\n        `(3)   , (4) // , ` +\n        `(5)      , (6) 2-3  .\\n\\n` +\n        `      .     .`,\n    },\n  ],\n  pro: [\n    {\n      id: 'overview',\n      label: '',\n      icon: FileText,\n      prompt:\n        `      .\\n\\n` +\n        `: (1)   ,     (1-10  ), ` +\n        `(2) 7      , ` +\n        `(3)  :       , ` +\n        `(4)   -     , ` +\n        `(5) SWOT , (6) Black Swans -  , ` +\n        `(7)   -72 .\\n\\n` +\n        `  =  .  ,   .`,\n    },\n    {\n      id: 'strategy',\n      label: '',\n      icon: Target,\n      prompt:\n        `    -  .\\n\\n` +\n        `: (1)   -   , ` +\n        `(2) 3  :   , ,  ,   , ` +\n        `(3) 3     , ` +\n        `(4)     -    , ` +\n        `(5)      , ` +\n        `(6)   -    , ` +\n        `(7) Plan B & C   .\\n\\n` +\n        `     -  .  .`,\n    },\n    {\n      id: 'risk',\n      label: ' ',\n      icon: BarChart3,\n      prompt:\n        `    -  .\\n\\n` +\n        `: (1)    1-10  , ` +\n        `(2)    , ,  , ` +\n        `(3)    , ` +\n        `(4)   , ` +\n        `(5) Black Swan Events -   , ` +\n        `(6)  :  //  .\\n\\n` +\n        `:       .  .`,\n    },\n    {\n      id: 'knowledge',\n      label: ' ',\n      icon: Gavel,\n      prompt:\n        `       .\\n\\n` +\n        `: (1)   -      , ` +\n        `(2)     , ` +\n        `(3) , ,  , ` +\n        `(4)    -     , ` +\n        `(5)   .\\n\\n` +\n        ` :     .   .`,\n    },\n    {\n      id: 'adversarial',\n      label: '',\n      icon: Swords,\n      prompt:\n        `        .\\n\\n` +\n        ` \"  ( ) vs  \"  ( )\\n\\n` +\n        `** 1 -  :**       .     .\\n\\n` +\n        `** 2 - :**    .    .\\n\\n` +\n        `** 3 - :**      .\\n\\n` +\n        `** :**     ?     ?   ? 3  .\\n\\n` +\n        `    ,  \"\".     .`,\n      premium: true,\n    },\n  ],\n  enterprise: [\n    {\n      id: 'overview',\n      label: '',\n      icon: FileText,\n      prompt:\n        `    Enterprise -   .\\n\\n` +\n        `: (1) :   %,   1-10, ,  , ` +\n        `(2) Top 10    ,   , ` +\n        `(3)   :    ,  , ` +\n        `(4)      , ` +\n        `(5)     , ` +\n        `(6) Red Flags & Black Swans, ` +\n        `(7)   30-60-90   KPIs.\\n\\n` +\n        `  =  .  .  .`,\n    },\n    {\n      id: 'strategy',\n      label: '',\n      icon: Target,\n      prompt:\n        `     Enterprise.\\n\\n` +\n        `: (1) Vision & Mission -   -KPIs , ` +\n        `(2)   3 :  (  + ),  ( + ),  ( + ), ` +\n        `(3)  Game Theory -      , ` +\n        `(4) Decision Trees  , ` +\n        `(5)  - -ROI, ` +\n        `(6) Contingency Plans A/B/C   .\\n\\n` +\n        `   .  .`,\n    },\n    {\n      id: 'risk',\n      label: ' ',\n      icon: BarChart3,\n      prompt:\n        `     Enterprise.\\n\\n` +\n        `: (1) Risk Dashboard:   (1-10) , , , , ` +\n        `(2)  : , , , Owner, SLA, ` +\n        `(3) Trigger Events -    , ` +\n        `(4) Monte Carlo: Best case, Expected, Worst case  , ` +\n        `(5)     , ` +\n        `(6) Escalation Protocol.\\n\\n` +\n        `     .  .`,\n    },\n    {\n      id: 'contract_analysis',\n      label: ' ',\n      icon: FileText,\n      prompt:\n        `     Enterprise.\\n\\n` +\n        `: (1)  :  , , ,   , ` +\n        `(2)  :  , , , ` +\n        `(3)  :   vs  , ` +\n        `(4)  :  -,  ,  , ` +\n        `(5)   , ` +\n        `(6)   -    , ` +\n        `(7)  \"  BATNA.\\n\\n` +\n        `  =   .  .`,\n    },\n    {\n      id: 'knowledge',\n      label: ' ',\n      icon: Gavel,\n      prompt:\n        `    Enterprise.\\n\\n` +\n        `: (1)  : , , , , , ` +\n        `(2)  : ,  facts , holding, ` +\n        `(3)  : , , , , ` +\n        `(4)  :     , ` +\n        `(5) Gap Analysis -   .\\n\\n` +\n        `   .   .  .`,\n    },\n    {\n      id: 'adversarial',\n      label: '',\n      icon: Swords,\n      prompt:\n        `     Enterprise.\\n\\n` +\n        ` \"   (25  , ) vs  \"   (, )\\n\\n` +\n        `** 1 - :**      .   ,  , narrative .\\n\\n` +\n        `** 2 -  :**        .\\n\\n` +\n        `** 3 -  :**    .\\n\\n` +\n        `** 4 - :**   .\\n\\n` +\n        `**:** Scorecard (   ),   ( ),  /, 5  ,  .\\n\\n` +\n        `    .   =  .`,\n      premium: true,\n      enterprise: true,\n    },\n  ],\n};\n\n//  \" \" tabs - focused on core analysis capabilities\n// Note: Removed \"  - system focuses on case/claims statistics, not personal profiles\nconst QUICK_ACCESS_TABS = [\n  { key: 'issuesmap', label: '', title: ' // ', requiresTier: 'free' },\n  { key: 'credibility', label: '', title: '   ', requiresTier: 'free' },\n  { key: 'game_theory', label: '', title: '    ', requiresTier: 'professional' },\n  { key: 'forensics', label: '', title: '  (/)', requiresTier: 'professional' },\n];\n\n// CSS Animations for messages\nconst messageAnimationStyles = `\n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(10px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n`;\n\nconst ChatPanel = forwardRef(({\n  caseId,\n  caseName,\n  analysisResult = null,\n  sessionId,\n  onSessionChange,\n  onPinItem,\n  onAddDocuments,  //  Callback to open file manager / upload dialog\n  onNewCase,       //  Callback to create new case\n  userTier = 'free',\n  isPremium = false,\n  isEnterprise = false,\n  initialQueuedAction = null,\n  initialQueuedActionPayload = null,\n}, ref) => {\n  const navigate = useNavigate();\n  const { cases, fetchCases, casesLoading } = useCasesStore();\n  const addLog = useActivityLogStore((s) => s.addEntry);\n\n  const [messages, setMessages] = useState([]);\n  // Used to force-refresh chat history (e.g., after uploads insert a server-side message)\n  const [historyRefreshKey, setHistoryRefreshKey] = useState(0);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [streamingText, setStreamingText] = useState('');\n  const [streamingProgress, setStreamingProgress] = useState(null); // { stage, progress, message }\n  const [isStreaming, setIsStreaming] = useState(false);\n  const [feedback, setFeedback] = useState({});\n  const [copiedMessageId, setCopiedMessageId] = useState(null);\n  const [uploadFiles, setUploadFiles] = useState([]);\n  //  Free chat: inline upload that auto-creates a case\n  const [showFreeUploadModal, setShowFreeUploadModal] = useState(false);\n  const [freeUploadFiles, setFreeUploadFiles] = useState([]);\n  const [freeUploadName, setFreeUploadName] = useState(() => `  - ${new Date().toLocaleDateString('he-IL')}`);\n  const [freeUploading, setFreeUploading] = useState(false);\n  const freeFileInputRef = useRef(null);\n\n  //  Upgrade modal (used for locked tabs/tools)\n  const [upgradeModalOpen, setUpgradeModalOpen] = useState(false);\n  const [upgradeModalInfo, setUpgradeModalInfo] = useState({\n    featureName: '',\n    featureDescription: '',\n    requiredTier: 'professional',\n  });\n\n  //  Case selector state (when no caseId)\n  const [casesWithSessions, setCasesWithSessions] = useState([]);\n  const [loadingCaseSessions, setLoadingCaseSessions] = useState(false);\n  const [expandedCaseId, setExpandedCaseId] = useState(null);\n\n  //  Continuation state - for \" ?\" feature\n  const [continuationMessageId, setContinuationMessageId] = useState(null);\n\n  // Smart Tools state\n  const [selectedTool, setSelectedTool] = useState(null);\n  const [caseFiles, setCaseFiles] = useState([]);\n  const [caseType, setCaseType] = useState(null);\n  const [selectedFiles, setSelectedFiles] = useState([]);\n  const [searchInput, setSearchInput] = useState('');\n  const [localAnalysis, setLocalAnalysis] = useState(null);\n  const analysisLoadedRef = useRef(false);\n  const queuedActionRanRef = useRef(false);\n\n  // Case Context (Players) state\n  const [caseContext, setCaseContext] = useState(null);\n  const [showPlayersPanel, setShowPlayersPanel] = useState(false);\n  const [editingPlayers, setEditingPlayers] = useState(false);\n  const [playersForm, setPlayersForm] = useState({\n    judges: '',\n    myPartyName: '',\n    myPartyRole: 'plaintiff',\n    myLawyerName: '',\n    opposingPartyName: '',\n    opposingPartyRole: 'defendant',\n    opposingLawyerName: '',\n    myWitnesses: '',\n    opposingWitnesses: '',\n    additionalContext: '', //  NEW: Free text for nicknames, aliases, special context\n  });\n\n  //  Capabilities Registry modal\n  const [showCapabilities, setShowCapabilities] = useState(false);\n\n  //  Case lifecycle status (for UX guidance while analysis runs)\n  const [caseLifecycleStatus, setCaseLifecycleStatus] = useState(null);\n\n  const messagesEndRef = useRef(null);\n  const messagesContainerRef = useRef(null);\n  const inputRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // Expose methods via ref\n  useImperativeHandle(ref, () => ({\n    scrollToMessage: (messageId) => {\n      const messageEl = messagesContainerRef.current?.querySelector(`[data-message-id=\"${messageId}\"]`);\n      if (messageEl) {\n        messageEl.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        // Highlight effect\n        messageEl.classList.add('ring-2', 'ring-purple-500');\n        setTimeout(() => messageEl.classList.remove('ring-2', 'ring-purple-500'), 2000);\n      }\n    },\n    getMessages: () => messages,\n  }), [messages]);\n\n  //  Monitor document processing status (OCR/RAG indexing)\n  const { triggerCheck: triggerProcessingCheck } = useDocumentProcessingStatus({\n    caseId,\n    enabled: !!caseId, // Only poll when we have a case\n  });\n\n  //  Show point questions only guidance while analysis is running\n  const fetchCaseLifecycleStatus = useCallback(async () => {\n    if (!caseId) return;\n    try {\n      const data = await apiGet(`/api/cases/${caseId}`, { showErrorToast: false });\n      const status = data?.case?.status || data?.status || 'completed';\n      setCaseLifecycleStatus(status);\n    } catch {\n      // Non-critical\n    }\n  }, [caseId]);\n\n  useEffect(() => {\n    if (!caseId) return;\n    fetchCaseLifecycleStatus();\n    const interval = setInterval(fetchCaseLifecycleStatus, 5000);\n    return () => clearInterval(interval);\n  }, [caseId, fetchCaseLifecycleStatus]);\n\n  // Get quick actions for tier\n  const quickActions = useMemo(() => {\n    if (isEnterprise) return QUICK_ACTIONS.enterprise;\n    if (isPremium) return QUICK_ACTIONS.pro;\n    return QUICK_ACTIONS.free;\n  }, [isPremium, isEnterprise]);\n\n  const hasTier = useMemo(() => {\n    const tierLevels = { free: 0, basic: 1, professional: 2, enterprise: 3, admin: 4 };\n    const effectiveTier = (userTier || 'free').toLowerCase();\n    return (requiredTier) =>\n      (tierLevels[effectiveTier] ?? 0) >= (tierLevels[requiredTier] ?? 0);\n  }, [userTier]);\n\n  const openUpgradeModal = useCallback((featureName, featureDescription, requiredTier) => {\n    const normalizedTier = (requiredTier === 'basic' || requiredTier === 'professional' || requiredTier === 'enterprise')\n      ? requiredTier\n      : 'professional';\n    setUpgradeModalInfo({\n      featureName: featureName || ' ',\n      featureDescription: featureDescription || '    ',\n      requiredTier: normalizedTier,\n    });\n    setUpgradeModalOpen(true);\n  }, []);\n\n  //  All quick actions now go to bottom bar (forensics moved to   tabs)\n  const bottomQuickActions = useMemo(() => {\n    return quickActions || [];\n  }, [quickActions]);\n\n  //  No navigation to analysis pages: all analyses must run inside chat.\n\n  // Scroll to bottom\n  const scrollToBottom = useCallback((behavior = 'auto') => {\n    messagesEndRef.current?.scrollIntoView({ behavior });\n  }, []);\n\n  // Jump to specific message (for TOC navigation)\n  const jumpToMessage = useCallback((messageId) => {\n    const messageEl = messagesContainerRef.current?.querySelector(`[data-message-id=\"${messageId}\"]`);\n    if (messageEl) {\n      messageEl.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      // Highlight effect\n      messageEl.classList.add('ring-2', 'ring-purple-500', 'ring-opacity-70');\n      setTimeout(() => messageEl.classList.remove('ring-2', 'ring-purple-500', 'ring-opacity-70'), 2000);\n    }\n  }, []);\n\n  // Handle export from TOC\n  const handleTOCExport = useCallback((selectedIds) => {\n    toast.success(` ${selectedIds.length}  `);\n  }, []);\n\n  const scrollRafRef = useRef(null);\n  const lastScrollAtRef = useRef(0);\n  const isNearBottom = useCallback(() => {\n    const el = messagesContainerRef.current;\n    if (!el) return true;\n    const distance = el.scrollHeight - el.scrollTop - el.clientHeight;\n    return distance < 120; // px\n  }, []);\n\n  const scheduleAutoScroll = useCallback((behavior) => {\n    // Avoid doing smooth scroll on every streamed token (very slow).\n    if (!isNearBottom()) return;\n    const now = Date.now();\n    if (behavior === 'auto' && now - lastScrollAtRef.current < 80) return; // throttle streaming scrolls\n    lastScrollAtRef.current = now;\n    if (scrollRafRef.current) cancelAnimationFrame(scrollRafRef.current);\n    scrollRafRef.current = requestAnimationFrame(() => scrollToBottom(behavior));\n  }, [isNearBottom, scrollToBottom]);\n\n  useEffect(() => {\n    scheduleAutoScroll('smooth');\n  }, [messages, scheduleAutoScroll]);\n\n  useEffect(() => {\n    if (!isStreaming) return;\n    scheduleAutoScroll('auto');\n  }, [streamingText, isStreaming, scheduleAutoScroll]);\n\n  //  Allow other parts of the app (ChatLayout upload modal, etc.) to request a history refresh\n  useEffect(() => {\n    const handler = (evt) => {\n      // If an event provides case/session, we still just refresh current view.\n      // This keeps logic simple and avoids mismatched state.\n      setHistoryRefreshKey((k) => k + 1);\n    };\n    window.addEventListener('chat-refresh', handler);\n    return () => window.removeEventListener('chat-refresh', handler);\n  }, []);\n\n  //  Load cases with sessions when no case is selected\n  useEffect(() => {\n    const loadCasesWithSessions = async () => {\n      if (caseId) return; // Only load when no case selected\n\n      setLoadingCaseSessions(true);\n      try {\n        // First fetch cases list\n        await fetchCases();\n        // Then fetch all sessions\n        const data = await apiGet('/api/chat/all-sessions', { showErrorToast: false });\n        setCasesWithSessions(data.cases || []);\n      } catch (err) {\n        console.error('Failed to load cases with sessions:', err);\n      } finally {\n        setLoadingCaseSessions(false);\n      }\n    };\n\n    loadCasesWithSessions();\n  }, [caseId, fetchCases]);\n\n  // Load history\n  //  FIX: Added race condition protection - stale requests won't update state\n  useEffect(() => {\n    let isCancelled = false;\n\n    const loadHistory = async () => {\n      if (!caseId) return;\n\n      try {\n        const url = sessionId\n          ? `/api/cases/${caseId}/chat/history?session_id=${sessionId}`\n          : `/api/cases/${caseId}/chat/history`;\n\n        const data = await apiGet(url, { showErrorToast: false });\n\n        //  FIX: Don't update state if this effect was superseded\n        if (isCancelled) return;\n\n        setMessages(data.messages || []);\n\n        //  FIX: Only call onSessionChange if NO sessionId was requested\n        // This prevents auto-loading from overriding user-selected sessions\n        if (!sessionId && data.session_id && onSessionChange) {\n          onSessionChange(data.session_id);\n        }\n      } catch (err) {\n        if (!isCancelled) {\n          console.error('Failed to load history:', err);\n        }\n      }\n    };\n\n    loadHistory();\n\n    // Cleanup: mark this effect as cancelled so stale requests are ignored\n    return () => {\n      isCancelled = true;\n    };\n  }, [caseId, sessionId, onSessionChange, historyRefreshKey]);\n\n  // Load case context (players)\n  useEffect(() => {\n    const loadCaseContext = async () => {\n      if (!caseId) return;\n      try {\n        const response = await apiGet(`/api/cases/${caseId}/context`, { showErrorToast: false });\n        if (response && response.has_context && response.context) {\n          const ctx = response.context;\n          setCaseContext(ctx);\n          setPlayersForm({\n            judges: (ctx.judges || []).map(j => j.name).join(', '),\n            myPartyName: ctx.my_party_name || '',\n            myPartyRole: ctx.my_party_role || 'plaintiff',\n            myLawyerName: ctx.my_lawyer_name || '',\n            opposingPartyName: ctx.primary_opposing_party_name || ctx.opposing_party_name || '',\n            opposingPartyRole: ctx.primary_opposing_party_role || ctx.opposing_party_role || 'defendant',\n            opposingLawyerName: ctx.opposing_lawyer_name || '',\n            myWitnesses: (ctx.my_witnesses || []).map(w => w.name).join(', '),\n            opposingWitnesses: (ctx.opposing_witnesses || []).map(w => w.name).join(', '),\n            additionalContext: ctx.additional_context || '', //  NEW: Load additional context\n          });\n        }\n      } catch (err) {\n        console.error('Failed to load case context:', err);\n      }\n    };\n    loadCaseContext();\n  }, [caseId]);\n\n  // Check if context is missing critical info (party names only - judges are optional)\n  const isMissingContext = useMemo(() => {\n    //  IMPORTANT: Don't ask for \"players\" if no case selected at all\n    if (!caseId) return false;\n    //  FIX: Enable context collection for free_chat too - need to know parties!\n    if (!caseContext) return true;\n    //  FIX: Only require party names - judges are optional!\n    // Check if we have at least one party name (our side or opposing)\n    const hasParties = caseContext.my_party_name || caseContext.primary_opposing_party_name;\n    return !hasParties;\n  }, [caseContext, caseId, caseType]);\n\n  // Save case context\n  const saveCaseContext = async () => {\n    try {\n      const payload = {\n        judges: (playersForm.judges || '').split(',').map(n => ({ name: n.trim() })).filter(j => j.name),\n        my_party_name: playersForm.myPartyName || '',\n        my_party_role: playersForm.myPartyRole || 'plaintiff',\n        my_lawyer_name: playersForm.myLawyerName || '',\n        primary_opposing_party_name: playersForm.opposingPartyName || '',\n        primary_opposing_party_role: playersForm.opposingPartyRole || 'defendant',\n        opposing_lawyer_name: playersForm.opposingLawyerName || '',\n        my_witnesses: (playersForm.myWitnesses || '').split(',').map(n => ({ name: n.trim() })).filter(w => w.name),\n        opposing_witnesses: (playersForm.opposingWitnesses || '').split(',').map(n => ({ name: n.trim() })).filter(w => w.name),\n        additional_context: playersForm.additionalContext || '', //  NEW: Free text for nicknames, aliases\n      };\n\n      const data = await apiPatch(`/api/cases/${caseId}/context`, payload);\n      setCaseContext(data);\n      setEditingPlayers(false);\n      toast.success('  ');\n    } catch (err) {\n      console.error('Failed to save case context:', err);\n      // Show detailed error message\n      const errMsg = err?.message || '  ';\n      toast.error(` : ${errMsg}`);\n    }\n  };\n\n  // Load case files for smart tools\n  useEffect(() => {\n    const loadFiles = async () => {\n      if (!caseId) return;\n      try {\n        const data = await apiGet(`/api/cases/${caseId}`, { showErrorToast: false });\n        if (data?.files) {\n          setCaseFiles(data.files);\n        }\n        const ct = data?.case_type || data?.case?.case_type || null;\n        setCaseType(ct);\n      } catch (err) {\n        console.error('Failed to load case files:', err);\n      }\n    };\n    loadFiles();\n  }, [caseId]);\n\n  //  Ensure analysisResult exists for chat quick-access counters\n  useEffect(() => {\n    const loadAnalysisIfMissing = async () => {\n      if (!caseId) return;\n      if (analysisResult) return;\n      if (analysisLoadedRef.current) return;\n      analysisLoadedRef.current = true;\n      try {\n        const data = await apiGet(`/api/cases/${caseId}/analysis`, { showErrorToast: false });\n        setLocalAnalysis(data);\n      } catch (err) {\n        // Silent - chat should still work even without analysis blob\n      }\n    };\n    loadAnalysisIfMissing();\n  }, [caseId, analysisResult]);\n\n  const effectiveAnalysis = analysisResult || localAnalysis;\n\n  // Toggle file selection\n  const toggleFileSelection = useCallback((file) => {\n    setSelectedFiles(prev => {\n      const isSelected = prev.some(f => f.id === file.id);\n      if (isSelected) {\n        return prev.filter(f => f.id !== file.id);\n      }\n      return [...prev, file];\n    });\n  }, []);\n\n  // Send message - defined first so it can be used by executeTool\n  //  FIX: Added displayText parameter - shows short summary to user while sending full prompt to LLM\n  const sendMessage = useCallback(async (text = input, displayText = null) => {\n    if (!text.trim() && uploadFiles.length === 0) return;\n\n    //  CHANGE: Require case selection - no more free chat\n    //     \n    let effectiveCaseId = caseId;\n    let shouldNavigateAfter = false;\n    if (!effectiveCaseId) {\n      toast.info('        ');\n      addLog({ type: 'chat', level: 'warn', message: '   ' });\n      return;\n    }\n\n    addLog({ type: 'chat', level: 'info', message: ' ' });\n    //  FIX: Use displayText for UI if provided, otherwise use the full text\n    const userMessage = {\n      id: `temp_${Date.now()}`,\n      role: 'user',\n      content: displayText || text,  // Show short summary to user\n      timestamp: new Date().toISOString(),\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInput('');\n    setIsLoading(true);\n    setStreamingText('');\n\n    try {\n      // Check for adversarial analysis command\n      const isAdversarial = text.trim() === '/adversarial';\n\n      const endpoint = isAdversarial\n        ? `/api/cases/${effectiveCaseId}/chat/adversarial`\n        : `/api/cases/${effectiveCaseId}/chat`;\n\n      //  FIX: Get auth token from Zustand store (not localStorage)\n      const token = useAuthStore.getState().token;\n      // Base URL for API - empty string means same origin (relative URLs)\n      const baseUrl = '';\n\n      //  STREAMING: Use fetch with streaming for text-only messages\n      if (uploadFiles.length === 0 && !isAdversarial) {\n        const formData = new FormData();\n        formData.append('message', text);\n        //  FIX: Send display_text separately to hide prompts from user\n        if (displayText && displayText !== text) {\n          formData.append('display_text', displayText);\n        }\n        if (sessionId) formData.append('session_id', sessionId);\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          headers: {\n            'Authorization': token ? `Bearer ${token}` : '',\n            'X-Stream-Response': 'true',  //  Request streaming\n          },\n          body: formData,\n          credentials: 'include',\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          //  Parse structured error messages from backend\n          let errorMessage = '  ';\n          if (errorData.detail) {\n            try {\n              const parsed = typeof errorData.detail === 'string'\n                ? JSON.parse(errorData.detail)\n                : errorData.detail;\n              errorMessage = parsed.message || errorData.detail;\n            } catch {\n              errorMessage = errorData.detail;\n            }\n          }\n          throw new Error(errorMessage);\n        }\n\n        const contentType = response.headers.get('content-type') || '';\n\n        //  Handle streaming response (SSE)\n        if (contentType.includes('text/event-stream')) {\n          setIsStreaming(true);\n          const reader = response.body.getReader();\n          const decoder = new TextDecoder();\n          let fullText = '';\n          let messageId = null;\n          let newSessionId = null;\n          let toolResult = null;\n          let toolBanner = null;\n          let documentsUsed = []; //  Track which documents Yitro used\n          let totalDocuments = 0;\n          let taxonomySnapshot = null; //  Taxonomy (claims/contradictions/entities)\n          let sseBuffer = ''; //  FIX: Buffer for incomplete SSE events\n\n          while (true) {\n            const { done, value } = await reader.read();\n            if (done) break;\n\n            const chunk = decoder.decode(value, { stream: true });\n            sseBuffer += chunk;\n\n            //  FIX: Split by double newline (SSE event delimiter) and process complete events\n            const events = sseBuffer.split('\\n\\n');\n            // Keep the last part in buffer (might be incomplete)\n            sseBuffer = events.pop() || '';\n\n            // Process complete events - flatten to lines\n            const lines = events.flatMap(event => event.split('\\n'));\n\n            for (const line of lines) {\n              if (line.startsWith('data: ')) {\n                try {\n                  const data = JSON.parse(line.slice(6));\n\n                  if (data.type === 'token' && data.chunk) {\n                    fullText += data.chunk;\n                    setStreamingText(fullText);\n                  } else if (data.type === 'warning') {\n                    // Show warning but continue\n                    console.warn(' Stream warning:', data.message);\n                    // Add warning to end of text\n                    fullText += `\\n\\n ${data.message}`;\n                    setStreamingText(fullText);\n                  } else if (data.type === 'progress') {\n                    //  Analysis progress update\n                    setStreamingProgress({\n                      stage: data.stage,\n                      progress: data.progress,\n                      message: data.message,\n                    });\n                  } else if (data.type === 'verified_content') {\n                    //  Verified streaming mode: receive full content at once after verification\n                    fullText = data.content;\n                    setStreamingText(fullText);\n                    setStreamingProgress({ progress: 100, message: '', stage: 'complete' });\n                  } else if (data.type === 'continuation') {\n                    //  Response was chunked - will offer \"continue\" button\n                    console.log(' Continuation available:', data.message);\n                  } else if (data.type === 'done') {\n                    messageId = data.message_id;\n                    newSessionId = data.session_id;\n                    toolResult = data.tool_result;\n                    toolBanner = data.tool_banner;\n                    //  NEW: Capture documents used for transparency\n                    documentsUsed = data.documents_used || [];\n                    totalDocuments = data.total_documents || 0;\n                    taxonomySnapshot = data.taxonomy_snapshot || null;\n                    //  Check if continuation is available\n                    if (data.continuation_available) {\n                      setContinuationMessageId(messageId);\n                    } else {\n                      setContinuationMessageId(null);\n                    }\n                    // Check if response was truncated (hard limit)\n                    if (data.truncated && !data.continuation_available) {\n                      fullText += '\\n\\n---\\n _   .     ._';\n                    }\n                  } else if (data.type === 'error') {\n                    throw new Error(data.message || ' ');\n                  }\n                } catch (parseErr) {\n                  // Ignore parse errors for incomplete chunks\n                }\n              }\n            }\n          }\n\n          // Add final message\n          const assistantMessage = {\n            id: messageId || `msg_${Date.now()}`,\n            role: 'assistant',\n            content: fullText,\n            timestamp: new Date().toISOString(),\n            tool_result: toolResult,\n            tool_banner: toolBanner,\n            documents_used: documentsUsed, //  Track sources for transparency\n            total_documents: totalDocuments,\n            taxonomy_snapshot: taxonomySnapshot,\n          };\n\n          setMessages(prev => [...prev, assistantMessage]);\n          setIsStreaming(false);\n          setStreamingText('');\n          setStreamingProgress(null); // Clear progress\n          addLog({ type: 'chat', level: 'success', message: ' ' });\n\n          if (newSessionId && onSessionChange) {\n            onSessionChange(newSessionId);\n          }\n        } else {\n          // Non-streaming JSON response\n          const data = await response.json();\n          const assistantMessage = {\n            id: data.message_id || `msg_${Date.now()}`,\n            role: 'assistant',\n            content: data.response,\n            timestamp: new Date().toISOString(),\n            tool_result: data.tool_result,\n            tool_banner: data.tool_banner,\n            taxonomy_snapshot: data.taxonomy_snapshot,\n          };\n\n          setMessages(prev => [...prev, assistantMessage]);\n          addLog({ type: 'chat', level: 'success', message: ' ' });\n\n          if (data.session_id && onSessionChange) {\n            onSessionChange(data.session_id);\n          }\n        }\n      } else if (uploadFiles.length > 0) {\n        addLog({ type: 'upload', level: 'info', message: ` ${uploadFiles.length}  ` });\n        //  File upload - no streaming (uses FormData)\n        const formData = new FormData();\n        formData.append('message', text);\n        if (sessionId) formData.append('session_id', sessionId);\n\n        //  Extract actual files and sources\n        const sources = uploadFiles.map(item => item.source || 'self');\n        formData.append('file_sources', JSON.stringify(sources));\n        uploadFiles.forEach(item => {\n          const actualFile = item.file || item; // Support both wrapped and unwrapped\n          formData.append('files', actualFile);\n        });\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          headers: {\n            'Authorization': token ? `Bearer ${token}` : '',\n          },\n          body: formData,\n          credentials: 'include',\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          //  Parse structured error messages from backend\n          let errorMessage = '  ';\n          if (errorData.detail) {\n            try {\n              const parsed = typeof errorData.detail === 'string'\n                ? JSON.parse(errorData.detail)\n                : errorData.detail;\n              errorMessage = parsed.message || errorData.detail;\n            } catch {\n              errorMessage = errorData.detail;\n            }\n          }\n          throw new Error(errorMessage);\n        }\n\n        const data = await response.json();\n        const assistantMessage = {\n          id: data.message_id || `msg_${Date.now()}`,\n          role: 'assistant',\n          content: data.response,\n          timestamp: new Date().toISOString(),\n          tool_result: data.tool_result,\n          tool_banner: data.tool_banner,\n          taxonomy_snapshot: data.taxonomy_snapshot,\n        };\n\n        setMessages(prev => [...prev, assistantMessage]);\n        addLog({ type: 'upload', level: 'success', message: '   ' });\n        addLog({ type: 'chat', level: 'success', message: ' ' });\n\n        if (data.session_id && onSessionChange) {\n          onSessionChange(data.session_id);\n        }\n      } else {\n        // Adversarial analysis - use apiPost (no streaming)\n        const data = await apiPost(endpoint, {\n          message: '     ',\n          session_id: sessionId,\n        });\n\n        const assistantMessage = {\n          id: data.message_id || `msg_${Date.now()}`,\n          role: 'assistant',\n          content: data.response,\n          timestamp: new Date().toISOString(),\n          tool_result: data.tool_result,\n          tool_banner: data.tool_banner,\n          is_adversarial: true,\n        };\n\n        setMessages(prev => [...prev, assistantMessage]);\n        addLog({ type: 'chat', level: 'success', message: ' ' });\n\n        if (data.session_id && onSessionChange) {\n          onSessionChange(data.session_id);\n        }\n      }\n    } catch (err) {\n      console.error('Failed to send message:', err);\n      toast.error(err.message || '  ');\n      setMessages(prev => prev.slice(0, -1)); // Remove temp message\n      setIsStreaming(false);\n      setStreamingText('');\n      addLog({ type: 'chat', level: 'error', message: '  / ' });\n    } finally {\n      setIsLoading(false);\n      setUploadFiles([]);\n\n      //  FIX: Navigate AFTER files are uploaded to prevent state loss\n      if (shouldNavigateAfter && effectiveCaseId) {\n        navigate(`/cases/${effectiveCaseId}/chat`, { replace: true });\n        //  FIX: Dispatch event to refresh sidebar when new case is created\n        window.dispatchEvent(new CustomEvent('caseCreated', { detail: { caseId: effectiveCaseId } }));\n      }\n    }\n  }, [input, uploadFiles, caseId, sessionId, onSessionChange, navigate, addLog]);\n\n  //  Allow external UI (CapabilitiesRail) to trigger actions inside chat.\n  useEffect(() => {\n    const handler = (evt) => {\n      const detail = evt?.detail || {};\n      const prompt = detail.prompt;\n      const displayText = detail.displayText ?? null;\n      if (typeof prompt === 'string' && prompt.trim()) {\n        sendMessage(prompt, displayText);\n      }\n    };\n    window.addEventListener('chat-send', handler);\n    return () => window.removeEventListener('chat-send', handler);\n  }, [sendMessage]);\n\n  // \n  //  WORLD-CLASS ANALYSIS PROMPT SYSTEM v2.0\n  // \n  const buildAnalysisPrompt = useCallback((actionKey, payload = null) => {\n    // \n    //  UNIFIED BASE CONTRACT -   \n    // \n    const baseContract = `\n---\n##   \n- **:**       ( , )   \"  \"\n- **-:**    , ,   \n- **:** , ,    \n\n##    - -\n**     .  :**\n-    [___]  [X%]\n-     \n-    \n-  \n\n**    **,   \"     \"    .\n`;\n\n    switch (actionKey) {\n      // \n      //  EXECUTIVE -   \n      // \n      case 'executive':\n        return `        .\n\n**   :**\n\n1. ** ** -    ,   ,  .     .\n\n2. ** ** -      ?     .\n\n3. ** ** -      ?   ?    ?\n\n4. **3  ** -    ,    ?\n\n5. **** -  3  (, , )     .\n\n6. ** ** -     ?\n\n** :**   ,  \n\n${baseContract}`;\n\n      // \n      //  ISSUES MAP -   \n      // \n      case 'issuesmap':\n        return `    ,   .\n\n**   :**\n\n1. ** ** -   ?    -  .\n\n2. ** ** -  :  ?   ?   ?   ?\n\n3. **  ** -   ?   ?  ?\n\n4. **** -     ?    .\n\n5. **  ** -   ?   ?   ?\n\n6. **  ** -     ?\n\n7. ** ** -   :  ( ), , .\n\n** :**    ,  \n\n${baseContract}`;\n\n      // \n      //  FORENSICS -   \n      // \n      case 'forensics':\n        return `    - ,   -   .\n\n**   :**\n\n1. ** ** -    (\" \"),  ,  .  .\n\n2. ** ** -     ?   ?   ?   ?\n\n3. ** ** -      ?     ?\n\n4. ** ** -        .    .\n\n5. ** ** -  :  ,  ,  ,  .\n\n6. **3   ** -        .\n\n7. **  ** -  3  : ,  ,  .\n\n** :**  ,  \n\n${baseContract}`;\n\n      // \n      //  GAME THEORY -     \n      // \n      case 'game_theory':\n        return `      .\n\n**   :**\n\n1. ** ** -  ?      ?    /?\n\n2. ** ** -     ? ( , , , )\n\n3. **   (Nash)** -         ?\n\n4. ** ZOPA** -      (Zone of Possible Agreement)?  ?\n\n5. **BATNA** -        (  )?\n\n6. ** ** -    :    ?  ?   ?\n\n7. ** ** -   ,   ? ?  ?\n\n8. ** ** -    /?  ?\n\n** :**  ,   \n\n${baseContract}`;\n\n      case 'counsel':\n      case 'profiler': {\n        const lawyerName =\n          payload?.opponentLawyerName ? ` (${payload.opponentLawyerName})` : '';\n        return `    \" ${lawyerName}    .    .\n\n**   :**\n\n1. ** ** -   ?    ?   (//)?   .\n\n2. ** ** -  ?   ?   ?    ?\n\n3. ** ** -     ?    \"?    ?\n\n4. **** -   ?   ?\n\n5. **** -   ?  ?  .\n\n6. **** -    ?   ?    ?\n\n7. ** ** -   ?   ?   ?\n\n${baseContract}`;\n      }\n      // \n      //  RISK -   \n      // \n      case 'risk':\n        return `       - , ,  .\n\n**   :**\n\n1. ** ** -   ///?     (1-10).\n\n2. ** ** -   : , , , ,  .\n\n3. ** ** -   ?   ?  ?\n\n4. ** ** -  ?     ?  ?\n\n5. ** ** -    .\n\n6. ** \" \"** -    ?     ?    ?\n\n7. ** ** -  :  , , .\n\n8. ** ** -       .\n\n** :**  ,  \n\n${baseContract}`;\n\n      // \n      //  INTELLIGENCE -  \n      // \n      case 'intelligence':\n        return ` \"    - ,  .\n\n**   :**\n\n1. ** ** -    ,  ,  ,  .\n\n2. **  ** ( ) -      (, , \")?   ?   ?\n\n3. ** ** -   ?  ?   ?\n\n4. ** ** -   ,   ,  ,   .  -ROI?\n\n5. **  ** -     (, , )?    ?   ?\n\n6. **** -        .\n\n7. ** ** - 3     .\n\n8. **Red Team** -   \" ,    ?\n\n** :**   ,  \" ,  \n\n${baseContract}`;\n\n      // \n      //  CREDIBILITY -   \n      // \n      case 'credibility':\n        return `     -     .\n\n**   :**\n\n1. ** ** -   /// ?\n\n2. ** ** -  :         (, ).    (//)  .\n\n3. ** ** -   (1-100)  :  ,  ,  ,  .  , ,   ?\n\n4. ** ** -     ?  ?\n\n5. **  ** - : ,  ,  ,  ,  .  .\n\n6. **   ** -   ,      ?\n\n7. **  ** -  ,  3 : (1)   , (2)   , (3)  .\n\n8. ** ** - \" 3 \" -      ().\n\n** :**   ,  \n\n${baseContract}`;\n\n      default:\n        return null;\n    }\n  }, []);\n\n  //  FIX: Display labels for analysis actions (user sees this, not the full prompt)\n  const ACTION_DISPLAY_LABELS = {\n    // Quick Access Tabs\n    executive: '   ...',\n    issuesmap: '   ...',\n    forensics: '   ...',\n    game_theory: '    ...',\n    risk: '   ...',\n    intelligence: '   ...',\n    credibility: '   ...',\n    // Quick Actions\n    overview: '   ...',\n    strategy: '  ...',\n    knowledge: '   ...',\n    adversarial: '   ...',\n    contract_analysis: '   ...',\n    // Smart Tools\n    compare_docs: '  ...',\n    analyze_testimony: '  ...',\n    cross_exam: '   ...',\n    semantic_search: '  ...',\n    simulation: '  ...',\n  };\n\n  const runQueuedAction = useCallback(async (actionKey, payload = null) => {\n    if (!actionKey) return;\n\n    // Tier gating (align with UI)\n    const tab = QUICK_ACCESS_TABS.find(t => t.key === actionKey) || null;\n    if (tab) {\n      const requiredTier = tab.requiresTier || 'free';\n      const allowed = hasTier(requiredTier);\n      if (!allowed) {\n        openUpgradeModal(tab.label, tab.title, requiredTier);\n        return;\n      }\n    }\n\n    //  Intelligence must run Risk first (automatic chain)\n    if (actionKey === 'intelligence') {\n      const riskPrompt = buildAnalysisPrompt('risk', payload);\n      const intelPrompt = buildAnalysisPrompt('intelligence', payload);\n      //  FIX: Show short display text, send full prompt to LLM\n      if (riskPrompt) await sendMessage(riskPrompt, ACTION_DISPLAY_LABELS['risk']);\n      if (intelPrompt) await sendMessage(intelPrompt, ACTION_DISPLAY_LABELS['intelligence']);\n      return;\n    }\n\n    const prompt = buildAnalysisPrompt(actionKey, payload);\n    const displayText = ACTION_DISPLAY_LABELS[actionKey] || `  ${actionKey}...`;\n    //  FIX: Show short display text, send full prompt to LLM\n    if (prompt) await sendMessage(prompt, displayText);\n  }, [buildAnalysisPrompt, hasTier, openUpgradeModal, sendMessage]);\n\n  //  Run queuedAction passed from redirects (/counsel,/profiler,/intelligence, etc.)\n  useEffect(() => {\n    if (!caseId) return;\n    if (!initialQueuedAction) return;\n    if (queuedActionRanRef.current) return;\n    queuedActionRanRef.current = true;\n    runQueuedAction(initialQueuedAction, initialQueuedActionPayload);\n  }, [caseId, initialQueuedAction, initialQueuedActionPayload, runQueuedAction]);\n\n  //  Handle \" ?\" button click\n  const handleContinue = useCallback(async () => {\n    if (!continuationMessageId || !caseId) return;\n\n    setIsLoading(true);\n    setStreamingText('');\n    setContinuationMessageId(null); // Clear to prevent double-clicks\n\n    try {\n      const token = useAuthStore.getState().token;\n      const baseUrl = '';\n\n      const response = await fetch(`${baseUrl}/api/cases/${caseId}/chat`, {\n        method: 'POST',\n        headers: {\n          'Authorization': token ? `Bearer ${token}` : '',\n          'X-Stream-Response': 'true',\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          message: '',\n          session_id: sessionId,\n          continue_from: continuationMessageId,\n        }),\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.detail || '  ');\n      }\n\n      // Handle streaming response (same logic as sendMessage)\n      const contentType = response.headers.get('content-type') || '';\n      if (contentType.includes('text/event-stream')) {\n        const reader = response.body.getReader();\n        const decoder = new TextDecoder();\n        let fullText = '';\n        let messageId = null;\n        let newSessionId = null;\n        let sseBuffer = ''; //  FIX: Buffer for incomplete SSE events\n\n        setIsStreaming(true);\n\n        while (true) {\n          const { done, value } = await reader.read();\n          if (done) break;\n\n          const chunk = decoder.decode(value, { stream: true });\n          sseBuffer += chunk;\n\n          //  FIX: Split by double newline (SSE event delimiter) and process complete events\n          const events = sseBuffer.split('\\n\\n');\n          sseBuffer = events.pop() || '';\n          const lines = events.flatMap(event => event.split('\\n'));\n\n          for (const line of lines) {\n            if (line.startsWith('data: ')) {\n              try {\n                const data = JSON.parse(line.slice(6));\n\n                if (data.type === 'token' && data.chunk) {\n                  fullText += data.chunk;\n                  setStreamingText(fullText);\n                } else if (data.type === 'continuation') {\n                  console.log(' More continuation available');\n                } else if (data.type === 'done') {\n                  messageId = data.message_id;\n                  newSessionId = data.session_id;\n                  if (data.continuation_available) {\n                    setContinuationMessageId(messageId);\n                  }\n                }\n              } catch (parseErr) {\n                // Ignore parse errors\n              }\n            }\n          }\n        }\n\n        // Add continuation message\n        const assistantMessage = {\n          id: messageId || `msg_${Date.now()}`,\n          role: 'assistant',\n          content: fullText,\n          timestamp: new Date().toISOString(),\n          isContinuation: true,\n        };\n\n        setMessages(prev => [...prev, assistantMessage]);\n        setIsStreaming(false);\n        setStreamingText('');\n\n        if (newSessionId && onSessionChange) {\n          onSessionChange(newSessionId);\n        }\n      }\n    } catch (error) {\n      console.error('Continuation error:', error);\n      toast.error(error.message || '  ');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [continuationMessageId, caseId, sessionId, onSessionChange]);\n\n  // Execute smart tool\n  const executeTool = useCallback((tool, files = []) => {\n    let prompt = '';\n\n    //  SMART TOOLS - UPGRADED TO WORLD-CLASS PROMPTS - December 2024\n    switch (tool.id) {\n      case 'compare_docs':\n        if (files.length < 2) {\n          toast.error('  2  ');\n          return;\n        }\n        prompt = `#     ${files.map(f => f.filename).join(' vs ')}\n\n     .  , ,  .\n\n##   \n|  |  |\n|-----|-----|\n|   | X |\n|   | // |\n|  \"\"  | |\n\n##    (  )\n| # |  |    |    |  |   |\n|---|------|-------------|-------------|-------|--------------|\n :   +  \n\n##    \n|   |   |    |   |\n|--------|-----------|-------------|----------|\n\n##  - \n-   \n-  \n- / \n\n##    \n|  |   |   | ? |\n|-------|---------|---------|--------|\n\n##  5    \n :\n** X:** [ ]\n-  : [ ]\n-   : [ + ]\n-  : [  ]\n\n##   \n1. [ + ]\n\n   =  .     \"  \"`;\n        break;\n\n      case 'analyze_testimony':\n        if (files.length === 0) {\n          toast.error('   ');\n          return;\n        }\n        prompt = `#     ${files.map(f => f.filename).join(', ')}\n\n     .    .\n\n##   \n|  |  |\n|-------|-------|\n|   | X/10 |\n|   | X/10 |\n|   | // |\n|   | / |\n\n##    ( )\n| # |  X  |  Y  |   |  |\n|---|-----------|-----------|------------|-------|\n :   + \n\n##    \n|  |   |    |\n|-----|----------|---------------|\n\n##   \n###  -:\n-  (\"\", \"\")\n-   (\" \", \"  \")\n-   \n\n###  :\n-  \" \"\n-    \n-  /\n\n##    \n| # |  |  |    |   |\n|---|-------|-------|---------------|----------|\n\n##  7   \n :\n** X:** []\n-  : [ ]\n-   : [ X]\n-  : [    ]\n-   : [  X   Y]\n\n##    \n1.  -[ ]  2.  -[]  3.   -[ ]\n\n   =  + .    \"  \"`;\n        break;\n\n      case 'cross_exam':\n        prompt = `#         \n\n##   \n  ?     ?\n\n##  10    (  )\n\n###   (1-3)\n :\n** X:** [     ]\n-  : [  ]\n-   : [/ ]\n-   : [   ]\n-   : [ ]\n\n###   (4-7)\n[      ]\n\n###   (8-10)\n** X:** [  ]\n-  :   \n-   : [ ]\n-  : [     ]\n-   : [ ]\n\n##   \n\\`\\`\\`\n 1 \n    \"\"   2\n    \"\"   2\n\\`\\`\\`\n\n##   \n-    ( )\n-   \n\n##    \n- [ ]   \n- [ ]   \n- [ ]  \n\n        `;\n        break;\n\n      case 'semantic_search':\n        // searchInput is passed via the tool object\n        if (!tool.searchQuery?.trim()) {\n          toast.error('  ');\n          return;\n        }\n        prompt = `#    : \"${tool.searchQuery}\"\n\n      .   .\n\n##   \n|  |  |\n|-----|-----|\n|   | X |\n|   | X |\n|   | // |\n\n##    ( )\n| # |  |  |  |  |\n|---|------|------|-------|----------|\n :    \n\n##    ( )\n|  |  |  |   |\n|------|------|------|-----------|\n\n##   \n    :\n- [ +   ]\n\n##   \n     :\n|    |    |  |\n|-------------|-------------|--------|\n\n##    \n- [        ]\n\n##  \n1. [  ]\n2. [   ]\n\n   =   ( + )`;\n        break;\n\n      case 'simulation':\n        prompt = `#       5 \n\n##   \n|  |  |\n|-------|-----|\n|   | [//] |\n|   | [  ] |\n|   | [//] |\n\n---\n\n##   1: \n\n### \"  :\n[   2-3  ]\n  : []\n\n###    :\n[/ ]\n  : [ ]\n\n###  :\n[//]\n\n ** :** [  ]\n\n---\n\n##  2: \n[   ]\n\n---\n\n##  3: \n[  ]\n\n---\n\n##  4:  \n[   ]\n\n---\n\n##  5: \n###   :\n[  ]\n\n###   :\n[  ]\n\n---\n\n##   \n\n### Scorecard:\n|  |  |  |  |\n|-----|------|------|------|\n| 1 | | | X/10 |\n| 2 | | | X/10 |\n| 3 | | | X/10 |\n| 4 | | | X/10 |\n| 5 | | | X/10 |\n| **\"** | | | **/50 |\n\n###  :\n###  :\n###   :\n\n##  5   \n1. [ + ]\n\n##  \n- [    ]\n\n      `;\n        break;\n\n      default:\n        return;\n    }\n\n    setSelectedTool(null);\n    setSelectedFiles([]);\n    setSearchInput('');\n    sendMessage(prompt);\n  }, [sendMessage]);\n\n  // Handle smart tool selection\n  const handleToolSelect = useCallback((tool) => {\n    if (tool.premium && !isPremium) {\n      openUpgradeModal(tool.name, tool.description, 'professional');\n      return;\n    }\n\n    if (tool.needsFiles) {\n      setSelectedTool(tool);\n      setSelectedFiles([]);\n      setSearchInput('');\n    } else if (tool.needsInput) {\n      setSelectedTool(tool);\n      setSearchInput('');\n    } else {\n      executeTool(tool);\n    }\n  }, [isPremium, executeTool, openUpgradeModal]);\n\n  // Handle quick action click\n  const handleQuickAction = (action) => {\n    if (action.premium && !isPremium) {\n      openUpgradeModal(action.label, '    Professional ', 'professional');\n      return;\n    }\n    if (action.enterprise && !isEnterprise) {\n      openUpgradeModal(action.label, '    Enterprise ', 'enterprise');\n      return;\n    }\n\n    //  Gating rules for strategy/risk (prevent running when prerequisites are missing)\n    const a = effectiveAnalysis;\n    const contradictionsCount = a?.contradictions_count ?? (Array.isArray(a?.contradictions) ? a.contradictions.length : 0);\n    const disputesCount = a?.disputes_count ?? (Array.isArray(a?.disputes) ? a.disputes.length : 0);\n    const deceptionCount = Array.isArray(a?.deception_patterns) ? a.deception_patterns.length : 0;\n    const hasAttackSignals = (contradictionsCount + disputesCount + deceptionCount) > 0;\n\n    const isPleadingDoc = (f) => {\n      const dt = String(f?.document_type || f?.doc_type || '').toLowerCase();\n      const fn = String(f?.filename || '').toLowerCase();\n      return ['claim', 'defense', 'reply', 'response'].includes(dt) || fn.includes(' ') || fn.includes(' ') || fn.includes(' ') || fn.includes('');\n    };\n    const hasPleadingsSelf = (caseFiles || []).some(f => isPleadingDoc(f) && (f?.source || 'self') === 'self');\n    const hasPleadingsOpponent = (caseFiles || []).some(f => isPleadingDoc(f) && (f?.source || 'self') === 'opponent');\n    const hasAnyClaimDoc = (caseFiles || []).some(f => isPleadingDoc(f));\n    const hasOpponentLawyer = !!(caseContext?.opposing_lawyer_name || playersForm?.opposingLawyerName);\n\n    if (action.id === 'risk') {\n      if (!(hasPleadingsSelf && hasPleadingsOpponent)) {\n        toast.error('         ( + ).');\n        return;\n      }\n    }\n\n    if (action.id === 'strategy') {\n      if (!hasAnyClaimDoc) {\n        toast.error('      / / .');\n        return;\n      }\n      if (!hasOpponentLawyer) {\n        toast.error('    / \"  ( ).');\n        return;\n      }\n      if (!hasAttackSignals) {\n        toast.error('    //   .    .');\n        return;\n      }\n    }\n\n    //  FIX: Show action label to user, send full prompt to LLM\n    const displayText = ` ${action.label}...`;\n    sendMessage(action.prompt, displayText);\n  };\n\n  //  On-demand deep analysis (explicit user action)\n  const runDeepAnalysis = useCallback(async (mode = 'full') => {\n    if (!caseId) return;\n    try {\n      toast.info('  ');\n      await apiPost(`/api/cases/${encodeURIComponent(caseId)}/reanalyze`, { mode });\n      toast.success(' .      .');\n      try {\n        addLog?.({\n          type: 'analysis',\n          level: 'info',\n          message: `   (${mode})`,\n          meta: { caseId }\n        });\n      } catch {\n        // ignore\n      }\n    } catch (err) {\n      const msg = err?.message || '  ';\n      toast.error(msg);\n    }\n  }, [caseId, addLog]);\n\n  // Copy message\n  const copyMessage = async (messageId, content) => {\n    try {\n      await navigator.clipboard.writeText(content);\n      setCopiedMessageId(messageId);\n      setTimeout(() => setCopiedMessageId(null), 2000);\n      toast.success('');\n    } catch (err) {\n      toast.error(' ');\n    }\n  };\n\n  // Pin content from message\n  const handlePin = async (content, category = 'note', sourceMessageId = null) => {\n    const result = await onPinItem({\n      content,\n      category,\n      source_message_id: sourceMessageId,\n    });\n\n    if (result.success) {\n      toast.success('  ');\n    } else if (result.reason === 'limit') {\n      toast.error('  .  -Pro');\n    } else {\n      toast.error(' ');\n    }\n  };\n\n  // Handle file upload - with source selection support\n  const handleFileSelect = (e) => {\n    const files = Array.from(e.target.files);\n    if (files.length > 3) {\n      toast.error('   3 ');\n      return;\n    }\n    //  Wrap files with source metadata\n    const filesWithSource = files.map(file => ({\n      file,\n      source: 'self', // Default source\n      name: file.name\n    }));\n    setUploadFiles(filesWithSource);\n    addLog({ type: 'upload', level: 'info', message: ` ${filesWithSource.length}  ` });\n  };\n\n  const removeFile = (index) => {\n    setUploadFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  //  Update file source\n  const updateFileSource = (index, newSource) => {\n    setUploadFiles(prev => prev.map((item, i) =>\n      i === index ? { ...item, source: newSource } : item\n    ));\n    addLog({ type: 'upload', level: 'info', message: `   (#${index + 1}): ${newSource}` });\n  };\n\n  //  Source options for file upload\n  const SOURCE_OPTIONS = [\n    { value: 'self', label: ' ', color: 'emerald' },\n    { value: 'opponent', label: ' ', color: 'red' },\n    { value: 'court', label: '  ', color: 'blue' },\n    { value: 'third_party', label: '  ', color: 'amber' }\n  ];\n\n  //  Free chat upload handlers (auto-create case + upload)\n  const handleFreeFilesSelect = (e) => {\n    const files = Array.from(e.target.files || []);\n    if (files.length === 0) return;\n    const wrapped = files.map((file) => ({\n      file,\n      name: file.name,\n      size: (file.size / 1024 / 1024).toFixed(2) + ' MB',\n      source: 'self',\n      opponentLawyerName: ''\n    }));\n    setFreeUploadFiles((prev) => {\n      const existing = new Set(prev.map((x) => x.name));\n      return [...prev, ...wrapped.filter((x) => !existing.has(x.name))].slice(0, 20);\n    });\n    addLog({ type: 'upload', level: 'info', message: ` ${files.length}   ` });\n    if (freeFileInputRef.current) freeFileInputRef.current.value = '';\n  };\n\n  const updateFreeFileSource = (index, newSource) => {\n    setFreeUploadFiles((prev) => prev.map((f, i) => (i === index ? { ...f, source: newSource } : f)));\n    addLog({ type: 'upload', level: 'info', message: `   (#${index + 1}): ${newSource}` });\n  };\n\n  const removeFreeUploadFile = (idx) => setFreeUploadFiles((prev) => prev.filter((_, i) => i !== idx));\n\n  const startFreeUpload = async () => {\n    if (freeUploadFiles.length === 0) return;\n    if (freeUploading) return;\n\n    // Validate opponent lawyer names when needed\n    const missingOpponentNames = freeUploadFiles.some(\n      (f) => f.source === 'opponent' && (!f.opponentLawyerName || !String(f.opponentLawyerName).trim())\n    );\n    if (missingOpponentNames) {\n      toast.error('   \"   ');\n      return;\n    }\n\n    setFreeUploading(true);\n    try {\n      addLog({ type: 'upload', level: 'info', message: '   ...' });\n      const created = await apiPost('/api/cases', {\n        name: (freeUploadName || '').trim() || `  - ${new Date().toLocaleString('he-IL')}`,\n        case_type: 'free_chat'\n      }, { showErrorToast: false });\n\n      const newCaseId = created?.case?.id;\n      if (!newCaseId) {\n        throw new Error('    ');\n      }\n\n      addLog({ type: 'upload', level: 'success', message: ` : ${created?.case?.name || newCaseId}` });\n      addLog({ type: 'upload', level: 'info', message: `  +  ${freeUploadFiles.length} ...` });\n\n      //  Create a dedicated chat session now, so the upload can be attached to it\n      let newSessionId = null;\n      try {\n        const sessResp = await apiPost(`/api/cases/${encodeURIComponent(newCaseId)}/chat/sessions`, {}, { showErrorToast: false });\n        newSessionId = sessResp?.session_id || null;\n      } catch (e) {\n        // Non-blocking: history endpoint can still create a session,\n        // but without session id the upload message may not be visible inside chat.\n        newSessionId = null;\n      }\n\n      const formData = new FormData();\n      //  Do NOT auto-run full analysis after upload (free chat included)\n      formData.append('reanalyze_mode', 'skip');\n      formData.append('file_sources', JSON.stringify(freeUploadFiles.map((f) => f.source || 'self')));\n      formData.append('opponent_lawyer_names', JSON.stringify(freeUploadFiles.map((f) => (f.source === 'opponent' ? (f.opponentLawyerName || '') : ''))));\n      formData.append('document_types', JSON.stringify(freeUploadFiles.map(() => 'other')));\n      if (newSessionId) {\n        formData.append('chat_session_id', String(newSessionId));\n      }\n      freeUploadFiles.forEach((f) => formData.append('files', f.file));\n\n      await apiUpload(`/api/cases/${encodeURIComponent(newCaseId)}/files`, formData, { showErrorToast: true, timeoutMs: 600000 });\n\n      addLog({ type: 'upload', level: 'success', message: '      ' });\n\n      setShowFreeUploadModal(false);\n      setFreeUploadFiles([]);\n\n      // Go straight into the new case chat\n      navigate(newSessionId ? `/cases/${newCaseId}/chat?session=${encodeURIComponent(newSessionId)}` : `/cases/${newCaseId}/chat`);\n      //  FIX: Dispatch event to refresh sidebar when new case is created\n      window.dispatchEvent(new CustomEvent('caseCreated', { detail: { caseId: newCaseId } }));\n    } catch (err) {\n      console.error('Free upload failed:', err);\n      addLog({ type: 'upload', level: 'error', message: '   ' });\n      toast.error(err?.message || ' ');\n    } finally {\n      setFreeUploading(false);\n    }\n  };\n\n  // Handle keyboard shortcuts\n  const handleKeyDown = (e) => {\n    // Enter to send (without Shift)\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n    // Ctrl+Enter / Cmd+Enter to send (alternative)\n    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {\n      e.preventDefault();\n      sendMessage();\n    }\n    // Up arrow to edit last message (when input is empty)\n    if (e.key === 'ArrowUp' && input === '' && messages.length > 0) {\n      const lastUserMessage = [...messages].reverse().find(m => m.role === 'user');\n      if (lastUserMessage) {\n        setInput(lastUserMessage.content);\n        e.preventDefault();\n      }\n    }\n  };\n\n  return (\n    <div className=\"h-full min-h-0 flex flex-col\">\n      {/* Inject animation styles */}\n      <style>{messageAnimationStyles}</style>\n\n      {/* ActivityLogStrip removed - users don't need to see activity log */}\n\n      {/* Messages Area */}\n      <div className=\"flex-1 flex flex-row min-h-0\">\n        {/* Chat Messages */}\n        <div ref={messagesContainerRef} className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {messages.length === 0 ? (\n          // Empty state - different based on whether case is selected\n          !caseId ? (\n            //  NO CASE SELECTED - Show case selector with document upload\n            <div className=\"flex flex-col h-full text-right\">\n              <div className=\"text-center mb-6\">\n                <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-blue-600 flex items-center justify-center mb-4 mx-auto\">\n                  <Sparkles size={32} className=\"text-white\" />\n                </div>\n                <h2 className=\"text-white text-xl font-bold mb-2\">,  </h2>\n                <p className=\"text-white/60 text-sm max-w-md mx-auto\">\n                     .     ,    .\n                </p>\n              </div>\n\n              {/*  Prominent Document Upload CTA */}\n              <div className=\"mb-6 mx-auto max-w-md w-full\">\n                <div\n                  onClick={() => onNewCase ? onNewCase() : navigate('/cases?new=true')}\n                  className=\"group cursor-pointer p-6 bg-gradient-to-br from-purple-600/20 to-blue-600/20 border-2 border-dashed border-purple-500/50 rounded-2xl hover:border-purple-400 hover:from-purple-600/30 hover:to-blue-600/30 transition-all\"\n                >\n                  <div className=\"flex flex-col items-center gap-3\">\n                    <div className=\"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform\">\n                      <FolderPlus size={28} className=\"text-purple-400\" />\n                    </div>\n                    <div className=\"text-center\">\n                      <p className=\"text-white font-semibold text-lg\">    </p>\n                      <p className=\"text-white/50 text-sm mt-1\">PDF, DOC, DOCX,  </p>\n                    </div>\n                    <div className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg font-medium group-hover:bg-purple-700 transition-colors\">\n                      <Plus size={18} />\n                       \n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Divider */}\n              <div className=\"flex items-center gap-4 mb-4 mx-auto max-w-md w-full\">\n                <div className=\"flex-1 h-px bg-white/20\"></div>\n                <span className=\"text-white/40 text-sm\">   </span>\n                <div className=\"flex-1 h-px bg-white/20\"></div>\n              </div>\n\n              {/* Cases list with sessions */}\n              <div className=\"flex-1 overflow-y-auto\">\n                <h3 className=\"text-white/80 font-medium mb-3 flex items-center gap-2\">\n                  <Folder size={18} className=\"text-blue-400\" />\n                   \n                </h3>\n\n                {loadingCaseSessions || casesLoading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"animate-spin text-purple-400\" size={32} />\n                  </div>\n                ) : casesWithSessions.length > 0 ? (\n                  <div className=\"space-y-2\">\n                    {casesWithSessions.map((caseItem) => (\n                      <div\n                        key={caseItem.case_id}\n                        className=\"bg-white/5 border border-white/10 rounded-xl overflow-hidden hover:border-purple-500/30 transition-all\"\n                      >\n                        {/* Case header */}\n                        <button\n                          onClick={() => setExpandedCaseId(expandedCaseId === caseItem.case_id ? null : caseItem.case_id)}\n                          className=\"w-full p-3 flex items-center justify-between text-right hover:bg-white/5 transition-colors\"\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <Folder size={18} className=\"text-blue-400\" />\n                            <div>\n                              <div className=\"text-white font-medium\">{caseItem.case_name || ' '}</div>\n                              <div className=\"flex items-center gap-3 text-xs text-white/50\">\n                                <span className=\"flex items-center gap-1\">\n                                  <MessageCircle size={12} />\n                                  {caseItem.sessions?.length || 0} \n                                </span>\n                                {caseItem.created_at && (\n                                  <span className=\"flex items-center gap-1\">\n                                    <Calendar size={12} />\n                                    {new Date(caseItem.created_at).toLocaleDateString('he-IL')}\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                          <ChevronRight size={18} className={`text-white/40 transition-transform ${expandedCaseId === caseItem.case_id ? 'rotate-90' : ''}`} />\n                        </button>\n\n                        {/* Sessions list */}\n                        {expandedCaseId === caseItem.case_id && caseItem.sessions?.length > 0 && (\n                          <div className=\"border-t border-white/10 bg-black/20 p-2 space-y-1\">\n                            {caseItem.sessions.slice(0, 5).map((session) => (\n                              <button\n                                key={session.session_id}\n                                onClick={() => navigate(`/cases/${caseItem.case_id}/chat?session=${session.session_id}`)}\n                                className=\"w-full p-2 text-right rounded-lg hover:bg-white/10 transition-colors flex items-center gap-2\"\n                              >\n                                <MessageCircle size={14} className=\"text-purple-400\" />\n                                <div className=\"flex-1 min-w-0\">\n                                  <div className=\"text-white/90 text-sm truncate\">{session.title || '  '}</div>\n                                  <div className=\"text-white/40 text-xs\">\n                                    {session.updated_at && new Date(session.updated_at).toLocaleDateString('he-IL')}\n                                  </div>\n                                </div>\n                              </button>\n                            ))}\n                            {/* Open case button */}\n                            <button\n                              onClick={() => navigate(`/cases/${caseItem.case_id}/chat`)}\n                              className=\"w-full p-2 text-center text-purple-400 text-sm hover:bg-purple-500/10 rounded-lg transition-colors\"\n                            >\n                                 \n                            </button>\n                          </div>\n                        )}\n\n                        {/* Quick open if no sessions */}\n                        {expandedCaseId !== caseItem.case_id && (\n                          <button\n                            onClick={() => navigate(`/cases/${caseItem.case_id}/chat`)}\n                            className=\"w-full px-3 py-2 text-sm text-purple-400 hover:bg-purple-500/10 border-t border-white/5 transition-colors\"\n                          >\n                             \n                          </button>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                ) : cases.length > 0 ? (\n                  // Fallback to cases without sessions\n                  <div className=\"space-y-2\">\n                    {cases.slice(0, 10).map((caseItem) => (\n                      <button\n                        key={caseItem.id}\n                        onClick={() => navigate(`/cases/${caseItem.id}/chat`)}\n                        className=\"w-full p-3 bg-white/5 border border-white/10 rounded-xl text-right hover:border-purple-500/30 hover:bg-white/10 transition-all flex items-center gap-3\"\n                      >\n                        <Folder size={18} className=\"text-blue-400\" />\n                        <div className=\"flex-1\">\n                          <div className=\"text-white font-medium\">{caseItem.case_name || caseItem.name || ' '}</div>\n                          <div className=\"text-white/50 text-xs\">\n                            {caseItem.created_at && new Date(caseItem.created_at).toLocaleDateString('he-IL')}\n                          </div>\n                        </div>\n                        <ChevronRight size={16} className=\"text-white/40\" />\n                      </button>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-white/50\">\n                    <Folder size={48} className=\"mx-auto mb-4 opacity-30\" />\n                    <p>   </p>\n                    <p className=\"text-sm\">    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          ) : (\n            //  CASE SELECTED - Show regular quick actions\n            <div className=\"flex flex-col items-center justify-center h-full text-center\">\n              <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-blue-600 flex items-center justify-center mb-4\">\n                <Sparkles size={32} className=\"text-white\" />\n              </div>\n              <h2 className=\"text-white text-xl font-bold mb-2\">,  </h2>\n              <p className=\"text-white/60 text-sm mb-4 max-w-md\">\n                      ,  ,   .\n                      .\n              </p>\n\n              {/*  Representation Banner - auto-detect which side user represents */}\n              <div className=\"w-full max-w-xl mb-4\">\n                <RepresentationBanner caseId={caseId} compact={false} />\n              </div>\n\n              {/* Quick Actions Grid */}\n              <div className=\"flex flex-wrap justify-center gap-3 max-w-xl\">\n                {quickActions.map((action) => {\n                  const Icon = action.icon;\n                  const isLocked = (action.premium && !isPremium) || (action.enterprise && !isEnterprise);\n                  const isAdversarial = action.id === 'adversarial';\n\n                  return (\n                    <button\n                      key={action.id}\n                      onClick={() => handleQuickAction(action)}\n                      className={`group flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 ${\n                        isLocked\n                          ? 'bg-white/5 text-white/40 cursor-not-allowed border border-white/5'\n                          : isAdversarial\n                            ? 'bg-gradient-to-r from-amber-600/30 to-orange-600/30 text-amber-200 border border-amber-500/30 hover:from-amber-600/50 hover:to-orange-600/50 hover:scale-105 hover:shadow-lg hover:shadow-amber-500/20'\n                            : 'bg-white/10 text-white border border-white/10 hover:bg-gradient-to-r hover:from-purple-600/40 hover:to-blue-600/40 hover:border-purple-500/30 hover:scale-105 hover:shadow-lg hover:shadow-purple-500/20'\n                      }`}\n                      title={isLocked ? '  ' : action.label}\n                    >\n                      <Icon size={18} className={`transition-transform group-hover:scale-110 ${isAdversarial ? 'text-amber-400' : ''}`} />\n                      <span>{action.label}</span>\n                      {isLocked && <Crown size={14} className=\"text-amber-400 mr-1\" />}\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n          )\n        ) : (\n          // Messages list\n          <>\n            {messages.map((message, index) => (\n              <div\n                key={message.id}\n                data-message-id={message.id}\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'} transition-all duration-300`}\n                style={{\n                  animation: 'slideUp 0.3s ease-out',\n                  animationFillMode: 'both',\n                  animationDelay: `${Math.min(index * 30, 150)}ms`\n                }}\n              >\n                <div\n                  className={`max-w-[85%] rounded-2xl p-4 shadow-lg hover:shadow-xl transition-shadow duration-200 ${\n                    message.role === 'user'\n                      ? 'bg-purple-600/30 border border-purple-500/30 shadow-purple-900/20'\n                      : message.meta?.auto_summary\n                        ? 'bg-gradient-to-br from-emerald-900/30 to-teal-900/20 border border-emerald-500/30 shadow-emerald-900/20'\n                        : 'bg-white/5 border border-white/10 shadow-black/20'\n                  }`}\n                >\n                  {/* Adversarial Analysis Badge */}\n                  {message.is_adversarial && (\n                    <div className=\"flex items-center gap-2 mb-3 pb-2 border-b border-white/10\">\n                      <Swords size={16} className=\"text-amber-400\" />\n                      <span className=\"text-amber-300 text-sm font-medium\"> </span>\n                      <span className=\"text-white/40 text-xs\">  AI</span>\n                    </div>\n                  )}\n\n                  {/*  P0: V1 Auto-Summary Badge (NotebookLM-feel) */}\n                  {message.meta?.auto_summary && (\n                    <div className=\"flex items-center gap-2 mb-3 pb-2 border-b border-emerald-500/30\">\n                      <Sparkles size={16} className=\"text-emerald-400\" />\n                      <span className=\"text-emerald-300 text-sm font-medium\">\n                         {message.meta.auto_summary.version === 1 ? 'V1 ()' : `V${message.meta.auto_summary.version}`}\n                      </span>\n                      {message.meta.auto_summary.filename && (\n                        <span className=\"text-white/40 text-xs truncate max-w-[200px]\" title={message.meta.auto_summary.filename}>\n                           {message.meta.auto_summary.filename}\n                        </span>\n                      )}\n                      {message.meta.auto_summary.incremental && (\n                        <span className=\"px-1.5 py-0.5 bg-emerald-500/20 text-emerald-300 rounded text-[10px]\">\n                          \n                        </span>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Message content */}\n                  {message.role === 'assistant' ? (\n                    <SmartResponseRenderer content={message.content} />\n                  ) : (\n                    <p className=\"text-white/90 text-sm whitespace-pre-wrap\">\n                      {message.content}\n                    </p>\n                  )}\n\n                  {/*  Documents Used - Always visible as chips */}\n                  {message.role === 'assistant' && (message.documents_used || message.meta?.documents_used) && (message.documents_used || message.meta?.documents_used).length > 0 && (\n                    <div className=\"mt-3 flex flex-wrap gap-2\">\n                      {(message.documents_used || message.meta?.documents_used).slice(0, 5).map((doc, idx) => (\n                        <div\n                          key={idx}\n                          className=\"flex items-center gap-1.5 px-2.5 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded-lg text-xs hover:bg-blue-500/20 transition-colors cursor-pointer\"\n                          title={doc.filename}\n                        >\n                          <FileText size={12} className=\"text-blue-400\" />\n                          <span className=\"text-white/80 max-w-[120px] truncate\">\n                            {doc.filename}\n                          </span>\n                          {doc.pages && doc.pages.length > 0 && (\n                            <span className=\"text-blue-300 font-medium\">\n                              ' {doc.pages.slice(0, 3).join(', ')}{doc.pages.length > 3 ? '...' : ''}\n                            </span>\n                          )}\n                          {doc.relevance && (\n                            <span className=\"px-1.5 py-0.5 bg-green-500/30 text-green-300 rounded text-[10px]\">\n                              {doc.relevance}%\n                            </span>\n                          )}\n                        </div>\n                      ))}\n                      {(message.documents_used || message.meta?.documents_used).length > 5 && (\n                        <span className=\"text-xs text-white/40 self-center\">\n                          +{(message.documents_used || message.meta?.documents_used).length - 5} \n                        </span>\n                      )}\n                    </div>\n                  )}\n\n                  {/*  Uploaded files - Always visible as chips */}\n                  {message.role === 'assistant' && message.meta?.uploaded_files && message.meta.uploaded_files.length > 0 && (\n                    <div className=\"mt-2 flex flex-wrap gap-2\">\n                      {message.meta.uploaded_files.map((doc, idx) => (\n                        <div\n                          key={idx}\n                          className=\"flex items-center gap-1.5 px-2.5 py-1.5 bg-cyan-500/10 border border-cyan-500/20 rounded-lg text-xs\"\n                          title={doc.filename}\n                        >\n                          <Paperclip size={12} className=\"text-cyan-400\" />\n                          <span className=\"text-white/80 max-w-[120px] truncate\">\n                            {doc.filename}\n                          </span>\n                          {doc.pages && doc.pages.length > 0 && (\n                            <span className=\"text-cyan-300\">\n                              ' {doc.pages.join(', ')}\n                            </span>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n\n                  {/*  Taxonomy snapshot - Always visible as cards */}\n                  {message.role === 'assistant' && (message.taxonomy_snapshot || message.meta?.taxonomy_snapshot) && (\n                    (() => {\n                      const snap = message.taxonomy_snapshot || message.meta?.taxonomy_snapshot;\n                      const claims = snap?.claims_sample || [];\n                      const contradictions = snap?.contradictions_sample || [];\n                      const entities = snap?.entities_sample || [];\n                      const cCount = typeof snap?.claims_count === 'number' ? snap.claims_count : null;\n                      const kCount = typeof snap?.contradictions_count === 'number' ? snap.contradictions_count : null;\n                      const eCount = typeof snap?.entities_count === 'number' ? snap.entities_count : null;\n\n                      const hasAny =\n                        (Array.isArray(claims) && claims.length > 0) ||\n                        (Array.isArray(contradictions) && contradictions.length > 0) ||\n                        (Array.isArray(entities) && entities.length > 0);\n\n                      if (!hasAny) return null;\n\n                      return (\n                        <div className=\"mt-3 space-y-2\">\n                          {/* Taxonomy header */}\n                          <div className=\"flex items-center gap-2 text-xs text-purple-300\">\n                            <span></span>\n                            <span>\n                              \n                              {cCount !== null && kCount !== null && eCount !== null\n                                ? ` ( ${cCount}   ${kCount}   ${eCount})`\n                                : ''}\n                            </span>\n                          </div>\n\n                          {/* Claims as cards */}\n                          {Array.isArray(claims) && claims.length > 0 && (\n                            <div className=\"space-y-1.5\">\n                              {claims.slice(0, 3).map((c, idx) => (\n                                <div key={idx} className=\"flex items-start gap-2 p-2.5 bg-blue-500/10 border border-blue-500/20 rounded-lg\">\n                                  <span className=\"w-1.5 h-1.5 rounded-full bg-blue-400 mt-1.5 flex-shrink-0\" />\n                                  <div className=\"flex-1 min-w-0\">\n                                    <span className=\"text-xs text-white/90\">{c.text || ''}</span>\n                                    {c.location?.filename && (\n                                      <span className=\"text-[10px] text-blue-300 ml-2\">\n                                         {c.location.filename}{c.location.page ? ` ' ${c.location.page}` : ''}\n                                      </span>\n                                    )}\n                                  </div>\n                                </div>\n                              ))}\n                              {claims.length > 3 && (\n                                <span className=\"text-[10px] text-white/40\">+{claims.length - 3}  </span>\n                              )}\n                            </div>\n                          )}\n\n                          {/* Contradictions as cards */}\n                          {Array.isArray(contradictions) && contradictions.length > 0 && (\n                            <div className=\"space-y-1.5\">\n                              {contradictions.slice(0, 3).map((c, idx) => (\n                                <div key={idx} className=\"flex items-start gap-2 p-2.5 bg-red-500/10 border border-red-500/20 rounded-lg\">\n                                  <span className=\"w-1.5 h-1.5 rounded-full bg-red-400 mt-1.5 flex-shrink-0\" />\n                                  <div className=\"flex-1 min-w-0\">\n                                    <span className=\"text-xs text-white/90\">{c.description || c.text || ''}</span>\n                                    {c.location?.filename && (\n                                      <span className=\"text-[10px] text-red-300 ml-2\">\n                                         {c.location.filename}{c.location.page ? ` ' ${c.location.page}` : ''}\n                                      </span>\n                                    )}\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          )}\n\n                          {/* Entities as chips */}\n                          {Array.isArray(entities) && entities.length > 0 && (\n                            <div className=\"flex flex-wrap gap-1.5\">\n                              {entities.slice(0, 6).map((e, idx) => (\n                                <span\n                                  key={idx}\n                                  className=\"px-2 py-1 bg-purple-500/10 border border-purple-500/20 rounded-lg text-xs text-purple-200\"\n                                  title={e.location?.filename ? `${e.location.filename}${e.location.page ? ` ' ${e.location.page}` : ''}` : ''}\n                                >\n                                  {e.name || e.text || ''}\n                                </span>\n                              ))}\n                              {entities.length > 6 && (\n                                <span className=\"text-[10px] text-white/40 self-center\">+{entities.length - 6}</span>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      );\n                    })()\n                  )}\n\n                  {/* Warning if no documents used */}\n                  {message.role === 'assistant' && message.documents_used && message.documents_used.length === 0 && message.total_documents === 0 && (\n                    <div className=\"mt-2 px-2 py-1 bg-amber-500/10 border border-amber-500/30 rounded text-xs text-amber-300 flex items-center gap-2\">\n                      <AlertCircle size={12} />\n                      <span>     </span>\n                    </div>\n                  )}\n\n                  {/* Tool Result (embedded content) */}\n                  {message.tool_result && (\n                    <div className=\"mt-3 p-3 bg-black/20 rounded-lg border border-white/10\">\n                      {message.tool_banner && (\n                        <div className=\"flex items-center gap-2 mb-2 text-xs text-white/60\">\n                          <span>{message.tool_banner.icon}</span>\n                          <span>{message.tool_banner.title}</span>\n                        </div>\n                      )}\n                      {/* Render tool result items with pin buttons */}\n                      {Array.isArray(message.tool_result) && message.tool_result.map((item, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 py-1 group\">\n                          <span className=\"text-white/80 text-sm flex-1\">{item.text || item.description || JSON.stringify(item)}</span>\n                          <button\n                            onClick={() => handlePin(item.text || item.description, item.type || 'note', message.id)}\n                            className=\"opacity-0 group-hover:opacity-100 p-1 rounded hover:bg-white/10 text-white/40 hover:text-amber-400 transition-all\"\n                            title=\"\"\n                          >\n                            <Pin size={12} />\n                          </button>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Actions for assistant messages */}\n                  {message.role === 'assistant' && (\n                    <div className=\"flex items-center justify-between gap-2 mt-3 pt-2 border-t border-white/10\">\n                      {/* Left side: Action buttons */}\n                      <div className=\"flex items-center gap-2\">\n                        <button\n                          onClick={() => handlePin(message.content, 'insight', message.id)}\n                          className=\"p-1.5 rounded-lg text-white/40 hover:text-amber-400 hover:bg-white/10 transition-colors\"\n                          title=\" \"\n                        >\n                          <Pin size={14} />\n                        </button>\n                        <button\n                          onClick={() => copyMessage(message.id, message.content)}\n                          className=\"p-1.5 rounded-lg text-white/40 hover:text-white hover:bg-white/10 transition-colors\"\n                          title=\"\"\n                        >\n                          {copiedMessageId === message.id ? (\n                            <Check size={14} className=\"text-green-400\" />\n                          ) : (\n                            <Copy size={14} />\n                          )}\n                        </button>\n                      </div>\n\n                      {/* Right side: Star Rating */}\n                      <StarRating\n                        messageId={message.id}\n                        caseId={caseId}\n                        messageContent={message.content}\n                        initialRating={feedback[message.id] || 0}\n                        onRated={(rating) => setFeedback(prev => ({ ...prev, [message.id]: rating }))}\n                        size={14}\n                        showLabel={true}\n                      />\n                    </div>\n                  )}\n\n                  {/* Suggested follow-up questions (for last assistant message) */}\n                  {message.role === 'assistant' && index === messages.length - 1 && !isLoading && !isStreaming && (\n                    <div className=\"mt-3 pt-3 border-t border-white/5\">\n                      <p className=\"text-white/40 text-xs mb-2\"> :</p>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {message.is_adversarial ? (\n                          <>\n                            <button onClick={() => sendMessage('   ?')} className=\"text-xs px-3 py-1.5 rounded-full bg-white/5 text-white/70 hover:bg-purple-600/30 hover:text-white transition-all\">\n                                ?\n                            </button>\n                            <button onClick={() => sendMessage('   ?')} className=\"text-xs px-3 py-1.5 rounded-full bg-white/5 text-white/70 hover:bg-purple-600/30 hover:text-white transition-all\">\n                               ?\n                            </button>\n                          </>\n                        ) : (\n                          <>\n                            <button onClick={() => sendMessage('  ')} className=\"text-xs px-3 py-1.5 rounded-full bg-white/5 text-white/70 hover:bg-purple-600/30 hover:text-white transition-all\">\n                               \n                            </button>\n                            <button onClick={() => sendMessage('  ')} className=\"text-xs px-3 py-1.5 rounded-full bg-white/5 text-white/70 hover:bg-purple-600/30 hover:text-white transition-all\">\n                               \n                            </button>\n                            <button onClick={() => sendMessage('    ?')} className=\"text-xs px-3 py-1.5 rounded-full bg-white/5 text-white/70 hover:bg-purple-600/30 hover:text-white transition-all\">\n                                \n                            </button>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ))}\n\n            {/* Streaming response - show text as it arrives */}\n            {isStreaming && streamingText && (\n              <div className=\"flex justify-start\">\n                <div className=\"max-w-[85%] bg-white/5 border border-white/10 rounded-2xl p-4 shadow-lg\">\n                  {/*  Performance: lightweight renderer during streaming */}\n                  <div className=\"text-white/90 text-sm whitespace-pre-wrap leading-relaxed\">\n                    {streamingText}\n                  </div>\n\n                  {/* Progress indicator while streaming */}\n                  {streamingProgress && (\n                    <div className=\"mt-3 pt-3 border-t border-white/10\">\n                      <WaveLoader\n                        size={35}\n                        showText={true}\n                        progress={streamingProgress.progress}\n                        progressMessage={streamingProgress.stage}\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Loading indicator (no streaming text yet, or verified streaming without content) */}\n            {(isLoading && !isStreaming) || (isStreaming && !streamingText && streamingProgress) ? (\n              <div className=\"flex justify-center py-8\">\n                <WaveLoader\n                  size={70}\n                  showText={true}\n                  progress={streamingProgress?.progress}\n                  progressMessage={streamingProgress?.message || streamingProgress?.stage}\n                />\n              </div>\n            ) : null}\n\n            {/*  Continuation button - \" ?\" */}\n            {continuationMessageId && !isLoading && !isStreaming && (\n              <div className=\"flex justify-center py-3\">\n                <button\n                  onClick={handleContinue}\n                  className=\"group flex items-center gap-2 px-5 py-2.5 rounded-full\n                    bg-gradient-to-r from-purple-600/30 to-blue-600/30\n                    border border-purple-500/30 hover:border-purple-400/50\n                    text-white/90 hover:text-white\n                    transition-all duration-200 hover:scale-105\n                    shadow-lg shadow-purple-500/10\"\n                >\n                  <span className=\"text-sm font-medium\"> ?</span>\n                  <ChevronDown size={16} className=\"group-hover:translate-y-0.5 transition-transform\" />\n                </button>\n              </div>\n            )}\n\n            <div ref={messagesEndRef} />\n          </>\n        )}\n        </div>\n      </div>\n\n      {/* Smart Tools Panel */}\n      {selectedTool && (\n        <div className=\"px-4 py-3 border-t border-white/10 bg-gradient-to-r from-slate-900/90 to-purple-900/20\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <div className=\"flex items-center gap-2\">\n              {(() => { const Icon = selectedTool.icon; return <Icon size={18} className=\"text-purple-400\" />; })()}\n              <span className=\"text-white font-medium\">{selectedTool.name}</span>\n            </div>\n            <button\n              onClick={() => { setSelectedTool(null); setSelectedFiles([]); setSearchInput(''); }}\n              className=\"p-1 rounded text-white/40 hover:text-white hover:bg-white/10\"\n            >\n              <X size={16} />\n            </button>\n          </div>\n\n          {/* File selection for tools that need files */}\n          {selectedTool.needsFiles && (\n            <>\n              <p className=\"text-white/60 text-xs mb-2\">\n                 {selectedTool.minFiles === 2 ? ' 2 ' : ''} :\n              </p>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto mb-3\">\n                {caseFiles.map((file) => (\n                  <button\n                    key={file.id}\n                    onClick={() => toggleFileSelection(file)}\n                    className={`p-2 rounded-lg text-right text-xs transition-all truncate ${\n                      selectedFiles.some(f => f.id === file.id)\n                        ? 'bg-purple-600 text-white border-2 border-purple-400'\n                        : 'bg-white/5 text-white/80 border border-white/10 hover:bg-white/10'\n                    }`}\n                  >\n                    <FileText size={12} className=\"inline ml-1\" />\n                    {file.filename}\n                  </button>\n                ))}\n              </div>\n              {caseFiles.length === 0 && (\n                <p className=\"text-white/40 text-xs text-center py-2\">  </p>\n              )}\n            </>\n          )}\n\n          {/* Search input for semantic search */}\n          {selectedTool.needsInput && (\n            <div className=\"mb-3\">\n              <input\n                type=\"text\"\n                value={searchInput}\n                onChange={(e) => setSearchInput(e.target.value)}\n                placeholder=\"  ?\"\n                className=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 text-sm focus:outline-none focus:border-purple-500\"\n                onKeyDown={(e) => e.key === 'Enter' && executeTool({ ...selectedTool, searchQuery: searchInput }, selectedFiles)}\n              />\n            </div>\n          )}\n\n          {/* Execute button */}\n          <button\n            onClick={() => executeTool({ ...selectedTool, searchQuery: searchInput }, selectedFiles)}\n            disabled={\n              (selectedTool.needsFiles && selectedFiles.length < (selectedTool.minFiles || 1)) ||\n              (selectedTool.needsInput && !searchInput.trim())\n            }\n            className=\"w-full py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg text-sm font-medium hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n          >\n            {selectedTool.needsFiles\n              ? ` ${selectedTool.name} (${selectedFiles.length} )`\n              : selectedTool.needsInput\n                ? ''\n                : ` ${selectedTool.name}`\n            }\n          </button>\n        </div>\n      )}\n\n      {/* Uploaded Files Preview - with Source Selection */}\n      {uploadFiles.length > 0 && (\n        <div className=\"px-4 py-3 border-t border-white/10 bg-slate-900/50\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"text-white/50 text-xs\">   ({uploadFiles.length}) -    :</div>\n            <button\n              onClick={() => sendMessage('  ', ' ')}\n              disabled={isLoading}\n              className=\"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-xs font-medium rounded-lg transition-colors flex items-center gap-1.5 disabled:opacity-50\"\n            >\n              <Paperclip size={12} />\n               \n            </button>\n          </div>\n          <div className=\"flex flex-col gap-2\">\n            {uploadFiles.map((fileItem, idx) => {\n              const currentSource = fileItem.source || 'self';\n\n              return (\n                <div\n                  key={idx}\n                  className=\"flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg border border-white/10\"\n                >\n                  <FileText size={16} className=\"text-purple-400 flex-shrink-0\" />\n                  <span className=\"text-white/80 truncate flex-1 text-sm\">{fileItem.name}</span>\n\n                  {/* Source Selection Dropdown */}\n                  <select\n                    value={currentSource}\n                    onChange={(e) => updateFileSource(idx, e.target.value)}\n                    className={`px-2 py-1 rounded text-xs bg-slate-800 border cursor-pointer transition-colors\n                      ${currentSource === 'self' ? 'border-emerald-500/50 text-emerald-400' :\n                        currentSource === 'opponent' ? 'border-red-500/50 text-red-400' :\n                        currentSource === 'court' ? 'border-blue-500/50 text-blue-400' :\n                        'border-amber-500/50 text-amber-400'}`}\n                  >\n                    {SOURCE_OPTIONS.map(option => (\n                      <option key={option.value} value={option.value}>\n                        {option.label}\n                      </option>\n                    ))}\n                  </select>\n\n                  <button\n                    onClick={() => removeFile(idx)}\n                    className=\"text-white/40 hover:text-red-400 transition-colors p-1\"\n                    title=\" \"\n                  >\n                    <X size={14} />\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Input Area - Made sticky for mobile/tablet to prevent disappearing */}\n      <div className=\"sticky bottom-0 p-2 sm:p-3 md:p-4 border-t border-white/10 bg-slate-900/95 backdrop-blur-sm z-10\">\n        {/*  Always show representation + analysis discipline guidance */}\n        {caseId && (\n          <div className=\"px-1 sm:px-0\">\n            <RepresentationBanner caseId={caseId} compact />\n          </div>\n        )}\n        {caseId && ['analyzing', 'processing', 'pending'].includes(String(caseLifecycleStatus || '')) && (\n          <div className=\"mb-2 px-3 py-2 rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-200 text-xs\">\n            <div className=\"font-medium mb-0.5\">  </div>\n            <div className=\"text-white/70\">\n                ,      // .    .\n            </div>\n          </div>\n        )}\n        <div className=\"flex items-end gap-1 sm:gap-2\">\n          {/* Add documents to case button - PERMANENT upload */}\n          {onAddDocuments && (\n            <div className=\"relative group\">\n              <button\n                onClick={onAddDocuments}\n                className=\"p-1.5 sm:p-2 rounded-lg bg-gradient-to-r from-purple-600/25 to-blue-600/25\n                  text-purple-300 hover:text-white\n                  border border-purple-500/30 hover:border-purple-400/50\n                  hover:from-purple-600/40 hover:to-blue-600/40\n                  transition-all duration-200 shadow-md shadow-purple-500/5\"\n              >\n                <FolderPlus size={14} className=\"sm:w-4 sm:h-4\" />\n              </button>\n              {/* Detailed tooltip - hidden on mobile */}\n              <div className=\"hidden sm:block absolute bottom-full mb-2 right-0 w-48 p-2 rounded-lg\n                bg-slate-800 border border-white/20 shadow-xl\n                opacity-0 group-hover:opacity-100 pointer-events-none\n                transition-opacity duration-200 z-50\">\n                <p className=\"text-white text-xs font-medium mb-1\">   </p>\n                <p className=\"text-white/60 text-xs\">       </p>\n              </div>\n            </div>\n          )}\n\n          {/* File upload button - attach files to message (always visible) */}\n          <div className=\"relative group\">\n            <input\n              type=\"file\"\n              ref={fileInputRef}\n              onChange={handleFileSelect}\n              multiple\n              accept=\".pdf,.doc,.docx,.txt\"\n              className=\"hidden\"\n            />\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              className=\"p-2 sm:p-3 rounded-xl bg-white/5 text-white/50 hover:text-white hover:bg-white/10 transition-colors\"\n            >\n              <Paperclip size={18} className=\"sm:w-5 sm:h-5\" />\n            </button>\n            {/* Detailed tooltip - hidden on mobile */}\n            <div className=\"hidden sm:block absolute bottom-full mb-2 right-0 w-48 p-2 rounded-lg\n              bg-slate-800 border border-white/20 shadow-xl\n              opacity-0 group-hover:opacity-100 pointer-events-none\n              transition-opacity duration-200 z-50\">\n              <p className=\"text-white text-xs font-medium mb-1\">   </p>\n              <p className=\"text-white/60 text-xs\">\n                {!caseId\n                  ? '    '\n                  : caseType === 'free_chat'\n                    ? '     '\n                    : ' -   '}\n              </p>\n            </div>\n          </div>\n\n          {/* Text input */}\n          <div className=\"flex-1 relative min-w-0\">\n            <textarea\n              ref={inputRef}\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"  ...\"\n              rows={1}\n              className=\"w-full px-3 py-2 sm:px-4 sm:py-3 bg-white/5 border border-white/10 rounded-xl text-white text-sm sm:text-base placeholder-white/40 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50 resize-none\"\n              style={{ minHeight: '40px', maxHeight: '100px' }}\n            />\n          </div>\n\n          {/*  Capabilities / Actions button (yellow, next to Send) */}\n          <div className=\"relative group flex-shrink-0\">\n            <button\n              onClick={() => setShowCapabilities(true)}\n              className=\"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-3 rounded-xl\n                bg-yellow-500/20 border border-yellow-500/40 text-yellow-200\n                hover:bg-yellow-500/30 hover:border-yellow-400/60\n                transition-colors\"\n              title=\"/:     \"\n              aria-label=\"   \"\n            >\n              <Sparkles size={18} className=\"sm:w-5 sm:h-5\" />\n              <span className=\"hidden sm:inline text-sm font-semibold\"></span>\n            </button>\n            <div className=\"hidden sm:block absolute bottom-full mb-2 right-0 w-64 p-2 rounded-lg\n              bg-slate-800 border border-yellow-500/30 shadow-xl\n              opacity-0 group-hover:opacity-100 pointer-events-none\n              transition-opacity duration-200 z-50\">\n              <p className=\"text-yellow-100 text-xs font-bold mb-1\">  </p>\n              <p className=\"text-white/70 text-xs\">\n                     ,   / ,     .\n              </p>\n            </div>\n          </div>\n\n          {/* Send button */}\n          <button\n            onClick={() => sendMessage()}\n            disabled={isLoading || (!input.trim() && uploadFiles.length === 0)}\n            className={`p-2 sm:p-3 rounded-xl transition-all flex-shrink-0 ${\n              isLoading || (!input.trim() && uploadFiles.length === 0)\n                ? 'bg-white/5 text-white/30 cursor-not-allowed'\n                : 'bg-purple-600 text-white hover:bg-purple-700'\n            }`}\n          >\n            {isLoading ? (\n              <Loader2 size={18} className=\"animate-spin sm:w-5 sm:h-5\" />\n            ) : (\n              <Send size={18} className=\"sm:w-5 sm:h-5\" />\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/*  Upgrade modal for locked features */}\n      <CapabilitiesMenu\n        isOpen={showCapabilities}\n        onClose={() => setShowCapabilities(false)}\n        caseId={caseId}\n        onSelectCapability={(capability) => {\n          // Heavy analyses are user-triggered (On-Demand). Others can be asked via chat.\n          const onDemand = new Set(['claims', 'contradictions', 'disputes', 'red_flags', 'timeline', 'insights']);\n          if (caseId && onDemand.has(capability.id)) {\n            //  FIX: Send analysis_type instead of capability_id (backend expects analysis_type for these)\n            apiPost(`/api/cases/${encodeURIComponent(caseId)}/analyze-on-demand`, {\n              analysis_type: capability.id,\n              options: { force_refresh: false },\n            })\n              .then(() => toast.success(`: ${capability.name}`))\n              .catch((e) => toast.error(e?.message || '  '));\n            return;\n          }\n\n          // Otherwise: use the capability example as the user prompt, but show a short label in UI.\n          sendMessage(capability.example, capability.name);\n        }}\n      />\n\n      <UpgradeModal\n        isOpen={upgradeModalOpen}\n        onClose={() => setUpgradeModalOpen(false)}\n        featureName={upgradeModalInfo.featureName}\n        featureDescription={upgradeModalInfo.featureDescription}\n        requiredTier={upgradeModalInfo.requiredTier}\n        currentTier={userTier}\n      />\n\n      {/* Note: Free chat upload modal removed - chat only available within case context */}\n    </div>\n  );\n});\n\n// Display name for debugging\nChatPanel.displayName = 'ChatPanel';\n\nexport default ChatPanel;\n","/**\n * useDocumentProcessingStatus - Monitor document processing (OCR/RAG indexing) status\n *\n * Shows toast notifications when:\n * - Documents start processing\n * - Documents are ready for analysis\n */\n\nimport { useEffect, useRef, useCallback } from 'react';\nimport { toast } from 'sonner';\nimport { apiGet } from '../utils/api';\n\ninterface RagPrepareStatus {\n  status: 'running' | 'completed' | 'failed';\n  started_at?: string;\n  completed_at?: string;\n  files_prepared?: number;\n  pages?: number;\n}\n\ninterface AnalysisStatus {\n  rag_prepare?: RagPrepareStatus;\n  [key: string]: any;\n}\n\ninterface UseDocumentProcessingStatusOptions {\n  caseId: string | null;\n  enabled?: boolean;\n  onReady?: () => void;\n}\n\nexport function useDocumentProcessingStatus({\n  caseId,\n  enabled = true,\n  onReady,\n}: UseDocumentProcessingStatusOptions) {\n  const lastStatusRef = useRef<string | null>(null);\n  const pollingRef = useRef<NodeJS.Timeout | null>(null);\n  const hasShownProcessingToast = useRef(false);\n\n  const checkStatus = useCallback(async () => {\n    if (!caseId || !enabled) return;\n\n    try {\n      const response = await apiGet<{ analysis_status: AnalysisStatus }>(\n        `/api/cases/${caseId}/analysis-status`,\n        { showErrorToast: false }\n      );\n\n      const ragStatus = response?.analysis_status?.rag_prepare?.status;\n\n      // Show \"processing\" toast only once\n      if (ragStatus === 'running' && !hasShownProcessingToast.current) {\n        hasShownProcessingToast.current = true;\n        toast.loading(' ...     ', {\n          id: `rag-processing-${caseId}`,\n          duration: 10000,\n        });\n      }\n\n      // Show \"ready\" toast when status changes to completed\n      if (ragStatus === 'completed' && lastStatusRef.current === 'running') {\n        const filesPrepared = response?.analysis_status?.rag_prepare?.files_prepared || 0;\n        const pages = response?.analysis_status?.rag_prepare?.pages || 0;\n\n        // Dismiss the loading toast\n        toast.dismiss(`rag-processing-${caseId}`);\n\n        // Show success toast\n        toast.success(\n          `  ! (${filesPrepared} , ${pages} )`,\n          {\n            id: `rag-ready-${caseId}`,\n            duration: 5000,\n            description: '        ',\n          }\n        );\n\n        // Reset flags and stop polling\n        hasShownProcessingToast.current = false;\n        if (pollingRef.current) {\n          clearInterval(pollingRef.current);\n          pollingRef.current = null;\n        }\n\n        onReady?.();\n      }\n\n      lastStatusRef.current = ragStatus || null;\n    } catch (error) {\n      // Silently fail - don't show errors for status checks\n      console.debug('Failed to check document processing status:', error);\n    }\n  }, [caseId, enabled, onReady]);\n\n  // Start polling when caseId changes\n  useEffect(() => {\n    if (!caseId || !enabled) return;\n\n    // Check immediately\n    checkStatus();\n\n    // Poll every 3 seconds while processing\n    pollingRef.current = setInterval(checkStatus, 3000);\n\n    // Cleanup\n    return () => {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n    };\n  }, [caseId, enabled, checkStatus]);\n\n  // Expose method to manually trigger check (e.g., after upload)\n  const triggerCheck = useCallback(() => {\n    hasShownProcessingToast.current = false;\n    lastStatusRef.current = null;\n    checkStatus();\n  }, [checkStatus]);\n\n  return { triggerCheck };\n}\n","/**\n * PinnedPanel -   \n *\n *  CODE-003: Migrated to TypeScript\n *\n * ':\n * -     \n * -   \n * -  \n * -   \n * -  (Pro+)\n */\n\nimport React, { useState, useMemo, type FC } from 'react';\nimport {\n  Pin,\n  AlertTriangle,\n  HelpCircle,\n  Quote,\n  StickyNote,\n  Trash2,\n  ExternalLink,\n  Download,\n  ChevronDown,\n  ChevronRight,\n  Sparkles,\n  Crown,\n  type LucideIcon,\n} from 'lucide-react';\nimport { toast } from 'sonner';\n\n// ===========================\n// Types\n// ===========================\n\ntype CategoryKey = 'contradiction' | 'question' | 'quote' | 'note' | 'insight';\n\ninterface CategoryConfig {\n  label: string;\n  icon: LucideIcon;\n  color: string;\n  bgColor: string;\n}\n\ninterface PinnedItem {\n  id: string;\n  category?: CategoryKey;\n  content: string;\n  source_info?: string;\n  source_message_id?: string;\n  created_at?: string;\n}\n\ninterface PinnedPanelProps {\n  items?: PinnedItem[];\n  onUnpin: (itemId: string) => Promise<boolean>;\n  onJumpToSource?: (messageId: string) => void;\n  isPremium?: boolean;\n  maxItems?: number;\n}\n\n// ===========================\n// Constants\n// ===========================\n\nconst CATEGORIES: Record<CategoryKey, CategoryConfig> = {\n  contradiction: {\n    label: '',\n    icon: AlertTriangle,\n    color: 'text-red-400',\n    bgColor: 'bg-red-500/10',\n  },\n  question: {\n    label: '',\n    icon: HelpCircle,\n    color: 'text-amber-400',\n    bgColor: 'bg-amber-500/10',\n  },\n  quote: {\n    label: '',\n    icon: Quote,\n    color: 'text-blue-400',\n    bgColor: 'bg-blue-500/10',\n  },\n  note: {\n    label: '',\n    icon: StickyNote,\n    color: 'text-green-400',\n    bgColor: 'bg-green-500/10',\n  },\n  insight: {\n    label: '',\n    icon: Sparkles,\n    color: 'text-purple-400',\n    bgColor: 'bg-purple-500/10',\n  },\n};\n\n// ===========================\n// Component\n// ===========================\n\nconst PinnedPanel: FC<PinnedPanelProps> = ({\n  items = [],\n  onUnpin,\n  onJumpToSource,\n  isPremium = false,\n  maxItems = 10,\n}) => {\n  const [filter, setFilter] = useState<CategoryKey | 'all'>('all');\n  const [expandedCategories, setExpandedCategories] = useState<Record<CategoryKey, boolean>>({\n    contradiction: true,\n    question: true,\n    quote: true,\n    note: true,\n    insight: true,\n  });\n\n  // Group items by category\n  const groupedItems = useMemo(() => {\n    const groups: Record<CategoryKey, PinnedItem[]> = {\n      contradiction: [],\n      question: [],\n      quote: [],\n      note: [],\n      insight: [],\n    };\n\n    items.forEach(item => {\n      const category = item.category || 'note';\n      if (groups[category]) {\n        groups[category].push(item);\n      } else {\n        groups['note'].push(item);\n      }\n    });\n\n    return groups;\n  }, [items]);\n\n  // Filter items\n  const filteredGroups = useMemo(() => {\n    if (filter === 'all') return groupedItems;\n    return { [filter]: groupedItems[filter] || [] } as Partial<Record<CategoryKey, PinnedItem[]>>;\n  }, [groupedItems, filter]);\n\n  // Toggle category expansion\n  const toggleCategory = (category: CategoryKey): void => {\n    setExpandedCategories(prev => ({\n      ...prev,\n      [category]: !prev[category],\n    }));\n  };\n\n  // Handle unpin\n  const handleUnpin = async (itemId: string): Promise<void> => {\n    const success = await onUnpin(itemId);\n    if (success) {\n      toast.success('  ');\n    } else {\n      toast.error('  ');\n    }\n  };\n\n  // Export pinned items\n  const handleExport = (): void => {\n    if (!isPremium) {\n      toast.error('   Pro ');\n      return;\n    }\n\n    const exportData = items.map(item => ({\n      category: CATEGORIES[item.category || 'note']?.label || '',\n      content: item.content,\n      source: item.source_info || '',\n      created: item.created_at,\n    }));\n\n    const blob = new Blob([JSON.stringify(exportData, null, 2)], {\n      type: 'application/json',\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `pinned-items-${new Date().toISOString().split('T')[0]}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n\n    toast.success('  ');\n  };\n\n  const totalItems = items.length;\n  const isAtLimit = !isPremium && totalItems >= maxItems;\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"p-3 border-b border-white/10\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center gap-2\">\n            <Pin size={16} className=\"text-amber-400\" />\n            <h3 className=\"text-white/90 font-semibold text-sm\"></h3>\n            <span className=\"text-xs text-white/40 bg-white/10 px-1.5 py-0.5 rounded-full\">\n              {totalItems}{!isPremium && `/${maxItems}`}\n            </span>\n          </div>\n\n          {isPremium && (\n            <button\n              onClick={handleExport}\n              className=\"p-1.5 rounded-lg text-white/50 hover:text-white hover:bg-white/10 transition-colors\"\n              title=\" \"\n            >\n              <Download size={14} />\n            </button>\n          )}\n        </div>\n\n        {/* Filter */}\n        <div className=\"flex gap-1 flex-wrap\">\n          <button\n            onClick={() => setFilter('all')}\n            className={`px-2 py-1 rounded text-xs transition-all ${\n              filter === 'all'\n                ? 'bg-purple-600 text-white'\n                : 'bg-white/5 text-white/60 hover:text-white'\n            }`}\n          >\n            \n          </button>\n          {(Object.entries(CATEGORIES) as [CategoryKey, CategoryConfig][]).map(([key, cat]) => {\n            const count = groupedItems[key]?.length || 0;\n            if (count === 0) return null;\n            const Icon = cat.icon;\n            return (\n              <button\n                key={key}\n                onClick={() => setFilter(key)}\n                className={`px-2 py-1 rounded text-xs flex items-center gap-1 transition-all ${\n                  filter === key\n                    ? 'bg-purple-600 text-white'\n                    : 'bg-white/5 text-white/60 hover:text-white'\n                }`}\n              >\n                <Icon size={10} />\n                <span>{count}</span>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Limit Warning */}\n      {isAtLimit && (\n        <div className=\"mx-3 mt-3 p-2 bg-amber-500/10 border border-amber-500/30 rounded-lg\">\n          <div className=\"flex items-start gap-2\">\n            <Crown size={14} className=\"text-amber-400 mt-0.5 flex-shrink-0\" />\n            <div>\n              <p className=\"text-amber-200 text-xs font-medium\"> </p>\n              <p className=\"text-amber-200/70 text-xs mt-0.5\">\n                 -Pro   \n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Items List */}\n      <div className=\"flex-1 overflow-y-auto p-2\">\n        {totalItems === 0 ? (\n          <div className=\"text-center py-8\">\n            <Pin size={24} className=\"text-white/20 mx-auto mb-2\" />\n            <p className=\"text-white/40 text-xs\">\n                 '  \n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {(Object.entries(filteredGroups) as [CategoryKey, PinnedItem[]][]).map(([category, categoryItems]) => {\n              if (!categoryItems || categoryItems.length === 0) return null;\n\n              const cat = CATEGORIES[category];\n              const Icon = cat.icon;\n              const isExpanded = expandedCategories[category];\n\n              return (\n                <div key={category} className=\"bg-white/5 rounded-lg overflow-hidden\">\n                  {/* Category Header */}\n                  <button\n                    onClick={() => toggleCategory(category)}\n                    className=\"w-full p-2 flex items-center gap-2 hover:bg-white/5 transition-colors\"\n                  >\n                    <Icon size={14} className={cat.color} />\n                    <span className=\"text-white/90 text-xs font-medium flex-1 text-right\">\n                      {cat.label}\n                    </span>\n                    <span className=\"text-white/40 text-xs bg-white/10 px-1.5 py-0.5 rounded-full\">\n                      {categoryItems.length}\n                    </span>\n                    {isExpanded ? (\n                      <ChevronDown size={12} className=\"text-white/40\" />\n                    ) : (\n                      <ChevronRight size={12} className=\"text-white/40\" />\n                    )}\n                  </button>\n\n                  {/* Category Items */}\n                  {isExpanded && (\n                    <div className=\"px-2 pb-2 space-y-1\">\n                      {categoryItems.map((item) => (\n                        <div\n                          key={item.id}\n                          className={`p-2 rounded-lg ${cat.bgColor} border border-white/5 group`}\n                        >\n                          <p className=\"text-white/90 text-xs leading-relaxed\">\n                            {item.content}\n                          </p>\n\n                          {item.source_info && (\n                            <p className=\"text-white/40 text-xs mt-1\">\n                               {item.source_info}\n                            </p>\n                          )}\n\n                          {/* Actions */}\n                          <div className=\"flex items-center gap-1 mt-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                            {item.source_message_id && onJumpToSource && (\n                              <button\n                                onClick={() => onJumpToSource(item.source_message_id!)}\n                                className=\"p-1 rounded bg-white/10 hover:bg-white/20 text-white/60 hover:text-white transition-colors\"\n                                title=\" \"\n                              >\n                                <ExternalLink size={10} />\n                              </button>\n                            )}\n                            <button\n                              onClick={() => handleUnpin(item.id)}\n                              className=\"p-1 rounded bg-white/10 hover:bg-red-500/30 text-white/60 hover:text-red-300 transition-colors\"\n                              title=\" \"\n                            >\n                              <Trash2 size={10} />\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PinnedPanel;\n","/**\n * CasesSessionsPanel -       '\n *\n * :\n * -    \n * -       \n * -       \n */\n\nimport React, { useState, useEffect, useCallback, type FC } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Folder,\n  FolderOpen,\n  MessagesSquare,\n  ChevronDown,\n  ChevronRight,\n  Loader2,\n  FileText,\n  Clock,\n  RefreshCw,\n  List,\n  User,\n  Bot,\n  HelpCircle,\n  Search,\n  Lightbulb,\n  BarChart3,\n  Plus\n} from 'lucide-react';\nimport { apiGet, apiPost } from '../../utils/api';\nimport { toast } from 'sonner';\n\ninterface MessageItem {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  created_at?: string;\n}\n\ninterface TOCEntry {\n  message_id: string;\n  entry_type: 'question' | 'answer' | 'key_finding' | 'recommendation' | 'summary' | 'topic';\n  title: string;\n  content_preview: string;\n  timestamp?: string;\n  role: string;\n  importance: number;\n  topic_tags: string[];\n}\n\ninterface GroupedTOC {\n  questions?: TOCEntry[];\n  key_findings?: TOCEntry[];\n  recommendations?: TOCEntry[];\n  summaries?: TOCEntry[];\n  other?: TOCEntry[];\n}\n\ninterface FileItem {\n  id: string;\n  filename: string;\n  file_size?: number;\n  created_at?: string;\n}\n\ninterface CaseItem {\n  id: string;\n  name: string;\n  status: string;\n  files_count: number;\n  created_at: string;\n  files?: FileItem[];\n}\n\ninterface SessionItem {\n  id: string;\n  title: string;\n  message_count: number;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface CasesSessionsPanelProps {\n  currentCaseId?: string;\n  currentSessionId?: string;\n  onSessionSelect: (caseId: string, sessionId: string) => void;\n  onScrollToMessage?: (messageId: string) => void;\n}\n\nconst CasesSessionsPanel: FC<CasesSessionsPanelProps> = ({\n  currentCaseId,\n  currentSessionId,\n  onSessionSelect,\n  onScrollToMessage\n}) => {\n  const navigate = useNavigate();\n  const [cases, setCases] = useState<CaseItem[]>([]);\n  const [isLoadingCases, setIsLoadingCases] = useState(false);\n  const [expandedCases, setExpandedCases] = useState<Set<string>>(new Set());\n  const [caseSessions, setCaseSessions] = useState<Record<string, SessionItem[]>>({});\n  const [caseFiles, setCaseFiles] = useState<Record<string, FileItem[]>>({});\n  const [loadingSessions, setLoadingSessions] = useState<Set<string>>(new Set());\n  const [loadingFiles, setLoadingFiles] = useState<Set<string>>(new Set());\n\n  // TOC state - using smart grouped TOC\n  const [groupedTOC, setGroupedTOC] = useState<GroupedTOC>({});\n  const [loadingTOC, setLoadingTOC] = useState(false);\n  const [showTOC, setShowTOC] = useState(true);\n  const [expandedTOCGroups, setExpandedTOCGroups] = useState<Set<string>>(new Set(['questions', 'key_findings']));\n\n  // Fetch all user's cases\n  const fetchCases = useCallback(async () => {\n    setIsLoadingCases(true);\n    try {\n      const data = await apiGet<{ cases: CaseItem[] }>('/api/cases', { showErrorToast: false });\n      setCases(data.cases || []);\n    } catch (err) {\n      console.error('Failed to fetch cases:', err);\n    } finally {\n      setIsLoadingCases(false);\n    }\n  }, []);\n\n  // Fetch sessions for a specific case\n  const fetchSessions = useCallback(async (caseId: string) => {\n    setLoadingSessions(prev => new Set(prev).add(caseId));\n    try {\n      const data = await apiGet<{ sessions: SessionItem[] }>(\n        `/api/cases/${caseId}/chat/sessions`,\n        { showErrorToast: false }\n      );\n      setCaseSessions(prev => ({ ...prev, [caseId]: data.sessions || [] }));\n    } catch (err) {\n      console.error('Failed to fetch sessions:', err);\n      setCaseSessions(prev => ({ ...prev, [caseId]: [] }));\n    } finally {\n      setLoadingSessions(prev => {\n        const next = new Set(prev);\n        next.delete(caseId);\n        return next;\n      });\n    }\n  }, []);\n\n  // Fetch files for a specific case\n  const fetchFiles = useCallback(async (caseId: string) => {\n    setLoadingFiles(prev => new Set(prev).add(caseId));\n    try {\n      const data = await apiGet<{ files: FileItem[] }>(\n        `/api/cases/${caseId}/files`,\n        { showErrorToast: false }\n      );\n      setCaseFiles(prev => ({ ...prev, [caseId]: data.files || [] }));\n    } catch (err) {\n      console.error('Failed to fetch files:', err);\n      setCaseFiles(prev => ({ ...prev, [caseId]: [] }));\n    } finally {\n      setLoadingFiles(prev => {\n        const next = new Set(prev);\n        next.delete(caseId);\n        return next;\n      });\n    }\n  }, []);\n\n  // Fetch smart TOC for current session\n  const fetchSessionTOC = useCallback(async (caseId: string, sessionId: string) => {\n    setLoadingTOC(true);\n    try {\n      const data = await apiGet<{ toc: GroupedTOC; grouped: boolean }>(\n        `/api/cases/${caseId}/chat/sessions/${sessionId}/toc?grouped=true`,\n        { showErrorToast: false }\n      );\n      setGroupedTOC(data.toc || {});\n    } catch (err) {\n      console.error('Failed to fetch session TOC:', err);\n      setGroupedTOC({});\n    } finally {\n      setLoadingTOC(false);\n    }\n  }, []);\n\n  // Create new chat session for a case\n  const createNewSession = useCallback(async (caseId: string) => {\n    try {\n      const data = await apiPost<{ session_id: string; title: string }>(\n        `/api/cases/${caseId}/chat/new-session`,\n        {}\n      );\n\n      if (data.session_id) {\n        // Refresh sessions list\n        await fetchSessions(caseId);\n        // Switch to new session\n        onSessionSelect(caseId, data.session_id);\n        toast.success('  ');\n      }\n    } catch (err) {\n      console.error('Failed to create new session:', err);\n      toast.error('   ');\n    }\n  }, [fetchSessions, onSessionSelect]);\n\n  // Initial load\n  useEffect(() => {\n    fetchCases();\n  }, [fetchCases]);\n\n  // Load TOC when session changes\n  useEffect(() => {\n    if (currentCaseId && currentSessionId) {\n      fetchSessionTOC(currentCaseId, currentSessionId);\n    } else {\n      setGroupedTOC({});\n    }\n  }, [currentCaseId, currentSessionId, fetchSessionTOC]);\n\n  // Auto-expand current case\n  useEffect(() => {\n    if (currentCaseId && !expandedCases.has(currentCaseId)) {\n      setExpandedCases(prev => new Set(prev).add(currentCaseId));\n      if (!caseSessions[currentCaseId]) {\n        fetchSessions(currentCaseId);\n      }\n      if (!caseFiles[currentCaseId]) {\n        fetchFiles(currentCaseId);\n      }\n    }\n  }, [currentCaseId, expandedCases, caseSessions, caseFiles, fetchSessions, fetchFiles]);\n\n  // Toggle case expansion\n  const toggleCase = async (caseId: string) => {\n    const isExpanded = expandedCases.has(caseId);\n\n    if (isExpanded) {\n      setExpandedCases(prev => {\n        const next = new Set(prev);\n        next.delete(caseId);\n        return next;\n      });\n    } else {\n      setExpandedCases(prev => new Set(prev).add(caseId));\n      // Fetch sessions and files if not already loaded\n      if (!caseSessions[caseId]) {\n        fetchSessions(caseId);\n      }\n      if (!caseFiles[caseId]) {\n        fetchFiles(caseId);\n      }\n    }\n  };\n\n  // Format date\n  const formatDate = (dateStr: string) => {\n    try {\n      const date = new Date(dateStr);\n      return date.toLocaleDateString('he-IL', { day: 'numeric', month: 'short' });\n    } catch {\n      return '';\n    }\n  };\n\n  // Format time for TOC\n  const formatTime = (dateStr: string) => {\n    try {\n      const date = new Date(dateStr);\n      return date.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' });\n    } catch {\n      return '';\n    }\n  };\n\n  // Toggle TOC group expansion\n  const toggleTOCGroup = (group: string) => {\n    setExpandedTOCGroups(prev => {\n      const next = new Set(prev);\n      if (next.has(group)) {\n        next.delete(group);\n      } else {\n        next.add(group);\n      }\n      return next;\n    });\n  };\n\n  // TOC group config with icons and labels\n  const tocGroupConfig: Record<string, { icon: React.ReactNode; label: string; color: string }> = {\n    questions: { icon: <HelpCircle size={12} />, label: '', color: 'blue' },\n    key_findings: { icon: <Search size={12} />, label: ' ', color: 'red' },\n    recommendations: { icon: <Lightbulb size={12} />, label: '', color: 'yellow' },\n    summaries: { icon: <BarChart3 size={12} />, label: '', color: 'green' },\n    other: { icon: <Bot size={12} />, label: '', color: 'gray' },\n  };\n\n  // Count total TOC entries\n  const totalTOCEntries = Object.values(groupedTOC).reduce((sum, entries) => sum + (entries?.length || 0), 0);\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"p-3 border-b border-white/10\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-white/90 font-semibold text-sm flex items-center gap-2\">\n            <Folder size={14} />\n             \n          </h3>\n          <button\n            onClick={fetchCases}\n            className=\"p-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 text-white\"\n            title=\"\"\n          >\n            <RefreshCw size={12} />\n          </button>\n        </div>\n      </div>\n\n      {/* Smart Table of Contents for current session */}\n      {currentSessionId && totalTOCEntries > 0 && (\n        <div className=\"border-b border-white/10\">\n          <button\n            onClick={() => setShowTOC(!showTOC)}\n            className=\"w-full flex items-center justify-between px-3 py-2 hover:bg-white/5 transition-colors\"\n          >\n            <div className=\"flex items-center gap-2 text-white/80\">\n              <List size={14} className=\"text-purple-400\" />\n              <span className=\"text-xs font-medium\"> </span>\n              <span className=\"text-[10px] text-white/40\">({totalTOCEntries})</span>\n            </div>\n            {showTOC ? (\n              <ChevronDown size={14} className=\"text-white/40\" />\n            ) : (\n              <ChevronRight size={14} className=\"text-white/40\" />\n            )}\n          </button>\n\n          {showTOC && (\n            <div className=\"max-h-60 overflow-y-auto px-2 pb-2 space-y-1\">\n              {loadingTOC ? (\n                <div className=\"flex items-center justify-center py-2\">\n                  <Loader2 size={14} className=\"animate-spin text-purple-400\" />\n                </div>\n              ) : (\n                Object.entries(groupedTOC).map(([groupKey, entries]) => {\n                  if (!entries || entries.length === 0) return null;\n                  const config = tocGroupConfig[groupKey] || tocGroupConfig.other;\n                  const isExpanded = expandedTOCGroups.has(groupKey);\n\n                  return (\n                    <div key={groupKey} className=\"space-y-0.5\">\n                      {/* Group header */}\n                      <button\n                        onClick={() => toggleTOCGroup(groupKey)}\n                        className={`w-full flex items-center gap-2 px-2 py-1 rounded text-xs hover:bg-white/5 transition-colors\n                          ${config.color === 'blue' ? 'text-blue-400' : ''}\n                          ${config.color === 'red' ? 'text-red-400' : ''}\n                          ${config.color === 'yellow' ? 'text-yellow-400' : ''}\n                          ${config.color === 'green' ? 'text-green-400' : ''}\n                          ${config.color === 'gray' ? 'text-gray-400' : ''}\n                        `}\n                      >\n                        {isExpanded ? <ChevronDown size={10} /> : <ChevronRight size={10} />}\n                        {config.icon}\n                        <span className=\"font-medium\">{config.label}</span>\n                        <span className=\"text-white/40 text-[10px]\">({entries.length})</span>\n                      </button>\n\n                      {/* Group entries */}\n                      {isExpanded && (\n                        <div className=\"mr-4 space-y-0.5\">\n                          {entries.map((entry) => (\n                            <button\n                              key={entry.message_id}\n                              onClick={() => onScrollToMessage?.(entry.message_id)}\n                              className={`w-full flex items-start gap-2 px-2 py-1 rounded text-right transition-colors\n                                hover:bg-${config.color}-500/10\n                                ${entry.importance >= 3 ? 'bg-white/5' : ''}\n                              `}\n                            >\n                              <div className=\"flex-1 min-w-0\">\n                                <span className=\"text-xs text-white/80 block truncate\">{entry.title}</span>\n                                {entry.importance >= 2 && (\n                                  <span className=\"text-[10px] text-white/40 block truncate\">{entry.content_preview}</span>\n                                )}\n                              </div>\n                              {entry.timestamp && (\n                                <span className=\"text-[9px] text-white/30 flex-shrink-0\">\n                                  {formatTime(entry.timestamp)}\n                                </span>\n                              )}\n                            </button>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  );\n                })\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-y-auto p-2 space-y-1\">\n        {isLoadingCases ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"animate-spin text-blue-400\" size={24} />\n          </div>\n        ) : cases.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Folder className=\"mx-auto text-white/30 mb-2\" size={32} />\n            <p className=\"text-white/50 text-sm\"> </p>\n            <button\n              onClick={() => navigate('/cases?new=true')}\n              className=\"mt-2 text-xs text-blue-400 hover:text-blue-300\"\n            >\n                \n            </button>\n          </div>\n        ) : (\n          cases.map((c) => {\n            const isExpanded = expandedCases.has(c.id);\n            const isCurrentCase = c.id === currentCaseId;\n            const sessions = caseSessions[c.id] || [];\n            const isLoadingSess = loadingSessions.has(c.id);\n\n            return (\n              <div key={c.id} className=\"space-y-0.5\">\n                {/* Case header */}\n                <button\n                  onClick={() => toggleCase(c.id)}\n                  className={`w-full flex items-center gap-2 px-2 py-2 rounded-lg text-sm transition-colors ${\n                    isCurrentCase\n                      ? 'bg-blue-500/20 text-blue-200 border border-blue-500/30'\n                      : 'text-white/80 hover:bg-white/5'\n                  }`}\n                >\n                  {isLoadingSess ? (\n                    <Loader2 size={14} className=\"animate-spin text-blue-400\" />\n                  ) : isExpanded ? (\n                    <ChevronDown size={14} className=\"text-white/50\" />\n                  ) : (\n                    <ChevronRight size={14} className=\"text-white/50\" />\n                  )}\n                  {isExpanded ? (\n                    <FolderOpen size={14} className=\"text-blue-400\" />\n                  ) : (\n                    <Folder size={14} className=\"text-blue-400/70\" />\n                  )}\n                  <span className=\"flex-1 text-right truncate\">\n                    {c.name || ` ${c.id.slice(0, 8)}...`}\n                  </span>\n                  {c.files_count > 0 && (\n                    <span className=\"flex items-center gap-1 text-[10px] text-green-400\">\n                      <FileText size={10} />\n                      {c.files_count}\n                    </span>\n                  )}\n                </button>\n\n                {/* Sessions and Files list */}\n                {isExpanded && (\n                  <div className=\"mr-4 space-y-1 border-r border-white/10 pr-2\">\n                    {/* Sessions section with New Chat button */}\n                    <div className=\"space-y-0.5\">\n                      <div className=\"flex items-center justify-between px-2 pt-1\">\n                        <p className=\"text-[10px] text-purple-300/70 font-medium\"></p>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            createNewSession(c.id);\n                          }}\n                          className=\"flex items-center gap-1 text-[10px] text-purple-400 hover:text-purple-300 transition-colors\"\n                          title=\" \"\n                        >\n                          <Plus size={10} />\n                          <span></span>\n                        </button>\n                      </div>\n                      {sessions.length > 0 ? (\n                        sessions.map((session) => {\n                          const isCurrentSession = session.id === currentSessionId;\n                          return (\n                            <button\n                              key={session.id}\n                              onClick={() => onSessionSelect(c.id, session.id)}\n                              className={`w-full flex items-center gap-2 px-2 py-1.5 rounded text-xs transition-colors ${\n                                isCurrentSession\n                                  ? 'bg-purple-500/20 text-purple-200 border border-purple-500/30'\n                                  : 'text-white/70 hover:bg-purple-500/10'\n                              }`}\n                            >\n                              <MessagesSquare size={12} className=\"text-purple-400\" />\n                              <span className=\"flex-1 text-right truncate\">\n                                {session.title || ''}\n                              </span>\n                              <div className=\"flex items-center gap-1 text-[10px] text-white/40\">\n                                {session.message_count > 0 && (\n                                  <span>{session.message_count}</span>\n                                )}\n                                <Clock size={8} />\n                                <span>{formatDate(session.updated_at || session.created_at)}</span>\n                              </div>\n                            </button>\n                          );\n                        })\n                      ) : (\n                        <p className=\"text-xs text-white/40 py-1 px-2 text-right\">  </p>\n                      )}\n                    </div>\n\n                    {/* Files/Documents section */}\n                    {(caseFiles[c.id]?.length > 0 || loadingFiles.has(c.id)) && (\n                      <div className=\"space-y-0.5 pt-1\">\n                        <p className=\"text-[10px] text-green-300/70 font-medium px-2\"></p>\n                        {loadingFiles.has(c.id) ? (\n                          <div className=\"flex items-center justify-center py-1\">\n                            <Loader2 size={12} className=\"animate-spin text-green-400\" />\n                          </div>\n                        ) : (\n                          caseFiles[c.id]?.map((file) => (\n                            <div\n                              key={file.id}\n                              className=\"flex items-center gap-2 px-2 py-1 rounded text-xs text-white/60 hover:bg-green-500/10 transition-colors\"\n                            >\n                              <FileText size={12} className=\"text-green-400 flex-shrink-0\" />\n                              <span className=\"flex-1 text-right truncate\">\n                                {file.filename}\n                              </span>\n                            </div>\n                          ))\n                        )}\n                      </div>\n                    )}\n\n                  </div>\n                )}\n              </div>\n            );\n          })\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CasesSessionsPanel;\n","/**\n * ChatLayout -  '   3 \n *\n * Layout:\n * [Statistics Panel | Chat Panel | Pinned Results Panel]\n *\n * ':\n * -    \n * - '   Quick Actions\n * -    \n * - Responsive -   \n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport {\n  PanelLeftClose,\n  PanelLeftOpen,\n  PanelRightClose,\n  PanelRightOpen,\n  Settings,\n  X,\n  Copy,\n  Download,\n  Check,\n  Upload,\n  FileText,\n  Loader2,\n  Trash2,\n  BarChart3,\n  Layers,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport ChatPanel from './ChatPanel';\nimport PinnedPanel from './PinnedPanel';\nimport StatisticsPanel from './StatisticsPanel';\nimport CasesSessionsPanel from './CasesSessionsPanel';\nimport CapabilitiesRail from './CapabilitiesRail';\n// NotebookLM Integration\nimport NotebookCanvas from '../notebook/NotebookCanvas';\nimport NotebookRail from '../notebook/NotebookRail';\nimport { useNotebookData } from '../../hooks/useNotebookData';\nimport { useSubscriptionStore } from '../../store/useSubscriptionStore';\nimport { apiGet, apiPost, apiDelete, apiUpload } from '../../utils/api';\nimport { startUploadJob } from '../GlobalUploadProgress';\n\nconst PREMIUM_TIERS = ['professional', 'enterprise', 'pro', 'admin'];\nconst SOURCE_OPTIONS = [\n  { value: 'self', label: ' ' },\n  { value: 'opponent', label: ' ' },\n  { value: 'court', label: '  ' },\n  { value: 'third_party', label: '  \\'' },\n];\n\nconst DOC_TYPE_OPTIONS = [\n  { value: 'claim', label: '  ' },\n  { value: 'defense', label: '  ' },\n  { value: 'protocol', label: ' ' },\n  { value: 'affidavit', label: ' ' },\n  { value: 'other', label: ' ' },\n];\n\nconst ChatLayout = ({ caseId, caseName, analysisResult = {}, onClose }) => {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Panel visibility state\n  const [showStatistics, setShowStatistics] = useState(true);\n  const [showCasesSessions, setShowCasesSessions] = useState(true);\n  const [showCapabilitiesRail, setShowCapabilitiesRail] = useState(true);\n\n  //  NotebookLM Integration - Layer state\n  const [notebookLayer, setNotebookLayer] = useState('v1');\n  const [showNotebookView, setShowNotebookView] = useState(true); // Toggle between notebook and stats view\n\n  //  NotebookLM data hook\n  const notebookData = useNotebookData({ caseId, caseName, analysisResult });\n\n  // Pinned items state (kept for backward compatibility)\n  const [pinnedItems, setPinnedItems] = useState([]);\n\n  const lastSessionStorageKey = caseId ? `yitro_last_chat_session_${caseId}` : null;\n\n  // Current session (initialize from URL/localStorage to avoid \"jumping\" between sessions)\n  const [currentSessionId, setCurrentSessionId] = useState(() => {\n    try {\n      if (!caseId) return null;\n      const params = new URLSearchParams(window.location.search || '');\n      const fromUrl = params.get('session');\n      const fromStorage = lastSessionStorageKey ? localStorage.getItem(lastSessionStorageKey) : null;\n      return fromUrl || fromStorage || null;\n    } catch {\n      return null;\n    }\n  });\n\n  //  Inline upload modal state (stays in Yitro!)\n  const [showUploadModal, setShowUploadModal] = useState(false);\n  const [uploadFiles, setUploadFiles] = useState([]);\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef(null);\n  const [availableCases, setAvailableCases] = useState([]);\n  const [targetCaseId, setTargetCaseId] = useState(caseId || '');\n\n  // Subscription info\n  const { data: subscriptionData } = useSubscriptionStore();\n  const userTier = (subscriptionData?.tier || subscriptionData?.subscription_tier || 'free').toLowerCase();\n  const isAdmin = subscriptionData?.role === 'admin';\n  const isPremium = PREMIUM_TIERS.includes(userTier) || isAdmin;\n  const isEnterprise = userTier === 'enterprise' || isAdmin;\n\n  // Responsive handling\n  useEffect(() => {\n    const handleResize = () => {\n      if (window.innerWidth < 768) {\n        setShowStatistics(false);\n        setShowCasesSessions(false);\n        setShowCapabilitiesRail(false);\n      } else if (window.innerWidth < 1200) {\n        setShowCasesSessions(false);\n        setShowCapabilitiesRail(true);\n      }\n    };\n\n    handleResize();\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  //  If we got a queuedAction via navigation state, clear it so refresh/back doesn't re-trigger it.\n  useEffect(() => {\n    if (!location?.state?.queuedAction) return;\n    navigate(`${location.pathname}${location.search || ''}`, { replace: true, state: {} });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location?.state?.queuedAction]);\n\n  // Load pinned items\n  useEffect(() => {\n    const loadPinnedItems = async () => {\n      try {\n        const data = await apiGet(`/api/cases/${caseId}/pinned`, { showErrorToast: false });\n        setPinnedItems(data.items || []);\n      } catch (err) {\n        console.error('Failed to load pinned items:', err);\n      }\n    };\n\n    if (caseId) {\n      loadPinnedItems();\n    }\n  }, [caseId]);\n\n  // Pin item handler\n  const handlePinItem = useCallback(async (item) => {\n    // Check tier limits\n    if (!isPremium && pinnedItems.length >= 10) {\n      // Show upgrade prompt\n      return { success: false, reason: 'limit' };\n    }\n\n    try {\n      const newItem = await apiPost(`/api/cases/${caseId}/pinned`, item);\n      setPinnedItems(prev => [newItem, ...prev]);\n      return { success: true };\n    } catch (err) {\n      console.error('Failed to pin item:', err);\n    }\n    return { success: false };\n  }, [caseId, isPremium, pinnedItems.length]);\n\n  // Unpin item handler\n  const handleUnpinItem = useCallback(async (itemId) => {\n    try {\n      await apiDelete(`/api/cases/${caseId}/pinned/${itemId}`);\n      setPinnedItems(prev => prev.filter(item => item.id !== itemId));\n      return true;\n    } catch (err) {\n      console.error('Failed to unpin item:', err);\n    }\n    return false;\n  }, [caseId]);\n\n  // Session change handler\n  const handleSessionChange = useCallback((sessionId) => {\n    setCurrentSessionId(sessionId);\n    try {\n      if (lastSessionStorageKey && sessionId) {\n        localStorage.setItem(lastSessionStorageKey, String(sessionId));\n      }\n      // Persist session in URL so \"return to chat\" stays on same point\n      if (caseId && sessionId) {\n        const params = new URLSearchParams(location.search || '');\n        params.set('session', String(sessionId));\n        navigate(`/cases/${caseId}/chat?${params.toString()}`, { replace: true });\n      }\n    } catch {\n      // Non-critical\n    }\n  }, [caseId, lastSessionStorageKey, location.search, navigate]);\n\n  //  Sync session from URL/localStorage if route changes while mounted\n  //  FIX: Also reset sessionId when switching cases (even if new case has no session)\n  useEffect(() => {\n    if (!caseId) return;\n    const params = new URLSearchParams(location.search || '');\n    const fromUrl = params.get('session');\n    const fromStorage = lastSessionStorageKey ? localStorage.getItem(lastSessionStorageKey) : null;\n    const next = fromUrl || fromStorage || null;\n    //  FIX: Always update if different (including null) to prevent stale session\n    if (next !== currentSessionId) {\n      setCurrentSessionId(next);\n    }\n  }, [caseId, currentSessionId, lastSessionStorageKey, location.search]);\n\n  // Chat panel ref for jump to source\n  const chatPanelRef = useRef(null);\n\n  // Copy state\n  const [copied, setCopied] = useState(false);\n\n  // Jump to source message handler\n  const handleJumpToSource = useCallback((messageId) => {\n    if (chatPanelRef.current?.scrollToMessage) {\n      chatPanelRef.current.scrollToMessage(messageId);\n    }\n  }, []);\n\n  // Copy conversation handler\n  const handleCopyConversation = useCallback(async () => {\n    if (chatPanelRef.current?.getMessages) {\n      const messages = chatPanelRef.current.getMessages();\n      if (messages.length === 0) {\n        toast.error('  ');\n        return;\n      }\n\n      const text = messages.map(m =>\n        `${m.role === 'user' ? ' ' : ' '}:\\n${m.content}`\n      ).join('\\n\\n---\\n\\n');\n\n      await navigator.clipboard.writeText(text);\n      setCopied(true);\n      toast.success(' !');\n      setTimeout(() => setCopied(false), 2000);\n    }\n  }, []);\n\n  // Download conversation handler\n  const handleDownloadConversation = useCallback(() => {\n    if (chatPanelRef.current?.getMessages) {\n      const messages = chatPanelRef.current.getMessages();\n      if (messages.length === 0) {\n        toast.error('  ');\n        return;\n      }\n\n      //  Word-compatible HTML document (opens in Word)\n      const title = `   - ${caseName || ''}`;\n      const date = new Date().toLocaleDateString('he-IL');\n      const body = messages.map((m) => {\n        const who = m.role === 'user' ? '' : '';\n        const safe = String(m.content || '')\n          .replace(/&/g, '&amp;')\n          .replace(/</g, '&lt;')\n          .replace(/>/g, '&gt;')\n          .replace(/\\n/g, '<br/>');\n        return `<h2>${who}</h2><div style=\"margin-bottom:14px; line-height:1.5;\">${safe}</div>`;\n      }).join('\\n');\n      const html = `<!doctype html><html><head><meta charset=\"utf-8\"/></head><body dir=\"rtl\"><h1>${title}</h1><p>: ${date}</p>${body}</body></html>`;\n\n      const blob = new Blob([html], { type: 'application/msword' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `-${caseName || ''}-${new Date().toISOString().split('T')[0]}.doc`;\n      a.click();\n      URL.revokeObjectURL(url);\n      toast.success(' !');\n    }\n  }, [caseName]);\n\n  //  Open inline upload modal instead of navigating away\n  const handleAddDocuments = useCallback(() => {\n    setShowUploadModal(true);\n  }, []);\n\n  //  NotebookLM handlers - trigger capability analysis\n  //  FIX: Only valid on-demand types - others go through chat\n  const ON_DEMAND_TYPES = new Set([\n    'claims', 'contradictions', 'disputes', 'red_flags', 'timeline', 'insights'\n  ]);\n\n  const handleCapabilityClick = useCallback(async (capabilityId) => {\n    if (!caseId) {\n      toast.error('    ');\n      return;\n    }\n\n    // Move to V3 layer for deep analysis\n    setNotebookLayer('v3');\n\n    // Heavy analyses are user-triggered (On-Demand) and run in background\n    if (ON_DEMAND_TYPES.has(capabilityId)) {\n      try {\n        //  FIX: Send analysis_type instead of capability_id (backend expects analysis_type for these)\n        await apiPost(`/api/cases/${encodeURIComponent(caseId)}/analyze-on-demand`, {\n          analysis_type: capabilityId,\n          options: { force_refresh: false },\n        });\n        const capName = notebookData.capabilities.find(c => c.id === capabilityId)?.name_he || capabilityId;\n        toast.success(`: ${capName}`);\n      } catch (err) {\n        toast.error(err?.message || '  ');\n      }\n      return;\n    }\n\n    // Otherwise: ask the assistant (chat action) with specific prompts\n    const cap = notebookData.capabilities.find(c => c.id === capabilityId);\n    if (cap) {\n      // Specific prompts for each capability\n      const CAPABILITY_PROMPTS = {\n        // Strategy group\n        strategy: '    . :  ,  ,  ,  ,  ,  .',\n        game_theory: '    . :  ,    ,  ,   , .',\n        risk_assessment: '   . :   ,     ,  ,  .',\n        strategy_memo: '    . : ,  ,  , ,   .',\n        // Workflow group\n        summary: '    . :  ,  , /,  .',\n        entities: '     : , , , , , .   .',\n        // Research group\n        precedents: '     . :   ,  ,    .',\n        legal_knowledge: '      . : , , ,  .',\n        judge_analytics: '    . :  ,  ,  ,   .',\n        counsel_analytics: '      . :   ,  , ,   .',\n        // Advanced group\n        evidence_strength: '    . :  ,  ,  ,  .',\n        adversarial: '   -        .    ?',\n        narrative: '     .     ?   ?',\n        gap_analysis: '  :  ,   ,   ,   .',\n        // Forensics group\n        forensics: '    .  -, ,  .',\n        rhetoric_forensics: '   .   ,  ,  .',\n        contract_forensics: '   .   , ,   .',\n        witness_credibility: '   .   ,  ,   .',\n      };\n\n      const prompt = CAPABILITY_PROMPTS[capabilityId] ||\n        `  : ${cap.name_he}\\n\\n     / .`;\n\n      window.dispatchEvent(\n        new CustomEvent('chat-send', {\n          detail: { prompt, displayText: cap.name_he },\n        })\n      );\n    }\n  }, [caseId, notebookData.capabilities]);\n\n  const handleSourceClick = useCallback((sourceId) => {\n    // Open document viewer or highlight source\n    console.log('Source clicked:', sourceId);\n  }, []);\n\n  const handleEvidenceClick = useCallback((evidence) => {\n    // Scroll to evidence or open source\n    console.log('Evidence clicked:', evidence);\n  }, []);\n\n  //  If chat is open without a caseId, allow selecting a target case for upload\n  useEffect(() => {\n    let alive = true;\n    async function loadCasesIfNeeded() {\n      if (!showUploadModal) return;\n      if (caseId) {\n        setTargetCaseId(caseId);\n        return;\n      }\n      try {\n        const data = await apiGet('/api/cases', { showErrorToast: false });\n        const cases = data?.cases || [];\n        if (!alive) return;\n        setAvailableCases(cases);\n        // Default to first case if available\n        if (!targetCaseId && cases.length > 0) {\n          setTargetCaseId(cases[0].id);\n        }\n      } catch (err) {\n        console.error('Failed to load cases:', err);\n      }\n    }\n    loadCasesIfNeeded();\n    return () => { alive = false; };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showUploadModal, caseId]);\n\n  //  Handle file selection\n  const handleFileSelect = useCallback((e) => {\n    const files = Array.from(e.target.files || []);\n    const validExtensions = ['.pdf', '.png', '.jpg', '.jpeg', '.tiff', '.doc', '.docx', '.txt'];\n    const maxSize = 50 * 1024 * 1024; // 50MB\n\n    const validFiles = files.filter(file => {\n      const ext = '.' + file.name.split('.').pop().toLowerCase();\n      if (!validExtensions.includes(ext)) {\n        toast.error(`   : ${file.name}`);\n        return false;\n      }\n      if (file.size > maxSize) {\n        toast.error(`  : ${file.name} ( 50MB)`);\n        return false;\n      }\n      return true;\n    });\n\n    setUploadFiles(prev => {\n      const existingNames = prev.map(f => f.name);\n      const newFiles = validFiles.filter(f => !existingNames.includes(f.name));\n      return [...prev, ...newFiles.map(file => ({\n        file,\n        name: file.name,\n        size: (file.size / 1024 / 1024).toFixed(2) + ' MB',\n        source: 'self', // Default source\n        documentType: 'other', // Default type\n        opponentLawyerName: '' // Required only for opponent docs\n      }))];\n    });\n\n    // Reset input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  }, []);\n\n  //  Handle file upload to case\n  const handleUploadFiles = useCallback(async () => {\n    const effectiveCaseId = caseId || targetCaseId;\n    if (uploadFiles.length === 0) return;\n    if (!effectiveCaseId) {\n      toast.error('   ');\n      return;\n    }\n\n    // Validate opponent lawyer names if needed\n    const missingOpponentNames = uploadFiles.some(\n      (f) => f.source === 'opponent' && (!f.opponentLawyerName || !String(f.opponentLawyerName).trim())\n    );\n    if (missingOpponentNames) {\n      toast.error('   \"   ');\n      return;\n    }\n\n    setUploading(true);\n\n    try {\n      //  Start tracking in global progress panel\n      const jobId = `case-${effectiveCaseId}`;\n      startUploadJob({\n        id: jobId,\n        type: 'case',\n        name: caseName || (availableCases.find(c => c.id === effectiveCaseId)?.name) || '',\n        totalFiles: uploadFiles.length,\n        documents: uploadFiles.map(f => ({\n          filename: f.name,\n          status: 'pending',\n          canRetry: true\n        }))\n      });\n\n      const formData = new FormData();\n      //  Do NOT auto-run full case analysis after upload.\n      // We still prepare the document for RAG (server-side OCR/normalization + indexing).\n      formData.append('reanalyze_mode', 'skip');\n      if (currentSessionId) {\n        // Link upload to the active chat session so the document appears under that session.\n        formData.append('chat_session_id', currentSessionId);\n      }\n\n      // Add file metadata\n      const fileDocTypes = uploadFiles.map(f => f.documentType || 'other');\n      const fileSources = uploadFiles.map(f => f.source || 'self');\n      const opponentLawyerNames = uploadFiles.map(f => (f.source === 'opponent' ? (f.opponentLawyerName || '') : ''));\n      formData.append('document_types', JSON.stringify(fileDocTypes));\n      formData.append('file_sources', JSON.stringify(fileSources));\n      formData.append('opponent_lawyer_names', JSON.stringify(opponentLawyerNames));\n\n      uploadFiles.forEach(f => {\n        formData.append('files', f.file);\n      });\n\n      await apiUpload(\n        `/api/cases/${encodeURIComponent(effectiveCaseId)}/files`,\n        formData,\n        { showErrorToast: true, timeoutMs: 600000 }\n      );\n\n      toast.success(`${uploadFiles.length === 1 ? ' ' : `${uploadFiles.length}  `} !`);\n      // Refresh chat to show the server-inserted assistant message + attachments (if any)\n      try {\n        window.dispatchEvent(new CustomEvent('chat-refresh', { detail: { caseId: effectiveCaseId, sessionId: currentSessionId } }));\n      } catch {\n        // ignore\n      }\n\n      //  Close modal - stay in Yitro!\n      setShowUploadModal(false);\n      setUploadFiles([]);\n\n    } catch (err) {\n      console.error('Upload failed:', err);\n      toast.error(err.message || '  ');\n    } finally {\n      setUploading(false);\n    }\n  }, [uploadFiles, caseId, targetCaseId, caseName, availableCases, currentSessionId]);\n\n  //  Remove file from upload list\n  const removeUploadFile = useCallback((fileName) => {\n    setUploadFiles(prev => prev.filter(f => f.name !== fileName));\n  }, []);\n\n  return (\n    <div className=\"h-screen flex flex-col bg-gradient-to-br from-slate-900 via-blue-900/50 to-slate-900\" dir=\"rtl\">\n      {/* Header */}\n      <header className=\"h-14 border-b border-white/10 bg-slate-900/80 backdrop-blur-sm flex items-center justify-between px-4\">\n        <div className=\"flex items-center gap-3\">\n          <h1 className=\"text-white font-bold text-lg\"></h1>\n          <span className=\"text-white/40\">|</span>\n          <span className=\"text-white/80 text-sm truncate max-w-[200px]\">\n            {caseName || '  '}\n          </span>\n          {/*  Removed ReliabilityIndicator badge per UX request */}\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          {/* Panel toggles - Cases on left, Statistics on right */}\n          <button\n            onClick={() => setShowCasesSessions(!showCasesSessions)}\n            className={`p-2 rounded-lg transition-colors ${\n              showCasesSessions ? 'bg-blue-600/30 text-blue-300' : 'text-white/50 hover:text-white hover:bg-white/10'\n            }`}\n            title={showCasesSessions ? '  ' : '  '}\n          >\n            {showCasesSessions ? <PanelRightClose size={18} /> : <PanelRightOpen size={18} />}\n          </button>\n\n          <button\n            onClick={() => setShowStatistics(!showStatistics)}\n            className={`p-2 rounded-lg transition-colors ${\n              showStatistics ? 'bg-purple-600/30 text-purple-300' : 'text-white/50 hover:text-white hover:bg-white/10'\n            }`}\n            title={showStatistics ? ' ' : ' '}\n          >\n            {showStatistics ? <PanelLeftClose size={18} /> : <PanelLeftOpen size={18} />}\n          </button>\n\n          {/*  NotebookLM Layer Indicators */}\n          {showStatistics && (\n            <div className=\"flex items-center gap-1 mr-2\">\n              {['v1', 'v2', 'v3'].map((layer) => (\n                <button\n                  key={layer}\n                  onClick={() => setNotebookLayer(layer)}\n                  className={`px-2 py-1 text-xs rounded transition-colors ${\n                    notebookLayer === layer\n                      ? 'bg-blue-600/50 text-blue-200 font-medium'\n                      : 'text-white/40 hover:text-white/70 hover:bg-white/10'\n                  }`}\n                  title={layer === 'v1' ? ' ' : layer === 'v2' ? ' ' : ' '}\n                >\n                  {layer.toUpperCase()}\n                </button>\n              ))}\n            </div>\n          )}\n\n          <div className=\"w-px h-6 bg-white/10 mx-2\" />\n\n          {/* Copy/Download buttons */}\n          <button\n            onClick={handleCopyConversation}\n            className=\"p-2 rounded-lg text-white/50 hover:text-white hover:bg-white/10 transition-colors\"\n            title=\" \"\n          >\n            {copied ? <Check size={18} className=\"text-green-400\" /> : <Copy size={18} />}\n          </button>\n\n          <button\n            onClick={handleDownloadConversation}\n            className=\"p-2 rounded-lg text-white/50 hover:text-white hover:bg-white/10 transition-colors\"\n            title=\" \"\n          >\n            <Download size={18} />\n          </button>\n\n          <button\n            className=\"p-2 rounded-lg text-white/50 hover:text-white hover:bg-white/10 transition-colors\"\n            title=\"\"\n          >\n            <Settings size={18} />\n          </button>\n\n          {onClose && (\n            <>\n              <div className=\"w-px h-6 bg-white/10 mx-2\" />\n              <button\n                onClick={onClose}\n                className=\"p-2 rounded-lg text-white/50 hover:text-red-400 hover:bg-red-500/10 transition-colors\"\n                title=\" '\"\n              >\n                <X size={18} />\n              </button>\n            </>\n          )}\n        </div>\n      </header>\n\n      {/* Main Content - min-h-0 ensures proper flex behavior on mobile */}\n      <div className=\"flex-1 flex overflow-hidden min-h-0\">\n        {/* Cases & Sessions Panel - Leftmost (swapped) */}\n        <div\n          className={`border-l border-white/10 bg-slate-900/50 flex-shrink-0 overflow-hidden transition-all duration-300 ease-in-out ${\n            showCasesSessions ? 'w-72 opacity-100' : 'w-0 opacity-0'\n          }`}\n        >\n          {showCasesSessions && (\n            <CasesSessionsPanel\n              currentCaseId={caseId}\n              currentSessionId={currentSessionId}\n              onSessionSelect={(selectedCaseId, selectedSessionId) => {\n                // Navigate to the selected session\n                handleSessionChange(selectedSessionId);\n                if (selectedCaseId !== caseId) {\n                  // If different case, navigate to it\n                  navigate(`/cases/${selectedCaseId}/chat?session=${selectedSessionId}`);\n                }\n              }}\n              onScrollToMessage={handleJumpToSource}\n            />\n          )}\n        </div>\n\n        {/* Chat Panel - Center - min-h-0 critical for mobile flex layout */}\n        <div className=\"flex-1 min-w-0 min-h-0 flex flex-col overflow-hidden\">\n          <ChatPanel\n            ref={chatPanelRef}\n            caseId={caseId}\n            caseName={caseName}\n            analysisResult={analysisResult}\n            sessionId={currentSessionId}\n            onSessionChange={handleSessionChange}\n            onPinItem={handlePinItem}\n            onAddDocuments={handleAddDocuments}\n            userTier={userTier}\n            isPremium={isPremium}\n            isEnterprise={isEnterprise}\n            //  queuedAction: allow redirects (/profiler,/counsel,...) to open chat and run an action\n            initialQueuedAction={\n              (location?.state && location.state.queuedAction) ? location.state.queuedAction : null\n            }\n            initialQueuedActionPayload={\n              (location?.state && location.state.queuedActionPayload) ? location.state.queuedActionPayload : null\n            }\n          />\n        </div>\n\n        {/*  NotebookLM Rail - capabilities and sources */}\n        {showCapabilitiesRail && (\n          <NotebookRail\n            capabilities={notebookData.capabilities}\n            sources={notebookData.sources}\n            activeArtifacts={[]}\n            nextActions={notebookData.nextActions || []}\n            onCapabilityClick={handleCapabilityClick}\n            onSourceClick={handleSourceClick}\n            onArtifactClick={(id) => console.log('Artifact:', id)}\n          />\n        )}\n\n        {/*  NotebookLM Canvas - replaces Statistics Panel */}\n        <div\n          className={`border-r border-white/10 bg-slate-900/50 flex-shrink-0 overflow-hidden transition-all duration-300 ease-in-out ${\n            showStatistics ? 'w-80 opacity-100' : 'w-0 opacity-0'\n          }`}\n        >\n          {showStatistics && (\n            <NotebookCanvas\n              currentLayer={notebookLayer}\n              layerStatuses={notebookData.layerStatuses}\n              v1Data={notebookData.v1Data}\n              v2Data={notebookData.v2Data}\n              v3Data={notebookData.v3Data}\n              onLayerChange={setNotebookLayer}\n              onEvidenceClick={handleEvidenceClick}\n              onClaimClick={(claimId) => console.log('Claim clicked:', claimId)}\n              onActorClick={(actorId) => console.log('Actor clicked:', actorId)}\n              onCapabilityClick={handleCapabilityClick}\n            />\n          )}\n        </div>\n      </div>\n\n      {/*  Inline Upload Modal - Stays in Yitro! */}\n      {showUploadModal && (\n        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-slate-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[80vh] overflow-hidden\">\n            {/* Header */}\n            <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <Upload size={20} />\n                <h3 className=\"font-bold\">  </h3>\n              </div>\n              <button\n                onClick={() => { setShowUploadModal(false); setUploadFiles([]); }}\n                className=\"p-1 hover:bg-white/20 rounded-lg transition-colors\"\n              >\n                <X size={20} />\n              </button>\n            </div>\n\n            {/* Content */}\n            <div className=\"p-4 space-y-4\">\n              {/*  Case selection (only when not in a specific case) */}\n              {!caseId && (\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <label className=\"block text-white/70 text-sm\">  </label>\n                    <button\n                      onClick={() => navigate('/cases?new=true')}\n                      className=\"text-xs text-cyan-300 hover:text-cyan-200 underline\"\n                      title=\"  \"\n                    >\n                        \n                    </button>\n                  </div>\n                  <select\n                    value={targetCaseId}\n                    onChange={(e) => setTargetCaseId(e.target.value)}\n                    className=\"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm\"\n                  >\n                    <option value=\"\" disabled> </option>\n                    {availableCases.map((c) => (\n                      <option key={c.id} value={c.id}>\n                        {c.name || c.case_name || c.id}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              )}\n\n              {/* Drop zone */}\n              <div\n                className=\"border-2 border-dashed border-blue-400/50 rounded-xl p-6 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-500/10 transition-all\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  multiple\n                  accept=\".pdf,.png,.jpg,.jpeg,.tiff,.doc,.docx,.txt\"\n                  onChange={handleFileSelect}\n                  className=\"hidden\"\n                />\n                <Upload size={32} className=\"mx-auto text-blue-400 mb-2\" />\n                <p className=\"text-white/70\">     </p>\n                <p className=\"text-white/40 text-sm mt-1\">PDF, Word,  ( 50MB)</p>\n              </div>\n\n              {/* File list */}\n              {uploadFiles.length > 0 && (\n                <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n                  <p className=\"text-white/60 text-sm\">  ({uploadFiles.length}):</p>\n                  {uploadFiles.map((file) => (\n                    <div\n                      key={file.name}\n                      className=\"bg-slate-700/50 rounded-lg p-2 text-sm border border-white/5\"\n                    >\n                      <div className=\"flex items-start gap-2\">\n                        <FileText size={16} className=\"text-blue-400 flex-shrink-0 mt-0.5\" />\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <span className=\"text-white/80 truncate\">{file.name}</span>\n                            <span className=\"text-white/40 flex-shrink-0\">{file.size}</span>\n                          </div>\n\n                          {/*  Ownership (source) + doc type */}\n                          <div className=\"mt-2 grid grid-cols-2 gap-2\">\n                            <select\n                              value={file.source || 'self'}\n                              onChange={(e) => {\n                                const newSource = e.target.value;\n                                setUploadFiles((prev) => prev.map((f) => f.name === file.name ? { ...f, source: newSource } : f));\n                              }}\n                              className=\"px-2 py-1 bg-slate-800 border border-white/10 rounded text-white/80 text-xs\"\n                              title=\"  \"\n                            >\n                              {SOURCE_OPTIONS.map(opt => (\n                                <option key={opt.value} value={opt.value}>{opt.label}</option>\n                              ))}\n                            </select>\n\n                            <select\n                              value={file.documentType || 'other'}\n                              onChange={(e) => {\n                                const newType = e.target.value;\n                                setUploadFiles((prev) => prev.map((f) => f.name === file.name ? { ...f, documentType: newType } : f));\n                              }}\n                              className=\"px-2 py-1 bg-slate-800 border border-white/10 rounded text-white/80 text-xs\"\n                              title=\" \"\n                            >\n                              {DOC_TYPE_OPTIONS.map(opt => (\n                                <option key={opt.value} value={opt.value}>{opt.label}</option>\n                              ))}\n                            </select>\n                          </div>\n\n                          {/*  Opponent lawyer name (only when source=opponent) */}\n                          {file.source === 'opponent' && (\n                            <div className=\"mt-2\">\n                              <input\n                                value={file.opponentLawyerName || ''}\n                                onChange={(e) => {\n                                  const v = e.target.value;\n                                  setUploadFiles((prev) => prev.map((f) => f.name === file.name ? { ...f, opponentLawyerName: v } : f));\n                                }}\n                                placeholder=' \"  ()'\n                                className=\"w-full px-2 py-1 bg-slate-800 border border-red-500/30 rounded text-white/80 text-xs placeholder-white/30\"\n                              />\n                            </div>\n                          )}\n                        </div>\n\n                        <button\n                          onClick={() => removeUploadFile(file.name)}\n                          className=\"p-1 text-white/40 hover:text-red-400 transition-colors flex-shrink-0\"\n                          title=\"\"\n                        >\n                          <Trash2 size={14} />\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {/* Actions */}\n              <div className=\"flex gap-2 pt-2\">\n                <button\n                  onClick={() => { setShowUploadModal(false); setUploadFiles([]); }}\n                  className=\"flex-1 px-4 py-2 rounded-lg border border-white/20 text-white/70 hover:bg-white/10 transition-colors\"\n                >\n                  \n                </button>\n                <button\n                  onClick={handleUploadFiles}\n                  disabled={uploadFiles.length === 0 || uploading}\n                  className=\"flex-1 px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium hover:from-blue-500 hover:to-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2\"\n                >\n                  {uploading ? (\n                    <>\n                      <Loader2 size={16} className=\"animate-spin\" />\n                      ...\n                    </>\n                  ) : (\n                    <>\n                      <Upload size={16} />\n                       {uploadFiles.length > 0 ? `(${uploadFiles.length})` : ''}\n                    </>\n                  )}\n                </button>\n              </div>\n\n              <p className=\"text-white/40 text-xs text-center\">\n                    .       .\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChatLayout;\n","/**\n * CTA Capability Buttons - WOW Response System\n *\n * Renders call-to-action buttons for on-demand heavy capabilities.\n * These allow users to trigger expensive analysis operations with clear indication\n * of what they're about to run.\n */\n\nimport React, { useState } from 'react';\nimport {\n  Zap,\n  Brain,\n  Scale,\n  Users,\n  Clock,\n  Search,\n  AlertCircle,\n  Loader2,\n  ChevronRight,\n} from 'lucide-react';\n\n// Capability definitions\nconst CAPABILITY_CONFIG: Record<\n  string,\n  {\n    icon: React.ElementType;\n    label: string;\n    description: string;\n    color: string;\n    bgColor: string;\n    borderColor: string;\n    warning?: string;\n  }\n> = {\n  hakashran: {\n    icon: Brain,\n    label: ' ',\n    description: '    ',\n    color: 'text-purple-400',\n    bgColor: 'bg-purple-500/10 hover:bg-purple-500/20',\n    borderColor: 'border-purple-500/30',\n    warning: '  -   ',\n  },\n  adversarial: {\n    icon: Users,\n    label: ' ',\n    description: '    ',\n    color: 'text-red-400',\n    bgColor: 'bg-red-500/10 hover:bg-red-500/20',\n    borderColor: 'border-red-500/30',\n    warning: '  -   ',\n  },\n  game_theory: {\n    icon: Scale,\n    label: ' ',\n    description: '    ',\n    color: 'text-blue-400',\n    bgColor: 'bg-blue-500/10 hover:bg-blue-500/20',\n    borderColor: 'border-blue-500/30',\n    warning: '  -   ',\n  },\n  judge_analytics: {\n    icon: Scale,\n    label: ' ',\n    description: '    ',\n    color: 'text-indigo-400',\n    bgColor: 'bg-indigo-500/10 hover:bg-indigo-500/20',\n    borderColor: 'border-indigo-500/30',\n  },\n  build_timeline: {\n    icon: Clock,\n    label: '  ',\n    description: '    ',\n    color: 'text-cyan-400',\n    bgColor: 'bg-cyan-500/10 hover:bg-cyan-500/20',\n    borderColor: 'border-cyan-500/30',\n  },\n  run_claims_analysis: {\n    icon: Search,\n    label: ' ',\n    description: '   ',\n    color: 'text-green-400',\n    bgColor: 'bg-green-500/10 hover:bg-green-500/20',\n    borderColor: 'border-green-500/30',\n  },\n  claims: {\n    icon: Search,\n    label: '  ',\n    description: '   ',\n    color: 'text-green-400',\n    bgColor: 'bg-green-500/10 hover:bg-green-500/20',\n    borderColor: 'border-green-500/30',\n  },\n  contradictions: {\n    icon: AlertCircle,\n    label: ' ',\n    description: '   ',\n    color: 'text-orange-400',\n    bgColor: 'bg-orange-500/10 hover:bg-orange-500/20',\n    borderColor: 'border-orange-500/30',\n  },\n  timeline: {\n    icon: Clock,\n    label: '  ',\n    description: '   ',\n    color: 'text-cyan-400',\n    bgColor: 'bg-cyan-500/10 hover:bg-cyan-500/20',\n    borderColor: 'border-cyan-500/30',\n  },\n  insights: {\n    icon: Zap,\n    label: ' ',\n    description: '   ',\n    color: 'text-amber-400',\n    bgColor: 'bg-amber-500/10 hover:bg-amber-500/20',\n    borderColor: 'border-amber-500/30',\n  },\n  upload_documents: {\n    icon: Search,\n    label: ' ',\n    description: '  ',\n    color: 'text-blue-400',\n    bgColor: 'bg-blue-500/10 hover:bg-blue-500/20',\n    borderColor: 'border-blue-500/30',\n  },\n};\n\ninterface Props {\n  capabilities: string[];\n  onCapabilityClick: (capability: string) => void;\n  loadingCapability?: string | null;\n  compact?: boolean;\n}\n\nconst CTACapabilityButton: React.FC<{\n  capability: string;\n  onClick: () => void;\n  isLoading: boolean;\n  compact?: boolean;\n}> = ({ capability, onClick, isLoading, compact }) => {\n  const config = CAPABILITY_CONFIG[capability];\n\n  if (!config) {\n    console.warn(`Unknown capability: ${capability}`);\n    return null;\n  }\n\n  const Icon = config.icon;\n\n  if (compact) {\n    return (\n      <button\n        onClick={onClick}\n        disabled={isLoading}\n        className={`\n          flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm\n          border ${config.borderColor} ${config.bgColor}\n          transition-all duration-200 disabled:opacity-50\n        `}\n        title={config.description}\n      >\n        {isLoading ? (\n          <Loader2 size={14} className=\"animate-spin\" />\n        ) : (\n          <Icon size={14} className={config.color} />\n        )}\n        <span className={config.color}>{config.label}</span>\n      </button>\n    );\n  }\n\n  return (\n    <button\n      onClick={onClick}\n      disabled={isLoading}\n      className={`\n        flex items-start gap-3 p-3 rounded-lg text-right w-full\n        border ${config.borderColor} ${config.bgColor}\n        transition-all duration-200 disabled:opacity-50 group\n      `}\n    >\n      <div className={`p-2 rounded-lg ${config.bgColor} ${config.borderColor} border`}>\n        {isLoading ? (\n          <Loader2 size={18} className=\"animate-spin text-white/60\" />\n        ) : (\n          <Icon size={18} className={config.color} />\n        )}\n      </div>\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center gap-2\">\n          <span className={`font-medium ${config.color}`}>{config.label}</span>\n          <ChevronRight\n            size={14}\n            className=\"text-white/40 group-hover:text-white/60 transition-colors\"\n          />\n        </div>\n        <p className=\"text-xs text-white/50 mt-0.5\">{config.description}</p>\n        {config.warning && (\n          <div className=\"flex items-center gap-1 mt-1 text-xs text-yellow-400/70\">\n            <AlertCircle size={10} />\n            <span>{config.warning}</span>\n          </div>\n        )}\n      </div>\n    </button>\n  );\n};\n\nconst CTACapabilityButtons: React.FC<Props> = ({\n  capabilities,\n  onCapabilityClick,\n  loadingCapability,\n  compact = false,\n}) => {\n  if (!capabilities?.length) {\n    return null;\n  }\n\n  const validCapabilities = capabilities.filter((cap) => CAPABILITY_CONFIG[cap]);\n\n  if (!validCapabilities.length) {\n    return null;\n  }\n\n  return (\n    <div className=\"mt-4 pt-4 border-t border-white/10\">\n      <h4 className=\"text-xs text-white/50 mb-2 flex items-center gap-1\">\n        <Zap size={12} />\n         \n      </h4>\n      <div className={compact ? 'flex flex-wrap gap-2' : 'grid gap-2 md:grid-cols-2'}>\n        {validCapabilities.map((capability) => (\n          <CTACapabilityButton\n            key={capability}\n            capability={capability}\n            onClick={() => onCapabilityClick(capability)}\n            isLoading={loadingCapability === capability}\n            compact={compact}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default CTACapabilityButtons;\nexport { CTACapabilityButton, CAPABILITY_CONFIG };\n","/**\n * Breadcrumbs - Navigation breadcrumbs\n *\n *  CODE-003: Migrated to TypeScript\n */\n\nimport React from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { ChevronLeft, Home } from 'lucide-react';\n\n// ===========================\n// Types\n// ===========================\n\ninterface BreadcrumbsProps {\n  caseName?: string;\n}\n\ntype PathSegment = string;\n\n// ===========================\n// Constants\n// ===========================\n\nconst TAB_SEGMENTS = [\n  'contradictions',\n  'claims',\n  'entities',\n  'insights',\n  'roadmap',\n  'strategies',\n  'intelligence',\n  'files'\n] as const;\n\nconst SEGMENT_LABELS: Record<string, string> = {\n  'cases': '',\n  'learning': '',\n  'tokens': ' ',\n  'settings': '',\n  'support': '',\n  'legal': '',\n  'profile': '',\n  'admin': '',\n  // Tab names\n  'contradictions': '',\n  'claims': '',\n  'entities': '',\n  'insights': '',\n  'roadmap': ' ',\n  'strategies': '',\n  'intelligence': 'Intelligence',\n  'files': '',\n};\n\n// ===========================\n// Component\n// ===========================\n\nconst Breadcrumbs: React.FC<BreadcrumbsProps> = ({ caseName }) => {\n  const location = useLocation();\n  const pathSegments: PathSegment[] = location.pathname.split('/').filter(Boolean);\n\n  const isTabSegment = (segment: string): boolean => {\n    return (TAB_SEGMENTS as readonly string[]).includes(segment);\n  };\n\n  const getBreadcrumbLabel = (segment: string, index: number): string => {\n    // Check predefined labels\n    if (SEGMENT_LABELS[segment]) {\n      return SEGMENT_LABELS[segment];\n    }\n\n    // Case ID - use case name if available\n    if (pathSegments[index - 1] === 'cases' && caseName) {\n      return caseName;\n    }\n\n    return segment;\n  };\n\n  const getBreadcrumbPath = (index: number): string => {\n    return '/' + pathSegments.slice(0, index + 1).join('/');\n  };\n\n  const shouldShowSegment = (segment: string, index: number): boolean => {\n    // Don't show case ID as separate breadcrumb if next segment is a tab\n    if (pathSegments[index - 1] === 'cases' &&\n        pathSegments[index + 1] &&\n        isTabSegment(pathSegments[index + 1])) {\n      return false;\n    }\n    return true;\n  };\n\n  if (pathSegments.length === 0) {\n    return null; // Don't show breadcrumbs on home page\n  }\n\n  return (\n    <nav className=\"flex items-center gap-2 text-sm mb-4\" dir=\"rtl\">\n      <Link\n        to=\"/\"\n        className=\"flex items-center gap-1 text-blue-300 hover:text-white transition-colors\"\n      >\n        <Home size={16} />\n        <span></span>\n      </Link>\n\n      {pathSegments.map((segment, index) => {\n        if (!shouldShowSegment(segment, index)) return null;\n\n        const isLast = index === pathSegments.length - 1;\n        const path = getBreadcrumbPath(index);\n        const label = getBreadcrumbLabel(segment, index);\n\n        return (\n          <React.Fragment key={index}>\n            <ChevronLeft size={16} className=\"text-white/30\" />\n            {isLast ? (\n              <span className=\"text-white font-semibold\">{label}</span>\n            ) : (\n              <Link\n                to={path}\n                className=\"text-blue-300 hover:text-white transition-colors\"\n              >\n                {label}\n              </Link>\n            )}\n          </React.Fragment>\n        );\n      })}\n    </nav>\n  );\n};\n\nexport default Breadcrumbs;\n","/**\n * NotebookChatInput - Chat input matching NotebookLM style\n *\n * Features:\n * - Compact input area with notebook styling\n * - Quick capability buttons\n * - Upload button integration\n * - RTL support\n */\n\nimport React, { useState, useRef, useCallback, KeyboardEvent } from 'react';\nimport {\n  Send,\n  Paperclip,\n  Loader2,\n  Brain,\n  Search,\n  Target,\n  Shield,\n  Users,\n  Clock,\n  AlertTriangle,\n  Scale,\n  FileText,\n} from 'lucide-react';\n\ninterface QuickCapability {\n  id: string;\n  label: string;\n  icon: React.ElementType;\n  prompt: string;\n}\n\ninterface NotebookChatInputProps {\n  onSend: (message: string, displayText?: string) => void;\n  onUpload?: () => void;\n  isLoading?: boolean;\n  placeholder?: string;\n  disabled?: boolean;\n  capabilities?: QuickCapability[];\n}\n\n// Default quick capabilities matching NotebookLM style\nconst DEFAULT_CAPABILITIES: QuickCapability[] = [\n  { id: 'claims', label: '', icon: Search, prompt: '       ' },\n  { id: 'contradictions', label: '', icon: AlertTriangle, prompt: '     ' },\n  { id: 'timeline', label: ' ', icon: Clock, prompt: '      ' },\n  { id: 'strategy', label: '', icon: Target, prompt: '      ' },\n];\n\nexport const NotebookChatInput: React.FC<NotebookChatInputProps> = ({\n  onSend,\n  onUpload,\n  isLoading = false,\n  placeholder = '    ...',\n  disabled = false,\n  capabilities = DEFAULT_CAPABILITIES,\n}) => {\n  const [message, setMessage] = useState('');\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  const handleSend = useCallback(() => {\n    const trimmed = message.trim();\n    if (!trimmed || isLoading || disabled) return;\n    onSend(trimmed);\n    setMessage('');\n    // Reset textarea height\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n    }\n  }, [message, onSend, isLoading, disabled]);\n\n  const handleKeyDown = useCallback((e: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  }, [handleSend]);\n\n  const handleQuickCapability = useCallback((cap: QuickCapability) => {\n    onSend(cap.prompt, cap.label);\n  }, [onSend]);\n\n  const adjustTextareaHeight = useCallback(() => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = `${Math.min(textarea.scrollHeight, 120)}px`;\n    }\n  }, []);\n\n  return (\n    <div className=\"border-t border-slate-800 bg-slate-900/80 backdrop-blur-sm\" dir=\"rtl\">\n      {/* Quick Capabilities Row */}\n      <div className=\"px-4 py-2 border-b border-slate-800/50\">\n        <div className=\"flex items-center gap-2 overflow-x-auto scrollbar-hide\">\n          {capabilities.map((cap) => {\n            const Icon = cap.icon;\n            return (\n              <button\n                key={cap.id}\n                onClick={() => handleQuickCapability(cap)}\n                disabled={isLoading || disabled}\n                className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-full\n                  bg-slate-800/50 border border-slate-700/50\n                  text-white/70 text-xs font-medium\n                  hover:bg-slate-700 hover:border-blue-500/30 hover:text-white\n                  disabled:opacity-50 disabled:cursor-not-allowed\n                  transition-all duration-150 whitespace-nowrap\"\n              >\n                <Icon size={14} className=\"text-blue-400\" />\n                <span>{cap.label}</span>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Input Area */}\n      <div className=\"p-4\">\n        <div className=\"flex items-end gap-2\">\n          {/* Upload Button */}\n          {onUpload && (\n            <button\n              onClick={onUpload}\n              disabled={isLoading || disabled}\n              className=\"p-2.5 rounded-xl bg-slate-800/50 border border-slate-700/50\n                text-white/60 hover:text-white hover:bg-slate-700 hover:border-blue-500/30\n                disabled:opacity-50 disabled:cursor-not-allowed\n                transition-all duration-150\"\n              title=\" \"\n            >\n              <Paperclip size={20} />\n            </button>\n          )}\n\n          {/* Text Input */}\n          <div className=\"flex-1 relative\">\n            <textarea\n              ref={textareaRef}\n              value={message}\n              onChange={(e) => {\n                setMessage(e.target.value);\n                adjustTextareaHeight();\n              }}\n              onKeyDown={handleKeyDown}\n              placeholder={placeholder}\n              disabled={isLoading || disabled}\n              rows={1}\n              className=\"w-full px-4 py-3 pr-4 pl-12\n                bg-slate-800/50 border border-slate-700/50 rounded-xl\n                text-white placeholder-white/40 text-sm\n                focus:outline-none focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500/50\n                disabled:opacity-50 disabled:cursor-not-allowed\n                resize-none overflow-hidden\n                transition-all duration-150\"\n              style={{ minHeight: '48px', maxHeight: '120px' }}\n            />\n\n            {/* Send Button (inside input) */}\n            <button\n              onClick={handleSend}\n              disabled={!message.trim() || isLoading || disabled}\n              className=\"absolute left-2 bottom-2 p-2 rounded-lg\n                bg-blue-600 hover:bg-blue-500\n                text-white\n                disabled:bg-slate-700 disabled:text-white/30 disabled:cursor-not-allowed\n                transition-all duration-150\"\n            >\n              {isLoading ? (\n                <Loader2 size={18} className=\"animate-spin\" />\n              ) : (\n                <Send size={18} />\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Status/Hint */}\n        <div className=\"mt-2 text-center\">\n          <span className=\"text-[10px] text-white/30\">\n            {isLoading ? '   ...' : 'Shift+Enter    Enter '}\n          </span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NotebookChatInput;\n","/**\n * SuggestedActions - Action buttons below chat message\n *\n * Displays suggested follow-up actions that the user can click.\n * Each action sends a predefined prompt.\n */\n\nimport React from 'react';\nimport { ArrowLeft, Search, AlertTriangle, Target, Clock, Scale, Brain } from 'lucide-react';\nimport type { SuggestedAction, SuggestedActionsProps } from '../../../types/notebook';\n\n// Icon mapping for common actions\nconst ACTION_ICONS: Record<string, React.ElementType> = {\n  search: Search,\n  claims: Search,\n  contradictions: AlertTriangle,\n  strategy: Target,\n  timeline: Clock,\n  precedents: Scale,\n  analysis: Brain,\n  default: ArrowLeft,\n};\n\nconst getActionIcon = (action: SuggestedAction): React.ElementType => {\n  // Try to match icon from label or explicit icon\n  if (action.icon && ACTION_ICONS[action.icon]) {\n    return ACTION_ICONS[action.icon];\n  }\n\n  // Try to infer from label\n  const label = action.label_he.toLowerCase();\n  for (const [key, Icon] of Object.entries(ACTION_ICONS)) {\n    if (label.includes(key)) {\n      return Icon;\n    }\n  }\n\n  return ACTION_ICONS.default;\n};\n\nexport const SuggestedActions: React.FC<SuggestedActionsProps> = ({\n  actions,\n  onActionClick,\n}) => {\n  if (!actions || actions.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex flex-wrap gap-2 pt-3\" dir=\"rtl\">\n      {actions.map((action) => {\n        const Icon = getActionIcon(action);\n        return (\n          <button\n            key={action.id}\n            onClick={() => onActionClick(action)}\n            className=\"flex items-center gap-2 px-3 py-2\n              bg-slate-800/40 border border-slate-700/50 rounded-lg\n              text-xs text-white/80 font-medium\n              hover:bg-slate-700 hover:border-blue-500/50 hover:text-white\n              transition-all duration-150\"\n          >\n            <Icon size={14} className=\"text-blue-400\" />\n            <span>{action.label_he}</span>\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default SuggestedActions;\n","/**\n * SegmentedTabs - Tab navigation for Playbook sections\n *\n * HARD BAN: No Accordion/Collapsible\n * Uses horizontal tabs for section switching.\n *\n * Sections:\n * -  (Investigation)\n * -  (Discovery)\n * -  (Drafting)\n * - \" (Negotiation)\n */\n\nimport React from 'react';\nimport { Search, FileSearch, FileText, Handshake } from 'lucide-react';\nimport type { PlaybookSection, SegmentedTabsProps } from '../../../types/notebook';\n\nconst SECTION_ICONS: Record<PlaybookSection, React.ElementType> = {\n  investigation: Search,\n  discovery: FileSearch,\n  drafting: FileText,\n  negotiation: Handshake,\n};\n\nconst DEFAULT_LABELS: Record<PlaybookSection, string> = {\n  investigation: '',\n  discovery: '',\n  drafting: '',\n  negotiation: '\"',\n};\n\nexport const SegmentedTabs: React.FC<SegmentedTabsProps> = ({\n  sections,\n  activeSection,\n  onSectionChange,\n  sectionLabels = DEFAULT_LABELS,\n}) => {\n  return (\n    <div className=\"flex items-center gap-1 p-1 bg-slate-800/50 rounded-xl\" dir=\"rtl\">\n      {sections.map((section) => {\n        const Icon = SECTION_ICONS[section];\n        const isActive = section === activeSection;\n        const label = sectionLabels[section] || DEFAULT_LABELS[section];\n\n        return (\n          <button\n            key={section}\n            onClick={() => onSectionChange(section)}\n            className={`\n              flex items-center gap-2 px-4 py-2 rounded-lg\n              text-sm font-medium transition-all duration-200\n              ${isActive\n                ? 'bg-blue-600 text-white shadow-lg shadow-blue-600/30'\n                : 'text-white/60 hover:text-white hover:bg-slate-700/50'\n              }\n            `}\n          >\n            <Icon size={16} />\n            <span>{label}</span>\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default SegmentedTabs;\n","/**\n * Case Page - Individual case view with analysis results\n */\n\nimport React, { useState, useEffect, useCallback, useRef, lazy, Suspense } from 'react';\nimport { useParams, useNavigate, useSearchParams, useLocation } from 'react-router-dom';\nimport {\n  Loader2, Activity, Download, MessageSquare, Brain, AlertCircle, Lock, Crown, ListChecks, ChevronDown, ChevronUp\n} from 'lucide-react';\nimport { toast } from 'sonner';\n//  Removed PanelGroup imports - chat is now full screen when open\n\n//  PERF FIX: Essential components loaded immediately\nimport { ChatLayout } from '../components/chat';\nimport Breadcrumbs from '../components/Breadcrumbs';\n//  NotebookLM-style UI\nimport { NotebookPage } from '../components/notebook';\nimport { useNotebookData } from '../hooks/useNotebookData';\nimport ErrorDisplay from '../components/ErrorDisplay';\nimport { CasePageSkeleton } from '../components/LoadingSkeletons';\nimport { API_BASE_URL } from '../config';\nimport { apiGet, fetchWithAuth } from '../utils/api';\nimport { logger } from '../utils/logger';\n//  FIX: Use subscription store with caching to prevent rate limiting\nimport { useSubscriptionStore } from '../store/useSubscriptionStore';\n//  FIX: Sync case ID with global store for sidebar\nimport { useCaseStore } from '../store/useCaseStore';\n\n//  PERF FIX: Lazy load heavy/tab-specific components\nconst ExportDialog = lazy(() => import('../components/ExportDialog'));\nconst FileManager = lazy(() => import('../components/FileManager'));\nconst ConclusionsView = lazy(() => import('../components/ConclusionsView'));\nconst ExecutiveDashboard = lazy(() => import('../components/ExecutiveDashboard'));\nconst UpgradeModal = lazy(() => import('../components/UpgradeModal'));\nconst IntelligencePage = lazy(() => import('../components/intelligence/IntelligencePage'));\nconst DeepAnalysis = lazy(() => import('../components/DeepAnalysis'));\nconst LegalNotebookPanel = lazy(() => import('../components/legal-notebook/LegalNotebookPanel'));\nconst RepresentationBanner = lazy(() => import('../components/representation/RepresentationBanner'));\nconst JudgeEnrichmentBanner = lazy(() => import('../components/JudgeEnrichmentBanner'));\n\n//  NOTE: Analysis views (issues/forensics/counsel/intelligence/profiler/RAG) must run inside chat (no separate pages).\n\n// Loading fallback for lazy components\nconst LazyLoadFallback = () => (\n  <div className=\"flex items-center justify-center h-64\">\n    <Loader2 className=\"animate-spin text-blue-400\" size={32} />\n  </div>\n);\n\nconst CasePage = () => {\n  const { caseId, tab } = useParams();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [searchParams] = useSearchParams();\n  const autoOpenUpload = searchParams.get('upload') === 'true';\n\n  //  FIX: Detect if this is a newly created free chat (skip loading)\n  const isNewFreeChat = location.state?.newFreeChat === true;\n\n  //  FIX: Sync case ID and analysis state with global store for sidebar awareness\n  const { setActiveCase, setAnalyzing: setGlobalAnalyzing, clearAnalyzing: clearGlobalAnalyzing } = useCaseStore();\n\n  //  CHAT-CENTRIC: Default to chat tab and auto-open chat panel\n  const [activeTab, setActiveTab] = useState(tab || 'chat');\n  const [advancedMode, setAdvancedMode] = useState(false);\n  const [modeTouched, setModeTouched] = useState(false); // user manually changed mode\n  const [caseData, setCaseData] = useState(null);\n  const [analysisResult, setAnalysisResult] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [loadingCase, setLoadingCase] = useState(true); //  FIX: Track case data loading separately\n  const [showExportDialog, setShowExportDialog] = useState(false);\n  //  CHAT-CENTRIC: Auto-open chat when no specific tab is provided\n  const [showChatbot, setShowChatbot] = useState(!tab || tab === 'chat');\n  const [, setAnalysisStatus] = useState(null);\n  const [error, setError] = useState(null); //  UX-103 FIX: Error state\n\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const prevAnalyzingRef = useRef(false); // Track previous analyzing state for notification\n\n  const [intelligenceData, setIntelligenceData] = useState(null);\n  const [executiveSummary, setExecutiveSummary] = useState(null);\n  const [serverStatus, setServerStatus] = useState({ checking: true, online: false, error: null });\n  const [userData, setUserData] = useState(null);\n  // eslint-disable-next-line no-unused-vars\n  const [timelineData, setTimelineData] = useState(null); // Kept for potential future use\n  const [graphData, setGraphData] = useState(null);\n  // eslint-disable-next-line no-unused-vars\n  const [loadingTimeline, setLoadingTimeline] = useState(false); // Kept for potential future use\n  const [loadingGraph, setLoadingGraph] = useState(false);\n  //  FIX: Track sidebar width for chat positioning\n  const [sidebarWidth, setSidebarWidth] = useState(window.innerWidth < 768 ? '4rem' : '16rem');\n  const [upgradeModal, setUpgradeModal] = useState({\n    isOpen: false,\n    featureName: '',\n    featureDescription: '',\n    requiredTier: 'professional'\n  });\n  //  Grouped tabs UI (4 primary groups) in advanced mode\n  const [activeTabGroup, setActiveTabGroup] = useState(null);\n\n  // Re-analyze with focus state\n  const [showReanalyzeModal, setShowReanalyzeModal] = useState(false);\n  const [reanalyzeFocus, setReanalyzeFocus] = useState('');\n  const [isReanalyzing, setIsReanalyzing] = useState(false);\n  const tierLevels = { free: 0, basic: 1, professional: 2, enterprise: 3, admin: 4 };\n  const rawUserTier = (userData?.subscription_tier || 'free').toLowerCase();\n  const effectiveTier =\n    userData?.role === 'admin' || userData?.is_admin ? 'admin' : rawUserTier;\n  const hasTier = (requiredTier) =>\n    (tierLevels[effectiveTier] ?? 0) >= (tierLevels[requiredTier] ?? 0);\n\n  //  NotebookLM-style data adapter\n  const notebookData = useNotebookData({\n    caseId,\n    caseName: caseData?.name,\n    analysisResult,\n    documents: caseData?.files,\n  });\n\n  //  FIX: Sync caseId with global store for sidebar to work\n  useEffect(() => {\n    if (caseId) {\n      setActiveCase(caseId, caseData?.name || null);\n    }\n  }, [caseId, caseData?.name, setActiveCase]);\n\n  //  Notify when analysis completes (was analyzing, now not)\n  useEffect(() => {\n    if (prevAnalyzingRef.current && !isAnalyzing) {\n      // Analysis just completed!\n      toast.success('  !    .', {\n        duration: 6000,\n        action: {\n          label: '',\n          onClick: () => setActiveTab('executive')\n        }\n      });\n      // Reload analysis result to show new data\n      loadAnalysisResult();\n    }\n    prevAnalyzingRef.current = isAnalyzing;\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isAnalyzing]);\n\n  //  FIX: Sync local isAnalyzing state with global store for sidebar button disabling\n  useEffect(() => {\n    if (isAnalyzing) {\n      setGlobalAnalyzing(true, 0);\n    } else {\n      clearGlobalAnalyzing();\n    }\n  }, [isAnalyzing, setGlobalAnalyzing, clearGlobalAnalyzing]);\n\n  const openUpgradeModal = (featureName, featureDescription, requiredTier) => {\n    setUpgradeModal({\n      isOpen: true,\n      featureName,\n      featureDescription,\n      requiredTier\n    });\n  };\n\n  const closeUpgradeModal = () =>\n    setUpgradeModal((prev) => ({ ...prev, isOpen: false }));\n\n  const syncTabRoute = useCallback(\n    (targetTab, replace = true) => {\n      if (!caseId) return;\n      navigate(`/cases/${caseId}/${targetTab}`, { replace });\n    },\n    [caseId, navigate]\n  );\n\n  //  Open chat and (optionally) queue an action inside chat (no separate analysis pages).\n  const openChatWithAction = useCallback(\n    (queuedAction = null, queuedActionPayload = null) => {\n      if (!caseId) return;\n      setShowChatbot(true);\n      setActiveTab('chat');\n      navigate(`/cases/${caseId}/chat`, {\n        replace: true,\n        state: queuedAction ? { queuedAction, queuedActionPayload } : {},\n      });\n    },\n    [caseId, navigate]\n  );\n\n  const openChatPanel = useCallback(\n    ({ updateRoute = false } = {}) => {\n      if (updateRoute) {\n        openChatWithAction(null, null);\n        return;\n      }\n      if (!showChatbot) setShowChatbot(true);\n      if (activeTab !== 'chat') setActiveTab('chat');\n    },\n    [activeTab, openChatWithAction, showChatbot]\n  );\n\n  const closeChatPanel = useCallback(\n    ({ updateRoute = false } = {}) => {\n      if (showChatbot) {\n        setShowChatbot(false);\n      }\n      if (activeTab === 'chat') {\n        const fallbackTab = 'conclusions';\n        setActiveTab(fallbackTab);\n        if (updateRoute) {\n          syncTabRoute(fallbackTab);\n        }\n      }\n    },\n    [activeTab, showChatbot, syncTabRoute]\n  );\n\n  // Update active tab when URL changes\n  useEffect(() => {\n    if (tab) {\n      //  Hard rule: no separate analysis pages. Redirect analysis tabs into chat with queuedAction.\n      const toChatAction = {\n        issuesmap: 'issuesmap',\n        forensics: 'forensics',\n        counsel: 'counsel',\n        profiler: 'counsel', // unify \" \" + \"\\\" \"\n        intelligence: 'intelligence',\n        rag: null,\n      };\n\n      if (tab === 'ai-summary') {\n        navigate(`/cases/${caseId}/executive`, { replace: true });\n        return;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(toChatAction, tab)) {\n        const action = toChatAction[tab];\n        openChatWithAction(action, null);\n        return;\n      }\n\n      setActiveTab(tab);\n\n      // Auto-switch to advanced mode if user navigates to an advanced tab\n      const advancedTabs = [\n        'conclusions',\n        'executive',\n        // analysis tabs are handled in chat (no page)\n      ];\n      if (advancedTabs.includes(tab)) {\n        setAdvancedMode(true);\n      }\n      if (tab === 'chat') {\n        openChatPanel({ updateRoute: false });\n      } else {\n        //  FIX: Close chat panel when navigating to non-chat tabs via sidebar\n        setShowChatbot(false);\n      }\n    }\n  }, [tab, openChatPanel, openChatWithAction, navigate, caseId]);\n\n  // Handle mode toggle\n  const handleModeToggle = () => {\n    const newMode = !advancedMode;\n    setModeTouched(true);\n    setAdvancedMode(newMode);\n\n    // Smart tab switching when toggling modes\n    if (newMode === false) {\n      // Switching to Simple Mode\n      // If current tab is not available in simple mode, switch to executive\n      const simpleTabs = ['conclusions', 'chat', 'files'];\n      if (!simpleTabs.includes(activeTab)) {\n        navigate(`/cases/${caseId}/conclusions`);\n        setActiveTab('conclusions');\n      }\n    } else {\n      // Switching to Advanced Mode - stay on current tab\n      // No need to switch tabs\n    }\n  };\n\n  //  After analysis completion, automatically enable Advanced Mode so users see all analysis tabs.\n  useEffect(() => {\n    if (modeTouched) return;\n    const status = (analysisResult?.status || caseData?.status || '').toLowerCase();\n    if (status === 'completed') {\n      setAdvancedMode(true);\n    }\n  }, [analysisResult?.status, caseData?.status, modeTouched]);\n\n  // Handle ESC key to close chat\n  useEffect(() => {\n    const handleEscape = (e) => {\n      if (e.key === 'Escape' && showChatbot) {\n        closeChatPanel({ updateRoute: true });\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [showChatbot, closeChatPanel]);\n\n  //  FIX: Listen for window resize to update sidebar width\n  useEffect(() => {\n    const handleResize = () => {\n      setSidebarWidth(window.innerWidth < 768 ? '4rem' : '16rem');\n    };\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  //  Handle navigation from Tool Banner in chat\n  useEffect(() => {\n    const handleNavigateToTab = (e) => {\n      const { tab: targetTab } = e.detail || {};\n      if (targetTab) {\n        //  No navigation pages: tool banners should trigger queued chat actions.\n        const actionMapping = {\n          contradictions: 'forensics',\n          redflags: 'forensics',\n          claims: 'issuesmap',\n          disputes: 'issuesmap',\n          cross: 'counsel',\n          strategies: 'counsel',\n          profiler: 'counsel',\n          overview: 'executive',\n          intelligence: 'intelligence',\n        };\n        const action = actionMapping[targetTab] || targetTab;\n        openChatWithAction(action, null);\n      }\n    };\n\n    window.addEventListener('navigate-to-tab', handleNavigateToTab);\n    return () => window.removeEventListener('navigate-to-tab', handleNavigateToTab);\n  }, [openChatWithAction]);\n\n  // Check server connectivity\n  const checkServerConnectivity = async () => {\n    try {\n      logger.log(' Checking server connectivity...');\n      const controller = new AbortController();\n      //  FIX: Increased timeout to 15s - server may be slow when processing uploads\n      const timeoutId = setTimeout(() => controller.abort(), 15000);\n\n      const response = await fetch(`${API_BASE_URL}/api/healthz`, {\n        method: 'GET',\n        signal: controller.signal\n      }).catch(() => null);\n\n      clearTimeout(timeoutId);\n\n      if (response && response.ok) {\n        logger.log(' Server is online');\n        setServerStatus({ checking: false, online: true, error: null });\n        return true;\n      } else {\n        logger.warn(' Server health check failed');\n        setServerStatus({\n          checking: false,\n          online: false,\n          error: '    '\n        });\n        return false;\n      }\n    } catch (error) {\n      logger.error(' Server connectivity check failed:', error);\n      setServerStatus({\n        checking: false,\n        online: false,\n        error: `   : ${error.message}`\n      });\n      return false;\n    }\n  };\n\n  //  FIX: Use subscription store with caching to prevent rate limiting\n  const { data: subscriptionData, fetchSubscription } = useSubscriptionStore();\n\n  // Load user data from subscription store (cached)\n  const loadUserData = async () => {\n    try {\n      const data = await fetchSubscription();\n      if (data) {\n        setUserData(data);\n      }\n    } catch (error) {\n      logger.error('Failed to load user data:', error);\n      // Silent fail - not critical\n    }\n  };\n\n  //  FIX: Sync userData when subscription store updates\n  useEffect(() => {\n    if (subscriptionData && !userData) {\n      setUserData(subscriptionData);\n    }\n  }, [subscriptionData, userData]);\n\n  useEffect(() => {\n    const init = async () => {\n      logger.log(` CasePage init called with caseId: ${caseId}, isNewFreeChat: ${isNewFreeChat}`);\n      setExecutiveSummary(null);\n\n      //  FIX: For newly created free chat, show chat immediately without loading\n      if (isNewFreeChat) {\n        logger.log(' New free chat detected - showing chat immediately');\n        setLoading(false);\n        setLoadingCase(false);\n        setShowChatbot(true);\n        // Create minimal case data for display\n        setCaseData({\n          id: caseId,\n          name: `  - ${new Date().toLocaleDateString('he-IL')}`,\n          case_type: 'free_chat',\n          status: 'completed'\n        });\n        // Clear navigation state to prevent re-triggering\n        window.history.replaceState({}, document.title);\n        // Load user data in background (for subscription info)\n        loadUserData();\n        return;\n      }\n\n      const isOnline = await checkServerConnectivity();\n      logger.log(` Server connectivity check: ${isOnline ? 'ONLINE' : 'OFFLINE'}`);\n      if (isOnline) {\n        try {\n          //  FIX: First load case data to check case_type\n          logger.log(' Loading case data first...');\n          const caseResponse = await apiGet(`/api/cases/${caseId}`);\n          logger.log(` Case loaded: case_type=${caseResponse?.case_type}`);\n          setCaseData(caseResponse);\n          setLoadingCase(false);\n\n          //  FIX: For free_chat cases, skip analysis loading - show chat immediately\n          if (caseResponse?.case_type === 'free_chat') {\n            logger.log(' Free chat case detected - skipping analysis loading');\n            setLoading(false);\n            setShowChatbot(true);\n            // Just load user data (for subscription info)\n            loadUserData();\n            return;\n          }\n\n          //  PERF FIX: For regular cases, parallelize remaining API calls\n          logger.log(' Starting parallel API calls for analysis...');\n          await Promise.all([\n            loadUserData(),\n            loadAnalysisResult(),\n            loadExecutiveSummary()\n          ]);\n          logger.log(' All parallel API calls completed');\n        } catch (error) {\n          //  FIX: Safety net - ensure loading is false even if Promise.all fails\n          logger.error(' Error in parallel API calls:', error);\n          setLoading(false);\n          setLoadingCase(false);\n        }\n      } else {\n        logger.error(' Server offline - skipping data load');\n        //  FIX: Set loading to false even when offline to prevent infinite loading\n        setLoading(false);\n        setLoadingCase(false);\n        setError('  .      .');\n      }\n    };\n\n    init();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [caseId, isNewFreeChat]);\n  const loadExecutiveSummary = async () => {\n    if (!caseId) return;\n    try {\n      //  P0 FIX: Correct endpoint for AI summary\n      const data = await apiGet(`/api/cases/${caseId}/ai-summary`, {\n        showErrorToast: false\n      });\n      if (data?.exists && data.summary) {\n        setExecutiveSummary(data.summary);\n      }\n    } catch (error) {\n      logger.warn('Failed to load executive summary:', error);\n    }\n  };\n\n\n  const loadCaseData = async (options = {}) => {\n    const { silent = false } = options; //  silent=true prevents blocking UI\n    logger.log(` loadCaseData called for case: ${caseId} (silent=${silent})`);\n    if (!silent) setLoadingCase(true); //  FIX: Only block UI if not silent reload\n    if (!caseId) {\n      logger.error(' loadCaseData: caseId is undefined/null!');\n      setLoadingCase(false);\n      return;\n    }\n    try {\n      logger.log(` Making API call to /api/cases/${caseId}`);\n      const data = await apiGet(`/api/cases/${caseId}`);\n      logger.log(` loadCaseData received data:`, data);\n      setCaseData(data);\n      setError(null); //  UX-103 FIX: Clear error on success\n\n      //  FIX: Always show progress if status is analyzing/processing\n      if (data.status === 'analyzing' || data.status === 'processing') {\n        //  Removed: separate progress panel (shown in chat instead)\n        setIsAnalyzing(true);\n        //  FIX: Don't block UI waiting for analysis - show progress tracker immediately\n        setLoading(false);\n      } else if (data.status === 'completed' || data.status === 'ready') {\n        //  'ready' = OCR done, awaiting user's on-demand analysis choices\n        setIsAnalyzing(false);\n      } else {\n        // For other statuses, check if we should show progress\n        //  Removed: separate progress panel (shown in chat instead)\n        setIsAnalyzing(data.status === 'analyzing' || data.status === 'processing');\n      }\n    } catch (error) {\n      logger.error('Failed to load case data:', error);\n      const errorMessage = error instanceof Error ? error.message : '   ';\n      setError(errorMessage);\n      toast.error('   ');\n    } finally {\n      setLoadingCase(false); //  FIX: End case loading\n    }\n  };\n\n  const loadAnalysisResult = async (retryCount = 0) => {\n    const MAX_RETRIES = 3;\n\n    try {\n      //  FIX: Don't set loading=true here - it causes race condition with loadCaseData\n      // The initial loading state is true, and loadCaseData handles setting it to false\n      // when appropriate (e.g., when case is analyzing and should show progress tracker)\n      logger.log(` Loading analysis for case ${caseId} (attempt ${retryCount + 1}/${MAX_RETRIES + 1})`);\n\n      //  P0 FIX: Use centralized API utility with retry\n      const data = await apiGet(`/api/cases/${caseId}/analysis`, {\n        retry: retryCount < MAX_RETRIES,\n        maxRetries: MAX_RETRIES - retryCount,\n        showErrorToast: retryCount >= MAX_RETRIES\n      });\n      logger.log(' Analysis loaded successfully:', {\n        status: data.status,\n        contradictions: data.contradictions?.length || 0,\n        hasIntelligence: !!(data.intelligence || data.metadata?.intelligence)\n      });\n\n      setAnalysisResult(data);\n      setError(null); //  UX-103 FIX: Clear error on success\n      const summaryPayload =\n        data?.executive_summary ||\n        data?.metadata?.executive_summary ||\n        null;\n      setExecutiveSummary(summaryPayload);\n      if (!summaryPayload) {\n        loadExecutiveSummary();\n      }\n      setAnalysisStatus(data.status || caseData?.status);\n      \n      //  FIX: Update analyzing state based on analysis status\n      if (data.status === 'analyzing' || data.status === 'processing') {\n        //  Removed: separate progress panel (shown in chat instead)\n        setIsAnalyzing(true);\n      } else if (data.status === 'completed' || data.status === 'ready' || data.status === 'failed') {\n        //  'ready' = OCR done, awaiting user's on-demand analysis choices\n        setIsAnalyzing(false);\n      }\n\n      if (data.metadata && data.metadata.intelligence) {\n        logger.log(' Intelligence loaded from metadata');\n        setIntelligenceData(data.metadata.intelligence);\n      } else if (data.intelligence) {\n        logger.log(' Intelligence loaded from root');\n        setIntelligenceData(data.intelligence);\n      }\n\n    } catch (error) {\n      logger.error(' Error loading analysis:', error);\n      setAnalysisResult(null);\n      const errorMessage = error instanceof Error ? error.message : '   ';\n      setError(errorMessage);\n      // Error toast already shown by apiGet if retries exhausted\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Load Timeline Data - Kept for potential future use\n  // eslint-disable-next-line no-unused-vars\n  const loadTimelineData = async () => {\n    if (!caseId) return;\n\n    try {\n      setLoadingTimeline(true);\n      //  P0 FIX: Use centralized API utility\n      const data = await apiGet(`/api/cases/${caseId}/timeline`, { showErrorToast: false });\n      logger.log(' Timeline loaded:', data);\n      setTimelineData(data);\n    } catch (error) {\n      logger.error(' Error loading timeline:', error);\n      // Silent fail - not critical\n    } finally {\n      setLoadingTimeline(false);\n    }\n  };\n\n  // Load Graph Data\n  const loadGraphData = async () => {\n    if (!caseId) return;\n\n    try {\n      setLoadingGraph(true);\n      //  P0 FIX: Use centralized API utility\n      const data = await apiGet(`/api/cases/${caseId}/contradiction-graph`, { showErrorToast: false });\n      logger.log(' Graph loaded:', data);\n      setGraphData(data);\n    } catch (error) {\n      logger.error(' Error loading graph:', error);\n      // Silent fail - not critical\n    } finally {\n      setLoadingGraph(false);\n    }\n  };\n\n  // Load graph when tab is selected\n  useEffect(() => {\n    if (activeTab === 'graph' && !graphData && !loadingGraph) {\n      loadGraphData();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeTab]);\n\n  // eslint-disable-next-line no-unused-vars\n  const handleAnalysisComplete = useCallback((completedCaseId) => {\n    logger.log(' Analysis completed for case:', completedCaseId);\n\n    if (completedCaseId === caseId) {\n      loadCaseData();\n      loadAnalysisResult();\n    }\n\n    //  Removed: separate progress panel (shown in chat instead)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [caseId]);\n\n  // Handle re-analyze with focus\n  const handleReanalyze = async () => {\n    if (!reanalyzeFocus.trim()) {\n      toast.error('    ');\n      return;\n    }\n\n    try {\n      setIsReanalyzing(true);\n      const response = await fetchWithAuth(`/api/cases/${caseId}/reanalyze`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ focus_topic: reanalyzeFocus.trim() })\n      });\n\n      if (response.ok) {\n        toast.success(`   : \"${reanalyzeFocus}\"`);\n        setShowReanalyzeModal(false);\n        setReanalyzeFocus('');\n        //  Removed: separate progress panel (shown in chat instead)\n        setIsAnalyzing(true);\n        // Reload case data to get progress updates\n        loadCaseData({ silent: true });\n      } else {\n        const error = await response.json();\n        toast.error(error.detail || '   ');\n      }\n    } catch (error) {\n      logger.error('Error re-analyzing:', error);\n      toast.error('   ');\n    } finally {\n      setIsReanalyzing(false);\n    }\n  };\n\n\n  //  FIX: Show loading spinner if EITHER case data OR analysis is loading\n  if (loading || loadingCase) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <Loader2 className=\"animate-spin h-12 w-12 text-purple-400 mx-auto mb-4\" />\n          <p className=\"text-blue-300\">{loadingCase ? ' ...' : ' ...'}</p>\n        </div>\n      </div>\n    );\n  }\n\n  //  FIX: Only show \"case not found\" AFTER case loading is complete\n  if (!caseData) {\n    return (\n      <div className=\"p-8\">\n        <div className=\"text-center py-12\">\n          <AlertCircle className=\"h-16 w-16 text-red-400 mx-auto mb-4\" />\n          <h3 className=\"text-2xl font-bold text-white mb-2\">  </h3>\n          <p className=\"text-blue-300 mb-4\">         </p>\n          <button\n            onClick={() => navigate('/')}\n            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n          >\n             \n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  //  Chat view - ChatLayout handles all chat functionality within the case\n  // NotebookPage components can be integrated into ChatLayout as a future enhancement\n  if (showChatbot) {\n    return (\n      <div className=\"h-screen fixed top-0 left-0 bottom-0 z-[100] bg-slate-900\"\n           style={{ right: sidebarWidth }}>\n        <ChatLayout\n          caseId={caseId}\n          caseName={caseData?.name}\n          analysisResult={analysisResult}\n          onClose={() => closeChatPanel({ updateRoute: true })}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-screen w-full\">\n        <div className=\"p-8 h-full overflow-y-auto\">\n          {/* Server Status Warning */}\n          {!serverStatus.online && !serverStatus.checking && (\n            <div className=\"mb-6 bg-red-500/20 border-2 border-red-500 rounded-xl p-6\">\n              <div className=\"flex items-start gap-4\">\n                <AlertCircle className=\"text-red-400 flex-shrink-0\" size={24} />\n                <div className=\"flex-1\">\n                  <h3 className=\"text-red-200 font-bold text-lg mb-2\">   </h3>\n                  <p className=\"text-red-300 mb-3\">{serverStatus.error}</p>\n                  <button\n                    onClick={async () => {\n                      setServerStatus({ checking: true, online: false, error: null });\n                      const isOnline = await checkServerConnectivity();\n                      if (isOnline) {\n                        loadAnalysisResult();\n                      }\n                    }}\n                    className=\"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all\"\n                  >\n                    {serverStatus.checking ? (\n                      <>\n                        <Loader2 className=\"animate-spin\" size={16} />\n                        <span>...</span>\n                      </>\n                    ) : (\n                      <>\n                        <Activity size={16} />\n                        <span>  </span>\n                      </>\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n      {/* Breadcrumbs */}\n      <Breadcrumbs caseName={caseData?.name} />\n\n      {/* Representation Banner - C9: Non-blocking auto-detection */}\n      {caseData?.case_type !== 'free_chat' && caseId && (\n        <Suspense fallback={null}>\n          <RepresentationBanner caseId={caseId} />\n        </Suspense>\n      )}\n\n      {/* Judge Enrichment Banner - P0 Task 5: Shows judge analytics status */}\n      {caseData?.case_type !== 'free_chat' && caseId && caseData?.status === 'completed' && (\n        <Suspense fallback={null}>\n          <JudgeEnrichmentBanner caseId={caseId} />\n        </Suspense>\n      )}\n\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-8\">\n        <div>\n          <button\n            onClick={() => navigate('/')}\n            className=\"text-blue-300 hover:text-white mb-4 flex items-center gap-2\"\n          >\n              \n          </button>\n          <h1 className=\"text-4xl font-bold text-white mb-2\">{caseData.name}</h1>\n          <div className=\"flex items-center gap-4 flex-wrap\">\n            <p className=\"text-blue-300\">\n              {caseData.status === 'completed' && '  '}\n              {caseData.status === 'ready' && '   -   '}\n              {caseData.status === 'analyzing' && ' ...'}\n              {caseData.status === 'processing' && ' ...'}\n              {caseData.status === 'failed' && '  '}\n            </p>\n\n            {/* Intelligence Status Indicator */}\n            {caseData.status === 'completed' && (\n              <>\n                {hasTier('professional') ? (\n                  // Pro/Enterprise/Admin - Intelligence Active\n                  <span className=\"text-sm px-3 py-1 rounded-lg bg-purple-500/20 text-purple-300 border border-purple-500 font-semibold flex items-center gap-2\">\n                    <Brain size={16} />\n                     \n                  </span>\n                ) : (\n                  // Free/Basic - Intelligence Disabled (clickable to upgrade)\n                  <button\n                    onClick={() =>\n                      openUpgradeModal(\n                        'Intelligence',\n                        '      Professional ',\n                        'professional'\n                      )\n                    }\n                    className=\"text-sm px-3 py-1 rounded-lg bg-gray-600/30 text-gray-400 border border-gray-600 font-semibold flex items-center gap-2 hover:bg-gray-600/50 transition-colors\"\n                    title=\"   Intelligence\"\n                  >\n                    <Brain size={16} />\n                    \n                  </button>\n                )}\n              </>\n            )}\n\n            {analysisResult && (\n              <span className=\"text-sm text-gray-400\">\n                {analysisResult.claims?.length || 0}  \n                {analysisResult.entities?.length || 0} \n              </span>\n            )}\n          </div>\n        </div>\n\n        {/* Action buttons - Redesigned */}\n        <div className=\"flex flex-wrap gap-4\">\n\n          <button\n            onClick={() => openChatPanel({ updateRoute: true })}\n            className=\"flex items-center gap-3 px-6 py-4 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-2xl hover:from-blue-700 hover:to-cyan-700 transition-all shadow-xl hover:shadow-2xl font-bold text-lg transform hover:scale-105\"\n          >\n            <MessageSquare size={24} />\n            <span>  </span>\n          </button>\n\n          <button\n            onClick={() => setShowReanalyzeModal(true)}\n            className=\"flex items-center gap-3 px-6 py-4 bg-gradient-to-r from-amber-600 to-orange-600 text-white rounded-2xl hover:from-amber-700 hover:to-orange-700 transition-all shadow-xl hover:shadow-2xl font-bold text-lg transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed\"\n            disabled={isAnalyzing || caseData.status === 'analyzing'}\n            title=\"      \"\n          >\n            <Activity size={24} />\n            <span> </span>\n          </button>\n\n          <button\n            onClick={() => setShowExportDialog(true)}\n            className=\"flex items-center gap-3 px-6 py-4 bg-gradient-to-r from-slate-700 to-slate-800 text-white rounded-2xl hover:from-slate-800 hover:to-slate-900 transition-all shadow-xl hover:shadow-2xl border border-white/30 font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105\"\n            disabled={!analysisResult || caseData.status !== 'completed'}\n          >\n            <Download size={24} />\n            <span></span>\n          </button>\n        </div>\n      </div>\n\n      {/*  Removed: separate full progress page.\n          Progress is shown inside chat header (AnalysisProgressPanel) after uploads. */}\n\n      {/*  UX-103 FIX: Error Display with Retry */}\n      {error && (\n        <ErrorDisplay\n          error={error}\n          onRetry={() => {\n            setError(null);\n            loadCaseData();\n            loadAnalysisResult();\n          }}\n          onDismiss={() => setError(null)}\n          title=\"  \"\n          className=\"mb-6\"\n        />\n      )}\n\n      {/*  Case Context Warning - Show when parties not defined */}\n      {caseData && (!analysisResult?.entities || analysisResult.entities.length === 0) && caseData.status === 'completed' && (\n        <div className=\"mb-6 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border-2 border-amber-500/50 rounded-2xl p-5\">\n          <div className=\"flex items-start gap-4\">\n            <div className=\"w-12 h-12 bg-amber-500/30 rounded-xl flex items-center justify-center flex-shrink-0\">\n              <span className=\"text-2xl\"></span>\n            </div>\n            <div className=\"flex-1\">\n              <h3 className=\"text-amber-200 font-bold text-lg mb-1\">   </h3>\n              <p className=\"text-amber-100/80 mb-3\">\n                    .      <strong></strong> <strong></strong>,\n                     .\n              </p>\n              <button\n                onClick={() => navigate(`/cases/${caseId}/context`)}\n                className=\"px-4 py-2 bg-amber-500 text-white rounded-lg font-semibold hover:bg-amber-600 transition-all flex items-center gap-2\"\n              >\n                <span>  </span>\n                <span></span>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Main Content -  FIX: Show tabs EVEN during analysis - user can browse existing data */}\n      {/* NOTE: Previously hid tabs during analyzing/processing - this was too aggressive */}\n      {/* User should be able to browse existing results while new documents are being processed */}\n      {caseData && (\n        <>\n          {/* Mode Toggle and Tabs */}\n          <div className=\"mb-6\">\n            {/* Mode Toggle Button with Explanation */}\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-4\">\n                <button\n                  onClick={handleModeToggle}\n                  className={`px-6 py-3 rounded-xl font-bold transition-all flex items-center gap-2 ${\n                    advancedMode\n                      ? 'bg-gradient-to-r from-orange-600 to-red-600 text-white hover:from-orange-700 hover:to-red-700'\n                      : 'bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700'\n                  }`}\n                >\n                  {advancedMode ? (\n                    <>\n                      <Activity size={20} />\n                      <span> </span>\n                    </>\n                  ) : (\n                    <>\n                      <Brain size={20} />\n                      <span> </span>\n                    </>\n                  )}\n                </button>\n\n                {/* Mode Explanation */}\n                <div className={`px-4 py-2 rounded-lg text-sm ${\n                  advancedMode\n                    ? 'bg-orange-500/20 text-orange-200 border border-orange-500/30'\n                    : 'bg-green-500/20 text-green-200 border border-green-500/30'\n                }`}>\n                  {advancedMode ? (\n                    <span> : ,  .     .</span>\n                  ) : (\n                    <span>3  : , '  -   </span>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"text-blue-300 text-sm\">\n                  {advancedMode ? ' ' : ' '}\n              </div>\n            </div>\n\n            {/* Tabs - Grouped (4 primary groups) */}\n            <div className=\"border-b border-white/20\">\n              {advancedMode ? (\n                /* Advanced Mode - Essential Tabs Only */\n                <>\n                  <div className=\"flex items-center gap-2 py-2 overflow-x-auto\">\n                    {[\n                      { id: 'core', label: '', hint: '  ' },\n                      { id: 'intelligence', label: '', hint: '     ' },\n                      { id: 'docs', label: '', hint: ' ' },\n                      { id: 'chat', label: '', hint: '  ' },\n                    ].map((g) => {\n                      const isOpen = activeTabGroup === g.id;\n                      return (\n                        <button\n                          key={g.id}\n                          onClick={() => {\n                            if (g.id === 'chat') {\n                              openChatPanel({ updateRoute: true });\n                              setActiveTab('chat');\n                              setActiveTabGroup(null);\n                              return;\n                            }\n                            setActiveTabGroup((prev) => (prev === g.id ? null : g.id));\n                          }}\n                          className={`px-4 py-2 rounded-full text-sm border transition-all whitespace-nowrap ${\n                            isOpen\n                              ? 'bg-white/10 text-white border-white/20'\n                              : 'bg-white/5 text-white/70 border-white/10 hover:bg-white/10 hover:text-white'\n                          }`}\n                          title={g.hint}\n                        >\n                          {g.label} {isOpen ? <ChevronUp className=\"inline-block ml-1\" size={14} /> : <ChevronDown className=\"inline-block ml-1\" size={14} />}\n                        </button>\n                      );\n                    })}\n                  </div>\n\n                  {activeTabGroup && (\n                    <div className=\"pb-3\">\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2\">\n                        {(() => {\n                          const coreTabs = [\n                            { key: 'conclusions', label: ' ', icon: <ListChecks size={18} />, tooltip: '  +   ', requiresTier: 'free' },\n                            { key: 'executive', label: ' ', icon: <Brain size={18} />, tooltip: '    ', requiresTier: 'free' },\n                          ];\n                          const intelligenceTabs = [\n                            { key: 'intel-overview', label: ' ', icon: null, tooltip: '   ', requiresTier: 'free' },\n                            { key: 'intel-strategy', label: ' ', icon: null, tooltip: ' ', requiresTier: 'professional' },\n                            { key: 'intel-risk', label: ' ', icon: null, tooltip: ' ', requiresTier: 'professional' },\n                            { key: 'intel-counsel', label: '  ', icon: null, tooltip: ' \"  ', requiresTier: 'professional' },\n                            { key: 'intel-forensic', label: ' ', icon: null, tooltip: '  ', requiresTier: 'enterprise' },\n                            { key: 'intel-deep', label: '  ', icon: null, tooltip: ' AI  - ,  , ', requiresTier: 'professional' },\n                            { key: 'legal-notebook', label: ' Legal Notebook', icon: null, tooltip: '  + Action Engine', requiresTier: 'professional' },\n                          ];\n                          const docsTabs = [\n                            { key: 'files', label: ' ', icon: null, count: caseData?.files?.length || 0, tooltip: '  ', requiresTier: 'free' },\n                          ];\n\n                          const tabsForGroup =\n                            activeTabGroup === 'core' ? coreTabs :\n                            activeTabGroup === 'intelligence' ? intelligenceTabs :\n                            activeTabGroup === 'docs' ? docsTabs :\n                            [];\n\n                          return tabsForGroup.map((tabItem) => {\n                            const requiredTier = tabItem.requiresTier || 'free';\n                            const allowed = hasTier(requiredTier);\n                            const isLocked = !allowed;\n                            const lockedHint = requiredTier === 'enterprise'\n                              ? 'Enterprise'\n                              : requiredTier === 'professional'\n                                ? 'Professional'\n                                : 'Basic';\n\n                            return (\n                              <button\n                                key={tabItem.key}\n                                onClick={() => {\n                                  if (isLocked) {\n                                    openUpgradeModal(\n                                      tabItem.label,\n                                      tabItem.tooltip || '    ',\n                                      requiredTier\n                                    );\n                                    return;\n                                  }\n                                  navigate(`/cases/${caseId}/${tabItem.key}`);\n                                  setActiveTab(tabItem.key);\n                                  setActiveTabGroup(null);\n                                }}\n                                title={isLocked ? `${tabItem.tooltip || ''}   ${lockedHint}` : tabItem.tooltip}\n                                className={`flex items-center justify-center gap-2 px-3 py-2 rounded-xl text-sm border transition-all ${\n                                  isLocked\n                                    ? 'bg-white/5 text-white/30 border-white/10'\n                                    : activeTab === tabItem.key\n                                      ? 'bg-purple-600/20 text-white border-purple-500/40'\n                                      : 'bg-white/5 text-white/80 border-white/10 hover:bg-white/10 hover:text-white'\n                                }`}\n                              >\n                                {tabItem.icon}\n                                <span className=\"whitespace-nowrap\">{tabItem.label}</span>\n                                {tabItem.count !== undefined && <span className=\"text-white/50\">({tabItem.count})</span>}\n                                {tabItem.hasData && <span className=\"text-[10px] bg-green-500 px-2 py-0.5 rounded-full\"></span>}\n                                {isLocked && (\n                                  <span className=\"inline-flex items-center gap-1 text-[10px] bg-white/5 border border-white/10 px-2 py-0.5 rounded-full\">\n                                    <Lock size={11} />\n                                    <span>{lockedHint}+</span>\n                                  </span>\n                                )}\n                              </button>\n                            );\n                          });\n                        })()}\n                      </div>\n                    </div>\n                  )}\n                </>\n              ) : (\n                /* Simple Mode - Only 3 Tabs */\n                [\n                  { key: 'conclusions', label: '', icon: <ListChecks size={20} />, tooltip: '  +   ' },\n                  { key: 'chat', label: '  ', icon: <MessageSquare size={20} />, tooltip: '    ' },\n                  { key: 'files', label: '', count: caseData?.files?.length || 0, tooltip: '  ' }\n                ].map((tabItem) => (\n                  <button\n                    key={tabItem.key}\n                    onClick={() => {\n                      if (tabItem.key === 'chat') {\n                        openChatPanel({ updateRoute: true });\n                      } else {\n                        navigate(`/cases/${caseId}/${tabItem.key}`);\n                        setActiveTab(tabItem.key);\n                      }\n                    }}\n                    title={tabItem.tooltip}\n                    className={`px-8 py-4 font-bold transition-all whitespace-nowrap flex items-center gap-3 text-lg ${\n                      activeTab === tabItem.key || (tabItem.key === 'chat' && showChatbot)\n                        ? 'text-white border-b-4 border-purple-500'\n                        : 'text-blue-300 hover:text-white'\n                    }`}\n                  >\n                    {tabItem.icon}\n                    {tabItem.label} {tabItem.count !== undefined && `(${tabItem.count})`}\n                  </button>\n                ))\n              )}\n            </div>\n          </div>\n\n          {/* Tab Content */}\n          <div className=\"mt-6\">\n            <Suspense fallback={<LazyLoadFallback />}>\n            {activeTab === 'conclusions' && (\n              <ConclusionsView\n                caseId={caseId}\n                caseData={caseData}\n                analysisResult={analysisResult || {}}\n                onOpenChat={() => openChatPanel({ updateRoute: true })}\n              />\n            )}\n            {activeTab === 'executive' && (\n              <>\n                {loading && !analysisResult && !caseData ? (\n                  <CasePageSkeleton />\n                ) : (\n                  <ExecutiveDashboard\n                    caseData={caseData}\n                    analysisResult={analysisResult || {}}\n                    executiveSummary={executiveSummary}\n                    intelligenceData={intelligenceData}\n                    userData={userData}\n                    caseId={caseId}\n                    onOpenChat={() => openChatPanel({ updateRoute: true })}\n                  />\n                )}\n              </>\n            )}\n\n            {/* Legacy tabs (players, questions, gaps, strategy, timeline, graph) removed - replaced by forensics system */}\n\n            {/*  Intelligence Pages - 6 separate analysis pages */}\n            {activeTab?.startsWith('intel-') && activeTab !== 'intel-deep' && (\n              <IntelligencePage\n                caseId={caseId}\n                pageType={activeTab.replace('intel-', '')}\n                onNavigateToChat={(prompt) => {\n                  openChatPanel({ updateRoute: true });\n                  // If prompt provided, store it for chat to pick up\n                  if (prompt) {\n                    navigate(`/cases/${caseId}/chat`, {\n                      replace: true,\n                      state: { queuedAction: 'ask', queuedActionPayload: { prompt } }\n                    });\n                  }\n                }}\n              />\n            )}\n\n            {/*  Deep Analysis -    */}\n            {activeTab === 'intel-deep' && (\n              <Suspense fallback={<LazyLoadFallback />}>\n                <DeepAnalysis caseId={caseId} />\n              </Suspense>\n            )}\n\n            {/*  Legal Notebook -   + Action Engine */}\n            {activeTab === 'legal-notebook' && (\n              <Suspense fallback={<LazyLoadFallback />}>\n                <LegalNotebookPanel caseId={caseId} caseName={caseData?.name} />\n              </Suspense>\n            )}\n\n            {activeTab === 'files' && (\n              <FileManager\n                caseId={caseId}\n                caseName={caseData.name}\n                files={caseData.files || []}\n                autoOpenUpload={autoOpenUpload}\n                onFilesUpdate={(result) => {\n                  //  FIX: Non-blocking upload - user can continue working\n\n                  //  FIX: Optimistically update files immediately so UI reflects changes\n                  if (result?.uploaded_files?.length > 0) {\n                    setCaseData(prev => ({\n                      ...prev,\n                      files: [...(prev?.files || []), ...result.uploaded_files]\n                    }));\n                  }\n\n                  if (result?.reanalyzing) {\n                    // Background reload without blocking UI (silent=true prevents loading spinner)\n                    loadCaseData({ silent: true });\n                    //  Show small progress indicator instead of blocking\n                    setIsAnalyzing(true);\n                    //  UX: After upload, move user to chat and show top progress there\n                    openChatPanel({ updateRoute: true });\n                    // Toast notification that analysis is happening in background\n                    toast.info('  !   .     .', {\n                      duration: 5000\n                    });\n                  } else {\n                    loadAnalysisResult();\n                    // Notify that files were updated\n                    toast.success('   ');\n                  }\n                }}\n              />\n            )}\n            </Suspense>\n          </div>\n        </>\n      )}\n\n      {/* Empty State - No Data */}\n      {!loading && !caseData && (\n        <div className=\"text-center py-12\">\n          <AlertCircle className=\"h-16 w-16 text-red-400 mx-auto mb-4\" />\n          <h3 className=\"text-2xl font-bold text-white mb-2\">  </h3>\n          <p className=\"text-blue-300\">\n                 .   .\n          </p>\n        </div>\n      )}\n\n      {/* Empty State - Analyzing */}\n      {(caseData?.status === 'analyzing' || caseData?.status === 'processing') && (\n        <div className=\"text-center py-12\">\n          <Activity className=\"h-16 w-16 text-purple-400 mx-auto mb-4 animate-pulse\" />\n          <h3 className=\"text-2xl font-bold text-white mb-2\">  ...</h3>\n          <p className=\"text-blue-300\">\n                .     .\n          </p>\n        </div>\n      )}\n\n      {/* Export Dialog */}\n      {showExportDialog && (\n        <ExportDialog\n          caseId={caseId}\n          caseName={caseData.name}\n          analysisResult={analysisResult}\n          onClose={() => setShowExportDialog(false)}\n        />\n      )}\n\n      <UpgradeModal\n        isOpen={upgradeModal.isOpen}\n        onClose={closeUpgradeModal}\n        featureName={upgradeModal.featureName}\n        featureDescription={upgradeModal.featureDescription}\n        requiredTier={upgradeModal.requiredTier}\n        currentTier={userData?.subscription_tier}\n      />\n\n      {/* Re-Analyze with Focus Modal */}\n      {showReanalyzeModal && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n          <div className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl border border-white/20 max-w-lg w-full p-6 shadow-2xl\">\n            <div className=\"flex items-center gap-3 mb-6\">\n              <div className=\"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center\">\n                <Activity className=\"text-amber-400\" size={24} />\n              </div>\n              <div>\n                <h2 className=\"text-xl font-bold text-white\"> </h2>\n                <p className=\"text-blue-300 text-sm\">       </p>\n              </div>\n            </div>\n\n            <div className=\"mb-6\">\n              <label className=\"block text-white font-semibold mb-2\">\n                     ?\n              </label>\n              <input\n                type=\"text\"\n                value={reanalyzeFocus}\n                onChange={(e) => setReanalyzeFocus(e.target.value)}\n                placeholder=\": , , ,  ...\"\n                className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent\"\n                dir=\"rtl\"\n              />\n              <p className=\"text-gray-400 text-xs mt-2\">\n                           \n              </p>\n            </div>\n\n            <div className=\"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 mb-6\">\n              <p className=\"text-amber-200 text-sm\">\n                <strong> :</strong>        - , ,\n                    .    .\n              </p>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => {\n                  setShowReanalyzeModal(false);\n                  setReanalyzeFocus('');\n                }}\n                className=\"flex-1 px-4 py-3 bg-white/10 text-white rounded-xl hover:bg-white/20 transition-all font-semibold\"\n              >\n                \n              </button>\n              <button\n                onClick={handleReanalyze}\n                disabled={isReanalyzing || !reanalyzeFocus.trim()}\n                className=\"flex-1 px-4 py-3 bg-gradient-to-r from-amber-600 to-orange-600 text-white rounded-xl hover:from-amber-700 hover:to-orange-700 transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n              >\n                {isReanalyzing ? (\n                  <>\n                    <Loader2 className=\"animate-spin\" size={18} />\n                    <span> ...</span>\n                  </>\n                ) : (\n                  <>\n                    <Activity size={18} />\n                    <span>  </span>\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n        </div>\n    </div>\n  );\n};\n\nexport default CasePage;\n"],"names":["_ref","isOpen","onClose","featureName","featureDescription","requiredTier","currentTier","navigate","useNavigate","targetTier","basic","name","price","features","gradient","professional","enterprise","_jsx","className","dir","children","_jsxs","concat","Lock","size","onClick","X","map","feature","index","Check","handleUpgrade","state","highlightTier","Crown","Info","SEVERITY_CONFIG","label","color","bgClass","barClass","iconClass","min","ClaimSide","claim","source","colorClass","onViewSource","FileText","ExternalLink","_ref2","_score","contradiction","text","isExpanded","setIsExpanded","useState","data","_claim1Match$","_claim2Match$","_source1Match$","_source2Match$","claim1Match","match","claim2Match","source1Match","source2Match","scoreMatch","claim1","trim","claim2","source1","source2","score","parseInt","undefined","parseContradiction","raw","n","Number","isNaN","Math","round","max","normalizeScore","severity_score","severity","getSeverityConfig","t","s","toLowerCase","includes","looksLikeNoContradiction","AlertTriangle","Swords","Zap","type","title","style","width","ChevronUp","ChevronDown","explanation","questions","length","slice","q","i","PATTERNS","date","amount","document","page","ENTITY_STYLES","icon","TYPE_LABELS","EntitySpan","EntityHighlighter","onEntityClick","entities","pattern","Object","entries","lastIndex","exec","push","start","end","sort","a","b","filtered","lastEnd","entity","findEntities","parts","content","entityType","part","MermaidDiagram","lazy","SECTION_TYPES","titleClass","patterns","insight","Lightbulb","recommendation","CheckCircle2","warning","strategy","Target","battle","legal","Scale","strength","Shield","question","HelpCircle","summary","ListChecks","processChildren","Array","isArray","child","CardMarkdownComponents","h1","node","props","_objectWithoutProperties","_excluded","_objectSpread","h2","_excluded2","h3","_ref3","_excluded3","ul","_ref4","_excluded4","ol","_ref5","_excluded5","li","_ref6","_excluded6","p","_ref7","_excluded7","strong","_ref8","_excluded8","em","_ref9","_excluded9","code","_ref0","inline","_excluded0","test","chartCode","String","replace","Suspense","fallback","chart","pre","_ref1","_excluded1","_Fragment","blockquote","_ref10","_excluded10","_ref11","_excluded11","target","rel","table","_ref12","_excluded12","thead","_ref13","_excluded13","tbody","_ref14","_excluded14","tr","_ref15","_excluded15","th","_ref16","_excluded16","td","_ref17","_excluded17","detectSectionType","lowerTitle","config","some","copyToClipboard","async","navigator","clipboard","writeText","_unused","SectionCard","_ref19","section","isLast","Icon","MessageSquare","isIntro","ReactMarkdown","remarkPlugins","remarkGfm","components","Copy","ContradictionCard","_ref18","filename","safeTitle","safe","html","blob","Blob","url","URL","createObjectURL","createElement","href","download","click","revokeObjectURL","downloadWordDoc","Download","_ref20","sections","useMemo","lines","split","currentSection","introContent","line","headerMatch","emojiHeaderMatch","boldHeaderMatch","introText","join","filter","parseResponseIntoSections","id","THINKING_WORDS","ANALYZING_WORDS","LEARNING_WORDS","EXCITED_WORDS","COOKING_WORDS","WORKING_WORDS","INVENTED_WORDS","ALL_WORDS","MOOD_CONFIG","thinking","words","minDelay","maxDelay","waveSpeed","analyzing","learning","excited","cooking","working","weird","MOODS","showText","progress","progressMessage","currentWord","setCurrentWord","mood","setMood","setWaveSpeed","isTransitioning","setIsTransitioning","timeoutRef","useRef","moodTimeoutRef","randomBetween","floor","random","pickRandomWord","currentMood","scheduleNextWord","delay","current","setTimeout","scheduleMoodChange","newMood","clearTimeout","useEffect","hasProgress","height","top","left","transform","background","boxShadow","animation","border","animationDelay","opacity","messageId","caseId","messageContent","onRated","initialRating","showLabel","rating","setRating","hoverRating","setHoverRating","isSubmitting","setIsSubmitting","hasRated","setHasRated","submitRating","useCallback","apiPost","message_id","newRating","message_preview","feedback_type","showErrorToast","toast","success","info","err","logger","error","displayRating","Sparkles","star","handleClick","starValue","onMouseEnter","onMouseLeave","disabled","Star","ratingValue","useActivityLogStore","create","persist","set","isCollapsed","addEntry","entry","ts","Date","now","newEntry","toString","level","message","meta","clear","setCollapsed","collapsed","partialize","SIDE_LABELS","unknown","plaintiff","defendant","petitioner","respondent","appellant","respondent_appeal","respondent_admin","CONFIDENCE_COLORS","low","medium","high","CONFIDENCE_LABELS","RepresentationBanner","onRepresentationChange","compact","representation","setRepresentation","loading","setLoading","resolving","setResolving","showEvidence","setShowEvidence","showSideSelector","setShowSideSelector","autoResolveAttemptedRef","fetchRepresentation","apiGet","console","is_confirmed","guess_side","triggerResolve","confirmRepresentation","side","clientName","response","side_confirmed","client_name","clearRepresentation","apiDelete","isConfirmed","hasGuess","confidence","displaySide","RefreshCw","key","Users","confidenceColor","confidence_level","confidenceLabel","evidence_refs","evidence","signal","quote","getCaseCapabilities","encodeURIComponent","CATEGORY_COLORS","analysis","search","intelligence","reports","interaction","STATUS_UI","available","badge","dot","requires_data","blocked_tier","blocked_quota","coming_soon","DEFAULT_EXAMPLES","claims","contradictions","timeline","disputes","game_theory","risk_assessment","rulings_search","similarity_search","judge_analytics","counsel_analytics","strategy_memo","export","draft_mode","chat","CapabilitiesMenu","onSelectCapability","activeCategory","setActiveCategory","searchQuery","setSearchQuery","setError","payload","setPayload","actionBusy","setActionBusy","showRepresentationPicker","setShowRepresentationPicker","cancelled","res","getAllCapabilities","prev","_res$categories","_res$categories$","categories","e","Error","load","categoriesVM","matches","c","description","example","out","cat","mapped","capabilities","status","name_he","description_he","status_reason_he","tooltip_he","action_label_he","action_url","action_required","action_params","flat","flatMap","flattenCapabilities","grouped","Map","vm","category","get","list","active","find","Search","placeholder","value","onChange","isActive","capability","_STATUS_UI$capability","_STATUS_UI$capability2","_STATUS_UI$capability3","_STATUS_UI$capability4","isAvailable","canAction","isBusy","_capability$action_re","_capability$action_pa","actionRequired","actionParams","analysis_type","capability_id","options","force_refresh","mode","_res$categories2","_res$categories2$","msg","startsWith","runCapabilityAction","stopPropagation","QUICK_ACTIONS","free","prompt","Gavel","pro","BarChart3","premium","QUICK_ACCESS_TABS","requiresTier","ChatPanel","forwardRef","ref","caseName","analysisResult","sessionId","onSessionChange","onPinItem","onAddDocuments","onNewCase","userTier","isPremium","isEnterprise","initialQueuedAction","initialQueuedActionPayload","cases","fetchCases","casesLoading","useCasesStore","addLog","messages","setMessages","historyRefreshKey","setHistoryRefreshKey","input","setInput","isLoading","setIsLoading","streamingText","setStreamingText","streamingProgress","setStreamingProgress","isStreaming","setIsStreaming","feedback","setFeedback","copiedMessageId","setCopiedMessageId","uploadFiles","setUploadFiles","showFreeUploadModal","setShowFreeUploadModal","freeUploadFiles","setFreeUploadFiles","freeUploadName","setFreeUploadName","toLocaleDateString","freeUploading","setFreeUploading","upgradeModalOpen","setUpgradeModalOpen","upgradeModalInfo","setUpgradeModalInfo","casesWithSessions","setCasesWithSessions","loadingCaseSessions","setLoadingCaseSessions","expandedCaseId","setExpandedCaseId","continuationMessageId","setContinuationMessageId","selectedTool","setSelectedTool","caseFiles","setCaseFiles","caseType","setCaseType","selectedFiles","setSelectedFiles","searchInput","setSearchInput","localAnalysis","setLocalAnalysis","analysisLoadedRef","queuedActionRanRef","caseContext","setCaseContext","showPlayersPanel","setShowPlayersPanel","editingPlayers","setEditingPlayers","playersForm","setPlayersForm","judges","myPartyName","myPartyRole","myLawyerName","opposingPartyName","opposingPartyRole","opposingLawyerName","myWitnesses","opposingWitnesses","additionalContext","showCapabilities","setShowCapabilities","caseLifecycleStatus","setCaseLifecycleStatus","messagesEndRef","messagesContainerRef","inputRef","fileInputRef","useImperativeHandle","scrollToMessage","_messagesContainerRef","messageEl","querySelector","scrollIntoView","behavior","block","classList","add","remove","getMessages","triggerCheck","triggerProcessingCheck","enabled","onReady","lastStatusRef","pollingRef","hasShownProcessingToast","checkStatus","_response$analysis_st","_response$analysis_st2","ragStatus","analysis_status","rag_prepare","duration","_response$analysis_st3","_response$analysis_st4","_response$analysis_st5","_response$analysis_st6","filesPrepared","files_prepared","pages","dismiss","clearInterval","debug","setInterval","useDocumentProcessingStatus","fetchCaseLifecycleStatus","_data$case","case","interval","quickActions","hasTier","tierLevels","admin","effectiveTier","_tierLevels$effective","_tierLevels$requiredT","openUpgradeModal","scrollToBottom","_messagesEndRef$curre","arguments","scrollRafRef","_messagesContainerRef2","selectedIds","lastScrollAtRef","isNearBottom","el","scrollHeight","scrollTop","clientHeight","scheduleAutoScroll","cancelAnimationFrame","requestAnimationFrame","handler","evt","k","window","addEventListener","removeEventListener","loadCasesWithSessions","isCancelled","session_id","loadHistory","has_context","context","ctx","j","my_party_name","my_party_role","my_lawyer_name","primary_opposing_party_name","opposing_party_name","primary_opposing_party_role","opposing_party_role","opposing_lawyer_name","my_witnesses","w","opposing_witnesses","additional_context","loadCaseContext","_data$case2","files","ct","case_type","loadFiles","loadAnalysisIfMissing","effectiveAnalysis","toggleFileSelection","file","f","sendMessage","displayText","effectiveCaseId","userMessage","role","timestamp","toISOString","isAdversarial","endpoint","token","useAuthStore","getState","baseUrl","formData","FormData","append","sources","item","JSON","stringify","forEach","actualFile","fetch","method","headers","body","credentials","ok","errorData","json","catch","errorMessage","detail","parse","_unused3","assistantMessage","tool_result","tool_banner","taxonomy_snapshot","is_adversarial","_unused2","reader","getReader","decoder","TextDecoder","fullText","newSessionId","toolResult","toolBanner","documentsUsed","totalDocuments","taxonomySnapshot","sseBuffer","done","read","decode","stream","events","pop","event","chunk","warn","stage","log","documents_used","total_documents","continuation_available","truncated","parseErr","_detail$displayText","buildAnalysisPrompt","actionKey","baseContract","lawyerName","opponentLawyerName","ACTION_DISPLAY_LABELS","executive","issuesmap","forensics","risk","credibility","overview","knowledge","adversarial","contract_analysis","compare_docs","analyze_testimony","cross_exam","semantic_search","simulation","runQueuedAction","tab","riskPrompt","intelPrompt","handleContinue","continue_from","isContinuation","executeTool","tool","_tool$searchQuery","handlePin","needsFiles","needsInput","_unused4","sourceMessageId","result","source_message_id","reason","SOURCE_OPTIONS","action","isLocked","_a$contradictions_cou","_a$disputes_count","hasAttackSignals","contradictions_count","disputes_count","deception_patterns","isPleadingDoc","dt","document_type","doc_type","fn","hasPleadingsSelf","hasPleadingsOpponent","hasAnyClaimDoc","hasOpponentLawyer","handleQuickAction","FolderPlus","Plus","Folder","Loader2","caseItem","_caseItem$sessions","_caseItem$sessions2","case_id","case_name","MessageCircle","sessions","created_at","Calendar","ChevronRight","session","updated_at","_message$meta","_message$meta2","_message$meta3","_message$meta4","_message$meta5","_message$meta6","_message$meta7","_message$meta8","_message$meta9","animationFillMode","auto_summary","version","incremental","SmartResponseRenderer","doc","idx","relevance","uploaded_files","Paperclip","_message$meta0","snap","claims_sample","contradictions_sample","entities_sample","cCount","claims_count","kCount","eCount","entities_count","_c$location","location","_c$location2","_e$location","AlertCircle","Pin","copyMessage","StarRating","WaveLoader","minFiles","onKeyDown","fileItem","currentSource","updateFileSource","newSource","option","removeFile","_","from","filesWithSource","multiple","accept","_fileInputRef$current","shiftKey","preventDefault","ctrlKey","metaKey","lastUserMessage","reverse","m","rows","minHeight","maxHeight","Send","onDemand","Set","has","then","UpgradeModal","displayName","Quote","StickyNote","currentCaseId","currentSessionId","onSessionSelect","onScrollToMessage","setCases","isLoadingCases","setIsLoadingCases","expandedCases","setExpandedCases","caseSessions","setCaseSessions","loadingSessions","setLoadingSessions","loadingFiles","setLoadingFiles","groupedTOC","setGroupedTOC","loadingTOC","setLoadingTOC","showTOC","setShowTOC","expandedTOCGroups","setExpandedTOCGroups","fetchSessions","next","delete","fetchFiles","fetchSessionTOC","toc","createNewSession","formatDate","dateStr","day","month","formatTime","toLocaleTimeString","hour","minute","tocGroupConfig","key_findings","recommendations","summaries","other","Bot","totalTOCEntries","values","reduce","sum","List","groupKey","toggleTOCGroup","group","importance","content_preview","_caseFiles$c$id","_caseFiles$c$id2","isCurrentCase","isLoadingSess","toggleCase","FolderOpen","files_count","isCurrentSession","MessagesSquare","message_count","Clock","PREMIUM_TIERS","DOC_TYPE_OPTIONS","_location$state2","useLocation","showStatistics","setShowStatistics","showCasesSessions","setShowCasesSessions","showCapabilitiesRail","setShowCapabilitiesRail","notebookLayer","setNotebookLayer","showNotebookView","setShowNotebookView","notebookData","useNotebookData","pinnedItems","setPinnedItems","lastSessionStorageKey","setCurrentSessionId","fromUrl","URLSearchParams","fromStorage","localStorage","getItem","showUploadModal","setShowUploadModal","uploading","setUploading","availableCases","setAvailableCases","targetCaseId","setTargetCaseId","subscriptionData","useSubscriptionStore","tier","subscription_tier","isAdmin","handleResize","innerWidth","_location$state","queuedAction","pathname","items","loadPinnedItems","handlePinItem","newItem","handleSessionChange","itemId","setItem","params","chatPanelRef","copied","setCopied","handleJumpToSource","_chatPanelRef$current","handleCopyConversation","_chatPanelRef$current2","handleDownloadConversation","_chatPanelRef$current3","who","handleAddDocuments","ON_DEMAND_TYPES","handleCapabilityClick","capabilityId","_notebookData$capabil","capName","cap","precedents","legal_knowledge","evidence_strength","narrative","gap_analysis","rhetoric_forensics","contract_forensics","witness_credibility","dispatchEvent","CustomEvent","handleSourceClick","sourceId","handleEvidenceClick","alive","loadCasesIfNeeded","handleFileSelect","validExtensions","validFiles","ext","existingNames","newFiles","toFixed","documentType","handleUploadFiles","_availableCases$find","jobId","startUploadJob","totalFiles","documents","canRetry","fileDocTypes","fileSources","opponentLawyerNames","apiUpload","timeoutMs","removeUploadFile","fileName","PanelRightClose","PanelRightOpen","PanelLeftClose","PanelLeftOpen","layer","toUpperCase","Settings","CasesSessionsPanel","selectedCaseId","selectedSessionId","queuedActionPayload","NotebookRail","activeArtifacts","nextActions","onCapabilityClick","onSourceClick","onArtifactClick","NotebookCanvas","currentLayer","layerStatuses","v1Data","v2Data","v3Data","onLayerChange","onEvidenceClick","onClaimClick","claimId","onActorClick","actorId","Upload","opt","newType","v","Trash2","Brain","TAB_SEGMENTS","SEGMENT_LABELS","pathSegments","Boolean","shouldShowSegment","segment","isTabSegment","Link","to","Home","path","getBreadcrumbPath","getBreadcrumbLabel","React","ChevronLeft","ArrowLeft","FileSearch","Handshake","ExportDialog","FileManager","ConclusionsView","ExecutiveDashboard","IntelligencePage","DeepAnalysis","LegalNotebookPanel","JudgeEnrichmentBanner","LazyLoadFallback","CasePage","_analysisResult$claim","_analysisResult$entit","_caseData$files2","useParams","searchParams","useSearchParams","autoOpenUpload","isNewFreeChat","newFreeChat","setActiveCase","setAnalyzing","setGlobalAnalyzing","clearAnalyzing","clearGlobalAnalyzing","useCaseStore","activeTab","setActiveTab","advancedMode","setAdvancedMode","modeTouched","setModeTouched","caseData","setCaseData","setAnalysisResult","loadingCase","setLoadingCase","showExportDialog","setShowExportDialog","showChatbot","setShowChatbot","setAnalysisStatus","isAnalyzing","setIsAnalyzing","prevAnalyzingRef","intelligenceData","setIntelligenceData","executiveSummary","setExecutiveSummary","serverStatus","setServerStatus","checking","online","userData","setUserData","timelineData","setTimelineData","graphData","setGraphData","loadingTimeline","setLoadingTimeline","loadingGraph","setLoadingGraph","sidebarWidth","setSidebarWidth","upgradeModal","setUpgradeModal","activeTabGroup","setActiveTabGroup","showReanalyzeModal","setShowReanalyzeModal","reanalyzeFocus","setReanalyzeFocus","isReanalyzing","setIsReanalyzing","rawUserTier","is_admin","loadAnalysisResult","syncTabRoute","targetTab","openChatWithAction","openChatPanel","updateRoute","closeChatPanel","fallbackTab","toChatAction","counsel","profiler","rag","prototype","hasOwnProperty","call","handleEscape","handleNavigateToTab","redflags","cross","strategies","checkServerConnectivity","controller","AbortController","timeoutId","abort","API_BASE_URL","fetchSubscription","loadUserData","history","replaceState","isOnline","caseResponse","Promise","all","loadExecutiveSummary","init","exists","loadCaseData","silent","retryCount","_data$contradictions","_data$metadata","_data$metadata2","MAX_RETRIES","retry","maxRetries","hasIntelligence","metadata","summaryPayload","executive_summary","loadGraphData","completedCaseId","right","ChatLayout","Activity","Breadcrumbs","ErrorDisplay","onRetry","onDismiss","handleModeToggle","newMode","hint","g","_caseData$files","coreTabs","tooltip","docsTabs","count","tabItem","lockedHint","hasData","onOpenChat","CasePageSkeleton","pageType","onNavigateToChat","onFilesUpdate","_result$uploaded_file","reanalyzing","closeUpgradeModal","fetchWithAuth","focus_topic"],"ignoreList":[],"sourceRoot":""}