/*! For license information please see 5487.d617c334.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5487],{3033:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]])},4669:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},5487:(e,t,s)=>{s.r(t),s.d(t,{CaseAnalyticsPage:()=>Y,default:()=>J});var a=s(5043),l=s(3216),n=s(5475),c=s(2532),r=s(2024),i=s(5692),o=s(7784);const d=(0,o.A)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]);var x=s(9688),m=s(4669),h=s(7719),u=s(1680),p=s(8646),g=s(579);const b={claim:{icon:m.A,color:"text-blue-400",bgColor:"bg-blue-500/20 border-blue-500/30",label:"\u05d8\u05e2\u05e0\u05d4"},contradiction:{icon:h.A,color:"text-amber-400",bgColor:"bg-amber-500/20 border-amber-500/30",label:"\u05e1\u05ea\u05d9\u05e8\u05d4"},evidence:{icon:u.A,color:"text-green-400",bgColor:"bg-green-500/20 border-green-500/30",label:"\u05e8\u05d0\u05d9\u05d4"},document:{icon:u.A,color:"text-purple-400",bgColor:"bg-purple-500/20 border-purple-500/30",label:"\u05de\u05e1\u05de\u05da"},statement:{icon:m.A,color:"text-cyan-400",bgColor:"bg-cyan-500/20 border-cyan-500/30",label:"\u05e2\u05d3\u05d5\u05ea"}},j={critical:"border-red-500",high:"border-orange-500",medium:"border-yellow-500",low:"border-gray-500"};function v(e){try{return new Date(e).toLocaleDateString("he-IL",{day:"numeric",month:"short",year:"numeric"})}catch(t){return e}}function N(e){try{const[t,s]=e.split("-");return new Date(parseInt(t),parseInt(s)-1).toLocaleDateString("he-IL",{month:"long",year:"numeric"})}catch(t){return e}}const f=e=>{let{event:t,onClick:s}=e;const a=b[t.type],l=a.icon,n=t.severity?j[t.severity]:"";return(0,g.jsx)("button",{onClick:s,className:"\n        w-full text-right p-3 rounded-lg border transition-all\n        hover:scale-[1.02] hover:shadow-lg\n        ".concat(a.bgColor,"\n        ").concat(n?"border-r-4 ".concat(n):"","\n      "),children:(0,g.jsxs)("div",{className:"flex items-start gap-3",children:[(0,g.jsx)("div",{className:"p-2 rounded-lg bg-slate-800/50 ".concat(a.color),children:(0,g.jsx)(l,{className:"w-4 h-4"})}),(0,g.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,g.jsx)("span",{className:"text-xs font-medium ".concat(a.color),children:a.label}),(0,g.jsx)("span",{className:"text-[10px] text-white/40",children:v(t.date)})]}),(0,g.jsx)("h4",{className:"text-sm font-medium text-white truncate",children:t.title}),t.description&&(0,g.jsx)("p",{className:"text-xs text-white/60 mt-1 line-clamp-2",children:t.description})]})]})})},w=e=>{let{monthKey:t,events:s,onEventClick:l}=e;const n=(0,a.useMemo)(()=>[...s].sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),[s]);return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsxs)("div",{className:"sticky top-0 z-10 flex items-center gap-3 mb-4 bg-slate-900/95 py-2",children:[(0,g.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500 border-2 border-slate-900"}),(0,g.jsx)("h3",{className:"text-sm font-semibold text-white",children:N(t)}),(0,g.jsxs)("span",{className:"text-xs text-white/40",children:["(",s.length," \u05d0\u05d9\u05e8\u05d5\u05e2\u05d9\u05dd)"]})]}),(0,g.jsx)("div",{className:"mr-6 pr-4 border-r-2 border-slate-700 space-y-3",children:n.map(e=>(0,g.jsx)(f,{event:e,onClick:()=>null===l||void 0===l?void 0:l(e)},e.id))})]})},y=e=>{let{activeFilters:t,onToggle:s,eventCounts:a}=e;return(0,g.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.keys(b).map(e=>{const l=b[e],n=a[e]||0,c=t.has(e);return(0,g.jsxs)("button",{onClick:()=>s(e),className:"\n              flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium\n              border transition-all\n              ".concat(c?"".concat(l.bgColor," ").concat(l.color):"bg-slate-800/50 text-white/40 border-slate-700 hover:text-white/60","\n            "),children:[(0,g.jsx)("span",{children:l.label}),(0,g.jsx)("span",{className:"px-1.5 py-0.5 rounded text-[10px] ".concat(c?"bg-white/10":"bg-slate-700"),children:n})]},e)})})},k=e=>{let{events:t,onEventClick:s,className:l=""}=e;const[n,c]=(0,a.useState)(new Set(Object.keys(b))),r=(0,a.useCallback)(e=>{c(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),i=(0,a.useMemo)(()=>{const e={claim:0,contradiction:0,evidence:0,document:0,statement:0};return t.forEach(t=>{e[t.type]=(e[t.type]||0)+1}),e},[t]),o=(0,a.useMemo)(()=>t.filter(e=>n.has(e.type)),[t,n]),d=(0,a.useMemo)(()=>function(e){const t=new Map;return e.forEach(e=>{try{const s=new Date(e.date),a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0")),l=t.get(a)||[];t.set(a,[...l,e])}catch(s){}}),new Map([...t.entries()].sort((e,t)=>e[0].localeCompare(t[0])))}(o),[o]);return 0===t.length?(0,g.jsx)("div",{className:"flex items-center justify-center h-64 ".concat(l),children:(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)(p.A,{className:"w-12 h-12 text-white/20 mx-auto mb-3"}),(0,g.jsx)("p",{className:"text-white/40 text-sm",children:"\u05d0\u05d9\u05df \u05d0\u05d9\u05e8\u05d5\u05e2\u05d9\u05dd \u05dc\u05ea\u05e6\u05d5\u05d2\u05d4"})]})}):(0,g.jsxs)("div",{className:"flex flex-col h-full ".concat(l),dir:"rtl",children:[(0,g.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800/50",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,g.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,g.jsx)(p.A,{className:"w-5 h-5 text-blue-400"}),"\u05e6\u05d9\u05e8 \u05d6\u05de\u05df"]}),(0,g.jsxs)("span",{className:"text-xs text-white/40",children:[o.length," \u05de\u05ea\u05d5\u05da ",t.length," \u05d0\u05d9\u05e8\u05d5\u05e2\u05d9\u05dd"]})]}),(0,g.jsx)(y,{activeFilters:n,onToggle:r,eventCounts:i})]}),(0,g.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-8",children:Array.from(d.entries()).map(e=>{let[t,a]=e;return(0,g.jsx)(w,{monthKey:t,events:a,onEventClick:s},t)})})]})};var C=s(3165),M=s(2382);const A=[{min:0,max:0,color:"bg-slate-700",label:"\u05e8\u05d9\u05e7"},{min:1,max:2,color:"bg-green-900/60",label:"\u05de\u05e2\u05d8"},{min:3,max:5,color:"bg-yellow-900/60",label:"\u05d1\u05d9\u05e0\u05d5\u05e0\u05d9"},{min:6,max:9,color:"bg-orange-900/60",label:"\u05d2\u05d1\u05d5\u05d4"},{min:10,max:1/0,color:"bg-red-900/60",label:"\u05d7\u05dd \u05de\u05d0\u05d5\u05d3"}];function I(e){const t=A.find(t=>e>=t.min&&e<=t.max);return(null===t||void 0===t?void 0:t.label)||"\u05dc\u05d0 \u05d9\u05d3\u05d5\u05e2"}const S=e=>{let{pageData:t,documentId:s,onClick:l}=e;const[n,c]=(0,a.useState)(!1),r=function(e){const t=A.find(t=>e>=t.min&&e<=t.max);return(null===t||void 0===t?void 0:t.color)||"bg-slate-700"}(t.totalScore);return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)("button",{onClick:l,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),className:"\n          w-8 h-8 rounded text-[10px] font-medium\n          flex items-center justify-center\n          transition-all hover:scale-110 hover:z-10\n          border border-slate-600/50\n          ".concat(r,"\n          ").concat(t.contradictionCount>0?"ring-1 ring-amber-500/50":"","\n        "),children:t.page}),n&&(0,g.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-20",children:(0,g.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-2 shadow-xl min-w-[120px]",children:[(0,g.jsxs)("div",{className:"text-xs font-medium text-white mb-1",children:["\u05e2\u05de\u05d5\u05d3 ",t.page]}),(0,g.jsxs)("div",{className:"space-y-1",children:[t.evidenceCount>0&&(0,g.jsxs)("div",{className:"flex items-center justify-between text-[10px]",children:[(0,g.jsx)("span",{className:"text-green-400",children:"\u05e8\u05d0\u05d9\u05d5\u05ea"}),(0,g.jsx)("span",{className:"text-white",children:t.evidenceCount})]}),t.contradictionCount>0&&(0,g.jsxs)("div",{className:"flex items-center justify-between text-[10px]",children:[(0,g.jsx)("span",{className:"text-amber-400",children:"\u05e1\u05ea\u05d9\u05e8\u05d5\u05ea"}),(0,g.jsx)("span",{className:"text-white",children:t.contradictionCount})]}),t.claimCount>0&&(0,g.jsxs)("div",{className:"flex items-center justify-between text-[10px]",children:[(0,g.jsx)("span",{className:"text-blue-400",children:"\u05d8\u05e2\u05e0\u05d5\u05ea"}),(0,g.jsx)("span",{className:"text-white",children:t.claimCount})]})]}),(0,g.jsx)("div",{className:"mt-1 pt-1 border-t border-slate-600",children:(0,g.jsx)("div",{className:"text-[9px] text-white/50",children:I(t.totalScore)})})]})})]})},E=e=>{let{document:t,onPageClick:s,isExpanded:l,onToggle:n}=e;const c=(0,a.useMemo)(()=>{const e=new Map;return t.pageData.forEach(t=>e.set(t.page,t)),e},[t.pageData]),r=(0,a.useMemo)(()=>({total:t.pageData.reduce((e,t)=>e+t.totalScore,0),contradictions:t.pageData.reduce((e,t)=>e+t.contradictionCount,0),evidence:t.pageData.reduce((e,t)=>e+t.evidenceCount,0)}),[t.pageData]),i=(0,a.useMemo)(()=>Array.from({length:t.totalPages},(e,t)=>t+1),[t.totalPages]);return(0,g.jsxs)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:[(0,g.jsxs)("button",{onClick:n,className:"w-full flex items-center justify-between px-4 py-3 bg-slate-800/50 hover:bg-slate-800 transition-colors",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)(u.A,{className:"w-4 h-4 text-white/60"}),(0,g.jsx)("span",{className:"text-sm font-medium text-white truncate max-w-[200px]",children:t.documentName}),(0,g.jsxs)("span",{className:"text-xs text-white/40",children:[t.totalPages," \u05e2\u05de\u05d5\u05d3\u05d9\u05dd"]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[r.contradictions>0&&(0,g.jsxs)("span",{className:"flex items-center gap-1 text-xs text-amber-400 bg-amber-500/10 px-2 py-0.5 rounded",children:[(0,g.jsx)(h.A,{className:"w-3 h-3"}),r.contradictions]}),r.evidence>0&&(0,g.jsxs)("span",{className:"flex items-center gap-1 text-xs text-green-400 bg-green-500/10 px-2 py-0.5 rounded",children:[(0,g.jsx)(C.A,{className:"w-3 h-3"}),r.evidence]})]}),(0,g.jsx)(M.A,{className:"w-4 h-4 text-white/40 transition-transform ".concat(l?"rotate-180":"")})]})]}),l&&(0,g.jsx)("div",{className:"p-4 bg-slate-900/50",children:(0,g.jsx)("div",{className:"flex flex-wrap gap-1",children:i.map(e=>{const a=c.get(e)||{page:e,evidenceCount:0,contradictionCount:0,claimCount:0,totalScore:0};return(0,g.jsx)(S,{pageData:a,documentId:t.documentId,onClick:()=>null===s||void 0===s?void 0:s(e)},e)})})})]})},D=()=>(0,g.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,g.jsx)("span",{className:"text-xs text-white/50",children:"\u05e6\u05e4\u05d9\u05e4\u05d5\u05ea:"}),A.map((e,t)=>(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.jsx)("div",{className:"w-4 h-4 rounded ".concat(e.color," border border-slate-600/50")}),(0,g.jsx)("span",{className:"text-[10px] text-white/40",children:e.label})]},t))]}),P=e=>{let{documents:t,onPageClick:s,className:l=""}=e;const[n,c]=(0,a.useState)(new Set(t.slice(0,1).map(e=>e.documentId)));return 0===t.length?(0,g.jsx)("div",{className:"flex items-center justify-center h-64 ".concat(l),children:(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)(u.A,{className:"w-12 h-12 text-white/20 mx-auto mb-3"}),(0,g.jsx)("p",{className:"text-white/40 text-sm",children:"\u05d0\u05d9\u05df \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05dc\u05ea\u05e6\u05d5\u05d2\u05d4"})]})}):(0,g.jsxs)("div",{className:"flex flex-col h-full ".concat(l),dir:"rtl",children:[(0,g.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800/50",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,g.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,g.jsx)(C.A,{className:"w-5 h-5 text-purple-400"}),"\u05de\u05e4\u05ea \u05d7\u05d5\u05dd \u05de\u05e1\u05de\u05db\u05d9\u05dd"]}),(0,g.jsxs)("span",{className:"text-xs text-white/40",children:[t.length," \u05de\u05e1\u05de\u05db\u05d9\u05dd"]})]}),(0,g.jsx)(D,{})]}),(0,g.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.map(e=>(0,g.jsx)(E,{document:e,onPageClick:t=>null===s||void 0===s?void 0:s(e.documentId,t),isExpanded:n.has(e.documentId),onToggle:()=>{return t=e.documentId,void c(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t}},e.documentId))})]})};var _=s(9379),z=s(3033);const T=["bg-blue-500","bg-green-500","bg-amber-500","bg-purple-500","bg-cyan-500","bg-pink-500","bg-red-500","bg-orange-500"],L=e=>{let{data:t,showPercentage:s,showValues:l,maxBars:n}=e;const c=(0,a.useMemo)(()=>t.reduce((e,t)=>e+t.value,0),[t]),r=(0,a.useMemo)(()=>Math.max(...t.map(e=>e.value)),[t]),i=t.slice(0,n),o=t.length-n,d=t.slice(n).reduce((e,t)=>e+t.value,0);return(0,g.jsxs)("div",{className:"space-y-3",children:[i.map((e,t)=>{const a=c>0?e.value/c*100:0,n=r>0?e.value/r*100:0,i=e.color||T[t%T.length];return(0,g.jsxs)("div",{className:"space-y-1",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("span",{className:"text-sm text-white/80 truncate flex-1",children:e.label}),(0,g.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[l&&(0,g.jsx)("span",{className:"text-white",children:e.value}),s&&(0,g.jsxs)("span",{className:"text-white/40",children:["(",a.toFixed(0),"%)"]})]})]}),(0,g.jsx)("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,g.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ".concat(i),style:{width:"".concat(n,"%")}})})]},e.label)}),o>0&&(0,g.jsxs)("div",{className:"text-xs text-white/40 pt-2 border-t border-slate-700",children:["\u05d5\u05e2\u05d5\u05d3 ",o," \u05e4\u05e8\u05d9\u05d8\u05d9\u05dd (",d," \u05d1\u05e1\u05d4\u05f4\u05db)"]})]})},V=e=>{let{data:t,showPercentage:s,showValues:l}=e;const n=(0,a.useMemo)(()=>t.reduce((e,t)=>e+t.value,0),[t]),c=(0,a.useMemo)(()=>{let e=0;return t.map((t,s)=>{const a=n>0?t.value/n*100:0,l=a/100*360,c=e;return e+=l,(0,_.A)((0,_.A)({},t),{},{percentage:a,startAngle:c,endAngle:c+l,color:t.color||T[s%T.length]})})},[t,n]),r=(e,t,s,a)=>{const l=(e-90)*Math.PI/180,n=(t-90)*Math.PI/180,c=50+a*Math.cos(l),r=50+a*Math.sin(l),i=50+a*Math.cos(n),o=50+a*Math.sin(n),d=50+s*Math.cos(n),x=50+s*Math.sin(n),m=50+s*Math.cos(l),h=50+s*Math.sin(l),u=t-e>180?1:0;return"\n      M ".concat(c," ").concat(r,"\n      A ").concat(a," ").concat(a," 0 ").concat(u," 1 ").concat(i," ").concat(o,"\n      L ").concat(d," ").concat(x,"\n      A ").concat(s," ").concat(s," 0 ").concat(u," 0 ").concat(m," ").concat(h,"\n      Z\n    ")};return(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsxs)("div",{className:"relative w-32 h-32 flex-shrink-0",children:[(0,g.jsx)("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:c.map((e,t)=>(0,g.jsx)("path",{d:r(e.startAngle,e.endAngle,25,40),className:e.color.replace("bg-","fill-"),stroke:"rgb(15 23 42)",strokeWidth:"1"},t))}),(0,g.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"text-lg font-bold text-white",children:n}),(0,g.jsx)("div",{className:"text-[10px] text-white/40",children:"\u05e1\u05d4\u05f4\u05db"})]})})]}),(0,g.jsxs)("div",{className:"flex-1 space-y-2",children:[c.slice(0,6).map((e,t)=>(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsx)("div",{className:"w-3 h-3 rounded-sm flex-shrink-0 ".concat(e.color)}),(0,g.jsx)("span",{className:"text-xs text-white/80 truncate flex-1",children:e.label}),(0,g.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[l&&(0,g.jsx)("span",{className:"text-white",children:e.value}),s&&(0,g.jsxs)("span",{className:"text-white/40",children:["(",e.percentage.toFixed(0),"%)"]})]})]},t)),c.length>6&&(0,g.jsxs)("div",{className:"text-[10px] text-white/40",children:["\u05d5\u05e2\u05d5\u05d3 ",c.length-6," \u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d5\u05ea..."]})]})]})},F=e=>{let{title:t,data:s,type:l="horizontal-bar",showPercentage:n=!0,showValues:c=!0,maxBars:r=8,className:i=""}=e;const o=(0,a.useMemo)(()=>[...s].sort((e,t)=>t.value-e.value),[s]),x=(0,a.useMemo)(()=>s.reduce((e,t)=>e+t.value,0),[s]),m="donut"===l?z.A:d;return 0===s.length?(0,g.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg ".concat(i),children:[(0,g.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,g.jsx)(m,{className:"w-5 h-5 text-white/40"}),(0,g.jsx)("h3",{className:"text-sm font-medium text-white",children:t})]}),(0,g.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,g.jsx)("p",{className:"text-white/40 text-sm",children:"\u05d0\u05d9\u05df \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd \u05dc\u05ea\u05e6\u05d5\u05d2\u05d4"})})]}):(0,g.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg ".concat(i),dir:"rtl",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsx)(m,{className:"w-5 h-5 text-purple-400"}),(0,g.jsx)("h3",{className:"text-sm font-medium text-white",children:t})]}),(0,g.jsxs)("span",{className:"text-xs text-white/40",children:[x," \u05e1\u05d4\u05f4\u05db"]})]}),"donut"===l?(0,g.jsx)(V,{data:o,showPercentage:n,showValues:c}):(0,g.jsx)(L,{data:o,showPercentage:n,showValues:c,maxBars:r})]})},O=(0,o.A)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var q=s(8326),B=s(9463);const K={strong:{color:"text-green-400",bgColor:"bg-green-500/30",label:"\u05d7\u05d6\u05e7"},medium:{color:"text-yellow-400",bgColor:"bg-yellow-500/30",label:"\u05d1\u05d9\u05e0\u05d5\u05e0\u05d9"},weak:{color:"text-orange-400",bgColor:"bg-orange-500/20",label:"\u05d7\u05dc\u05e9"},none:{color:"text-white/20",bgColor:"bg-slate-700/30",label:"\u05d0\u05d9\u05df"}},Z={supports:{symbol:"\u2713",color:"text-green-400"},contradicts:{symbol:"\u2717",color:"text-red-400"},mentions:{symbol:"\u2022",color:"text-blue-400"}},G=e=>{let{relationship:t,onClick:s}=e;const[l,n]=(0,a.useState)(!1),c=(null===t||void 0===t?void 0:t.strength)||"none",r=K[c],i=null!==t&&void 0!==t&&t.type?Z[t.type]:null;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)("button",{onClick:s,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),className:"\n          w-10 h-10 flex items-center justify-center\n          border border-slate-700/50 transition-all\n          hover:scale-110 hover:z-10 hover:shadow-lg\n          ".concat(r.bgColor,"\n        "),children:i?(0,g.jsx)("span",{className:"text-sm font-bold ".concat(i.color),children:i.symbol}):"none"!==c?(0,g.jsx)("span",{className:"text-lg ".concat(r.color),children:"\u25cf"}):(0,g.jsx)("span",{className:"text-white/10",children:"-"})}),l&&t&&"none"!==t.strength&&(0,g.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-20",children:(0,g.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-2 shadow-xl min-w-[100px] text-center",children:[(0,g.jsx)("div",{className:"text-xs font-medium ".concat(r.color),children:r.label}),t.type&&(0,g.jsxs)("div",{className:"text-[10px] text-white/50 mt-1",children:["supports"===t.type&&"\u05ea\u05d5\u05de\u05da","contradicts"===t.type&&"\u05e1\u05d5\u05ea\u05e8","mentions"===t.type&&"\u05de\u05d5\u05d6\u05db\u05e8"]}),t.details&&(0,g.jsx)("div",{className:"text-[10px] text-white/40 mt-1 max-w-[150px] truncate",children:t.details})]})})]})},H=()=>(0,g.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,g.jsx)("span",{className:"text-xs text-white/50",children:"\u05e2\u05d5\u05e6\u05de\u05ea \u05e7\u05e9\u05e8:"}),Object.entries(K).filter(e=>{let[t]=e;return"none"!==t}).map(e=>{let[t,s]=e;return(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.jsx)("div",{className:"w-4 h-4 rounded ".concat(s.bgColor)}),(0,g.jsx)("span",{className:"text-[10px] text-white/40",children:s.label})]},t)}),(0,g.jsx)("div",{className:"w-px h-4 bg-slate-600"}),(0,g.jsx)("span",{className:"text-xs text-white/50",children:"\u05e1\u05d5\u05d2:"}),Object.entries(Z).map(e=>{let[t,s]=e;return(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.jsx)("span",{className:"text-sm font-bold ".concat(s.color),children:s.symbol}),(0,g.jsxs)("span",{className:"text-[10px] text-white/40",children:["supports"===t&&"\u05ea\u05d5\u05de\u05da","contradicts"===t&&"\u05e1\u05d5\u05ea\u05e8","mentions"===t&&"\u05de\u05d5\u05d6\u05db\u05e8"]})]},t)})]}),W=e=>{let{data:t,onCellClick:s,className:l=""}=e;const[n,c]=(0,a.useState)(0),[r,i]=(0,a.useState)(0),o=(0,a.useMemo)(()=>{const e=new Map;return t.relationships.forEach(t=>{e.set("".concat(t.claimId,"-").concat(t.entityId),t)}),e},[t.relationships]),d=(0,a.useMemo)(()=>t.claims.slice(n,n+8),[t.claims,n]),x=(0,a.useMemo)(()=>t.entities.slice(r,r+6),[t.entities,r]),m=(0,a.useMemo)(()=>{const e={supports:0,contradicts:0,mentions:0},s={strong:0,medium:0,weak:0};return t.relationships.forEach(t=>{t.type&&void 0!==e[t.type]&&e[t.type]++,"none"!==t.strength&&void 0!==s[t.strength]&&s[t.strength]++}),{byType:e,byStrength:s,total:t.relationships.length}},[t.relationships]);return 0===t.claims.length||0===t.entities.length?(0,g.jsx)("div",{className:"flex items-center justify-center h-64 ".concat(l),children:(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)(O,{className:"w-12 h-12 text-white/20 mx-auto mb-3"}),(0,g.jsx)("p",{className:"text-white/40 text-sm",children:"\u05d0\u05d9\u05df \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd \u05dc\u05ea\u05e6\u05d5\u05d2\u05d4"})]})}):(0,g.jsxs)("div",{className:"flex flex-col h-full ".concat(l),dir:"rtl",children:[(0,g.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800/50",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,g.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,g.jsx)(O,{className:"w-5 h-5 text-cyan-400"}),"\u05de\u05d8\u05e8\u05d9\u05e6\u05ea \u05d8\u05e2\u05e0\u05d5\u05ea-\u05d9\u05e9\u05d5\u05d9\u05d5\u05ea"]}),(0,g.jsxs)("div",{className:"flex items-center gap-3 text-xs text-white/40",children:[(0,g.jsxs)("span",{children:[t.claims.length," \u05d8\u05e2\u05e0\u05d5\u05ea"]}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsxs)("span",{children:[t.entities.length," \u05d9\u05e9\u05d5\u05d9\u05d5\u05ea"]}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsxs)("span",{children:[m.total," \u05e7\u05e9\u05e8\u05d9\u05dd"]})]})]}),(0,g.jsx)(H,{})]}),(0,g.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,g.jsxs)("div",{className:"inline-block min-w-full",children:[(0,g.jsxs)("div",{className:"flex",children:[(0,g.jsx)("div",{className:"w-32 h-10 flex-shrink-0"}),r>0&&(0,g.jsx)("button",{onClick:()=>i(Math.max(0,r-6)),className:"w-10 h-10 flex items-center justify-center text-white/40 hover:text-white hover:bg-slate-700/50 rounded",children:(0,g.jsx)(q.A,{className:"w-4 h-4"})}),x.map(e=>(0,g.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,g.jsx)("span",{className:"text-[9px] text-white/60 font-medium truncate rotate-[-45deg] whitespace-nowrap max-w-[60px]",title:e.label,children:e.label})},e.id)),r+6<t.entities.length&&(0,g.jsx)("button",{onClick:()=>i(r+6),className:"w-10 h-10 flex items-center justify-center text-white/40 hover:text-white hover:bg-slate-700/50 rounded",children:(0,g.jsx)(B.A,{className:"w-4 h-4"})})]}),n>0&&(0,g.jsx)("div",{className:"flex items-center",children:(0,g.jsx)("button",{onClick:()=>c(Math.max(0,n-8)),className:"w-32 h-6 flex items-center justify-center text-white/40 hover:text-white text-xs",children:"\u2191 \u05d8\u05e2\u05e0\u05d5\u05ea \u05e7\u05d5\u05d3\u05de\u05d5\u05ea"})}),d.map(e=>(0,g.jsxs)("div",{className:"flex items-center",children:[(0,g.jsx)("div",{className:"w-32 h-10 flex items-center pr-2 flex-shrink-0",children:(0,g.jsx)("span",{className:"text-xs text-white/80 truncate",title:e.label,children:e.label})}),r>0&&(0,g.jsx)("div",{className:"w-10 h-10"}),x.map(t=>(0,g.jsx)(G,{relationship:o.get("".concat(e.id,"-").concat(t.id)),onClick:()=>null===s||void 0===s?void 0:s(e.id,t.id)},"".concat(e.id,"-").concat(t.id)))]},e.id)),n+8<t.claims.length&&(0,g.jsx)("div",{className:"flex items-center",children:(0,g.jsxs)("button",{onClick:()=>c(n+8),className:"w-32 h-6 flex items-center justify-center text-white/40 hover:text-white text-xs",children:["\u2193 \u05d8\u05e2\u05e0\u05d5\u05ea \u05e0\u05d5\u05e1\u05e4\u05d5\u05ea (",t.claims.length-n-8,")"]})})]})}),(0,g.jsx)("div",{className:"px-4 py-2 border-t border-slate-700 bg-slate-800/30",children:(0,g.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsx)("span",{className:"text-white/50",children:"\u05e1\u05d9\u05db\u05d5\u05dd:"}),(0,g.jsxs)("span",{className:"text-green-400",children:[m.byType.supports," \u05ea\u05d5\u05de\u05db\u05d9\u05dd"]}),(0,g.jsxs)("span",{className:"text-red-400",children:[m.byType.contradicts," \u05e1\u05d5\u05ea\u05e8\u05d9\u05dd"]}),(0,g.jsxs)("span",{className:"text-blue-400",children:[m.byType.mentions," \u05de\u05d5\u05d6\u05db\u05e8\u05d9\u05dd"]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsxs)("span",{className:"text-white/40",children:["\u05d7\u05d6\u05e7: ",m.byStrength.strong]}),(0,g.jsxs)("span",{className:"text-white/40",children:["\u05d1\u05d9\u05e0\u05d5\u05e0\u05d9: ",m.byStrength.medium]}),(0,g.jsxs)("span",{className:"text-white/40",children:["\u05d7\u05dc\u05e9: ",m.byStrength.weak]})]})]})})]})};function Y(){const{caseId:e}=(0,l.g)(),t=(0,l.Zp)(),{data:s,isLoading:o}=(0,c.I)({queryKey:["case",e],queryFn:()=>(0,x.apiGet)("/api/cases/".concat(e)),enabled:!!e}),m=(0,a.useMemo)(()=>{if(!s)return[];const e=[];return(s.claims||[]).forEach((t,s)=>{var a;(t.date||t.created_at)&&e.push({id:"claim-".concat(s),date:t.date||t.created_at,title:(null===(a=t.text)||void 0===a?void 0:a.substring(0,100))||"\u05d8\u05e2\u05e0\u05d4",type:"claim",sourceId:t.source_id})}),(s.contradictions||[]).forEach((t,s)=>{e.push({id:"contradiction-".concat(s),date:t.detected_at||(new Date).toISOString(),title:t.description||"\u05e1\u05ea\u05d9\u05e8\u05d4",type:"contradiction",severity:t.severity})}),(s.timeline||[]).forEach((t,s)=>{e.push({id:"timeline-".concat(s),date:t.date||t.timestamp,title:t.description||t.text,type:"evidence"})}),e},[s]),h=(0,a.useMemo)(()=>null!==s&&void 0!==s&&s.files_data?(s.files_data||[]).map(e=>{const t=[],a=e.pages||e.page_count||10;for(let l=1;l<=a;l++){const a=(s.claims||[]).filter(t=>t.source_id===e.id&&t.page===l).length,n=(s.contradictions||[]).filter(t=>t.source_a===e.id&&t.page_a===l||t.source_b===e.id&&t.page_b===l).length;t.push({page:l,evidenceCount:a,contradictionCount:n,claimCount:a,totalScore:a+2*n})}return{documentId:e.id,documentName:e.name||e.filename,totalPages:a,pageData:t}}):[],[s]),u=(0,a.useMemo)(()=>{if(null===s||void 0===s||!s.claims)return[];const e={};return(s.claims||[]).forEach(t=>{const s=t.type||t.category||"\u05db\u05dc\u05dc\u05d9";e[s]=(e[s]||0)+1}),Object.entries(e).map(e=>{let[t,s]=e;return{label:t,value:s}})},[s]),p=(0,a.useMemo)(()=>{if(null===s||void 0===s||!s.contradictions)return[];const e={critical:0,high:0,medium:0,low:0};return(s.contradictions||[]).forEach(t=>{const s=t.severity||"medium";e[s]=(e[s]||0)+1}),[{label:"\u05e7\u05e8\u05d9\u05d8\u05d9",value:e.critical,color:"bg-red-500"},{label:"\u05d2\u05d1\u05d5\u05d4",value:e.high,color:"bg-orange-500"},{label:"\u05d1\u05d9\u05e0\u05d5\u05e0\u05d9",value:e.medium,color:"bg-yellow-500"},{label:"\u05e0\u05de\u05d5\u05da",value:e.low,color:"bg-gray-500"}].filter(e=>e.value>0)},[s]),b=(0,a.useMemo)(()=>{if(!s)return{claims:[],entities:[],relationships:[]};const e=(s.claims||[]).slice(0,20).map((e,t)=>{var s;return{id:"claim-".concat(t),label:(null===(s=e.text)||void 0===s?void 0:s.substring(0,30))||"\u05d8\u05e2\u05e0\u05d4 ".concat(t+1)}}),t=(s.entities||[]).slice(0,15).map((e,t)=>({id:"entity-".concat(t),label:e.name||"\u05d9\u05e9\u05d5\u05ea ".concat(t+1)})),a=[];return e.forEach((e,s)=>{t.forEach((t,l)=>{(s+l)%3===0&&a.push({claimId:e.id,entityId:t.id,strength:(s+l)%5===0?"strong":"medium",type:(s+l)%4===0?"supports":"mentions"})})}),{claims:e,entities:t,relationships:a}},[s]);return o?(0,g.jsx)("div",{className:"h-full flex items-center justify-center bg-slate-950",children:(0,g.jsx)(r.A,{className:"w-8 h-8 text-blue-400 animate-spin"})}):(0,g.jsxs)("div",{className:"h-full flex flex-col bg-slate-950",dir:"rtl",children:[(0,g.jsx)("div",{className:"px-6 py-4 border-b border-slate-800 bg-slate-900",children:(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsx)(n.N_,{to:"/cases/".concat(e),className:"p-2 text-white/60 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,g.jsx)(i.A,{className:"w-5 h-5"})}),(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"p-2 bg-purple-600/20 rounded-lg",children:(0,g.jsx)(d,{className:"text-purple-400 w-5 h-5"})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h1",{className:"text-lg font-semibold text-white",children:"\u05d0\u05e0\u05dc\u05d9\u05d8\u05d9\u05e7\u05d4"}),(0,g.jsx)("p",{className:"text-sm text-white/50",children:(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.case_name)||"\u05ea\u05d9\u05e7"})]})]})]})}),(0,g.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,g.jsx)("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden h-[500px]",children:(0,g.jsx)(k,{events:m,onEventClick:s=>{s.sourceId&&t("/cases/".concat(e,"/documents/").concat(s.sourceId))}})}),(0,g.jsx)("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden h-[500px]",children:(0,g.jsx)(P,{documents:h,onPageClick:(s,a)=>{t("/cases/".concat(e,"/documents/").concat(s,"?page=").concat(a))}})}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsx)(F,{title:"\u05d4\u05ea\u05e4\u05dc\u05d2\u05d5\u05ea \u05d8\u05e2\u05e0\u05d5\u05ea \u05dc\u05e4\u05d9 \u05e1\u05d5\u05d2",data:u,type:"horizontal-bar",className:"bg-slate-900 border border-slate-800"}),(0,g.jsx)(F,{title:"\u05e1\u05ea\u05d9\u05e8\u05d5\u05ea \u05dc\u05e4\u05d9 \u05d7\u05d5\u05de\u05e8\u05d4",data:p,type:"donut",className:"bg-slate-900 border border-slate-800"})]}),(0,g.jsx)("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden h-[400px]",children:(0,g.jsx)(W,{data:b,onCellClick:(e,t)=>{console.log("Cell clicked:",e,t)}})})]})})]})}const J=Y},8646:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9463:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])}}]);
//# sourceMappingURL=5487.d617c334.chunk.js.map