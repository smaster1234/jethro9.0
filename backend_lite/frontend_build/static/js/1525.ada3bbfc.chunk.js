"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1525],{9933:(e,t,s)=>{s.r(t),s.d(t,{DocumentViewerPage:()=>S,default:()=>E});var a=s(5043),l=s(3216),n=s(5475),c=s(2024),r=s(7819),i=s(3658),o=s(1680),d=s(8326),x=s(9463),m=s(9292),h=s(386),u=s(1531),p=s(8969),b=s(7104),f=s(614),j=s(1718),g=s(8987),w=s(6424),N=s(7587),v=(s(4165),s(4947),s(579));j.EA.workerSrc="//unpkg.com/pdfjs-dist@".concat(j.rE,"/build/pdf.worker.min.mjs");const y=e=>{let{url:t,currentPage:s,scale:l=1,onDocumentLoad:n,onPageChange:i,highlightQuote:o,searchQuery:d}=e;const[x,m]=(0,a.useState)(0),[h,u]=(0,a.useState)(!0),[p,b]=(0,a.useState)(null),[f,j]=(0,a.useState)(!0),y=(0,a.useCallback)(e=>{let{numPages:t}=e;m(t),u(!1),b(null),null===n||void 0===n||n(t)},[n]),C=(0,a.useCallback)(e=>{console.error("PDF load error:",e),u(!1),b("\u05dc\u05d0 \u05e0\u05d9\u05ea\u05df \u05dc\u05d8\u05e2\u05d5\u05df \u05d0\u05ea \u05d4\u05de\u05e1\u05de\u05da. \u05d9\u05ea\u05db\u05df \u05e9\u05d4\u05e7\u05d5\u05d1\u05e5 \u05e4\u05d2\u05d5\u05dd \u05d0\u05d5 \u05e9\u05d0\u05d9\u05df \u05dc\u05da \u05d4\u05e8\u05e9\u05d0\u05d5\u05ea \u05d2\u05d9\u05e9\u05d4.")},[]),A=(0,a.useCallback)(()=>{j(!1)},[]),P=(0,a.useCallback)(()=>{j(!1)},[]),S=(0,a.useMemo)(()=>{if(!o&&!d)return;const e=[o,d].filter(Boolean);return t=>{let s=t.str;for(const a of e){if(!a)continue;const e=new RegExp("(".concat(k(a),")"),"gi");s=s.replace(e,'<mark class="bg-yellow-300 text-black px-0.5 rounded">$1</mark>')}return s}},[o,d]);return h?(0,v.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)(c.A,{className:"w-10 h-10 text-blue-500 animate-spin mx-auto"}),(0,v.jsx)("p",{className:"text-white/60 mt-4",children:"\u05d8\u05d5\u05e2\u05df \u05de\u05e1\u05de\u05da PDF..."})]})}):p?(0,v.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,v.jsxs)("div",{className:"text-center max-w-md",children:[(0,v.jsx)(N.A,{className:"w-16 h-16 text-red-400 mx-auto"}),(0,v.jsx)("h3",{className:"text-white text-lg mt-4",children:"\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d8\u05e2\u05d9\u05e0\u05ea PDF"}),(0,v.jsx)("p",{className:"text-white/60 mt-2",children:p})]})}):(0,v.jsxs)("div",{className:"flex flex-col items-center py-8",dir:"ltr",children:[(0,v.jsx)(g.A,{file:t,onLoadSuccess:y,onLoadError:C,loading:(0,v.jsx)("div",{className:"flex items-center justify-center p-12",children:(0,v.jsx)(c.A,{className:"w-8 h-8 text-blue-500 animate-spin"})}),error:(0,v.jsxs)("div",{className:"flex items-center justify-center p-12",children:[(0,v.jsx)(r.A,{className:"w-8 h-8 text-red-400"}),(0,v.jsx)("span",{className:"text-white/60 mr-2",children:"\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d8\u05e2\u05d9\u05e0\u05ea \u05d4\u05de\u05e1\u05de\u05da"})]}),className:"pdf-document",children:(0,v.jsxs)("div",{className:"relative",children:[f&&(0,v.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/50 z-10",children:(0,v.jsx)(c.A,{className:"w-6 h-6 text-blue-500 animate-spin"})}),(0,v.jsx)(w.A,{pageNumber:s,scale:l,onLoadSuccess:A,onLoadError:P,loading:null,renderTextLayer:!0,renderAnnotationLayer:!0,className:"pdf-page shadow-2xl",customTextRenderer:S})]})}),(0,v.jsxs)("div",{className:"mt-4 text-sm text-white/60",children:["\u05e2\u05de\u05d5\u05d3 ",s," \u05de\u05ea\u05d5\u05da ",x]})]})};function k(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var C=s(5262),A=s(7719);const P=e=>{let{numPages:t,currentPage:s,onPageClick:l,evidencePages:n=[],contradictionPages:c=[]}=e;const r=(0,a.useRef)(null),i=new Set(n),d=new Set(c),x=(0,C.Te)({count:t,getScrollElement:()=>r.current,estimateSize:()=>52,overscan:10});(0,a.useEffect)(()=>{x.scrollToIndex(s-1,{align:"center",behavior:"smooth"})},[s,x]);const m=(0,a.useCallback)(e=>d.has(e)?"contradiction":i.has(e)?"evidence":"normal",[i,d]);return(0,v.jsxs)("div",{className:"w-20 bg-slate-800 border-r border-slate-700 flex flex-col",dir:"rtl",children:[(0,v.jsx)("div",{className:"px-2 py-2 border-b border-slate-700",children:(0,v.jsx)("div",{className:"text-[10px] font-medium text-white/50 text-center",children:"\u05e0\u05d9\u05d5\u05d5\u05d8"})}),(0,v.jsxs)("div",{className:"px-2 py-1.5 border-b border-slate-700 space-y-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-1 text-[9px] text-white/40",children:[(0,v.jsx)("div",{className:"w-2 h-2 rounded-sm bg-amber-400/60"}),(0,v.jsx)("span",{children:"\u05e8\u05d0\u05d9\u05d4"})]}),(0,v.jsxs)("div",{className:"flex items-center gap-1 text-[9px] text-white/40",children:[(0,v.jsx)("div",{className:"w-2 h-2 rounded-sm bg-red-400/60"}),(0,v.jsx)("span",{children:"\u05e1\u05ea\u05d9\u05e8\u05d4"})]})]}),(0,v.jsx)("div",{ref:r,className:"flex-1 overflow-y-auto",style:{contain:"strict"},children:(0,v.jsx)("div",{style:{height:"".concat(x.getTotalSize(),"px"),width:"100%",position:"relative"},children:x.getVirtualItems().map(e=>{const t=e.index+1,a=t===s,n=m(t);return(0,v.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start,"px)")},children:(0,v.jsxs)("button",{onClick:()=>l(t),className:"\n                    w-full px-2 py-1.5 flex items-center gap-1.5\n                    transition-colors\n                    ".concat(a?"bg-blue-600/30 border-r-2 border-blue-500":"hover:bg-slate-700/50","\n                  "),children:[(0,v.jsx)("div",{className:"\n                    w-8 h-8 rounded flex items-center justify-center text-[10px] font-medium\n                    ".concat(a?"bg-blue-600 text-white":"contradiction"===n?"bg-red-900/40 text-red-300 border border-red-500/30":"evidence"===n?"bg-amber-900/40 text-amber-300 border border-amber-500/30":"bg-slate-700/50 text-white/60","\n                  "),children:t}),(0,v.jsxs)("div",{className:"flex-1 flex justify-end",children:["contradiction"===n&&(0,v.jsx)(A.A,{className:"w-3 h-3 text-red-400"}),"evidence"===n&&(0,v.jsx)(o.A,{className:"w-3 h-3 text-amber-400"})]})]})},e.key)})})}),(0,v.jsxs)("div",{className:"px-2 py-2 border-t border-slate-700 text-[9px] text-white/40 text-center",children:[t," \u05e2\u05de\u05d5\u05d3\u05d9\u05dd"]})]})},S=()=>{const{caseId:e,fileId:t}=(0,l.g)(),[s]=(0,n.ok)(),j=(0,l.Zp)(),[g,w]=(0,a.useState)(null),[N,k]=(0,a.useState)(!0),[C,A]=(0,a.useState)(null),[S,E]=(0,a.useState)(1),[D,L]=(0,a.useState)(0),[M,T]=(0,a.useState)(1),[I,F]=(0,a.useState)(!0),[K,z]=(0,a.useState)(""),[Q,R]=(0,a.useState)(!1),_=parseInt(s.get("page")||"1",10),H=s.get("quote")||"";(0,a.useEffect)(()=>{(async()=>{if(t){k(!0),A(null);try{const e=await fetch("/api/files/".concat(t,"/info"));if(e.ok){const s=await e.json();w({id:t,filename:s.filename||s.name||"document-".concat(t,".pdf"),mimeType:s.mime_type||s.mimeType||"application/pdf",pageCount:s.page_count||s.pages||0,url:s.url||"/api/files/".concat(t,"/content")})}else w({id:t,filename:"document-".concat(t,".pdf"),mimeType:"application/pdf",pageCount:0,url:"/api/files/".concat(t,"/content")})}catch(e){console.error("Error fetching document:",e),w({id:t,filename:"document-".concat(t,".pdf"),mimeType:"application/pdf",pageCount:0,url:"/api/files/".concat(t,"/content")})}finally{k(!1)}}})()},[t]),(0,a.useEffect)(()=>{_>0&&E(_)},[_]),(0,a.useEffect)(()=>{const t=t=>{if(!(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement))switch(t.key){case"n":case"ArrowRight":case"PageDown":t.preventDefault(),E(e=>Math.min(e+1,D));break;case"p":case"ArrowLeft":case"PageUp":t.preventDefault(),E(e=>Math.max(e-1,1));break;case"f":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),R(!0));break;case"Escape":Q?(R(!1),z("")):j("/cases/".concat(e));break;case"+":case"=":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),T(e=>Math.min(e+.1,3)));break;case"-":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),T(e=>Math.max(e-.1,.5)));break;case"Home":t.preventDefault(),E(1);break;case"End":t.preventDefault(),E(D)}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[D,Q,j,e]);const $=(0,a.useCallback)(e=>{L(e),k(!1)},[]),V=(0,a.useCallback)(e=>{E(e)},[]),q=()=>{j("/cases/".concat(e))};return N&&!g?(0,v.jsx)("div",{className:"h-screen flex items-center justify-center bg-slate-900",children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)(c.A,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto"}),(0,v.jsx)("p",{className:"text-white/70 mt-4",children:"\u05d8\u05d5\u05e2\u05df \u05de\u05e1\u05de\u05da..."})]})}):C?(0,v.jsx)("div",{className:"h-screen flex items-center justify-center bg-slate-900",children:(0,v.jsxs)("div",{className:"text-center max-w-md",children:[(0,v.jsx)(r.A,{className:"w-12 h-12 text-red-500 mx-auto"}),(0,v.jsx)("h2",{className:"text-white text-xl mt-4",children:"\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d8\u05e2\u05d9\u05e0\u05ea \u05d4\u05de\u05e1\u05de\u05da"}),(0,v.jsx)("p",{className:"text-white/60 mt-2",children:C}),(0,v.jsx)("button",{onClick:q,className:"mt-6 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"\u05d7\u05d6\u05d5\u05e8 \u05dc\u05ea\u05d9\u05e7"})]})}):(0,v.jsxs)("div",{className:"h-screen flex flex-col bg-slate-900",dir:"rtl",children:[(0,v.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 bg-slate-800 border-b border-slate-700",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)(n.N_,{to:"/cases/".concat(e),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",title:"\u05d7\u05d6\u05d5\u05e8 \u05dc\u05ea\u05d9\u05e7",children:(0,v.jsx)(i.A,{className:"w-5 h-5 text-white/70"})}),(0,v.jsx)("div",{className:"h-6 w-px bg-slate-700"}),(0,v.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,v.jsx)(o.A,{className:"w-4 h-4 text-blue-400"}),(0,v.jsx)("span",{className:"text-white font-medium truncate max-w-[300px]",children:(null===g||void 0===g?void 0:g.filename)||"\u05de\u05e1\u05de\u05da"})]})]}),(0,v.jsxs)("div",{className:"flex items-center gap-4",children:[(0,v.jsx)("button",{onClick:()=>E(e=>Math.max(e-1,1)),disabled:S<=1,className:"p-1.5 hover:bg-slate-700 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"\u05e2\u05de\u05d5\u05d3 \u05e7\u05d5\u05d3\u05dd (P)",children:(0,v.jsx)(d.A,{className:"w-5 h-5 text-white/70"})}),(0,v.jsxs)("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[(0,v.jsx)("input",{type:"number",value:S,onChange:e=>{const t=parseInt(e.target.value,10);t>=1&&t<=D&&E(t)},className:"w-12 px-2 py-1 bg-slate-700 border border-slate-600 rounded text-center text-white",min:1,max:D}),(0,v.jsx)("span",{children:"/"}),(0,v.jsx)("span",{children:D||"?"})]}),(0,v.jsx)("button",{onClick:()=>E(e=>Math.min(e+1,D)),disabled:S>=D,className:"p-1.5 hover:bg-slate-700 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"\u05e2\u05de\u05d5\u05d3 \u05d4\u05d1\u05d0 (N)",children:(0,v.jsx)(x.A,{className:"w-5 h-5 text-white/70"})})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("button",{onClick:()=>R(!Q),className:"p-2 rounded-lg transition-colors ".concat(Q?"bg-blue-600 text-white":"hover:bg-slate-700 text-white/70"),title:"\u05d7\u05d9\u05e4\u05d5\u05e9 (Ctrl+F)",children:(0,v.jsx)(m.A,{className:"w-5 h-5"})}),(0,v.jsx)("div",{className:"h-6 w-px bg-slate-700"}),(0,v.jsx)("button",{onClick:()=>T(e=>Math.max(e-.1,.5)),className:"p-2 hover:bg-slate-700 rounded-lg text-white/70",title:"\u05d4\u05e7\u05d8\u05e0\u05d4 (-)",children:(0,v.jsx)(h.A,{className:"w-5 h-5"})}),(0,v.jsxs)("button",{onClick:()=>T(1),className:"px-2 py-1 hover:bg-slate-700 rounded text-sm text-white/70",children:[Math.round(100*M),"%"]}),(0,v.jsx)("button",{onClick:()=>T(e=>Math.min(e+.1,3)),className:"p-2 hover:bg-slate-700 rounded-lg text-white/70",title:"\u05d4\u05d2\u05d3\u05dc\u05d4 (+)",children:(0,v.jsx)(u.A,{className:"w-5 h-5"})}),(0,v.jsx)("div",{className:"h-6 w-px bg-slate-700"}),(0,v.jsx)("button",{onClick:()=>F(!I),className:"p-2 rounded-lg transition-colors ".concat(I?"bg-blue-600 text-white":"hover:bg-slate-700 text-white/70"),title:"\u05de\u05e4\u05ea \u05e0\u05d9\u05d5\u05d5\u05d8",children:(0,v.jsx)(p.A,{className:"w-5 h-5"})}),(0,v.jsx)("button",{onClick:()=>{null!==g&&void 0!==g&&g.url&&window.open(g.url,"_blank")},className:"p-2 hover:bg-slate-700 rounded-lg text-white/70",title:"\u05d4\u05d5\u05e8\u05d3\u05d4",children:(0,v.jsx)(b.A,{className:"w-5 h-5"})}),(0,v.jsx)("button",{onClick:q,className:"p-2 hover:bg-red-600/20 rounded-lg text-red-400",title:"\u05e1\u05d2\u05d5\u05e8 (Esc)",children:(0,v.jsx)(f.A,{className:"w-5 h-5"})})]})]}),Q&&(0,v.jsx)("div",{className:"px-4 py-2 bg-slate-800/80 border-b border-slate-700",children:(0,v.jsxs)("div",{className:"flex items-center gap-3 max-w-md",children:[(0,v.jsx)(m.A,{className:"w-4 h-4 text-white/50"}),(0,v.jsx)("input",{type:"text",value:K,onChange:e=>z(e.target.value),placeholder:"\u05d7\u05e4\u05e9 \u05d1\u05d8\u05e7\u05e1\u05d8...",className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-1.5 text-sm text-white placeholder:text-white/40 focus:outline-none focus:border-blue-500",autoFocus:!0}),(0,v.jsx)("button",{onClick:()=>{R(!1),z("")},className:"p-1 hover:bg-slate-700 rounded text-white/60",children:(0,v.jsx)(f.A,{className:"w-4 h-4"})})]})}),(0,v.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,v.jsx)("div",{className:"flex-1 overflow-auto bg-slate-950",children:g&&(0,v.jsx)(y,{url:g.url,currentPage:S,scale:M,onDocumentLoad:$,onPageChange:V,highlightQuote:H,searchQuery:K})}),I&&D>0&&(0,v.jsx)(P,{numPages:D,currentPage:S,onPageClick:V,evidencePages:H?[_]:[]})]}),(0,v.jsxs)("div",{className:"px-4 py-2 bg-slate-800/50 border-t border-slate-700 text-xs text-white/40 flex items-center justify-center gap-6",children:[(0,v.jsx)("span",{children:"N/P - \u05e2\u05de\u05d5\u05d3 \u05d4\u05d1\u05d0/\u05e7\u05d5\u05d3\u05dd"}),(0,v.jsx)("span",{children:"Ctrl+F - \u05d7\u05d9\u05e4\u05d5\u05e9"}),(0,v.jsx)("span",{children:"Ctrl+/- - \u05d6\u05d5\u05dd"}),(0,v.jsx)("span",{children:"Esc - \u05e1\u05d2\u05d5\u05e8"})]})]})},E=S}}]);
//# sourceMappingURL=1525.ada3bbfc.chunk.js.map