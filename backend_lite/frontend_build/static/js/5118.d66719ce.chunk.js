"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5118],{5118:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var a=i(9379),n=i(5043),o=i(2024),s=i(7719),r=i(9688),c=i(5562);const l={liability:"\u05d7\u05d1\u05d5\u05ea",damages:"\u05e0\u05d6\u05e7",procedural:"\u05e4\u05e8\u05d5\u05e6\u05d3\u05d5\u05e8\u05dc\u05d9",defense:"\u05d4\u05d2\u05e0\u05d4",relief:"\u05e1\u05e2\u05d3",factual:"\u05e2\u05d5\u05d1\u05d3\u05ea\u05d9",legal:"\u05de\u05e9\u05e4\u05d8\u05d9",mixed:"\u05de\u05e2\u05d5\u05e8\u05d1"};var d=i(579);const u=e=>{let{caseId:t,caseName:i}=e;const[u,m]=(0,n.useState)(!0),[p,v]=(0,n.useState)(null),[y,f]=(0,n.useState)([]),[_,g]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{m(!0),v(null);try{const e=await(0,r.apiGet)("/api/cases/".concat(t),{showErrorToast:!1}).catch(()=>null),i=(null===e||void 0===e?void 0:e.files)||[],a=e=>{const t=(e||"").toLowerCase();return t.endsWith(".pdf")?"pdf":t.endsWith(".doc")||t.endsWith(".docx")?"doc":t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".webp")?"image":"other"},n=e=>{const t=String(e||"").toLowerCase();return t.includes("complete")||t.includes("done")||t.includes("success")?"complete":t.includes("process")||t.includes("running")?"processing":t.includes("error")||t.includes("fail")?"error":"pending"};f(i.map(e=>{const t=(null===e||void 0===e?void 0:e.filename)||(null===e||void 0===e?void 0:e.original_filename)||(null===e||void 0===e?void 0:e.name)||"\u05de\u05e1\u05de\u05da";return{id:String((null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.file_id)||(null===e||void 0===e?void 0:e.doc_id)||t),filename:t,file_type:a(t),pages:"number"===typeof(null===e||void 0===e?void 0:e.pages)?e.pages:"number"===typeof(null===e||void 0===e?void 0:e.num_pages)?e.num_pages:void 0,ocr_status:n((null===e||void 0===e?void 0:e.ocr_status)||(null===e||void 0===e?void 0:e.status)),mentions_count:"number"===typeof(null===e||void 0===e?void 0:e.mentions_count)?e.mentions_count:void 0}})),g([{id:"claims",name:"Claims",name_he:"\u05d8\u05e2\u05e0\u05d5\u05ea",icon:"search",status:"ready",onClick:()=>{}},{id:"contradictions",name:"Contradictions",name_he:"\u05e1\u05ea\u05d9\u05e8\u05d5\u05ea",icon:"alert",status:"ready",onClick:()=>{}},{id:"strategy",name:"Strategy",name_he:"\u05d0\u05e1\u05d8\u05e8\u05d8\u05d2\u05d9\u05d4",icon:"target",status:"partial",reason_he:"\u05d6\u05de\u05d9\u05df \u05dc\u05d0\u05d7\u05e8 \u05d9\u05e6\u05d9\u05e8\u05ea \u05ea\u05d5\u05e6\u05e8\u05d9\u05dd \u05d1\u05e1\u05d9\u05e1\u05d9\u05d9\u05dd",onClick:()=>{}}])}catch(e){v((null===e||void 0===e?void 0:e.message)||"\u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05d8\u05e2\u05d9\u05e0\u05ea \u05e0\u05ea\u05d5\u05e0\u05d9 \u05d4\u05de\u05d7\u05d1\u05e8\u05ea")}finally{m(!1)}})()},[t]);const h=(0,n.useMemo)(()=>i||"\u05de\u05d7\u05d1\u05e8\u05ea \u05d4\u05ea\u05d9\u05e7",[i]),x=(0,n.useMemo)(()=>({sources:y,capabilities:_}),[y,_]),w=async()=>{const e=await(0,r.apiGet)("/api/cases/".concat(t,"/claims"),{showErrorToast:!1}).catch(()=>({claims:[]}));return Array.isArray(null===e||void 0===e?void 0:e.claims)?e.claims:[]},b=async()=>{const e=await(0,r.apiGet)("/api/legal-notebook/cases/".concat(t,"/contradictions"),{showErrorToast:!1}).catch(()=>({contradictions:[]}));return Array.isArray(null===e||void 0===e?void 0:e.contradictions)?e.contradictions:[]},A=e=>({file_id:null===e||void 0===e?void 0:e.doc_id,page:"number"===typeof(null===e||void 0===e?void 0:e.page)?e.page:void 0,quote:null===e||void 0===e?void 0:e.quote});return u?(0,d.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,d.jsx)(o.A,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,d.jsx)("span",{className:"mr-3 text-gray-300",children:"\u05d8\u05d5\u05e2\u05df \u05de\u05d7\u05d1\u05e8\u05ea..."})]}):p?(0,d.jsxs)("div",{className:"bg-red-900/20 border border-red-500/30 rounded-xl p-6 text-center",children:[(0,d.jsx)(s.A,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),(0,d.jsx)("p",{className:"text-red-400",children:p})]}):(0,d.jsx)(c.A,{caseId:t,caseName:h,initialData:x,onFetchV1:async()=>{var e,i;const[n,o]=await Promise.all([w(),b()]),s=await(0,r.apiGet)("/api/cases/".concat(t,"/ai-summary"),{showErrorToast:!1}).catch(()=>null),c="string"===typeof(null===s||void 0===s?void 0:s.summary)?s.summary:"string"===typeof(null===s||void 0===s||null===(e=s.summary)||void 0===e?void 0:e.text)?s.summary.text:"string"===typeof(null===s||void 0===s||null===(i=s.summary)||void 0===i?void 0:i.one_liner)?s.summary.one_liner:null,l=((e,t)=>{const i="".concat(h,": \u05e0\u05de\u05e6\u05d0\u05d5 ").concat(e.length," \u05d8\u05e2\u05e0\u05d5\u05ea \u05d5\u05be").concat(t.length," \u05e1\u05ea\u05d9\u05e8\u05d5\u05ea."),a=e.length>0?"\u05de\u05d1\u05d8 \u05de\u05d4\u05d9\u05e8 \u05de\u05e6\u05d9\u05d2 \u05d0\u05ea \u05d4\u05ea\u05de\u05d5\u05e0\u05d4 \u05d4\u05db\u05d5\u05dc\u05dc\u05ea \u05dc\u05e4\u05e0\u05d9 \u05e6\u05dc\u05d9\u05dc\u05d4 \u05dc\u05e1\u05d1\u05d9\u05d1\u05ea \u05d4\u05e2\u05d1\u05d5\u05d3\u05d4.":"\u05d4\u05e2\u05dc\u05d4 \u05de\u05e1\u05de\u05db\u05d9\u05dd \u05d0\u05d5 \u05d4\u05e8\u05e5 \u05d9\u05db\u05d5\u05dc\u05d5\u05ea \u05db\u05d3\u05d9 \u05dc\u05d9\u05d9\u05e6\u05e8 \u05de\u05de\u05e6\u05d0\u05d9\u05dd.",n=e.slice(0,6).map((e,t)=>({id:e.id||"kp-".concat(t),text:String(e.claim_text||"").replace(/\s+/g," ").trim().slice(0,180),importance:t<2?"high":t<4?"medium":"low"})).filter(e=>e.text.length>0).slice(0,6),o=new Set;for(const r of e)r.party_from&&o.add(String(r.party_from)),r.party_against&&o.add(String(r.party_against));const s=Array.from(o).slice(0,12).map((e,t)=>({id:"actor-".concat(t,"-").concat(e),name:e,role:"\u05e6\u05d3",party:"other"}));return{summary:{text:"".concat(i," ").concat(a)},keyPoints:n.length>0?n:[{id:"kp-empty-1",text:"\u05d8\u05e8\u05dd \u05d6\u05d5\u05d4\u05d5 \u05e0\u05e7\u05d5\u05d3\u05d5\u05ea \u05de\u05e4\u05ea\u05d7.",importance:"low"}],actors:s}})(n,o);return c?(0,a.A)((0,a.A)({},l),{},{summary:{text:String(c).replace(/\s+/g," ").trim().slice(0,420)}}):l},onFetchV2:async()=>{const[e,t]=await Promise.all([w(),b()]);return((e,t)=>{const i=new Map;for(const a of e)for(const e of[a.party_from,a.party_against]){if(!e)continue;const t=String(e);i.has(t)||i.set(t,{id:"actor-".concat(t),name:t,role:"party",role_he:"\u05e6\u05d3",party:"other",interest_he:void 0,evidence:[]})}const n=e.map(e=>{const t=l[e.claim_type]||"\u05d8\u05e2\u05e0\u05d4",i="legal"===e.claim_type?"legal":"procedural"===e.claim_type?"procedural":"factual",a=Array.isArray(e.evidence_refs)?e.evidence_refs.map(A).filter(e=>e.file_id||e.quote):[];return{id:e.id,claim_type:i,claim_type_he:t,short_statement:String(e.claim_text||"").replace(/\s+/g," ").trim().slice(0,220),full_text:e.claim_text,polarity:"neutral",party:e.party_from||"",evidence:a,confidence:"number"===typeof e.confidence?e.confidence:void 0,disputed:!1}}),o={CRITICAL:"critical",HIGH:"high",MED:"medium",LOW:"low"},s=t.map(e=>{var t,i,n,s;const r=A(e.statement_a),c=A(e.statement_b),l=(e,t,i)=>({id:e,claim_type:"factual",claim_type_he:"\u05e2\u05d5\u05d1\u05d3\u05ea\u05d9\u05ea",short_statement:String(t||"").replace(/\s+/g," ").trim().slice(0,220)||"\u05d8\u05e2\u05e0\u05d4 (\u05dc\u05dc\u05d0 \u05e6\u05d9\u05d8\u05d5\u05d8)",polarity:"neutral",party:"",evidence:null!==i&&void 0!==i&&i.file_id||null!==i&&void 0!==i&&i.quote?[(0,a.A)({},i)]:[]});return{id:e.id,description:e.description,description_he:e.description,severity:o[e.severity]||"medium",claim1:l((null===(t=e.statement_a)||void 0===t?void 0:t.claim_id)||"".concat(e.id,"-a"),null===(i=e.statement_a)||void 0===i?void 0:i.quote,r),claim2:l((null===(n=e.statement_b)||void 0===n?void 0:n.claim_id)||"".concat(e.id,"-b"),null===(s=e.statement_b)||void 0===s?void 0:s.quote,c),evidence:[r,c].filter(e=>e.file_id||e.quote)}});return{actors:Array.from(i.values()),claims:n,timeline:[],contradictions:s,redFlags:[]}})(e,t)},onRunCapability:async()=>({ok:!0}),onDocumentOpen:()=>{}})}}}]);
//# sourceMappingURL=5118.d66719ce.chunk.js.map