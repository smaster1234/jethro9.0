{"version":3,"file":"static/js/1973.bd2a7108.chunk.js","mappings":"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","sources":["api/legalNotebook.ts","components/representation/RepresentationBanner.tsx","api/routes.ts","../node_modules/lucide-react/src/icons/pen.ts"],"sourcesContent":["/**\n * Legal Notebook API Client\n *\n * Typed API functions for Legal Notebook features (C7-C9):\n * - Precedent Dashboard & Query\n * - Contradiction Predicates & Context\n * - Representation Auto-Trigger & Status\n */\n\nimport { apiGet, apiPost } from '../utils/api';\nimport { LEGAL_NOTEBOOK_ROUTES } from './routes';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n// Precedent Dashboard\nexport interface PrecedentDashboardFilters {\n  court_type?: string;\n  district?: string;\n  years_from?: number;\n  years_to?: number;\n  procedural_posture?: string;\n}\n\nexport interface RepresentativeCase {\n  case_id: string;\n  court: string;\n  year: number;\n  outcome: 'supporting' | 'against' | 'neutral';\n  citation?: string;\n  summary?: string;\n}\n\nexport interface PrecedentDashboardResponse {\n  claim_type: string;\n  support_level: 'LOW' | 'MED' | 'HIGH';\n  total_cases: number;\n  time_window: string;\n  representative_cases: {\n    supporting: RepresentativeCase[];\n    against: RepresentativeCase[];\n  };\n  filters_applied: PrecedentDashboardFilters;\n}\n\n// Precedent Query\nexport interface PrecedentQueryPayload {\n  query: string;\n  claim_type?: string;\n  court_type?: string;\n  district?: string;\n  years_from?: number;\n  years_to?: number;\n  procedural_posture?: string;\n  limit?: number;\n}\n\nexport interface PrecedentCitation {\n  quote: string;\n  reference: string;\n  page?: number;\n  doc_id?: string;\n}\n\nexport interface PrecedentQueryResult {\n  case_id: string;\n  title: string;\n  court: string;\n  year: number;\n  why_relevant: string[];\n  citations: PrecedentCitation[];\n  outcome?: string;\n}\n\nexport interface PrecedentQueryResponse {\n  query: string;\n  results: PrecedentQueryResult[];\n  total_count: number;\n  filters_applied: Record<string, any>;\n}\n\n// Contradiction Predicates\nexport interface ContradictionPredicatesPayload {\n  contradiction_type?: string;\n  text_block_a: string;\n  text_block_b: string;\n  context?: string;\n}\n\nexport interface MappedPredicate {\n  predicate_id: string;\n  predicate_name: string;\n  category: string;\n  confidence: number;\n}\n\nexport interface ContradictionPredicatesResponse {\n  predicates: MappedPredicate[];\n  contradiction_type?: string;\n}\n\n// Contradiction Precedent Context\nexport interface PrecedentContextPayload {\n  mapped_predicates: string[];\n  claim_type?: string;\n  court_type?: string;\n  district?: string;\n  years_from?: number;\n  years_to?: number;\n  procedural_posture?: string;\n}\n\nexport interface PrecedentContextResult {\n  case_id: string;\n  title: string;\n  court: string;\n  year: number;\n  outcome?: string;\n  citations: PrecedentCitation[];\n  reasoning_factors?: string[];\n}\n\nexport interface PrecedentContextResponse {\n  predicates: string[];\n  results: PrecedentContextResult[];\n  total_count: number;\n}\n\n// Representation\nexport interface RepresentationTriggerResponse {\n  job_id: string;\n  status: 'pending' | 'running' | 'completed' | 'failed';\n  case_id: string;\n}\n\nexport interface RepresentationStatusResponse {\n  job_id: string;\n  status: 'pending' | 'running' | 'completed' | 'failed';\n  case_id: string;\n  representation?: {\n    side_confirmed: string;\n    confidence: number;\n    evidence_refs?: Array<{\n      signal: string;\n      doc_id: string;\n      quote?: string;\n    }>;\n  };\n  error?: string;\n}\n\nexport interface RepresentationConfirmPayload {\n  side: 'plaintiff' | 'defendant' | 'petitioner' | 'respondent' | 'appellant' | 'other';\n}\n\n// =============================================================================\n// API Functions\n// =============================================================================\n\n/**\n * Get precedent dashboard for a claim type\n */\nexport async function precedentDashboard(\n  claimType: string,\n  filters?: PrecedentDashboardFilters\n): Promise<PrecedentDashboardResponse> {\n  const url = LEGAL_NOTEBOOK_ROUTES.precedentDashboard(claimType);\n  const params = new URLSearchParams();\n\n  if (filters) {\n    if (filters.court_type) params.append('court_type', filters.court_type);\n    if (filters.district) params.append('district', filters.district);\n    if (filters.years_from) params.append('years_from', String(filters.years_from));\n    if (filters.years_to) params.append('years_to', String(filters.years_to));\n    if (filters.procedural_posture) params.append('procedural_posture', filters.procedural_posture);\n  }\n\n  const queryString = params.toString();\n  return apiGet<PrecedentDashboardResponse>(queryString ? `${url}?${queryString}` : url);\n}\n\n/**\n * Query precedents with free text and filters\n */\nexport async function precedentQuery(\n  payload: PrecedentQueryPayload\n): Promise<PrecedentQueryResponse> {\n  return apiPost<PrecedentQueryResponse>(LEGAL_NOTEBOOK_ROUTES.precedentQuery, payload);\n}\n\n/**\n * Map contradiction to predicates\n */\nexport async function contradictionPredicates(\n  payload: ContradictionPredicatesPayload\n): Promise<ContradictionPredicatesResponse> {\n  return apiPost<ContradictionPredicatesResponse>(\n    LEGAL_NOTEBOOK_ROUTES.contradictionPredicates,\n    payload\n  );\n}\n\n/**\n * Get precedent context for contradiction\n */\nexport async function contradictionPrecedentContext(\n  payload: PrecedentContextPayload\n): Promise<PrecedentContextResponse> {\n  return apiPost<PrecedentContextResponse>(\n    LEGAL_NOTEBOOK_ROUTES.contradictionPrecedentContext,\n    payload\n  );\n}\n\n/**\n * Trigger auto representation detection\n */\nexport async function representationAutoTrigger(\n  caseId: string\n): Promise<RepresentationTriggerResponse> {\n  return apiPost<RepresentationTriggerResponse>(\n    LEGAL_NOTEBOOK_ROUTES.representationAutoTrigger(caseId),\n    {}\n  );\n}\n\n/**\n * Get representation job status\n */\nexport async function representationStatus(\n  caseId: string,\n  jobId: string\n): Promise<RepresentationStatusResponse> {\n  return apiGet<RepresentationStatusResponse>(\n    LEGAL_NOTEBOOK_ROUTES.representationStatus(caseId, jobId)\n  );\n}\n\n/**\n * Confirm/override representation side\n */\nexport async function representationConfirm(\n  caseId: string,\n  payload: RepresentationConfirmPayload\n): Promise<{ success: boolean; side: string }> {\n  return apiPost(LEGAL_NOTEBOOK_ROUTES.representationConfirm(caseId), payload);\n}\n","/**\n * RepresentationBanner - Auto-detects representation side (C9)\n *\n * Non-blocking banner that:\n * - Triggers auto-detection on mount\n * - Polls for status until done/failed/timeout\n * - Shows detected side with confidence\n * - Allows user to confirm or override\n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport {\n  Users, Loader2, Check, X, AlertTriangle, Edit2, ChevronDown\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport {\n  representationAutoTrigger,\n  representationStatus,\n  representationConfirm,\n  RepresentationStatusResponse\n} from '../../api/legalNotebook';\n\n// =============================================================================\n// Types\n// =============================================================================\n\ninterface RepresentationBannerProps {\n  caseId: string;\n  onConfirmed?: (side: string) => void;\n}\n\ntype RepresentationSide = 'plaintiff' | 'defendant' | 'petitioner' | 'respondent' | 'appellant' | 'other' | 'unknown';\ntype ConfirmableSide = Exclude<RepresentationSide, 'unknown'>;\n\nconst SIDE_LABELS: Record<string, string> = {\n  plaintiff: 'תובע',\n  defendant: 'נתבע',\n  petitioner: 'מבקש',\n  respondent: 'משיב',\n  appellant: 'מערער',\n  respondent_appeal: 'משיב בערעור',\n  respondent_admin: 'משיב (מנהלי)',\n  other: 'אחר',\n  unknown: 'לא ידוע',\n};\n\nconst CONFIDENCE_LABELS: Record<string, { label: string; color: string }> = {\n  high: { label: 'גבוהה', color: 'text-green-600' },\n  medium: { label: 'בינונית', color: 'text-yellow-600' },\n  low: { label: 'נמוכה', color: 'text-red-600' },\n};\n\n// =============================================================================\n// Component\n// =============================================================================\n\nexport const RepresentationBanner: React.FC<RepresentationBannerProps> = ({\n  caseId,\n  onConfirmed\n}) => {\n  // State\n  const [status, setStatus] = useState<'idle' | 'running' | 'done' | 'failed' | 'timeout'>('idle');\n  const [jobId, setJobId] = useState<string | null>(null);\n  const [detectedSide, setDetectedSide] = useState<string | null>(null);\n  const [confidence, setConfidence] = useState<number>(0);\n  const [confirmedSide, setConfirmedSide] = useState<string | null>(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Refs for polling\n  const pollCount = useRef(0);\n  const pollInterval = useRef<NodeJS.Timeout | null>(null);\n\n  const MAX_POLLS = 15; // 30 seconds (2s interval)\n  const POLL_INTERVAL_MS = 2000;\n\n  // =============================================================================\n  // Polling Logic\n  // =============================================================================\n\n  const stopPolling = useCallback(() => {\n    if (pollInterval.current) {\n      clearInterval(pollInterval.current);\n      pollInterval.current = null;\n    }\n  }, []);\n\n  const pollStatus = useCallback(async () => {\n    if (!jobId) return;\n\n    pollCount.current += 1;\n\n    // Check timeout\n    if (pollCount.current >= MAX_POLLS) {\n      stopPolling();\n      setStatus('timeout');\n      setError('זמן הזיהוי פג - נסה שוב');\n      return;\n    }\n\n    try {\n      const result: RepresentationStatusResponse = await representationStatus(caseId, jobId);\n\n      if (result.status === 'completed') {\n        stopPolling();\n        setStatus('done');\n        if (result.representation) {\n          setDetectedSide(result.representation.side_confirmed);\n          setConfidence(result.representation.confidence);\n        }\n      } else if (result.status === 'failed') {\n        stopPolling();\n        setStatus('failed');\n        setError(result.error || 'הזיהוי נכשל');\n      }\n      // If still running/pending, keep polling\n    } catch (err: any) {\n      console.error('Poll status error:', err);\n      // Don't stop polling on transient errors\n    }\n  }, [caseId, jobId, stopPolling]);\n\n  // Start polling when jobId is set\n  useEffect(() => {\n    if (jobId && status === 'running') {\n      pollCount.current = 0;\n      pollInterval.current = setInterval(pollStatus, POLL_INTERVAL_MS);\n    }\n\n    return () => stopPolling();\n  }, [jobId, status, pollStatus, stopPolling]);\n\n  // =============================================================================\n  // Trigger Detection\n  // =============================================================================\n\n  const triggerDetection = useCallback(async () => {\n    setStatus('running');\n    setError(null);\n    setDetectedSide(null);\n\n    try {\n      const result = await representationAutoTrigger(caseId);\n      setJobId(result.job_id);\n\n      // If already completed (sync response)\n      if (result.status === 'completed') {\n        setStatus('done');\n      }\n    } catch (err: any) {\n      console.error('Trigger detection error:', err);\n      setStatus('failed');\n      setError(err.message || 'שגיאה בזיהוי');\n    }\n  }, [caseId]);\n\n  // Auto-trigger on mount\n  useEffect(() => {\n    triggerDetection();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [caseId]);\n\n  // =============================================================================\n  // Confirm/Override\n  // =============================================================================\n\n  const handleConfirm = useCallback(async () => {\n    if (!detectedSide) return;\n\n    try {\n      await representationConfirm(caseId, { side: detectedSide as any });\n      setConfirmedSide(detectedSide);\n      toast.success('צד הייצוג אושר');\n      onConfirmed?.(detectedSide);\n    } catch (err: any) {\n      console.error('Confirm error:', err);\n      toast.error(err.message || 'שגיאה באישור');\n    }\n  }, [caseId, detectedSide, onConfirmed]);\n\n  const handleOverride = useCallback(async (newSide: ConfirmableSide) => {\n    try {\n      await representationConfirm(caseId, { side: newSide });\n      setConfirmedSide(newSide);\n      setDetectedSide(newSide);\n      setShowEditModal(false);\n      toast.success('צד הייצוג עודכן');\n      onConfirmed?.(newSide);\n    } catch (err: any) {\n      console.error('Override error:', err);\n      toast.error(err.message || 'שגיאה בעדכון');\n    }\n  }, [caseId, onConfirmed]);\n\n  // =============================================================================\n  // Confidence Label\n  // =============================================================================\n\n  const getConfidenceLabel = (conf: number): { label: string; color: string } => {\n    if (conf >= 0.85) return CONFIDENCE_LABELS.high;\n    if (conf >= 0.65) return CONFIDENCE_LABELS.medium;\n    return CONFIDENCE_LABELS.low;\n  };\n\n  // =============================================================================\n  // Render\n  // =============================================================================\n\n  // Don't show if already confirmed\n  if (confirmedSide) {\n    return (\n      <div className=\"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center justify-between\" dir=\"rtl\">\n        <div className=\"flex items-center gap-3\">\n          <Check className=\"h-5 w-5 text-green-600\" />\n          <span className=\"text-green-800\">\n            מייצג את <strong>{SIDE_LABELS[confirmedSide] || confirmedSide}</strong>\n          </span>\n        </div>\n        <button\n          onClick={() => setShowEditModal(true)}\n          className=\"text-sm text-green-600 hover:text-green-800 flex items-center gap-1\"\n        >\n          <Edit2 className=\"h-4 w-4\" />\n          שנה\n        </button>\n\n        {/* Edit Modal */}\n        {showEditModal && (\n          <EditSideModal\n            currentSide={confirmedSide}\n            onSelect={handleOverride}\n            onClose={() => setShowEditModal(false)}\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Running state\n  if (status === 'running') {\n    return (\n      <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-3\" dir=\"rtl\">\n        <Loader2 className=\"h-5 w-5 text-blue-600 animate-spin\" />\n        <span className=\"text-blue-800\">מזהה צד ייצוג...</span>\n      </div>\n    );\n  }\n\n  // Failed/Timeout state\n  if (status === 'failed' || status === 'timeout') {\n    return (\n      <div className=\"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center justify-between\" dir=\"rtl\">\n        <div className=\"flex items-center gap-3\">\n          <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />\n          <span className=\"text-yellow-800\">{error || 'לא ניתן לזהות צד ייצוג'}</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={triggerDetection}\n            className=\"text-sm px-3 py-1 text-yellow-700 border border-yellow-400 rounded hover:bg-yellow-100\"\n          >\n            נסה שוב\n          </button>\n          <button\n            onClick={() => setShowEditModal(true)}\n            className=\"text-sm px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700\"\n          >\n            הגדר ידנית\n          </button>\n        </div>\n\n        {showEditModal && (\n          <EditSideModal\n            currentSide={null}\n            onSelect={handleOverride}\n            onClose={() => setShowEditModal(false)}\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Done state - show detected side\n  if (status === 'done' && detectedSide) {\n    const confLabel = getConfidenceLabel(confidence);\n\n    return (\n      <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between\" dir=\"rtl\">\n        <div className=\"flex items-center gap-3\">\n          <Users className=\"h-5 w-5 text-blue-600\" />\n          <span className=\"text-blue-800\">\n            זיהוי: מייצג את <strong>{SIDE_LABELS[detectedSide] || detectedSide}</strong>\n            <span className={`mr-2 text-sm ${confLabel.color}`}>\n              (ודאות {confLabel.label})\n            </span>\n          </span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={handleConfirm}\n            className=\"text-sm px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-1\"\n          >\n            <Check className=\"h-4 w-4\" />\n            אשר\n          </button>\n          <button\n            onClick={() => setShowEditModal(true)}\n            className=\"text-sm px-3 py-1 text-blue-600 border border-blue-400 rounded hover:bg-blue-100 flex items-center gap-1\"\n          >\n            <Edit2 className=\"h-4 w-4\" />\n            תקן\n          </button>\n        </div>\n\n        {showEditModal && (\n          <EditSideModal\n            currentSide={detectedSide}\n            onSelect={handleOverride}\n            onClose={() => setShowEditModal(false)}\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Idle/unknown - don't show anything\n  return null;\n};\n\n// =============================================================================\n// Edit Modal\n// =============================================================================\n\ninterface EditSideModalProps {\n  currentSide: string | null;\n  onSelect: (side: ConfirmableSide) => void;\n  onClose: () => void;\n}\n\nconst EditSideModal: React.FC<EditSideModalProps> = ({ currentSide, onSelect, onClose }) => {\n  const sides: ConfirmableSide[] = ['plaintiff', 'defendant', 'petitioner', 'respondent', 'appellant', 'other'];\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\" onClick={onClose}>\n      <div\n        className=\"bg-white rounded-lg shadow-xl p-6 w-96 max-w-full\"\n        onClick={(e) => e.stopPropagation()}\n        dir=\"rtl\"\n      >\n        <h3 className=\"text-lg font-semibold mb-4\">בחר צד ייצוג</h3>\n        <div className=\"space-y-2\">\n          {sides.map((side) => (\n            <button\n              key={side}\n              onClick={() => onSelect(side)}\n              className={`w-full p-3 text-right rounded-lg border transition-colors ${\n                currentSide === side\n                  ? 'border-blue-500 bg-blue-50 text-blue-700'\n                  : 'border-gray-200 hover:border-blue-300 hover:bg-gray-50'\n              }`}\n            >\n              {SIDE_LABELS[side]}\n            </button>\n          ))}\n        </div>\n        <button\n          onClick={onClose}\n          className=\"mt-4 w-full py-2 text-gray-600 hover:text-gray-800\"\n        >\n          ביטול\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default RepresentationBanner;\n","/**\n * API Routes - Single Source of Truth\n *\n * All API endpoint paths centralized for consistency.\n * Uses the existing API_BASE_URL from config.\n */\n\n// =============================================================================\n// Legal Notebook Routes (C7-C9)\n// =============================================================================\n\nexport const LEGAL_NOTEBOOK_ROUTES = {\n  // Precedent Dashboard (C7)\n  precedentDashboard: (claimType: string) =>\n    `/api/legal-notebook/precedent/dashboard/${encodeURIComponent(claimType)}`,\n\n  // Precedent Query (C7)\n  precedentQuery: '/api/legal-notebook/precedent/query',\n\n  // Contradiction Predicates (C8)\n  contradictionPredicates: '/api/legal-notebook/contradiction/predicates',\n\n  // Contradiction Precedent Context (C8)\n  contradictionPrecedentContext: '/api/legal-notebook/contradiction/precedent-context',\n\n  // Representation (C9)\n  representationAutoTrigger: (caseId: string) =>\n    `/api/legal-notebook/representation/${encodeURIComponent(caseId)}/auto-trigger`,\n  representationStatus: (caseId: string, jobId: string) =>\n    `/api/legal-notebook/representation/${encodeURIComponent(caseId)}/status/${encodeURIComponent(jobId)}`,\n  representationConfirm: (caseId: string) =>\n    `/api/legal-notebook/representation/${encodeURIComponent(caseId)}/confirm`,\n\n  // Claims\n  claims: '/api/legal-notebook/claims',\n  claimById: (claimId: string) =>\n    `/api/legal-notebook/claims/${encodeURIComponent(claimId)}`,\n  claimSearch: '/api/legal-notebook/claims/search',\n\n  // Contradictions\n  contradictions: '/api/legal-notebook/contradictions',\n  contradictionById: (contradictionId: string) =>\n    `/api/legal-notebook/contradictions/${encodeURIComponent(contradictionId)}`,\n} as const;\n\n// =============================================================================\n// Corpus Finder Routes (Patch C1-C6)\n// =============================================================================\n\nexport const CORPUS_FINDER_ROUTES = {\n  // Search\n  search: '/api/corpus-finder/search',\n\n  // Filters\n  filters: '/api/corpus-finder/filters',\n\n  // Document\n  document: (docId: string) =>\n    `/api/corpus-finder/document/${encodeURIComponent(docId)}`,\n\n  // Stats\n  stats: '/api/corpus-finder/stats',\n\n  // Evaluation Sets\n  evalSets: '/api/corpus-finder/eval-sets',\n  evalSetById: (setId: string) =>\n    `/api/corpus-finder/eval-sets/${encodeURIComponent(setId)}`,\n  evalSetItems: (setId: string) =>\n    `/api/corpus-finder/eval-sets/${encodeURIComponent(setId)}/items`,\n  evalSetItem: (setId: string, docId: string) =>\n    `/api/corpus-finder/eval-sets/${encodeURIComponent(setId)}/items/${encodeURIComponent(docId)}`,\n\n  // PDF Ingestion (PATCH v1.2)\n  ingestPdf: '/api/corpus-finder/ingest/pdf',\n  importFromDir: '/api/corpus-finder/import-from-dir',\n  jobStatus: (jobId: string) =>\n    `/api/corpus-finder/jobs/${encodeURIComponent(jobId)}`,\n  jobItems: (jobId: string) =>\n    `/api/corpus-finder/jobs/${encodeURIComponent(jobId)}/items`,\n  reprocessDoc: (docId: string) =>\n    `/api/corpus-finder/docs/${encodeURIComponent(docId)}/reprocess`,\n} as const;\n\n// =============================================================================\n// Case Context Routes\n// =============================================================================\n\nexport const CASE_ROUTES = {\n  caseById: (caseId: string) =>\n    `/api/cases/${encodeURIComponent(caseId)}`,\n  caseContext: (caseId: string) =>\n    `/api/cases/${encodeURIComponent(caseId)}/context`,\n} as const;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n];\n\n/**\n * @component @name Pen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/pen\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pen = createLucideIcon('pen', __iconNode);\n\nexport default Pen;\n"],"names":["async","representationConfirm","caseId","payload","apiPost","LEGAL_NOTEBOOK_ROUTES","SIDE_LABELS","plaintiff","defendant","petitioner","respondent","appellant","respondent_appeal","respondent_admin","other","unknown","CONFIDENCE_LABELS","label","color","RepresentationBanner","_ref","onConfirmed","status","setStatus","useState","jobId","setJobId","detectedSide","setDetectedSide","confidence","setConfidence","confirmedSide","setConfirmedSide","showEditModal","setShowEditModal","error","setError","pollCount","useRef","pollInterval","stopPolling","useCallback","current","clearInterval","pollStatus","result","apiGet","representationStatus","representation","side_confirmed","err","console","useEffect","setInterval","triggerDetection","representationAutoTrigger","job_id","message","handleConfirm","side","toast","success","handleOverride","newSide","_jsxs","className","dir","children","_jsx","Check","onClick","Edit2","EditSideModal","currentSide","onSelect","onClose","Loader2","AlertTriangle","confLabel","conf","Users","concat","_ref2","e","stopPropagation","map","precedentDashboard","claimType","encodeURIComponent","precedentQuery","contradictionPredicates","contradictionPrecedentContext","claims","claimById","claimId","claimSearch","contradictions","contradictionById","contradictionId","CORPUS_FINDER_ROUTES","search","filters","document","docId","stats","evalSets","evalSetById","setId","evalSetItems","evalSetItem","ingestPdf","importFromDir","jobStatus","jobItems","reprocessDoc","Pen","createLucideIcon","d","key"],"ignoreList":[],"sourceRoot":""}